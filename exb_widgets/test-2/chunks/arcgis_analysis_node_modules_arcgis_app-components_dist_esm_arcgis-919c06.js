"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-919c06"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-home.entry.js":
/*!*****************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-home.entry.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_home: () => (/* binding */ ArcgisNewItemPagesHome)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config-eb5f7dc2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js");
/* harmony import */ var _file_f36193e9_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./file-f36193e9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-f36193e9.js");
/* harmony import */ var _privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./privileges-ccd5f37d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-ccd5f37d.js");
/* harmony import */ var _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./item-properties-e6412a9a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-e6412a9a.js");
/* harmony import */ var _server_item_f12153e6_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./server-item-f12153e6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/server-item-f12153e6.js");
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/* harmony import */ var _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./ui-ecf86bba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js");
/* harmony import */ var _utils_86ac6961_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./utils-86ac6961.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-86ac6961.js");
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/* harmony import */ var _i18n_6685247f_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./i18n-6685247f.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/i18n-6685247f.js");
/* harmony import */ var _item_types_054054c6_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./item-types-054054c6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-054054c6.js");
/* harmony import */ var _privileges_35590eb4_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./privileges-35590eb4.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-35590eb4.js");
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/* harmony import */ var _guid_4f4176ba_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./guid-4f4176ba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js");
/* harmony import */ var _portal_79caaeff_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./portal-79caaeff.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-79caaeff.js");
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./functional-c82f5ab9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-c82f5ab9.js");
/* harmony import */ var _functional_9f648bee_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./functional-9f648bee.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-9f648bee.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */




















const ArcgisNewItemPagesHome = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.newItemUpdatePage = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
    this.allowedFileTypes = null;
    // Triggered when a file is selected (via drop or button)
    this.fileSelectHandler = async (file, fromLocalDevice) => {
      const { user, portal, config: { helpMap, helpBase }, telemetry } = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c;
      const label = fromLocalDevice ? "your device" : "drag drop";
      const payload = {
        eventType: "new item click",
        pageName: "my content",
        category: "new item",
        label
      };
      telemetry === null || telemetry === void 0 ? void 0 : telemetry.logEvent(payload);
      _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.telemetryDetails = label;
      // Show file uploader?
      // This is probably just going to be an analyze step, not upload - on prod upload doesn't happen till you hit submit at the end
      const { title, fileName, extension } = (0,_file_f36193e9_js__WEBPACK_IMPORTED_MODULE_2__.s)(file);
      _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_4__.i.title = title;
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.file = file;
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.fileName = fileName;
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.newItemMode = "file";
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.extension = extension;
      // In case the user goes back to the file select page
      //  and select a different file
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.selectedFields = undefined;
      const possibleItemTypes = (0,_item_types_054054c6_js__WEBPACK_IMPORTED_MODULE_11__.f)(extension);
      const mvFlow = _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.workflow === "map";
      if (possibleItemTypes.length === 1) {
        const type = possibleItemTypes[0].type;
        if (type === "GeoJson" &&
          mvFlow &&
          !(0,_privileges_35590eb4_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal) &&
          (0,_item_types_054054c6_js__WEBPACK_IMPORTED_MODULE_11__.i)(file.size)) {
          // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2800
          this.error = {
            description: _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.i18n.publishSelect.bigGeoJsonHintPublicAccount,
            linkText: _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.i18n.common.learnMore,
            link: `${helpBase}${helpMap["120003923"]}`
          };
          return;
        }
        _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.type = type;
        // reset fields UIs with new file
        if (["Microsoft Excel", "CSV", "GeoJson"].includes(type)) {
          _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.id = null;
          _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.analyzeResults = null;
          _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.selectedFields = null;
          if (type !== "GeoJson") {
            _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.selectedSheet = null;
          }
        }
        _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.tileLayerPublishType = type === "3DTiles Package" ? "3dTiles" : undefined;
        const nextStep = possibleItemTypes[0].nextStep;
        // there is no reason to show publishSelect screen for users that can't publish
        // We still need to analyze csv and let users select fields if add directly
        // even if they don't have publish privilege https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2857
        const publicAccountAnalyzeTypes = ["CSV", "Microsoft Excel"];
        if (mvFlow &&
          !(0,_privileges_35590eb4_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal) &&
          publicAccountAnalyzeTypes.includes(type)) {
          _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.enablePublishing = false;
          this.newItemUpdatePage.emit("publishSelect");
        }
        else if (!(0,_privileges_35590eb4_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal) ||
          (!_config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c.allowPublish && nextStep === "publishSelect")) {
          _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.enablePublishing = false;
          this.newItemUpdatePage.emit("itemProperties");
        }
        else {
          this.newItemUpdatePage.emit(nextStep);
        }
      }
      else if (extension === "zip") {
        this.newItemUpdatePage.emit("zipSelect");
        _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.applicationFile = null;
      }
    };
    this.managedFocus = true;
    this.error = undefined;
  }
  componentWillLoad() {
    // Initialize with file and existing item
    //  will not make the modal go into Home
    // So this will not be called -> safe :)
    (0,_utils_86ac6961_js__WEBPACK_IMPORTED_MODULE_8__.a)();
    const { allowedItemTypes, user, portal } = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c;
    if (allowedItemTypes) {
      // These type support both file and url flow
      const urlAndFileTypes = ["CSV", "GeoJson", "KML"];
      this.allowedFileTypes = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c.allowedItemTypes.filter((type) => 
      // Filter out url types that doesn't support file upload
      (!(0,_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_9__.i)(type) || urlAndFileTypes.includes(type)) &&
        // https://devtopia.esri.com/WebGIS/arcgis-webviewer-app/issues/6013
        !!user &&
        (urlAndFileTypes.includes(type) ||
          (!(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_3__.n)(user) && (0,_privileges_35590eb4_js__WEBPACK_IMPORTED_MODULE_12__.a)(user, type, portal))));
      const i18n = _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.i18n;
      this.browserHelpText = (0,_i18n_6685247f_js__WEBPACK_IMPORTED_MODULE_10__.r)(i18n.common.supportFileTypes, this.allowedFileTypes
        .map((type) => { var _a; return (_a = i18n.itemTypeInfo.lowercaseDisplayName[type]) !== null && _a !== void 0 ? _a : type; })
        .join(", "), "typeList");
    }
    if (_ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.workflow === "map" && !_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.existingItem) {
      // Sometimes when we go back, an item has already been created so we need to clean it up
      // For now, it only happens in MV
      // No need to await this, can be done in the background
      this.removeExistingFile();
    }
  }
  onTransitionComplete() {
    var _a;
    (_a = this.fileBrowserRef) === null || _a === void 0 ? void 0 : _a.focusMainInput();
  }
  async removeExistingFile() {
    const id = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.id;
    if (id) {
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.id = null;
      await (0,_server_item_f12153e6_js__WEBPACK_IMPORTED_MODULE_5__.d)(id, { permanentDelete: true });
    }
  }
  render() {
    const mvFlow = _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.workflow === "map";
    const { allowedFileTypes, error, fileSelectHandler } = this;
    const { portal, config, user, userLicensedItems } = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c;
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.H, null, _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c.allowedModes.includes("file") && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-file-browser", { ref: (ele) => (this.fileBrowserRef = ele), class: { "full-height": mvFlow }, allowedExtensions: allowedFileTypes ? (0,_item_types_054054c6_js__WEBPACK_IMPORTED_MODULE_11__.m)(allowedFileTypes) : undefined, helpText: this.browserHelpText, fullHeight: mvFlow, portal: portal, config: config, user: user, userLicensedItems: userLicensedItems, onCloudDriveConnected: (event) => {
        var _a;
        const provider = event.detail;
        const payload = {
          eventType: "new item click",
          pageName: "my content",
          category: "new item",
          label: provider
        };
        (_a = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c.telemetry) === null || _a === void 0 ? void 0 : _a.logEvent(payload);
        _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_7__.u.telemetryDetails = provider;
        _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_6__.a.cloudProvider = provider;
        this.newItemUpdatePage.emit("cloud");
      }, onFileSelect: ({ detail: { file, source } }) => {
        fileSelectHandler(file, source === "local-device");
      } })), !mvFlow && (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-create-layers-list", null), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { description: error === null || error === void 0 ? void 0 : error.description, link: { href: error === null || error === void 0 ? void 0 : error.link, title: error === null || error === void 0 ? void 0 : error.linkText }, active: !!error, onAlertDismiss: () => (this.error = null) })));
  }
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-f36193e9.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-f36193e9.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ sanitizeFileName),
/* harmony export */   f: () => (/* binding */ formatFileSize),
/* harmony export */   g: () => (/* binding */ getItemInfoByType),
/* harmony export */   s: () => (/* binding */ sanitizeFileInput),
/* harmony export */   v: () => (/* binding */ validateOverwriteFileName)
/* harmony export */ });
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/* harmony import */ var _guid_4f4176ba_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./guid-4f4176ba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



function sanitizeFileName(name, addGUID) {
  //TODO: add new param to spec file.
  const expression = /(?:\.([^.]+))?$/;
  const invalidTitleCharacters = /\.|-/g;
  let fileName = name.replace(/^.*(\\|\/|:)/, "");
  let extension = (fileName && expression.exec(fileName)[1] ? expression.exec(fileName)[1].toLowerCase() : "");
  let title = "";
  if (fileName.indexOf(".rft.") > -1) {
    const [name, suffix] = fileName.split(".rft.");
    extension = `rft.${suffix}`;
    title = name;
  }
  if (fileName && !title) {
    title = fileName.lastIndexOf(".") === -1 ? fileName : fileName.substring(0, fileName.lastIndexOf("."));
  }
  // Replace any invalid characters with an underscore
  title = title.replace(invalidTitleCharacters, "_");
  // Allow file upload of existing item's file name // currently used in append
  if (addGUID) {
    title = makeUniqueFileName(title);
    fileName = `${title}.${extension}`;
  }
  return { title, fileName, extension };
}
// Helper method that takes in a file & returns the cleaned up file name as is and in title form, and the detected file extension
function sanitizeFileInput(file, addGUID) {
  return sanitizeFileName(file.name, !!addGUID);
}
function makeUniqueFileName(name) {
  return `${name}_${(0,_guid_4f4176ba_js__WEBPACK_IMPORTED_MODULE_1__.g)()}`;
}
function validateOverwriteFileName(uploadedFileName, sourceFileName) {
  let fileName = uploadedFileName;
  const position = uploadedFileName.lastIndexOf("\\");
  if (position > -1) {
    fileName = fileName.substring(position + 1, fileName.length);
  }
  return fileName.replace(/\ /g, "_") === sourceFileName.replace(/\ /g, "_");
}
function getItemInfoByType(type) {
  if (_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[type]) {
    return _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[type];
  }
  else {
    return _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[Object.keys(_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a).find((fileType) => _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[fileType].type === type)];
  }
}
function formatFileSize(size) {
  if (!size) {
    return "0 B";
  }
  const i = Math.floor(Math.log(size) / Math.log(1024));
  const adjustedSize = Math.round(size / Math.pow(1024, i));
  const unit = ["B", "KB", "MB", "GB", "TB"][i];
  return `${adjustedSize} ${unit}`;
}




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ guid)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */
function generateId(counts) {
  return counts
    .map((count) => {
    let out = "";
    for (let i = 0; i < count; i++) {
      out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
    }
    return out;
  })
    .join("-");
}
const guid = () => generateId([2, 1, 1, 1, 3]);




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/i18n-6685247f.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/i18n-6685247f.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   r: () => (/* binding */ replaceI18NString)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */
const regexLookupMap = {
  fileName: /\$\{fileName\}/g,
  fileType: /\$\{type\}/g,
  typeList: /\$\{typeList\}/g,
  missingFields: /\$\{\missingFields\}/g
};
const replaceI18NString = (str, replacementString, type) => {
  const typeRegEx = new RegExp(regexLookupMap[type]);
  return str === null || str === void 0 ? void 0 : str.replace(typeRegEx, replacementString);
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-054054c6.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-054054c6.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ isLargeCSV),
/* harmony export */   f: () => (/* binding */ findPossibleItemTypesByExtension),
/* harmony export */   i: () => (/* binding */ isLargeGeoJSON),
/* harmony export */   m: () => (/* binding */ mapItemTypesToFileExtensions)
/* harmony export */ });
/* harmony import */ var _functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./functional-c82f5ab9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-c82f5ab9.js");
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



function findPossibleItemTypesByExtension(extension, validationTypes) {
  // Search item types extensions for the one imported
  let itemTypes;
  if (validationTypes) {
    itemTypes = validationTypes.map((value) => {
      return value.type;
    });
  }
  else {
    itemTypes = Object.keys(_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a);
  }
  let possibleItemTypes = [];
  itemTypes.forEach((type) => {
    var _a;
    if (((_a = _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a[type].fileExt) === null || _a === void 0 ? void 0 : _a.indexOf(extension)) >= 0) {
      possibleItemTypes.push(_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a[type]);
    }
  });
  return possibleItemTypes;
}
function mapItemTypesToFileExtensions(types) {
  if (!types) {
    return null;
  }
  return (0,_functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_0__.b)(types.flatMap((type) => { var _a; return (_a = _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a[type]) === null || _a === void 0 ? void 0 : _a.fileExt; }).filter((valid) => !!valid));
}
const isLargeGeoJSON = (sizeInBytes) => {
  const sizeInMB = sizeInBytes / 1024 / 1024;
  // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2553#issuecomment-3645404
  return sizeInMB > 50; // 50MB
};
const isLargeCSV = (sizeInBytes) => {
  const sizeInMB = sizeInBytes / 1024 / 1024;
  // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2875#issuecomment-3748913
  return sizeInMB > 20; // 20MB
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-86ac6961.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/utils-86ac6961.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ resetStoreOnHome),
/* harmony export */   r: () => (/* binding */ resetAddItemStores)
/* harmony export */ });
/* harmony import */ var _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-properties-e6412a9a.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-properties-e6412a9a.js");
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/* harmony import */ var _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-ecf86bba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */




function resetAddItemStores() {
  _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.d.reset();
  _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_0__.a.reset();
}
const resetStoreOnHome = () => {
  if (_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.existingItem || _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_2__.u.workflow === "register") {
    return;
  }
  _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.d.reset();
  const folder = _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_0__.i.folder;
  _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_0__.a.reset();
  _item_properties_e6412a9a_js__WEBPACK_IMPORTED_MODULE_0__.i.folder = folder;
};




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTkxOWMwNi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzRGO0FBQ3BDO0FBQ0k7QUFDQztBQUNZO0FBQ2I7QUFDRDtBQUNOO0FBQ087QUFDRjtBQUNFO0FBQzZFO0FBQzFFO0FBQ2xDO0FBQ0Q7QUFDRTtBQUNLO0FBQ0Q7QUFDQTs7QUFFbEM7QUFDQTtBQUNBLElBQUkscURBQWdCO0FBQ3BCLDZCQUE2QixxREFBVztBQUN4QztBQUNBO0FBQ0E7QUFDQSxjQUFjLHdCQUF3QixtQkFBbUIsY0FBYyxFQUFFLGtEQUFXO0FBQ3BGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxNQUFNLDhDQUFZO0FBQ2xCO0FBQ0E7QUFDQSxjQUFjLDZCQUE2QixFQUFFLG9EQUFpQjtBQUM5RCxNQUFNLDJEQUFtQjtBQUN6QixNQUFNLG9EQUFZO0FBQ2xCLE1BQU0sb0RBQVk7QUFDbEIsTUFBTSxvREFBWTtBQUNsQixNQUFNLG9EQUFZO0FBQ2xCO0FBQ0E7QUFDQSxNQUFNLG9EQUFZO0FBQ2xCLGdDQUFnQywyREFBZ0M7QUFDaEUscUJBQXFCLDhDQUFZO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywyREFBYztBQUN6QixVQUFVLDJEQUFjO0FBQ3hCO0FBQ0E7QUFDQSx5QkFBeUIsOENBQVk7QUFDckMsc0JBQXNCLDhDQUFZO0FBQ2xDLHFCQUFxQixTQUFTLEVBQUUscUJBQXFCO0FBQ3JEO0FBQ0E7QUFDQTtBQUNBLFFBQVEsb0RBQVk7QUFDcEI7QUFDQTtBQUNBLFVBQVUsb0RBQVk7QUFDdEIsVUFBVSxvREFBWTtBQUN0QixVQUFVLG9EQUFZO0FBQ3RCO0FBQ0EsWUFBWSxvREFBWTtBQUN4QjtBQUNBO0FBQ0EsUUFBUSxv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dUQ7QUFDWTs7QUFFbkU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSw0QkFBNEIsc0RBQWtCO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZUFBZSxzREFBa0I7QUFDakMsNkJBQTZCLHNEQUFrQjtBQUMvQztBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDBEQUFNLDJCQUEyQixRQUFRLGFBQWEsc0RBQWtCLDBEQUEwRDtBQUMzSTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4Qjs7QUFFMEg7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM1QzFIO0FBQ0E7QUFDQTtBQUNBO0FBQ21HO0FBQ3JCO0FBQ3pCOztBQUVyRDtBQUNBLEVBQUUsb0RBQVk7QUFDZCxFQUFFLDJEQUFtQjtBQUNyQjtBQUNBO0FBQ0EsTUFBTSxvREFBWSxpQkFBaUIsOENBQVk7QUFDL0M7QUFDQTtBQUNBLEVBQUUsb0RBQVk7QUFDZCxpQkFBaUIsMkRBQW1CO0FBQ3BDLEVBQUUsMkRBQW1CO0FBQ3JCLEVBQUUsMkRBQW1CO0FBQ3JCOztBQUUwRCIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1uZXctaXRlbS1wYWdlcy1ob21lLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2ZpbGUtZjM2MTkzZTkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vZ3VpZC00ZjQxNzZiYS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9pMThuLTY2ODUyNDdmLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2l0ZW0tdHlwZXMtMDU0MDU0YzYuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vdXRpbHMtODZhYzY5NjEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCB9IGZyb20gJy4vaW5kZXgtOTJlYmIzOTYuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25maWdTdGF0ZSB9IGZyb20gJy4vY29uZmlnLWViNWY3ZGMyLmpzJztcbmltcG9ydCB7IHMgYXMgc2FuaXRpemVGaWxlSW5wdXQgfSBmcm9tICcuL2ZpbGUtZjM2MTkzZTkuanMnO1xuaW1wb3J0IHsgbiBhcyBpc1B1YmxpY1VzZXIgfSBmcm9tICcuL3ByaXZpbGVnZXMtY2NkNWYzN2QuanMnO1xuaW1wb3J0IHsgaSBhcyBpdGVtUHJvcGVydGllc1N0YXRlIH0gZnJvbSAnLi9pdGVtLXByb3BlcnRpZXMtZTY0MTJhOWEuanMnO1xuaW1wb3J0IHsgZCBhcyBkZWxldGVJdGVtIH0gZnJvbSAnLi9zZXJ2ZXItaXRlbS1mMTIxNTNlNi5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tOTdkNTc3YTkuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWVjZjg2YmJhLmpzJztcbmltcG9ydCB7IGEgYXMgcmVzZXRTdG9yZU9uSG9tZSB9IGZyb20gJy4vdXRpbHMtODZhYzY5NjEuanMnO1xuaW1wb3J0IHsgaSBhcyBpc1VybFR5cGUgfSBmcm9tICcuL2l0ZW0tdHlwZXMtYjRmZTg2YWQuanMnO1xuaW1wb3J0IHsgciBhcyByZXBsYWNlSTE4TlN0cmluZyB9IGZyb20gJy4vaTE4bi02Njg1MjQ3Zi5qcyc7XG5pbXBvcnQgeyBmIGFzIGZpbmRQb3NzaWJsZUl0ZW1UeXBlc0J5RXh0ZW5zaW9uLCBpIGFzIGlzTGFyZ2VHZW9KU09OLCBtIGFzIG1hcEl0ZW1UeXBlc1RvRmlsZUV4dGVuc2lvbnMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtMDU0MDU0YzYuanMnO1xuaW1wb3J0IHsgYSBhcyBjYW5QdWJsaXNoVHlwZSB9IGZyb20gJy4vcHJpdmlsZWdlcy0zNTU5MGViNC5qcyc7XG5pbXBvcnQgJy4vaW5kZXgtODFkNTQ4YjcuanMnO1xuaW1wb3J0ICcuL2d1aWQtNGY0MTc2YmEuanMnO1xuaW1wb3J0ICcuL3BvcnRhbC03OWNhYWVmZi5qcyc7XG5pbXBvcnQgJy4vbG9hZE1vZHVsZXMtYWFmMzBiZDYuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtYzgyZjVhYjkuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtOWY2NDhiZWUuanMnO1xuXG5jb25zdCBBcmNnaXNOZXdJdGVtUGFnZXNIb21lID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtVXBkYXRlUGFnZVwiLCA3KTtcbiAgICB0aGlzLmFsbG93ZWRGaWxlVHlwZXMgPSBudWxsO1xuICAgIC8vIFRyaWdnZXJlZCB3aGVuIGEgZmlsZSBpcyBzZWxlY3RlZCAodmlhIGRyb3Agb3IgYnV0dG9uKVxuICAgIHRoaXMuZmlsZVNlbGVjdEhhbmRsZXIgPSBhc3luYyAoZmlsZSwgZnJvbUxvY2FsRGV2aWNlKSA9PiB7XG4gICAgICBjb25zdCB7IHVzZXIsIHBvcnRhbCwgY29uZmlnOiB7IGhlbHBNYXAsIGhlbHBCYXNlIH0sIHRlbGVtZXRyeSB9ID0gY29uZmlnU3RhdGU7XG4gICAgICBjb25zdCBsYWJlbCA9IGZyb21Mb2NhbERldmljZSA/IFwieW91ciBkZXZpY2VcIiA6IFwiZHJhZyBkcm9wXCI7XG4gICAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgICBldmVudFR5cGU6IFwibmV3IGl0ZW0gY2xpY2tcIixcbiAgICAgICAgcGFnZU5hbWU6IFwibXkgY29udGVudFwiLFxuICAgICAgICBjYXRlZ29yeTogXCJuZXcgaXRlbVwiLFxuICAgICAgICBsYWJlbFxuICAgICAgfTtcbiAgICAgIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5sb2dFdmVudChwYXlsb2FkKTtcbiAgICAgIHVpU3RvcmVTdGF0ZS50ZWxlbWV0cnlEZXRhaWxzID0gbGFiZWw7XG4gICAgICAvLyBTaG93IGZpbGUgdXBsb2FkZXI/XG4gICAgICAvLyBUaGlzIGlzIHByb2JhYmx5IGp1c3QgZ29pbmcgdG8gYmUgYW4gYW5hbHl6ZSBzdGVwLCBub3QgdXBsb2FkIC0gb24gcHJvZCB1cGxvYWQgZG9lc24ndCBoYXBwZW4gdGlsbCB5b3UgaGl0IHN1Ym1pdCBhdCB0aGUgZW5kXG4gICAgICBjb25zdCB7IHRpdGxlLCBmaWxlTmFtZSwgZXh0ZW5zaW9uIH0gPSBzYW5pdGl6ZUZpbGVJbnB1dChmaWxlKTtcbiAgICAgIGl0ZW1Qcm9wZXJ0aWVzU3RhdGUudGl0bGUgPSB0aXRsZTtcbiAgICAgIGFkZEl0ZW1TdGF0ZS5maWxlID0gZmlsZTtcbiAgICAgIGFkZEl0ZW1TdGF0ZS5maWxlTmFtZSA9IGZpbGVOYW1lO1xuICAgICAgYWRkSXRlbVN0YXRlLm5ld0l0ZW1Nb2RlID0gXCJmaWxlXCI7XG4gICAgICBhZGRJdGVtU3RhdGUuZXh0ZW5zaW9uID0gZXh0ZW5zaW9uO1xuICAgICAgLy8gSW4gY2FzZSB0aGUgdXNlciBnb2VzIGJhY2sgdG8gdGhlIGZpbGUgc2VsZWN0IHBhZ2VcbiAgICAgIC8vICBhbmQgc2VsZWN0IGEgZGlmZmVyZW50IGZpbGVcbiAgICAgIGFkZEl0ZW1TdGF0ZS5zZWxlY3RlZEZpZWxkcyA9IHVuZGVmaW5lZDtcbiAgICAgIGNvbnN0IHBvc3NpYmxlSXRlbVR5cGVzID0gZmluZFBvc3NpYmxlSXRlbVR5cGVzQnlFeHRlbnNpb24oZXh0ZW5zaW9uKTtcbiAgICAgIGNvbnN0IG12RmxvdyA9IHVpU3RvcmVTdGF0ZS53b3JrZmxvdyA9PT0gXCJtYXBcIjtcbiAgICAgIGlmIChwb3NzaWJsZUl0ZW1UeXBlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgY29uc3QgdHlwZSA9IHBvc3NpYmxlSXRlbVR5cGVzWzBdLnR5cGU7XG4gICAgICAgIGlmICh0eXBlID09PSBcIkdlb0pzb25cIiAmJlxuICAgICAgICAgIG12RmxvdyAmJlxuICAgICAgICAgICFjYW5QdWJsaXNoVHlwZSh1c2VyLCB0eXBlLCBwb3J0YWwpICYmXG4gICAgICAgICAgaXNMYXJnZUdlb0pTT04oZmlsZS5zaXplKSkge1xuICAgICAgICAgIC8vIGh0dHBzOi8vZGV2dG9waWEuZXNyaS5jb20vV2ViR0lTL2FyY2dpcy1hcHAtY29tcG9uZW50cy9pc3N1ZXMvMjgwMFxuICAgICAgICAgIHRoaXMuZXJyb3IgPSB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogdWlTdG9yZVN0YXRlLmkxOG4ucHVibGlzaFNlbGVjdC5iaWdHZW9Kc29uSGludFB1YmxpY0FjY291bnQsXG4gICAgICAgICAgICBsaW5rVGV4dDogdWlTdG9yZVN0YXRlLmkxOG4uY29tbW9uLmxlYXJuTW9yZSxcbiAgICAgICAgICAgIGxpbms6IGAke2hlbHBCYXNlfSR7aGVscE1hcFtcIjEyMDAwMzkyM1wiXX1gXG4gICAgICAgICAgfTtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgYWRkSXRlbVN0YXRlLnR5cGUgPSB0eXBlO1xuICAgICAgICAvLyByZXNldCBmaWVsZHMgVUlzIHdpdGggbmV3IGZpbGVcbiAgICAgICAgaWYgKFtcIk1pY3Jvc29mdCBFeGNlbFwiLCBcIkNTVlwiLCBcIkdlb0pzb25cIl0uaW5jbHVkZXModHlwZSkpIHtcbiAgICAgICAgICBhZGRJdGVtU3RhdGUuaWQgPSBudWxsO1xuICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5hbmFseXplUmVzdWx0cyA9IG51bGw7XG4gICAgICAgICAgYWRkSXRlbVN0YXRlLnNlbGVjdGVkRmllbGRzID0gbnVsbDtcbiAgICAgICAgICBpZiAodHlwZSAhPT0gXCJHZW9Kc29uXCIpIHtcbiAgICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5zZWxlY3RlZFNoZWV0ID0gbnVsbDtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYWRkSXRlbVN0YXRlLnRpbGVMYXllclB1Ymxpc2hUeXBlID0gdHlwZSA9PT0gXCIzRFRpbGVzIFBhY2thZ2VcIiA/IFwiM2RUaWxlc1wiIDogdW5kZWZpbmVkO1xuICAgICAgICBjb25zdCBuZXh0U3RlcCA9IHBvc3NpYmxlSXRlbVR5cGVzWzBdLm5leHRTdGVwO1xuICAgICAgICAvLyB0aGVyZSBpcyBubyByZWFzb24gdG8gc2hvdyBwdWJsaXNoU2VsZWN0IHNjcmVlbiBmb3IgdXNlcnMgdGhhdCBjYW4ndCBwdWJsaXNoXG4gICAgICAgIC8vIFdlIHN0aWxsIG5lZWQgdG8gYW5hbHl6ZSBjc3YgYW5kIGxldCB1c2VycyBzZWxlY3QgZmllbGRzIGlmIGFkZCBkaXJlY3RseVxuICAgICAgICAvLyBldmVuIGlmIHRoZXkgZG9uJ3QgaGF2ZSBwdWJsaXNoIHByaXZpbGVnZSBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtYXBwLWNvbXBvbmVudHMvaXNzdWVzLzI4NTdcbiAgICAgICAgY29uc3QgcHVibGljQWNjb3VudEFuYWx5emVUeXBlcyA9IFtcIkNTVlwiLCBcIk1pY3Jvc29mdCBFeGNlbFwiXTtcbiAgICAgICAgaWYgKG12RmxvdyAmJlxuICAgICAgICAgICFjYW5QdWJsaXNoVHlwZSh1c2VyLCB0eXBlLCBwb3J0YWwpICYmXG4gICAgICAgICAgcHVibGljQWNjb3VudEFuYWx5emVUeXBlcy5pbmNsdWRlcyh0eXBlKSkge1xuICAgICAgICAgIGFkZEl0ZW1TdGF0ZS5lbmFibGVQdWJsaXNoaW5nID0gZmFsc2U7XG4gICAgICAgICAgdGhpcy5uZXdJdGVtVXBkYXRlUGFnZS5lbWl0KFwicHVibGlzaFNlbGVjdFwiKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIGlmICghY2FuUHVibGlzaFR5cGUodXNlciwgdHlwZSwgcG9ydGFsKSB8fFxuICAgICAgICAgICghY29uZmlnU3RhdGUuYWxsb3dQdWJsaXNoICYmIG5leHRTdGVwID09PSBcInB1Ymxpc2hTZWxlY3RcIikpIHtcbiAgICAgICAgICBhZGRJdGVtU3RhdGUuZW5hYmxlUHVibGlzaGluZyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChcIml0ZW1Qcm9wZXJ0aWVzXCIpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UuZW1pdChuZXh0U3RlcCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGV4dGVuc2lvbiA9PT0gXCJ6aXBcIikge1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQoXCJ6aXBTZWxlY3RcIik7XG4gICAgICAgIGFkZEl0ZW1TdGF0ZS5hcHBsaWNhdGlvbkZpbGUgPSBudWxsO1xuICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5tYW5hZ2VkRm9jdXMgPSB0cnVlO1xuICAgIHRoaXMuZXJyb3IgPSB1bmRlZmluZWQ7XG4gIH1cbiAgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgLy8gSW5pdGlhbGl6ZSB3aXRoIGZpbGUgYW5kIGV4aXN0aW5nIGl0ZW1cbiAgICAvLyAgd2lsbCBub3QgbWFrZSB0aGUgbW9kYWwgZ28gaW50byBIb21lXG4gICAgLy8gU28gdGhpcyB3aWxsIG5vdCBiZSBjYWxsZWQgLT4gc2FmZSA6KVxuICAgIHJlc2V0U3RvcmVPbkhvbWUoKTtcbiAgICBjb25zdCB7IGFsbG93ZWRJdGVtVHlwZXMsIHVzZXIsIHBvcnRhbCB9ID0gY29uZmlnU3RhdGU7XG4gICAgaWYgKGFsbG93ZWRJdGVtVHlwZXMpIHtcbiAgICAgIC8vIFRoZXNlIHR5cGUgc3VwcG9ydCBib3RoIGZpbGUgYW5kIHVybCBmbG93XG4gICAgICBjb25zdCB1cmxBbmRGaWxlVHlwZXMgPSBbXCJDU1ZcIiwgXCJHZW9Kc29uXCIsIFwiS01MXCJdO1xuICAgICAgdGhpcy5hbGxvd2VkRmlsZVR5cGVzID0gY29uZmlnU3RhdGUuYWxsb3dlZEl0ZW1UeXBlcy5maWx0ZXIoKHR5cGUpID0+IFxuICAgICAgLy8gRmlsdGVyIG91dCB1cmwgdHlwZXMgdGhhdCBkb2Vzbid0IHN1cHBvcnQgZmlsZSB1cGxvYWRcbiAgICAgICghaXNVcmxUeXBlKHR5cGUpIHx8IHVybEFuZEZpbGVUeXBlcy5pbmNsdWRlcyh0eXBlKSkgJiZcbiAgICAgICAgLy8gaHR0cHM6Ly9kZXZ0b3BpYS5lc3JpLmNvbS9XZWJHSVMvYXJjZ2lzLXdlYnZpZXdlci1hcHAvaXNzdWVzLzYwMTNcbiAgICAgICAgISF1c2VyICYmXG4gICAgICAgICh1cmxBbmRGaWxlVHlwZXMuaW5jbHVkZXModHlwZSkgfHxcbiAgICAgICAgICAoIWlzUHVibGljVXNlcih1c2VyKSAmJiBjYW5QdWJsaXNoVHlwZSh1c2VyLCB0eXBlLCBwb3J0YWwpKSkpO1xuICAgICAgY29uc3QgaTE4biA9IHVpU3RvcmVTdGF0ZS5pMThuO1xuICAgICAgdGhpcy5icm93c2VySGVscFRleHQgPSByZXBsYWNlSTE4TlN0cmluZyhpMThuLmNvbW1vbi5zdXBwb3J0RmlsZVR5cGVzLCB0aGlzLmFsbG93ZWRGaWxlVHlwZXNcbiAgICAgICAgLm1hcCgodHlwZSkgPT4geyB2YXIgX2E7IHJldHVybiAoX2EgPSBpMThuLml0ZW1UeXBlSW5mby5sb3dlcmNhc2VEaXNwbGF5TmFtZVt0eXBlXSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdHlwZTsgfSlcbiAgICAgICAgLmpvaW4oXCIsIFwiKSwgXCJ0eXBlTGlzdFwiKTtcbiAgICB9XG4gICAgaWYgKHVpU3RvcmVTdGF0ZS53b3JrZmxvdyA9PT0gXCJtYXBcIiAmJiAhYWRkSXRlbVN0YXRlLmV4aXN0aW5nSXRlbSkge1xuICAgICAgLy8gU29tZXRpbWVzIHdoZW4gd2UgZ28gYmFjaywgYW4gaXRlbSBoYXMgYWxyZWFkeSBiZWVuIGNyZWF0ZWQgc28gd2UgbmVlZCB0byBjbGVhbiBpdCB1cFxuICAgICAgLy8gRm9yIG5vdywgaXQgb25seSBoYXBwZW5zIGluIE1WXG4gICAgICAvLyBObyBuZWVkIHRvIGF3YWl0IHRoaXMsIGNhbiBiZSBkb25lIGluIHRoZSBiYWNrZ3JvdW5kXG4gICAgICB0aGlzLnJlbW92ZUV4aXN0aW5nRmlsZSgpO1xuICAgIH1cbiAgfVxuICBvblRyYW5zaXRpb25Db21wbGV0ZSgpIHtcbiAgICB2YXIgX2E7XG4gICAgKF9hID0gdGhpcy5maWxlQnJvd3NlclJlZikgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZvY3VzTWFpbklucHV0KCk7XG4gIH1cbiAgYXN5bmMgcmVtb3ZlRXhpc3RpbmdGaWxlKCkge1xuICAgIGNvbnN0IGlkID0gYWRkSXRlbVN0YXRlLmlkO1xuICAgIGlmIChpZCkge1xuICAgICAgYWRkSXRlbVN0YXRlLmlkID0gbnVsbDtcbiAgICAgIGF3YWl0IGRlbGV0ZUl0ZW0oaWQsIHsgcGVybWFuZW50RGVsZXRlOiB0cnVlIH0pO1xuICAgIH1cbiAgfVxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgbXZGbG93ID0gdWlTdG9yZVN0YXRlLndvcmtmbG93ID09PSBcIm1hcFwiO1xuICAgIGNvbnN0IHsgYWxsb3dlZEZpbGVUeXBlcywgZXJyb3IsIGZpbGVTZWxlY3RIYW5kbGVyIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgcG9ydGFsLCBjb25maWcsIHVzZXIsIHVzZXJMaWNlbnNlZEl0ZW1zIH0gPSBjb25maWdTdGF0ZTtcbiAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgY29uZmlnU3RhdGUuYWxsb3dlZE1vZGVzLmluY2x1ZGVzKFwiZmlsZVwiKSAmJiAoaChcImFyY2dpcy1maWxlLWJyb3dzZXJcIiwgeyByZWY6IChlbGUpID0+ICh0aGlzLmZpbGVCcm93c2VyUmVmID0gZWxlKSwgY2xhc3M6IHsgXCJmdWxsLWhlaWdodFwiOiBtdkZsb3cgfSwgYWxsb3dlZEV4dGVuc2lvbnM6IGFsbG93ZWRGaWxlVHlwZXMgPyBtYXBJdGVtVHlwZXNUb0ZpbGVFeHRlbnNpb25zKGFsbG93ZWRGaWxlVHlwZXMpIDogdW5kZWZpbmVkLCBoZWxwVGV4dDogdGhpcy5icm93c2VySGVscFRleHQsIGZ1bGxIZWlnaHQ6IG12RmxvdywgcG9ydGFsOiBwb3J0YWwsIGNvbmZpZzogY29uZmlnLCB1c2VyOiB1c2VyLCB1c2VyTGljZW5zZWRJdGVtczogdXNlckxpY2Vuc2VkSXRlbXMsIG9uQ2xvdWREcml2ZUNvbm5lY3RlZDogKGV2ZW50KSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgY29uc3QgcHJvdmlkZXIgPSBldmVudC5kZXRhaWw7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSB7XG4gICAgICAgICAgZXZlbnRUeXBlOiBcIm5ldyBpdGVtIGNsaWNrXCIsXG4gICAgICAgICAgcGFnZU5hbWU6IFwibXkgY29udGVudFwiLFxuICAgICAgICAgIGNhdGVnb3J5OiBcIm5ldyBpdGVtXCIsXG4gICAgICAgICAgbGFiZWw6IHByb3ZpZGVyXG4gICAgICAgIH07XG4gICAgICAgIChfYSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmxvZ0V2ZW50KHBheWxvYWQpO1xuICAgICAgICB1aVN0b3JlU3RhdGUudGVsZW1ldHJ5RGV0YWlscyA9IHByb3ZpZGVyO1xuICAgICAgICBhZGRJdGVtU3RhdGUuY2xvdWRQcm92aWRlciA9IHByb3ZpZGVyO1xuICAgICAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQoXCJjbG91ZFwiKTtcbiAgICAgIH0sIG9uRmlsZVNlbGVjdDogKHsgZGV0YWlsOiB7IGZpbGUsIHNvdXJjZSB9IH0pID0+IHtcbiAgICAgICAgZmlsZVNlbGVjdEhhbmRsZXIoZmlsZSwgc291cmNlID09PSBcImxvY2FsLWRldmljZVwiKTtcbiAgICAgIH0gfSkpLCAhbXZGbG93ICYmIGgoXCJhcmNnaXMtbmV3LWl0ZW0tY3JlYXRlLWxheWVycy1saXN0XCIsIG51bGwpLCBoKFwiYXJjZ2lzLW5ldy1pdGVtLWFsZXJ0XCIsIHsgZGVzY3JpcHRpb246IGVycm9yID09PSBudWxsIHx8IGVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlcnJvci5kZXNjcmlwdGlvbiwgbGluazogeyBocmVmOiBlcnJvciA9PT0gbnVsbCB8fCBlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXJyb3IubGluaywgdGl0bGU6IGVycm9yID09PSBudWxsIHx8IGVycm9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBlcnJvci5saW5rVGV4dCB9LCBhY3RpdmU6ICEhZXJyb3IsIG9uQWxlcnREaXNtaXNzOiAoKSA9PiAodGhpcy5lcnJvciA9IG51bGwpIH0pKSk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IEFyY2dpc05ld0l0ZW1QYWdlc0hvbWUgYXMgYXJjZ2lzX25ld19pdGVtX3BhZ2VzX2hvbWUgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgYSBhcyBhZGRDcmVhdGVJdGVtVHlwZXMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtYjRmZTg2YWQuanMnO1xuaW1wb3J0IHsgZyBhcyBndWlkIH0gZnJvbSAnLi9ndWlkLTRmNDE3NmJhLmpzJztcblxuZnVuY3Rpb24gc2FuaXRpemVGaWxlTmFtZShuYW1lLCBhZGRHVUlEKSB7XG4gIC8vVE9ETzogYWRkIG5ldyBwYXJhbSB0byBzcGVjIGZpbGUuXG4gIGNvbnN0IGV4cHJlc3Npb24gPSAvKD86XFwuKFteLl0rKSk/JC87XG4gIGNvbnN0IGludmFsaWRUaXRsZUNoYXJhY3RlcnMgPSAvXFwufC0vZztcbiAgbGV0IGZpbGVOYW1lID0gbmFtZS5yZXBsYWNlKC9eLiooXFxcXHxcXC98OikvLCBcIlwiKTtcbiAgbGV0IGV4dGVuc2lvbiA9IChmaWxlTmFtZSAmJiBleHByZXNzaW9uLmV4ZWMoZmlsZU5hbWUpWzFdID8gZXhwcmVzc2lvbi5leGVjKGZpbGVOYW1lKVsxXS50b0xvd2VyQ2FzZSgpIDogXCJcIik7XG4gIGxldCB0aXRsZSA9IFwiXCI7XG4gIGlmIChmaWxlTmFtZS5pbmRleE9mKFwiLnJmdC5cIikgPiAtMSkge1xuICAgIGNvbnN0IFtuYW1lLCBzdWZmaXhdID0gZmlsZU5hbWUuc3BsaXQoXCIucmZ0LlwiKTtcbiAgICBleHRlbnNpb24gPSBgcmZ0LiR7c3VmZml4fWA7XG4gICAgdGl0bGUgPSBuYW1lO1xuICB9XG4gIGlmIChmaWxlTmFtZSAmJiAhdGl0bGUpIHtcbiAgICB0aXRsZSA9IGZpbGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKSA9PT0gLTEgPyBmaWxlTmFtZSA6IGZpbGVOYW1lLnN1YnN0cmluZygwLCBmaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIikpO1xuICB9XG4gIC8vIFJlcGxhY2UgYW55IGludmFsaWQgY2hhcmFjdGVycyB3aXRoIGFuIHVuZGVyc2NvcmVcbiAgdGl0bGUgPSB0aXRsZS5yZXBsYWNlKGludmFsaWRUaXRsZUNoYXJhY3RlcnMsIFwiX1wiKTtcbiAgLy8gQWxsb3cgZmlsZSB1cGxvYWQgb2YgZXhpc3RpbmcgaXRlbSdzIGZpbGUgbmFtZSAvLyBjdXJyZW50bHkgdXNlZCBpbiBhcHBlbmRcbiAgaWYgKGFkZEdVSUQpIHtcbiAgICB0aXRsZSA9IG1ha2VVbmlxdWVGaWxlTmFtZSh0aXRsZSk7XG4gICAgZmlsZU5hbWUgPSBgJHt0aXRsZX0uJHtleHRlbnNpb259YDtcbiAgfVxuICByZXR1cm4geyB0aXRsZSwgZmlsZU5hbWUsIGV4dGVuc2lvbiB9O1xufVxuLy8gSGVscGVyIG1ldGhvZCB0aGF0IHRha2VzIGluIGEgZmlsZSAmIHJldHVybnMgdGhlIGNsZWFuZWQgdXAgZmlsZSBuYW1lIGFzIGlzIGFuZCBpbiB0aXRsZSBmb3JtLCBhbmQgdGhlIGRldGVjdGVkIGZpbGUgZXh0ZW5zaW9uXG5mdW5jdGlvbiBzYW5pdGl6ZUZpbGVJbnB1dChmaWxlLCBhZGRHVUlEKSB7XG4gIHJldHVybiBzYW5pdGl6ZUZpbGVOYW1lKGZpbGUubmFtZSwgISFhZGRHVUlEKTtcbn1cbmZ1bmN0aW9uIG1ha2VVbmlxdWVGaWxlTmFtZShuYW1lKSB7XG4gIHJldHVybiBgJHtuYW1lfV8ke2d1aWQoKX1gO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVPdmVyd3JpdGVGaWxlTmFtZSh1cGxvYWRlZEZpbGVOYW1lLCBzb3VyY2VGaWxlTmFtZSkge1xuICBsZXQgZmlsZU5hbWUgPSB1cGxvYWRlZEZpbGVOYW1lO1xuICBjb25zdCBwb3NpdGlvbiA9IHVwbG9hZGVkRmlsZU5hbWUubGFzdEluZGV4T2YoXCJcXFxcXCIpO1xuICBpZiAocG9zaXRpb24gPiAtMSkge1xuICAgIGZpbGVOYW1lID0gZmlsZU5hbWUuc3Vic3RyaW5nKHBvc2l0aW9uICsgMSwgZmlsZU5hbWUubGVuZ3RoKTtcbiAgfVxuICByZXR1cm4gZmlsZU5hbWUucmVwbGFjZSgvXFwgL2csIFwiX1wiKSA9PT0gc291cmNlRmlsZU5hbWUucmVwbGFjZSgvXFwgL2csIFwiX1wiKTtcbn1cbmZ1bmN0aW9uIGdldEl0ZW1JbmZvQnlUeXBlKHR5cGUpIHtcbiAgaWYgKGFkZENyZWF0ZUl0ZW1UeXBlc1t0eXBlXSkge1xuICAgIHJldHVybiBhZGRDcmVhdGVJdGVtVHlwZXNbdHlwZV07XG4gIH1cbiAgZWxzZSB7XG4gICAgcmV0dXJuIGFkZENyZWF0ZUl0ZW1UeXBlc1tPYmplY3Qua2V5cyhhZGRDcmVhdGVJdGVtVHlwZXMpLmZpbmQoKGZpbGVUeXBlKSA9PiBhZGRDcmVhdGVJdGVtVHlwZXNbZmlsZVR5cGVdLnR5cGUgPT09IHR5cGUpXTtcbiAgfVxufVxuZnVuY3Rpb24gZm9ybWF0RmlsZVNpemUoc2l6ZSkge1xuICBpZiAoIXNpemUpIHtcbiAgICByZXR1cm4gXCIwIEJcIjtcbiAgfVxuICBjb25zdCBpID0gTWF0aC5mbG9vcihNYXRoLmxvZyhzaXplKSAvIE1hdGgubG9nKDEwMjQpKTtcbiAgY29uc3QgYWRqdXN0ZWRTaXplID0gTWF0aC5yb3VuZChzaXplIC8gTWF0aC5wb3coMTAyNCwgaSkpO1xuICBjb25zdCB1bml0ID0gW1wiQlwiLCBcIktCXCIsIFwiTUJcIiwgXCJHQlwiLCBcIlRCXCJdW2ldO1xuICByZXR1cm4gYCR7YWRqdXN0ZWRTaXplfSAke3VuaXR9YDtcbn1cblxuZXhwb3J0IHsgc2FuaXRpemVGaWxlTmFtZSBhcyBhLCBmb3JtYXRGaWxlU2l6ZSBhcyBmLCBnZXRJdGVtSW5mb0J5VHlwZSBhcyBnLCBzYW5pdGl6ZUZpbGVJbnB1dCBhcyBzLCB2YWxpZGF0ZU92ZXJ3cml0ZUZpbGVOYW1lIGFzIHYgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVJZChjb3VudHMpIHtcbiAgcmV0dXJuIGNvdW50c1xuICAgIC5tYXAoKGNvdW50KSA9PiB7XG4gICAgbGV0IG91dCA9IFwiXCI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICBvdXQgKz0gKCgoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkgfCAwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9KVxuICAgIC5qb2luKFwiLVwiKTtcbn1cbmNvbnN0IGd1aWQgPSAoKSA9PiBnZW5lcmF0ZUlkKFsyLCAxLCAxLCAxLCAzXSk7XG5cbmV4cG9ydCB7IGd1aWQgYXMgZyB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5jb25zdCByZWdleExvb2t1cE1hcCA9IHtcbiAgZmlsZU5hbWU6IC9cXCRcXHtmaWxlTmFtZVxcfS9nLFxuICBmaWxlVHlwZTogL1xcJFxce3R5cGVcXH0vZyxcbiAgdHlwZUxpc3Q6IC9cXCRcXHt0eXBlTGlzdFxcfS9nLFxuICBtaXNzaW5nRmllbGRzOiAvXFwkXFx7XFxtaXNzaW5nRmllbGRzXFx9L2dcbn07XG5jb25zdCByZXBsYWNlSTE4TlN0cmluZyA9IChzdHIsIHJlcGxhY2VtZW50U3RyaW5nLCB0eXBlKSA9PiB7XG4gIGNvbnN0IHR5cGVSZWdFeCA9IG5ldyBSZWdFeHAocmVnZXhMb29rdXBNYXBbdHlwZV0pO1xuICByZXR1cm4gc3RyID09PSBudWxsIHx8IHN0ciA9PT0gdm9pZCAwID8gdm9pZCAwIDogc3RyLnJlcGxhY2UodHlwZVJlZ0V4LCByZXBsYWNlbWVudFN0cmluZyk7XG59O1xuXG5leHBvcnQgeyByZXBsYWNlSTE4TlN0cmluZyBhcyByIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IGIgYXMgdW5pcXVlIH0gZnJvbSAnLi9mdW5jdGlvbmFsLWM4MmY1YWI5LmpzJztcbmltcG9ydCB7IGEgYXMgYWRkQ3JlYXRlSXRlbVR5cGVzIH0gZnJvbSAnLi9pdGVtLXR5cGVzLWI0ZmU4NmFkLmpzJztcblxuZnVuY3Rpb24gZmluZFBvc3NpYmxlSXRlbVR5cGVzQnlFeHRlbnNpb24oZXh0ZW5zaW9uLCB2YWxpZGF0aW9uVHlwZXMpIHtcbiAgLy8gU2VhcmNoIGl0ZW0gdHlwZXMgZXh0ZW5zaW9ucyBmb3IgdGhlIG9uZSBpbXBvcnRlZFxuICBsZXQgaXRlbVR5cGVzO1xuICBpZiAodmFsaWRhdGlvblR5cGVzKSB7XG4gICAgaXRlbVR5cGVzID0gdmFsaWRhdGlvblR5cGVzLm1hcCgodmFsdWUpID0+IHtcbiAgICAgIHJldHVybiB2YWx1ZS50eXBlO1xuICAgIH0pO1xuICB9XG4gIGVsc2Uge1xuICAgIGl0ZW1UeXBlcyA9IE9iamVjdC5rZXlzKGFkZENyZWF0ZUl0ZW1UeXBlcyk7XG4gIH1cbiAgbGV0IHBvc3NpYmxlSXRlbVR5cGVzID0gW107XG4gIGl0ZW1UeXBlcy5mb3JFYWNoKCh0eXBlKSA9PiB7XG4gICAgdmFyIF9hO1xuICAgIGlmICgoKF9hID0gYWRkQ3JlYXRlSXRlbVR5cGVzW3R5cGVdLmZpbGVFeHQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmRleE9mKGV4dGVuc2lvbikpID49IDApIHtcbiAgICAgIHBvc3NpYmxlSXRlbVR5cGVzLnB1c2goYWRkQ3JlYXRlSXRlbVR5cGVzW3R5cGVdKTtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gcG9zc2libGVJdGVtVHlwZXM7XG59XG5mdW5jdGlvbiBtYXBJdGVtVHlwZXNUb0ZpbGVFeHRlbnNpb25zKHR5cGVzKSB7XG4gIGlmICghdHlwZXMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICByZXR1cm4gdW5pcXVlKHR5cGVzLmZsYXRNYXAoKHR5cGUpID0+IHsgdmFyIF9hOyByZXR1cm4gKF9hID0gYWRkQ3JlYXRlSXRlbVR5cGVzW3R5cGVdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZmlsZUV4dDsgfSkuZmlsdGVyKCh2YWxpZCkgPT4gISF2YWxpZCkpO1xufVxuY29uc3QgaXNMYXJnZUdlb0pTT04gPSAoc2l6ZUluQnl0ZXMpID0+IHtcbiAgY29uc3Qgc2l6ZUluTUIgPSBzaXplSW5CeXRlcyAvIDEwMjQgLyAxMDI0O1xuICAvLyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtYXBwLWNvbXBvbmVudHMvaXNzdWVzLzI1NTMjaXNzdWVjb21tZW50LTM2NDU0MDRcbiAgcmV0dXJuIHNpemVJbk1CID4gNTA7IC8vIDUwTUJcbn07XG5jb25zdCBpc0xhcmdlQ1NWID0gKHNpemVJbkJ5dGVzKSA9PiB7XG4gIGNvbnN0IHNpemVJbk1CID0gc2l6ZUluQnl0ZXMgLyAxMDI0IC8gMTAyNDtcbiAgLy8gaHR0cHM6Ly9kZXZ0b3BpYS5lc3JpLmNvbS9XZWJHSVMvYXJjZ2lzLWFwcC1jb21wb25lbnRzL2lzc3Vlcy8yODc1I2lzc3VlY29tbWVudC0zNzQ4OTEzXG4gIHJldHVybiBzaXplSW5NQiA+IDIwOyAvLyAyME1CXG59O1xuXG5leHBvcnQgeyBpc0xhcmdlQ1NWIGFzIGEsIGZpbmRQb3NzaWJsZUl0ZW1UeXBlc0J5RXh0ZW5zaW9uIGFzIGYsIGlzTGFyZ2VHZW9KU09OIGFzIGksIG1hcEl0ZW1UeXBlc1RvRmlsZUV4dGVuc2lvbnMgYXMgbSB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBhIGFzIGl0ZW1Qcm9wZXJ0aWVzU3RvcmUsIGkgYXMgaXRlbVByb3BlcnRpZXNTdGF0ZSB9IGZyb20gJy4vaXRlbS1wcm9wZXJ0aWVzLWU2NDEyYTlhLmpzJztcbmltcG9ydCB7IGQgYXMgYWRkSXRlbVN0b3JlLCBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tOTdkNTc3YTkuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWVjZjg2YmJhLmpzJztcblxuZnVuY3Rpb24gcmVzZXRBZGRJdGVtU3RvcmVzKCkge1xuICBhZGRJdGVtU3RvcmUucmVzZXQoKTtcbiAgaXRlbVByb3BlcnRpZXNTdG9yZS5yZXNldCgpO1xufVxuY29uc3QgcmVzZXRTdG9yZU9uSG9tZSA9ICgpID0+IHtcbiAgaWYgKGFkZEl0ZW1TdGF0ZS5leGlzdGluZ0l0ZW0gfHwgdWlTdG9yZVN0YXRlLndvcmtmbG93ID09PSBcInJlZ2lzdGVyXCIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgYWRkSXRlbVN0b3JlLnJlc2V0KCk7XG4gIGNvbnN0IGZvbGRlciA9IGl0ZW1Qcm9wZXJ0aWVzU3RhdGUuZm9sZGVyO1xuICBpdGVtUHJvcGVydGllc1N0b3JlLnJlc2V0KCk7XG4gIGl0ZW1Qcm9wZXJ0aWVzU3RhdGUuZm9sZGVyID0gZm9sZGVyO1xufTtcblxuZXhwb3J0IHsgcmVzZXRTdG9yZU9uSG9tZSBhcyBhLCByZXNldEFkZEl0ZW1TdG9yZXMgYXMgciB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9