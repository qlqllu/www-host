"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-86449a"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js":
/*!**************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addItemState),
/* harmony export */   b: () => (/* binding */ addItemUrlState),
/* harmony export */   c: () => (/* binding */ addItemRequestState),
/* harmony export */   d: () => (/* binding */ addItemStore)
/* harmony export */ });
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const addItemStore = (0,_index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__.c)({
  typeKeywords: [],
  customParameters: [],
  analyzedLocationTypes: [],
  allowStoredAuth: true,
  isSecured: null,
  checkAuth: false
});
// Entire add item state object
const addItemState = addItemStore.state;
// Subsets of add item state
const addItemRequestState = addItemStore.state;
const addItemUrlState = addItemStore.state;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-summary.entry.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-feature-layer-summary.entry.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_feature_layer_summary: () => (/* binding */ ArcgisNewItemPagesFeatureLayerSummary)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/* harmony import */ var _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-ecf86bba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js");
/* harmony import */ var _feature_layer_d0f64b81_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./feature-layer-d0f64b81.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-d0f64b81.js");
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/* harmony import */ var _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./config-eb5f7dc2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */







const arcgisNewItemPagesFeatureLayerSummaryCss = ".info-container{padding-bottom:1.5rem}.layer-description{display:block;margin-bottom:1.5rem}.details{padding-bottom:0.5rem;display:block}.deselect-button{margin-top:1.5rem;margin-bottom:1rem}arcgis-new-item-layer-summary-item+arcgis-new-item-layer-summary-item{border-top:none}";

const ArcgisNewItemPagesFeatureLayerSummary = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.newItemUpdatePage = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
    this.featureLayerInfos = [];
    this.selectAll = () => {
      const selectedLayerInfoNames = {};
      this.featureLayerInfos.forEach((info) => {
        selectedLayerInfoNames[info.name] = true;
      });
      this.selectedLayerInfoNames = selectedLayerInfoNames;
    };
    this.deselectAll = () => {
      this.selectedLayerInfoNames = {};
    };
    this.selectOrDeselectLayer = (layerName, selected) => {
      if (selected) {
        this.selectedLayerInfoNames[layerName] = true;
      }
      else {
        delete this.selectedLayerInfoNames[layerName];
      }
      this.selectedLayerInfoNames = Object.assign({}, this.selectedLayerInfoNames);
    };
    this.selectedLayerInfoNames = {};
    this.alertInfo = undefined;
  }
  handleNext() {
    const { selectedLayerInfoNames, featureLayerInfos } = this;
    if (!Object.keys(selectedLayerInfoNames).some((name) => selectedLayerInfoNames[name] === true)) {
      (0,_feature_layer_d0f64b81_js__WEBPACK_IMPORTED_MODULE_3__.f)("No layer chosen");
      this.setAlertMessage("noLayer");
      return;
    }
    _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.selectedServiceInfoLayersNames = Object.assign({}, selectedLayerInfoNames);
    const layerChosen = featureLayerInfos.some((info) => info.type !== "Table" && selectedLayerInfoNames[info.name]);
    this.newItemUpdatePage.emit(layerChosen ? "featureLayerPreference" : "itemProperties");
  }
  async componentWillLoad() {
    const { serviceInfo, selectedServiceInfoLayersNames, addFeatureLayerType } = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a;
    const { i18n } = _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_2__.u;
    this.addCreateI18n = i18n;
    this.i18n = i18n.featureLayerSummary;
    this.creationType = addFeatureLayerType;
    this.layerName = (serviceInfo === null || serviceInfo === void 0 ? void 0 : serviceInfo.name) || _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.sourceTitle;
    const featureServiceInfo = serviceInfo;
    this.featureLayerInfos = [...featureServiceInfo.layers, ...featureServiceInfo.tables].sort((infoA, infoB) => infoA.id - infoB.id);
    let newSelectedLayerInfoNames = {};
    if (selectedServiceInfoLayersNames) {
      // This means we're going back from the next screen
      newSelectedLayerInfoNames = Object.assign({}, selectedServiceInfoLayersNames);
    }
    else {
      this.featureLayerInfos.forEach((info) => {
        newSelectedLayerInfoNames[info.name] = true;
      });
    }
    this.selectedLayerInfoNames = newSelectedLayerInfoNames;
  }
  setAlertMessage(type) {
    this.alertInfo = this.i18n.error[type];
  }
  render() {
    const { i18n, addCreateI18n, selectedLayerInfoNames, featureLayerInfos, alertInfo, creationType, layerName, selectAll, deselectAll, selectOrDeselectLayer } = this;
    const multipleLayers = featureLayerInfos.length > 1;
    const featureLayerI18n = addCreateI18n.featureLayer;
    const allowSelectAll = Object.keys(selectedLayerInfoNames).length <= 0;
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { class: "layer-description", header: featureLayerI18n.creationType[creationType], content: layerName, leadingIconInfo: { icon: "featureLayer", scale: "s" } }), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { header: i18n.layerDetails, content: multipleLayers ? i18n.deselectAnyLayers : "", class: "details" }), multipleLayers && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { kind: "neutral", class: "deselect-button", onClick: allowSelectAll ? selectAll : deselectAll }, allowSelectAll ? i18n.selectAll : i18n.deselectAll)), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "info-container" }, featureLayerInfos === null || featureLayerInfos === void 0 ? void 0 : featureLayerInfos.map((layer, index) => ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-layer-summary-item", { key: index, layerInfo: layer, translatedLayerType: featureLayerI18n.type, translatedFieldType: addCreateI18n.fieldType, selected: selectedLayerInfoNames[layer.name], hideSelect: !multipleLayers, onLayerSelectionChange: (event) => {
        selectOrDeselectLayer(layer.name, event.detail);
      }, onExpand: (event) => {
        const { expanded } = event.detail;
        if (expanded) {
          (0,_feature_layer_d0f64b81_js__WEBPACK_IMPORTED_MODULE_3__.i)("layer");
        }
      } })))), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { heading: alertInfo === null || alertInfo === void 0 ? void 0 : alertInfo.title, description: alertInfo === null || alertInfo === void 0 ? void 0 : alertInfo.description, active: !!alertInfo, onAlertDismiss: () => (this.alertInfo = null) })));
  }
  get el() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisNewItemPagesFeatureLayerSummary.style = arcgisNewItemPagesFeatureLayerSummaryCss;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ configState),
/* harmony export */   o: () => (/* binding */ onConfigChange)
/* harmony export */ });
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const configStore = (0,_index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__.c)({
  portal: null,
  user: null,
  api: 4,
  scale: "m"
});
const configState = configStore.state;
const onConfigChange = configStore.onChange;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-d0f64b81.js":
/*!*******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/feature-layer-d0f64b81.js ***!
  \*******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ featureServiceEndTelemetry),
/* harmony export */   b: () => (/* binding */ filterChangeTelemetry),
/* harmony export */   c: () => (/* binding */ featureLayerTypeTelemetry),
/* harmony export */   e: () => (/* binding */ enableLayerPreferenceTelemetry),
/* harmony export */   f: () => (/* binding */ featureLayerErrorTelemetry),
/* harmony export */   i: () => (/* binding */ itemExpandedTelemetry)
/* harmony export */ });
/* harmony import */ var _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./config-eb5f7dc2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js");
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



const TELEMETRY_ID = "create feature layer";
const TELEMETRY_PAGE_NAME = "my content";
const addFeatureLayerTypeToTelemetry = (type) => {
  switch (type) {
    case "build":
      return "blank";
    case "existing":
      return "fs";
    case "template":
      return "template";
    case "link":
      return "url";
  }
};
const enableLayerPreferenceTelemetry = (type) => {
  const telemetry = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
  telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `enable ${type === "captureGPS" ? "gps" : type === "enableZDefaults" ? "z" : "m"}`, {
    category: TELEMETRY_ID,
    attribute: addFeatureLayerTypeToTelemetry(_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
    pageName: TELEMETRY_PAGE_NAME
  });
};
const itemExpandedTelemetry = (type) => {
  const telemetry = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
  telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, `expand ${type} details`, {
    category: TELEMETRY_ID,
    attribute: addFeatureLayerTypeToTelemetry(_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
    pageName: TELEMETRY_PAGE_NAME
  });
};
const filterChangeTelemetry = () => {
  const telemetry = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
  telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "filter", {
    category: TELEMETRY_ID,
    attribute: addFeatureLayerTypeToTelemetry(_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.addFeatureLayerType),
    pageName: TELEMETRY_PAGE_NAME
  });
};
const featureLayerTypeTelemetry = (type) => {
  const telemetryType = addFeatureLayerTypeToTelemetry(type);
  const telemetry = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
  telemetry === null || telemetry === void 0 ? void 0 : telemetry.stepWorkflow(TELEMETRY_ID, "from option", {
    category: TELEMETRY_ID,
    attribute: telemetryType,
    pageName: TELEMETRY_PAGE_NAME
  });
};
const featureServiceEndTelemetry = () => {
  const { addFeatureLayerType, serviceInfo } = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a;
  const featureLayerServiceInfo = serviceInfo;
  const telemetry = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry;
  telemetry === null || telemetry === void 0 ? void 0 : telemetry.endWorkflow(TELEMETRY_ID, {
    category: TELEMETRY_ID,
    attribute: addFeatureLayerTypeToTelemetry(addFeatureLayerType),
    pageName: TELEMETRY_PAGE_NAME,
    count: featureLayerServiceInfo.layers.length,
    number: featureLayerServiceInfo.tables.length
  });
};
const featureLayerErrorTelemetry = (errString) => {
  var _a;
  (_a = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_0__.c.telemetry) === null || _a === void 0 ? void 0 : _a.logError({
    category: TELEMETRY_ID,
    error: errString
  });
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createStore)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const appendToMap = (map, propName, value) => {
    const items = map.get(propName);
    if (!items) {
        map.set(propName, [value]);
    }
    else if (!items.includes(value)) {
        items.push(value);
    }
};
const debounce = (fn, ms) => {
    let timeoutId;
    return (...args) => {
        if (timeoutId) {
            clearTimeout(timeoutId);
        }
        timeoutId = setTimeout(() => {
            timeoutId = 0;
            fn(...args);
        }, ms);
    };
};

/**
 * Check if a possible element isConnected.
 * The property might not be there, so we check for it.
 *
 * We want it to return true if isConnected is not a property,
 * otherwise we would remove these elements and would not update.
 *
 * Better leak in Edge than to be useless.
 */
const isConnected = (maybeElement) => !('isConnected' in maybeElement) || maybeElement.isConnected;
const cleanupElements = debounce((map) => {
    for (let key of map.keys()) {
        map.set(key, map.get(key).filter(isConnected));
    }
}, 2000);
const stencilSubscription = () => {
    if (typeof _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.g !== 'function') {
        // If we are not in a stencil project, we do nothing.
        // This function is not really exported by @stencil/core.
        return {};
    }
    const elmsToUpdate = new Map();
    return {
        dispose: () => elmsToUpdate.clear(),
        get: (propName) => {
            const elm = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.g)();
            if (elm) {
                appendToMap(elmsToUpdate, propName, elm);
            }
        },
        set: (propName) => {
            const elements = elmsToUpdate.get(propName);
            if (elements) {
                elmsToUpdate.set(propName, elements.filter(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.f));
            }
            cleanupElements(elmsToUpdate);
        },
        reset: () => {
            elmsToUpdate.forEach((elms) => elms.forEach(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.f));
            cleanupElements(elmsToUpdate);
        },
    };
};

const unwrap = (val) => (typeof val === 'function' ? val() : val);
const createObservableMap = (defaultState, shouldUpdate = (a, b) => a !== b) => {
    const unwrappedState = unwrap(defaultState);
    let states = new Map(Object.entries(unwrappedState !== null && unwrappedState !== void 0 ? unwrappedState : {}));
    const handlers = {
        dispose: [],
        get: [],
        set: [],
        reset: [],
    };
    const reset = () => {
        var _a;
        // When resetting the state, the default state may be a function - unwrap it to invoke it.
        // otherwise, the state won't be properly reset
        states = new Map(Object.entries((_a = unwrap(defaultState)) !== null && _a !== void 0 ? _a : {}));
        handlers.reset.forEach((cb) => cb());
    };
    const dispose = () => {
        // Call first dispose as resetting the state would
        // cause less updates ;)
        handlers.dispose.forEach((cb) => cb());
        reset();
    };
    const get = (propName) => {
        handlers.get.forEach((cb) => cb(propName));
        return states.get(propName);
    };
    const set = (propName, value) => {
        const oldValue = states.get(propName);
        if (shouldUpdate(value, oldValue, propName)) {
            states.set(propName, value);
            handlers.set.forEach((cb) => cb(propName, value, oldValue));
        }
    };
    const state = (typeof Proxy === 'undefined'
        ? {}
        : new Proxy(unwrappedState, {
            get(_, propName) {
                return get(propName);
            },
            ownKeys(_) {
                return Array.from(states.keys());
            },
            getOwnPropertyDescriptor() {
                return {
                    enumerable: true,
                    configurable: true,
                };
            },
            has(_, propName) {
                return states.has(propName);
            },
            set(_, propName, value) {
                set(propName, value);
                return true;
            },
        }));
    const on = (eventName, callback) => {
        handlers[eventName].push(callback);
        return () => {
            removeFromArray(handlers[eventName], callback);
        };
    };
    const onChange = (propName, cb) => {
        const unSet = on('set', (key, newValue) => {
            if (key === propName) {
                cb(newValue);
            }
        });
        // We need to unwrap the defaultState because it might be a function.
        // Otherwise we might not be sending the right reset value.
        const unReset = on('reset', () => cb(unwrap(defaultState)[propName]));
        return () => {
            unSet();
            unReset();
        };
    };
    const use = (...subscriptions) => {
        const unsubs = subscriptions.reduce((unsubs, subscription) => {
            if (subscription.set) {
                unsubs.push(on('set', subscription.set));
            }
            if (subscription.get) {
                unsubs.push(on('get', subscription.get));
            }
            if (subscription.reset) {
                unsubs.push(on('reset', subscription.reset));
            }
            if (subscription.dispose) {
                unsubs.push(on('dispose', subscription.dispose));
            }
            return unsubs;
        }, []);
        return () => unsubs.forEach((unsub) => unsub());
    };
    const forceUpdate = (key) => {
        const oldValue = states.get(key);
        handlers.set.forEach((cb) => cb(key, oldValue, oldValue));
    };
    return {
        state,
        get,
        set,
        on,
        onChange,
        use,
        dispose,
        reset,
        forceUpdate,
    };
};
const removeFromArray = (array, item) => {
    const index = array.indexOf(item);
    if (index >= 0) {
        array[index] = array[array.length - 1];
        array.length--;
    }
};

const createStore = (defaultState, shouldUpdate) => {
    const map = createObservableMap(defaultState, shouldUpdate);
    map.use(stencilSubscription());
    return map;
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js":
/*!********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ uiStore),
/* harmony export */   u: () => (/* binding */ uiStoreState)
/* harmony export */ });
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const uiStore = (0,_index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__.c)({
  nextText: "next",
  workflow: "content",
  scale: "m",
  disableScroll: false,
  featureFlags: { tileLayer3dTiles: false }
});
const uiStoreState = uiStore.state;




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTg2NDQ5YS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEOztBQUV2RCxxQkFBcUIscURBQVc7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwQmhHO0FBQ0E7QUFDQTtBQUNBO0FBQzZHO0FBQ2xEO0FBQ047QUFDcUQ7QUFDN0U7QUFDQzs7QUFFOUIsa0VBQWtFLHNCQUFzQixtQkFBbUIsY0FBYyxxQkFBcUIsU0FBUyxzQkFBc0IsY0FBYyxpQkFBaUIsa0JBQWtCLG1CQUFtQixzRUFBc0UsZ0JBQWdCOztBQUV2VTtBQUNBO0FBQ0EsSUFBSSxxREFBZ0I7QUFDcEIsNkJBQTZCLHFEQUFXO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0RBQW9EO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLDRDQUE0QztBQUN4RDtBQUNBLE1BQU0sNkRBQTBCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLElBQUksb0RBQVksa0RBQWtEO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtRUFBbUUsRUFBRSxvREFBWTtBQUM3RixZQUFZLE9BQU8sRUFBRSw4Q0FBWTtBQUNqQztBQUNBO0FBQ0E7QUFDQSxxR0FBcUcsb0RBQVk7QUFDakg7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtEQUFrRDtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksb0pBQW9KO0FBQ2hLO0FBQ0E7QUFDQTtBQUNBLFlBQVkscURBQUMsQ0FBQyxpREFBSSxRQUFRLHFEQUFDLGtDQUFrQyx3SEFBd0gsb0NBQW9DLEdBQUcscURBQUMsa0NBQWtDLG9HQUFvRyxzQkFBc0IscURBQUMscUJBQXFCLDhGQUE4Rix3REFBd0QscURBQUMsVUFBVSx5QkFBeUIsaUhBQWlILHFEQUFDLHlDQUF5QztBQUNwdUI7QUFDQSxPQUFPO0FBQ1AsZ0JBQWdCLFdBQVc7QUFDM0I7QUFDQSxVQUFVLDZEQUFxQjtBQUMvQjtBQUNBLFNBQVMsTUFBTSxxREFBQyw0QkFBNEIsOE9BQThPO0FBQzFSO0FBQ0EsYUFBYSxPQUFPLHFEQUFVO0FBQzlCO0FBQ0E7O0FBRWdHOzs7Ozs7Ozs7Ozs7Ozs7OztBQzdGaEc7QUFDQTtBQUNBO0FBQ0E7QUFDdUQ7O0FBRXZELG9CQUFvQixxREFBVztBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBOztBQUVpRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2ZqRDtBQUNBO0FBQ0E7QUFDQTtBQUN3RDtBQUNHOztBQUUzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isa0RBQVc7QUFDL0IsdUdBQXVHLHVFQUF1RTtBQUM5SztBQUNBLDhDQUE4QyxvREFBWTtBQUMxRDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0Esb0JBQW9CLGtEQUFXO0FBQy9CLHVHQUF1RyxNQUFNO0FBQzdHO0FBQ0EsOENBQThDLG9EQUFZO0FBQzFEO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQSxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBLDhDQUE4QyxvREFBWTtBQUMxRDtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBLFVBQVUsbUNBQW1DLEVBQUUsb0RBQVk7QUFDM0Q7QUFDQSxvQkFBb0Isa0RBQVc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLFFBQVEsa0RBQVc7QUFDbkI7QUFDQTtBQUNBLEdBQUc7QUFDSDs7QUFFeU07Ozs7Ozs7Ozs7Ozs7Ozs7QUMxRXpNO0FBQ0E7QUFDQTtBQUNBO0FBQzZFOztBQUU3RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0EsZUFBZSxpREFBZTtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLHFEQUFlO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSwyREFBMkQsaURBQVc7QUFDdEU7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLHdEQUF3RCxpREFBVztBQUNuRTtBQUNBLFNBQVM7QUFDVDtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBLGtIQUFrSDtBQUNsSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVHQUF1RztBQUN2RztBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2IsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU0Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyTTVCO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEOztBQUV2RCxnQkFBZ0IscURBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEIsQ0FBQztBQUNEOztBQUUyQyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FkZC1pdGVtLTk3ZDU3N2E5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1uZXctaXRlbS1wYWdlcy1mZWF0dXJlLWxheWVyLXN1bW1hcnkuZW50cnkuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vY29uZmlnLWViNWY3ZGMyLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2ZlYXR1cmUtbGF5ZXItZDBmNjRiODEuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vaW5kZXgtODFkNTQ4YjcuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vdWktZWNmODZiYmEuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBjIGFzIGNyZWF0ZVN0b3JlIH0gZnJvbSAnLi9pbmRleC04MWQ1NDhiNy5qcyc7XG5cbmNvbnN0IGFkZEl0ZW1TdG9yZSA9IGNyZWF0ZVN0b3JlKHtcbiAgdHlwZUtleXdvcmRzOiBbXSxcbiAgY3VzdG9tUGFyYW1ldGVyczogW10sXG4gIGFuYWx5emVkTG9jYXRpb25UeXBlczogW10sXG4gIGFsbG93U3RvcmVkQXV0aDogdHJ1ZSxcbiAgaXNTZWN1cmVkOiBudWxsLFxuICBjaGVja0F1dGg6IGZhbHNlXG59KTtcbi8vIEVudGlyZSBhZGQgaXRlbSBzdGF0ZSBvYmplY3RcbmNvbnN0IGFkZEl0ZW1TdGF0ZSA9IGFkZEl0ZW1TdG9yZS5zdGF0ZTtcbi8vIFN1YnNldHMgb2YgYWRkIGl0ZW0gc3RhdGVcbmNvbnN0IGFkZEl0ZW1SZXF1ZXN0U3RhdGUgPSBhZGRJdGVtU3RvcmUuc3RhdGU7XG5jb25zdCBhZGRJdGVtVXJsU3RhdGUgPSBhZGRJdGVtU3RvcmUuc3RhdGU7XG5cbmV4cG9ydCB7IGFkZEl0ZW1TdGF0ZSBhcyBhLCBhZGRJdGVtVXJsU3RhdGUgYXMgYiwgYWRkSXRlbVJlcXVlc3RTdGF0ZSBhcyBjLCBhZGRJdGVtU3RvcmUgYXMgZCB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCwgZCBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC05MmViYjM5Ni5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tOTdkNTc3YTkuanMnO1xuaW1wb3J0IHsgdSBhcyB1aVN0b3JlU3RhdGUgfSBmcm9tICcuL3VpLWVjZjg2YmJhLmpzJztcbmltcG9ydCB7IGYgYXMgZmVhdHVyZUxheWVyRXJyb3JUZWxlbWV0cnksIGkgYXMgaXRlbUV4cGFuZGVkVGVsZW1ldHJ5IH0gZnJvbSAnLi9mZWF0dXJlLWxheWVyLWQwZjY0YjgxLmpzJztcbmltcG9ydCAnLi9pbmRleC04MWQ1NDhiNy5qcyc7XG5pbXBvcnQgJy4vY29uZmlnLWViNWY3ZGMyLmpzJztcblxuY29uc3QgYXJjZ2lzTmV3SXRlbVBhZ2VzRmVhdHVyZUxheWVyU3VtbWFyeUNzcyA9IFwiLmluZm8tY29udGFpbmVye3BhZGRpbmctYm90dG9tOjEuNXJlbX0ubGF5ZXItZGVzY3JpcHRpb257ZGlzcGxheTpibG9jazttYXJnaW4tYm90dG9tOjEuNXJlbX0uZGV0YWlsc3twYWRkaW5nLWJvdHRvbTowLjVyZW07ZGlzcGxheTpibG9ja30uZGVzZWxlY3QtYnV0dG9ue21hcmdpbi10b3A6MS41cmVtO21hcmdpbi1ib3R0b206MXJlbX1hcmNnaXMtbmV3LWl0ZW0tbGF5ZXItc3VtbWFyeS1pdGVtK2FyY2dpcy1uZXctaXRlbS1sYXllci1zdW1tYXJ5LWl0ZW17Ym9yZGVyLXRvcDpub25lfVwiO1xuXG5jb25zdCBBcmNnaXNOZXdJdGVtUGFnZXNGZWF0dXJlTGF5ZXJTdW1tYXJ5ID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtVXBkYXRlUGFnZVwiLCA3KTtcbiAgICB0aGlzLmZlYXR1cmVMYXllckluZm9zID0gW107XG4gICAgdGhpcy5zZWxlY3RBbGwgPSAoKSA9PiB7XG4gICAgICBjb25zdCBzZWxlY3RlZExheWVySW5mb05hbWVzID0ge307XG4gICAgICB0aGlzLmZlYXR1cmVMYXllckluZm9zLmZvckVhY2goKGluZm8pID0+IHtcbiAgICAgICAgc2VsZWN0ZWRMYXllckluZm9OYW1lc1tpbmZvLm5hbWVdID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5zZWxlY3RlZExheWVySW5mb05hbWVzID0gc2VsZWN0ZWRMYXllckluZm9OYW1lcztcbiAgICB9O1xuICAgIHRoaXMuZGVzZWxlY3RBbGwgPSAoKSA9PiB7XG4gICAgICB0aGlzLnNlbGVjdGVkTGF5ZXJJbmZvTmFtZXMgPSB7fTtcbiAgICB9O1xuICAgIHRoaXMuc2VsZWN0T3JEZXNlbGVjdExheWVyID0gKGxheWVyTmFtZSwgc2VsZWN0ZWQpID0+IHtcbiAgICAgIGlmIChzZWxlY3RlZCkge1xuICAgICAgICB0aGlzLnNlbGVjdGVkTGF5ZXJJbmZvTmFtZXNbbGF5ZXJOYW1lXSA9IHRydWU7XG4gICAgICB9XG4gICAgICBlbHNlIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuc2VsZWN0ZWRMYXllckluZm9OYW1lc1tsYXllck5hbWVdO1xuICAgICAgfVxuICAgICAgdGhpcy5zZWxlY3RlZExheWVySW5mb05hbWVzID0gT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZExheWVySW5mb05hbWVzKTtcbiAgICB9O1xuICAgIHRoaXMuc2VsZWN0ZWRMYXllckluZm9OYW1lcyA9IHt9O1xuICAgIHRoaXMuYWxlcnRJbmZvID0gdW5kZWZpbmVkO1xuICB9XG4gIGhhbmRsZU5leHQoKSB7XG4gICAgY29uc3QgeyBzZWxlY3RlZExheWVySW5mb05hbWVzLCBmZWF0dXJlTGF5ZXJJbmZvcyB9ID0gdGhpcztcbiAgICBpZiAoIU9iamVjdC5rZXlzKHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXMpLnNvbWUoKG5hbWUpID0+IHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXNbbmFtZV0gPT09IHRydWUpKSB7XG4gICAgICBmZWF0dXJlTGF5ZXJFcnJvclRlbGVtZXRyeShcIk5vIGxheWVyIGNob3NlblwiKTtcbiAgICAgIHRoaXMuc2V0QWxlcnRNZXNzYWdlKFwibm9MYXllclwiKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgYWRkSXRlbVN0YXRlLnNlbGVjdGVkU2VydmljZUluZm9MYXllcnNOYW1lcyA9IE9iamVjdC5hc3NpZ24oe30sIHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXMpO1xuICAgIGNvbnN0IGxheWVyQ2hvc2VuID0gZmVhdHVyZUxheWVySW5mb3Muc29tZSgoaW5mbykgPT4gaW5mby50eXBlICE9PSBcIlRhYmxlXCIgJiYgc2VsZWN0ZWRMYXllckluZm9OYW1lc1tpbmZvLm5hbWVdKTtcbiAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQobGF5ZXJDaG9zZW4gPyBcImZlYXR1cmVMYXllclByZWZlcmVuY2VcIiA6IFwiaXRlbVByb3BlcnRpZXNcIik7XG4gIH1cbiAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgY29uc3QgeyBzZXJ2aWNlSW5mbywgc2VsZWN0ZWRTZXJ2aWNlSW5mb0xheWVyc05hbWVzLCBhZGRGZWF0dXJlTGF5ZXJUeXBlIH0gPSBhZGRJdGVtU3RhdGU7XG4gICAgY29uc3QgeyBpMThuIH0gPSB1aVN0b3JlU3RhdGU7XG4gICAgdGhpcy5hZGRDcmVhdGVJMThuID0gaTE4bjtcbiAgICB0aGlzLmkxOG4gPSBpMThuLmZlYXR1cmVMYXllclN1bW1hcnk7XG4gICAgdGhpcy5jcmVhdGlvblR5cGUgPSBhZGRGZWF0dXJlTGF5ZXJUeXBlO1xuICAgIHRoaXMubGF5ZXJOYW1lID0gKHNlcnZpY2VJbmZvID09PSBudWxsIHx8IHNlcnZpY2VJbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZXJ2aWNlSW5mby5uYW1lKSB8fCBhZGRJdGVtU3RhdGUuc291cmNlVGl0bGU7XG4gICAgY29uc3QgZmVhdHVyZVNlcnZpY2VJbmZvID0gc2VydmljZUluZm87XG4gICAgdGhpcy5mZWF0dXJlTGF5ZXJJbmZvcyA9IFsuLi5mZWF0dXJlU2VydmljZUluZm8ubGF5ZXJzLCAuLi5mZWF0dXJlU2VydmljZUluZm8udGFibGVzXS5zb3J0KChpbmZvQSwgaW5mb0IpID0+IGluZm9BLmlkIC0gaW5mb0IuaWQpO1xuICAgIGxldCBuZXdTZWxlY3RlZExheWVySW5mb05hbWVzID0ge307XG4gICAgaWYgKHNlbGVjdGVkU2VydmljZUluZm9MYXllcnNOYW1lcykge1xuICAgICAgLy8gVGhpcyBtZWFucyB3ZSdyZSBnb2luZyBiYWNrIGZyb20gdGhlIG5leHQgc2NyZWVuXG4gICAgICBuZXdTZWxlY3RlZExheWVySW5mb05hbWVzID0gT2JqZWN0LmFzc2lnbih7fSwgc2VsZWN0ZWRTZXJ2aWNlSW5mb0xheWVyc05hbWVzKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICB0aGlzLmZlYXR1cmVMYXllckluZm9zLmZvckVhY2goKGluZm8pID0+IHtcbiAgICAgICAgbmV3U2VsZWN0ZWRMYXllckluZm9OYW1lc1tpbmZvLm5hbWVdID0gdHJ1ZTtcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0aGlzLnNlbGVjdGVkTGF5ZXJJbmZvTmFtZXMgPSBuZXdTZWxlY3RlZExheWVySW5mb05hbWVzO1xuICB9XG4gIHNldEFsZXJ0TWVzc2FnZSh0eXBlKSB7XG4gICAgdGhpcy5hbGVydEluZm8gPSB0aGlzLmkxOG4uZXJyb3JbdHlwZV07XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgaTE4biwgYWRkQ3JlYXRlSTE4biwgc2VsZWN0ZWRMYXllckluZm9OYW1lcywgZmVhdHVyZUxheWVySW5mb3MsIGFsZXJ0SW5mbywgY3JlYXRpb25UeXBlLCBsYXllck5hbWUsIHNlbGVjdEFsbCwgZGVzZWxlY3RBbGwsIHNlbGVjdE9yRGVzZWxlY3RMYXllciB9ID0gdGhpcztcbiAgICBjb25zdCBtdWx0aXBsZUxheWVycyA9IGZlYXR1cmVMYXllckluZm9zLmxlbmd0aCA+IDE7XG4gICAgY29uc3QgZmVhdHVyZUxheWVySTE4biA9IGFkZENyZWF0ZUkxOG4uZmVhdHVyZUxheWVyO1xuICAgIGNvbnN0IGFsbG93U2VsZWN0QWxsID0gT2JqZWN0LmtleXMoc2VsZWN0ZWRMYXllckluZm9OYW1lcykubGVuZ3RoIDw9IDA7XG4gICAgcmV0dXJuIChoKEhvc3QsIG51bGwsIGgoXCJhcmNnaXMtbmV3LWl0ZW0tZGVzY3JpcHRpb25cIiwgeyBjbGFzczogXCJsYXllci1kZXNjcmlwdGlvblwiLCBoZWFkZXI6IGZlYXR1cmVMYXllckkxOG4uY3JlYXRpb25UeXBlW2NyZWF0aW9uVHlwZV0sIGNvbnRlbnQ6IGxheWVyTmFtZSwgbGVhZGluZ0ljb25JbmZvOiB7IGljb246IFwiZmVhdHVyZUxheWVyXCIsIHNjYWxlOiBcInNcIiB9IH0pLCBoKFwiYXJjZ2lzLW5ldy1pdGVtLWRlc2NyaXB0aW9uXCIsIHsgaGVhZGVyOiBpMThuLmxheWVyRGV0YWlscywgY29udGVudDogbXVsdGlwbGVMYXllcnMgPyBpMThuLmRlc2VsZWN0QW55TGF5ZXJzIDogXCJcIiwgY2xhc3M6IFwiZGV0YWlsc1wiIH0pLCBtdWx0aXBsZUxheWVycyAmJiAoaChcImNhbGNpdGUtYnV0dG9uXCIsIHsga2luZDogXCJuZXV0cmFsXCIsIGNsYXNzOiBcImRlc2VsZWN0LWJ1dHRvblwiLCBvbkNsaWNrOiBhbGxvd1NlbGVjdEFsbCA/IHNlbGVjdEFsbCA6IGRlc2VsZWN0QWxsIH0sIGFsbG93U2VsZWN0QWxsID8gaTE4bi5zZWxlY3RBbGwgOiBpMThuLmRlc2VsZWN0QWxsKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJpbmZvLWNvbnRhaW5lclwiIH0sIGZlYXR1cmVMYXllckluZm9zID09PSBudWxsIHx8IGZlYXR1cmVMYXllckluZm9zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmZWF0dXJlTGF5ZXJJbmZvcy5tYXAoKGxheWVyLCBpbmRleCkgPT4gKGgoXCJhcmNnaXMtbmV3LWl0ZW0tbGF5ZXItc3VtbWFyeS1pdGVtXCIsIHsga2V5OiBpbmRleCwgbGF5ZXJJbmZvOiBsYXllciwgdHJhbnNsYXRlZExheWVyVHlwZTogZmVhdHVyZUxheWVySTE4bi50eXBlLCB0cmFuc2xhdGVkRmllbGRUeXBlOiBhZGRDcmVhdGVJMThuLmZpZWxkVHlwZSwgc2VsZWN0ZWQ6IHNlbGVjdGVkTGF5ZXJJbmZvTmFtZXNbbGF5ZXIubmFtZV0sIGhpZGVTZWxlY3Q6ICFtdWx0aXBsZUxheWVycywgb25MYXllclNlbGVjdGlvbkNoYW5nZTogKGV2ZW50KSA9PiB7XG4gICAgICAgIHNlbGVjdE9yRGVzZWxlY3RMYXllcihsYXllci5uYW1lLCBldmVudC5kZXRhaWwpO1xuICAgICAgfSwgb25FeHBhbmQ6IChldmVudCkgPT4ge1xuICAgICAgICBjb25zdCB7IGV4cGFuZGVkIH0gPSBldmVudC5kZXRhaWw7XG4gICAgICAgIGlmIChleHBhbmRlZCkge1xuICAgICAgICAgIGl0ZW1FeHBhbmRlZFRlbGVtZXRyeShcImxheWVyXCIpO1xuICAgICAgICB9XG4gICAgICB9IH0pKSkpLCBoKFwiYXJjZ2lzLW5ldy1pdGVtLWFsZXJ0XCIsIHsgaGVhZGluZzogYWxlcnRJbmZvID09PSBudWxsIHx8IGFsZXJ0SW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWxlcnRJbmZvLnRpdGxlLCBkZXNjcmlwdGlvbjogYWxlcnRJbmZvID09PSBudWxsIHx8IGFsZXJ0SW5mbyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWxlcnRJbmZvLmRlc2NyaXB0aW9uLCBhY3RpdmU6ICEhYWxlcnRJbmZvLCBvbkFsZXJ0RGlzbWlzczogKCkgPT4gKHRoaXMuYWxlcnRJbmZvID0gbnVsbCkgfSkpKTtcbiAgfVxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG59O1xuQXJjZ2lzTmV3SXRlbVBhZ2VzRmVhdHVyZUxheWVyU3VtbWFyeS5zdHlsZSA9IGFyY2dpc05ld0l0ZW1QYWdlc0ZlYXR1cmVMYXllclN1bW1hcnlDc3M7XG5cbmV4cG9ydCB7IEFyY2dpc05ld0l0ZW1QYWdlc0ZlYXR1cmVMYXllclN1bW1hcnkgYXMgYXJjZ2lzX25ld19pdGVtX3BhZ2VzX2ZlYXR1cmVfbGF5ZXJfc3VtbWFyeSB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBjIGFzIGNyZWF0ZVN0b3JlIH0gZnJvbSAnLi9pbmRleC04MWQ1NDhiNy5qcyc7XG5cbmNvbnN0IGNvbmZpZ1N0b3JlID0gY3JlYXRlU3RvcmUoe1xuICBwb3J0YWw6IG51bGwsXG4gIHVzZXI6IG51bGwsXG4gIGFwaTogNCxcbiAgc2NhbGU6IFwibVwiXG59KTtcbmNvbnN0IGNvbmZpZ1N0YXRlID0gY29uZmlnU3RvcmUuc3RhdGU7XG5jb25zdCBvbkNvbmZpZ0NoYW5nZSA9IGNvbmZpZ1N0b3JlLm9uQ2hhbmdlO1xuXG5leHBvcnQgeyBjb25maWdTdGF0ZSBhcyBjLCBvbkNvbmZpZ0NoYW5nZSBhcyBvIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IGMgYXMgY29uZmlnU3RhdGUgfSBmcm9tICcuL2NvbmZpZy1lYjVmN2RjMi5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tOTdkNTc3YTkuanMnO1xuXG5jb25zdCBURUxFTUVUUllfSUQgPSBcImNyZWF0ZSBmZWF0dXJlIGxheWVyXCI7XG5jb25zdCBURUxFTUVUUllfUEFHRV9OQU1FID0gXCJteSBjb250ZW50XCI7XG5jb25zdCBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIFwiYnVpbGRcIjpcbiAgICAgIHJldHVybiBcImJsYW5rXCI7XG4gICAgY2FzZSBcImV4aXN0aW5nXCI6XG4gICAgICByZXR1cm4gXCJmc1wiO1xuICAgIGNhc2UgXCJ0ZW1wbGF0ZVwiOlxuICAgICAgcmV0dXJuIFwidGVtcGxhdGVcIjtcbiAgICBjYXNlIFwibGlua1wiOlxuICAgICAgcmV0dXJuIFwidXJsXCI7XG4gIH1cbn07XG5jb25zdCBlbmFibGVMYXllclByZWZlcmVuY2VUZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5zdGVwV29ya2Zsb3coVEVMRU1FVFJZX0lELCBgZW5hYmxlICR7dHlwZSA9PT0gXCJjYXB0dXJlR1BTXCIgPyBcImdwc1wiIDogdHlwZSA9PT0gXCJlbmFibGVaRGVmYXVsdHNcIiA/IFwielwiIDogXCJtXCJ9YCwge1xuICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkSXRlbVN0YXRlLmFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gIH0pO1xufTtcbmNvbnN0IGl0ZW1FeHBhbmRlZFRlbGVtZXRyeSA9ICh0eXBlKSA9PiB7XG4gIGNvbnN0IHRlbGVtZXRyeSA9IGNvbmZpZ1N0YXRlLnRlbGVtZXRyeTtcbiAgdGVsZW1ldHJ5ID09PSBudWxsIHx8IHRlbGVtZXRyeSA9PT0gdm9pZCAwID8gdm9pZCAwIDogdGVsZW1ldHJ5LnN0ZXBXb3JrZmxvdyhURUxFTUVUUllfSUQsIGBleHBhbmQgJHt0eXBlfSBkZXRhaWxzYCwge1xuICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkSXRlbVN0YXRlLmFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gIH0pO1xufTtcbmNvbnN0IGZpbHRlckNoYW5nZVRlbGVtZXRyeSA9ICgpID0+IHtcbiAgY29uc3QgdGVsZW1ldHJ5ID0gY29uZmlnU3RhdGUudGVsZW1ldHJ5O1xuICB0ZWxlbWV0cnkgPT09IG51bGwgfHwgdGVsZW1ldHJ5ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZWxlbWV0cnkuc3RlcFdvcmtmbG93KFRFTEVNRVRSWV9JRCwgXCJmaWx0ZXJcIiwge1xuICAgIGNhdGVnb3J5OiBURUxFTUVUUllfSUQsXG4gICAgYXR0cmlidXRlOiBhZGRGZWF0dXJlTGF5ZXJUeXBlVG9UZWxlbWV0cnkoYWRkSXRlbVN0YXRlLmFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FXG4gIH0pO1xufTtcbmNvbnN0IGZlYXR1cmVMYXllclR5cGVUZWxlbWV0cnkgPSAodHlwZSkgPT4ge1xuICBjb25zdCB0ZWxlbWV0cnlUeXBlID0gYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KHR5cGUpO1xuICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5zdGVwV29ya2Zsb3coVEVMRU1FVFJZX0lELCBcImZyb20gb3B0aW9uXCIsIHtcbiAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgIGF0dHJpYnV0ZTogdGVsZW1ldHJ5VHlwZSxcbiAgICBwYWdlTmFtZTogVEVMRU1FVFJZX1BBR0VfTkFNRVxuICB9KTtcbn07XG5jb25zdCBmZWF0dXJlU2VydmljZUVuZFRlbGVtZXRyeSA9ICgpID0+IHtcbiAgY29uc3QgeyBhZGRGZWF0dXJlTGF5ZXJUeXBlLCBzZXJ2aWNlSW5mbyB9ID0gYWRkSXRlbVN0YXRlO1xuICBjb25zdCBmZWF0dXJlTGF5ZXJTZXJ2aWNlSW5mbyA9IHNlcnZpY2VJbmZvO1xuICBjb25zdCB0ZWxlbWV0cnkgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnk7XG4gIHRlbGVtZXRyeSA9PT0gbnVsbCB8fCB0ZWxlbWV0cnkgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHRlbGVtZXRyeS5lbmRXb3JrZmxvdyhURUxFTUVUUllfSUQsIHtcbiAgICBjYXRlZ29yeTogVEVMRU1FVFJZX0lELFxuICAgIGF0dHJpYnV0ZTogYWRkRmVhdHVyZUxheWVyVHlwZVRvVGVsZW1ldHJ5KGFkZEZlYXR1cmVMYXllclR5cGUpLFxuICAgIHBhZ2VOYW1lOiBURUxFTUVUUllfUEFHRV9OQU1FLFxuICAgIGNvdW50OiBmZWF0dXJlTGF5ZXJTZXJ2aWNlSW5mby5sYXllcnMubGVuZ3RoLFxuICAgIG51bWJlcjogZmVhdHVyZUxheWVyU2VydmljZUluZm8udGFibGVzLmxlbmd0aFxuICB9KTtcbn07XG5jb25zdCBmZWF0dXJlTGF5ZXJFcnJvclRlbGVtZXRyeSA9IChlcnJTdHJpbmcpID0+IHtcbiAgdmFyIF9hO1xuICAoX2EgPSBjb25maWdTdGF0ZS50ZWxlbWV0cnkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5sb2dFcnJvcih7XG4gICAgY2F0ZWdvcnk6IFRFTEVNRVRSWV9JRCxcbiAgICBlcnJvcjogZXJyU3RyaW5nXG4gIH0pO1xufTtcblxuZXhwb3J0IHsgZmVhdHVyZVNlcnZpY2VFbmRUZWxlbWV0cnkgYXMgYSwgZmlsdGVyQ2hhbmdlVGVsZW1ldHJ5IGFzIGIsIGZlYXR1cmVMYXllclR5cGVUZWxlbWV0cnkgYXMgYywgZW5hYmxlTGF5ZXJQcmVmZXJlbmNlVGVsZW1ldHJ5IGFzIGUsIGZlYXR1cmVMYXllckVycm9yVGVsZW1ldHJ5IGFzIGYsIGl0ZW1FeHBhbmRlZFRlbGVtZXRyeSBhcyBpIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IGcgYXMgZ2V0UmVuZGVyaW5nUmVmLCBmIGFzIGZvcmNlVXBkYXRlIH0gZnJvbSAnLi9pbmRleC05MmViYjM5Ni5qcyc7XG5cbmNvbnN0IGFwcGVuZFRvTWFwID0gKG1hcCwgcHJvcE5hbWUsIHZhbHVlKSA9PiB7XG4gICAgY29uc3QgaXRlbXMgPSBtYXAuZ2V0KHByb3BOYW1lKTtcbiAgICBpZiAoIWl0ZW1zKSB7XG4gICAgICAgIG1hcC5zZXQocHJvcE5hbWUsIFt2YWx1ZV0pO1xuICAgIH1cbiAgICBlbHNlIGlmICghaXRlbXMuaW5jbHVkZXModmFsdWUpKSB7XG4gICAgICAgIGl0ZW1zLnB1c2godmFsdWUpO1xuICAgIH1cbn07XG5jb25zdCBkZWJvdW5jZSA9IChmbiwgbXMpID0+IHtcbiAgICBsZXQgdGltZW91dElkO1xuICAgIHJldHVybiAoLi4uYXJncykgPT4ge1xuICAgICAgICBpZiAodGltZW91dElkKSB7XG4gICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dElkKTtcbiAgICAgICAgfVxuICAgICAgICB0aW1lb3V0SWQgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIHRpbWVvdXRJZCA9IDA7XG4gICAgICAgICAgICBmbiguLi5hcmdzKTtcbiAgICAgICAgfSwgbXMpO1xuICAgIH07XG59O1xuXG4vKipcbiAqIENoZWNrIGlmIGEgcG9zc2libGUgZWxlbWVudCBpc0Nvbm5lY3RlZC5cbiAqIFRoZSBwcm9wZXJ0eSBtaWdodCBub3QgYmUgdGhlcmUsIHNvIHdlIGNoZWNrIGZvciBpdC5cbiAqXG4gKiBXZSB3YW50IGl0IHRvIHJldHVybiB0cnVlIGlmIGlzQ29ubmVjdGVkIGlzIG5vdCBhIHByb3BlcnR5LFxuICogb3RoZXJ3aXNlIHdlIHdvdWxkIHJlbW92ZSB0aGVzZSBlbGVtZW50cyBhbmQgd291bGQgbm90IHVwZGF0ZS5cbiAqXG4gKiBCZXR0ZXIgbGVhayBpbiBFZGdlIHRoYW4gdG8gYmUgdXNlbGVzcy5cbiAqL1xuY29uc3QgaXNDb25uZWN0ZWQgPSAobWF5YmVFbGVtZW50KSA9PiAhKCdpc0Nvbm5lY3RlZCcgaW4gbWF5YmVFbGVtZW50KSB8fCBtYXliZUVsZW1lbnQuaXNDb25uZWN0ZWQ7XG5jb25zdCBjbGVhbnVwRWxlbWVudHMgPSBkZWJvdW5jZSgobWFwKSA9PiB7XG4gICAgZm9yIChsZXQga2V5IG9mIG1hcC5rZXlzKCkpIHtcbiAgICAgICAgbWFwLnNldChrZXksIG1hcC5nZXQoa2V5KS5maWx0ZXIoaXNDb25uZWN0ZWQpKTtcbiAgICB9XG59LCAyMDAwKTtcbmNvbnN0IHN0ZW5jaWxTdWJzY3JpcHRpb24gPSAoKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBnZXRSZW5kZXJpbmdSZWYgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgLy8gSWYgd2UgYXJlIG5vdCBpbiBhIHN0ZW5jaWwgcHJvamVjdCwgd2UgZG8gbm90aGluZy5cbiAgICAgICAgLy8gVGhpcyBmdW5jdGlvbiBpcyBub3QgcmVhbGx5IGV4cG9ydGVkIGJ5IEBzdGVuY2lsL2NvcmUuXG4gICAgICAgIHJldHVybiB7fTtcbiAgICB9XG4gICAgY29uc3QgZWxtc1RvVXBkYXRlID0gbmV3IE1hcCgpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGRpc3Bvc2U6ICgpID0+IGVsbXNUb1VwZGF0ZS5jbGVhcigpLFxuICAgICAgICBnZXQ6IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxtID0gZ2V0UmVuZGVyaW5nUmVmKCk7XG4gICAgICAgICAgICBpZiAoZWxtKSB7XG4gICAgICAgICAgICAgICAgYXBwZW5kVG9NYXAoZWxtc1RvVXBkYXRlLCBwcm9wTmFtZSwgZWxtKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgc2V0OiAocHJvcE5hbWUpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnRzID0gZWxtc1RvVXBkYXRlLmdldChwcm9wTmFtZSk7XG4gICAgICAgICAgICBpZiAoZWxlbWVudHMpIHtcbiAgICAgICAgICAgICAgICBlbG1zVG9VcGRhdGUuc2V0KHByb3BOYW1lLCBlbGVtZW50cy5maWx0ZXIoZm9yY2VVcGRhdGUpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNsZWFudXBFbGVtZW50cyhlbG1zVG9VcGRhdGUpO1xuICAgICAgICB9LFxuICAgICAgICByZXNldDogKCkgPT4ge1xuICAgICAgICAgICAgZWxtc1RvVXBkYXRlLmZvckVhY2goKGVsbXMpID0+IGVsbXMuZm9yRWFjaChmb3JjZVVwZGF0ZSkpO1xuICAgICAgICAgICAgY2xlYW51cEVsZW1lbnRzKGVsbXNUb1VwZGF0ZSk7XG4gICAgICAgIH0sXG4gICAgfTtcbn07XG5cbmNvbnN0IHVud3JhcCA9ICh2YWwpID0+ICh0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nID8gdmFsKCkgOiB2YWwpO1xuY29uc3QgY3JlYXRlT2JzZXJ2YWJsZU1hcCA9IChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSA9IChhLCBiKSA9PiBhICE9PSBiKSA9PiB7XG4gICAgY29uc3QgdW53cmFwcGVkU3RhdGUgPSB1bndyYXAoZGVmYXVsdFN0YXRlKTtcbiAgICBsZXQgc3RhdGVzID0gbmV3IE1hcChPYmplY3QuZW50cmllcyh1bndyYXBwZWRTdGF0ZSAhPT0gbnVsbCAmJiB1bndyYXBwZWRTdGF0ZSAhPT0gdm9pZCAwID8gdW53cmFwcGVkU3RhdGUgOiB7fSkpO1xuICAgIGNvbnN0IGhhbmRsZXJzID0ge1xuICAgICAgICBkaXNwb3NlOiBbXSxcbiAgICAgICAgZ2V0OiBbXSxcbiAgICAgICAgc2V0OiBbXSxcbiAgICAgICAgcmVzZXQ6IFtdLFxuICAgIH07XG4gICAgY29uc3QgcmVzZXQgPSAoKSA9PiB7XG4gICAgICAgIHZhciBfYTtcbiAgICAgICAgLy8gV2hlbiByZXNldHRpbmcgdGhlIHN0YXRlLCB0aGUgZGVmYXVsdCBzdGF0ZSBtYXkgYmUgYSBmdW5jdGlvbiAtIHVud3JhcCBpdCB0byBpbnZva2UgaXQuXG4gICAgICAgIC8vIG90aGVyd2lzZSwgdGhlIHN0YXRlIHdvbid0IGJlIHByb3Blcmx5IHJlc2V0XG4gICAgICAgIHN0YXRlcyA9IG5ldyBNYXAoT2JqZWN0LmVudHJpZXMoKF9hID0gdW53cmFwKGRlZmF1bHRTdGF0ZSkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IHt9KSk7XG4gICAgICAgIGhhbmRsZXJzLnJlc2V0LmZvckVhY2goKGNiKSA9PiBjYigpKTtcbiAgICB9O1xuICAgIGNvbnN0IGRpc3Bvc2UgPSAoKSA9PiB7XG4gICAgICAgIC8vIENhbGwgZmlyc3QgZGlzcG9zZSBhcyByZXNldHRpbmcgdGhlIHN0YXRlIHdvdWxkXG4gICAgICAgIC8vIGNhdXNlIGxlc3MgdXBkYXRlcyA7KVxuICAgICAgICBoYW5kbGVycy5kaXNwb3NlLmZvckVhY2goKGNiKSA9PiBjYigpKTtcbiAgICAgICAgcmVzZXQoKTtcbiAgICB9O1xuICAgIGNvbnN0IGdldCA9IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICBoYW5kbGVycy5nZXQuZm9yRWFjaCgoY2IpID0+IGNiKHByb3BOYW1lKSk7XG4gICAgICAgIHJldHVybiBzdGF0ZXMuZ2V0KHByb3BOYW1lKTtcbiAgICB9O1xuICAgIGNvbnN0IHNldCA9IChwcm9wTmFtZSwgdmFsdWUpID0+IHtcbiAgICAgICAgY29uc3Qgb2xkVmFsdWUgPSBzdGF0ZXMuZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgaWYgKHNob3VsZFVwZGF0ZSh2YWx1ZSwgb2xkVmFsdWUsIHByb3BOYW1lKSkge1xuICAgICAgICAgICAgc3RhdGVzLnNldChwcm9wTmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgaGFuZGxlcnMuc2V0LmZvckVhY2goKGNiKSA9PiBjYihwcm9wTmFtZSwgdmFsdWUsIG9sZFZhbHVlKSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IHN0YXRlID0gKHR5cGVvZiBQcm94eSA9PT0gJ3VuZGVmaW5lZCdcbiAgICAgICAgPyB7fVxuICAgICAgICA6IG5ldyBQcm94eSh1bndyYXBwZWRTdGF0ZSwge1xuICAgICAgICAgICAgZ2V0KF8sIHByb3BOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGdldChwcm9wTmFtZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgb3duS2V5cyhfKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIEFycmF5LmZyb20oc3RhdGVzLmtleXMoKSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhhcyhfLCBwcm9wTmFtZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBzdGF0ZXMuaGFzKHByb3BOYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBzZXQoXywgcHJvcE5hbWUsIHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgc2V0KHByb3BOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KSk7XG4gICAgY29uc3Qgb24gPSAoZXZlbnROYW1lLCBjYWxsYmFjaykgPT4ge1xuICAgICAgICBoYW5kbGVyc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgcmVtb3ZlRnJvbUFycmF5KGhhbmRsZXJzW2V2ZW50TmFtZV0sIGNhbGxiYWNrKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIGNvbnN0IG9uQ2hhbmdlID0gKHByb3BOYW1lLCBjYikgPT4ge1xuICAgICAgICBjb25zdCB1blNldCA9IG9uKCdzZXQnLCAoa2V5LCBuZXdWYWx1ZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGtleSA9PT0gcHJvcE5hbWUpIHtcbiAgICAgICAgICAgICAgICBjYihuZXdWYWx1ZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBXZSBuZWVkIHRvIHVud3JhcCB0aGUgZGVmYXVsdFN0YXRlIGJlY2F1c2UgaXQgbWlnaHQgYmUgYSBmdW5jdGlvbi5cbiAgICAgICAgLy8gT3RoZXJ3aXNlIHdlIG1pZ2h0IG5vdCBiZSBzZW5kaW5nIHRoZSByaWdodCByZXNldCB2YWx1ZS5cbiAgICAgICAgY29uc3QgdW5SZXNldCA9IG9uKCdyZXNldCcsICgpID0+IGNiKHVud3JhcChkZWZhdWx0U3RhdGUpW3Byb3BOYW1lXSkpO1xuICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdW5TZXQoKTtcbiAgICAgICAgICAgIHVuUmVzZXQoKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIGNvbnN0IHVzZSA9ICguLi5zdWJzY3JpcHRpb25zKSA9PiB7XG4gICAgICAgIGNvbnN0IHVuc3VicyA9IHN1YnNjcmlwdGlvbnMucmVkdWNlKCh1bnN1YnMsIHN1YnNjcmlwdGlvbikgPT4ge1xuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5zZXQpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignc2V0Jywgc3Vic2NyaXB0aW9uLnNldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5nZXQpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignZ2V0Jywgc3Vic2NyaXB0aW9uLmdldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5yZXNldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdyZXNldCcsIHN1YnNjcmlwdGlvbi5yZXNldCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHN1YnNjcmlwdGlvbi5kaXNwb3NlKSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ2Rpc3Bvc2UnLCBzdWJzY3JpcHRpb24uZGlzcG9zZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHVuc3VicztcbiAgICAgICAgfSwgW10pO1xuICAgICAgICByZXR1cm4gKCkgPT4gdW5zdWJzLmZvckVhY2goKHVuc3ViKSA9PiB1bnN1YigpKTtcbiAgICB9O1xuICAgIGNvbnN0IGZvcmNlVXBkYXRlID0gKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHN0YXRlcy5nZXQoa2V5KTtcbiAgICAgICAgaGFuZGxlcnMuc2V0LmZvckVhY2goKGNiKSA9PiBjYihrZXksIG9sZFZhbHVlLCBvbGRWYWx1ZSkpO1xuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGdldCxcbiAgICAgICAgc2V0LFxuICAgICAgICBvbixcbiAgICAgICAgb25DaGFuZ2UsXG4gICAgICAgIHVzZSxcbiAgICAgICAgZGlzcG9zZSxcbiAgICAgICAgcmVzZXQsXG4gICAgICAgIGZvcmNlVXBkYXRlLFxuICAgIH07XG59O1xuY29uc3QgcmVtb3ZlRnJvbUFycmF5ID0gKGFycmF5LCBpdGVtKSA9PiB7XG4gICAgY29uc3QgaW5kZXggPSBhcnJheS5pbmRleE9mKGl0ZW0pO1xuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAgIGFycmF5W2luZGV4XSA9IGFycmF5W2FycmF5Lmxlbmd0aCAtIDFdO1xuICAgICAgICBhcnJheS5sZW5ndGgtLTtcbiAgICB9XG59O1xuXG5jb25zdCBjcmVhdGVTdG9yZSA9IChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSkgPT4ge1xuICAgIGNvbnN0IG1hcCA9IGNyZWF0ZU9ic2VydmFibGVNYXAoZGVmYXVsdFN0YXRlLCBzaG91bGRVcGRhdGUpO1xuICAgIG1hcC51c2Uoc3RlbmNpbFN1YnNjcmlwdGlvbigpKTtcbiAgICByZXR1cm4gbWFwO1xufTtcblxuZXhwb3J0IHsgY3JlYXRlU3RvcmUgYXMgYyB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBjIGFzIGNyZWF0ZVN0b3JlIH0gZnJvbSAnLi9pbmRleC04MWQ1NDhiNy5qcyc7XG5cbmNvbnN0IHVpU3RvcmUgPSBjcmVhdGVTdG9yZSh7XG4gIG5leHRUZXh0OiBcIm5leHRcIixcbiAgd29ya2Zsb3c6IFwiY29udGVudFwiLFxuICBzY2FsZTogXCJtXCIsXG4gIGRpc2FibGVTY3JvbGw6IGZhbHNlLFxuICBmZWF0dXJlRmxhZ3M6IHsgdGlsZUxheWVyM2RUaWxlczogZmFsc2UgfVxufSk7XG5jb25zdCB1aVN0b3JlU3RhdGUgPSB1aVN0b3JlLnN0YXRlO1xuXG5leHBvcnQgeyB1aVN0b3JlIGFzIGEsIHVpU3RvcmVTdGF0ZSBhcyB1IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=