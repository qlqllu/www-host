"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-24da61"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js":
/*!**************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addItemState),
/* harmony export */   b: () => (/* binding */ addItemUrlState),
/* harmony export */   c: () => (/* binding */ addItemRequestState),
/* harmony export */   d: () => (/* binding */ addItemStore)
/* harmony export */ });
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const addItemStore = (0,_index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__.c)({
  typeKeywords: [],
  customParameters: [],
  analyzedLocationTypes: [],
  allowStoredAuth: true,
  isSecured: null,
  checkAuth: false
});
// Entire add item state object
const addItemState = addItemStore.state;
// Subsets of add item state
const addItemRequestState = addItemStore.state;
const addItemUrlState = addItemStore.state;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ AppendOverwriteCloudPublishTypes),
/* harmony export */   N: () => (/* binding */ NONE_VALUE),
/* harmony export */   a: () => (/* binding */ appendFileTypes),
/* harmony export */   b: () => (/* binding */ AppendOverwritePublishTypes),
/* harmony export */   c: () => (/* binding */ appendExtensionsForEnterprise),
/* harmony export */   d: () => (/* binding */ appendExtensions),
/* harmony export */   u: () => (/* binding */ uidFields)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */
const uidFields = ["esriFieldTypeOID", "esriFieldTypeGlobalID"];
const NONE_VALUE = "<None>";
const AppendOverwritePublishTypes = {
  "file geodatabase": "filegeodatabase",
  shapefile: "shapefile",
  geojson: "geojson",
  csv: "CSV",
  "microsoft excel": "excel",
  geopackage: "geoPackage"
};
const appendFileTypes = {
  Shapefile: "shapefile",
  "File Geodatabase": "fileGeodatabase",
  CSV: "csv",
  "Microsoft Excel": "excel",
  GeoJson: "geojson",
  GeoPackage: "geoPackage"
};
const AppendOverwriteCloudPublishTypes = {
  csv: "CSV",
  excel: "Microsoft Excel",
  shapefile: "Shapefile",
  fgdb: "File Geodatabase",
  geojson: "GeoJson",
  googlesheets: "Microsoft Excel"
};
const appendExtensions = ["zip", "csv", "xls", "xlsx", "geojson", "gpkg", "json"];
const appendExtensionsForEnterprise = ["zip", "csv", "xls", "xlsx"];




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-append-key-value-pair.entry.js":
/*!****************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-append-key-value-pair.entry.js ***!
  \****************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_append_key_value_pair: () => (/* binding */ ArcgisNewItemAppendKeyValuePair)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/* harmony import */ var _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ui-ecf86bba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js");
/* harmony import */ var _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./append-58a7e7ab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js");
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */






const arcgisNewItemAppendKeyValuePairCss = ".description{font-size:0.875rem;font-weight:300;margin-bottom:1rem}.header{font-weight:500;font-size:1rem;color:var(--calcite-ui-text-1);margin-bottom:0.5rem}.description-label{font-size:0.75rem;margin-top:0.5rem}.key-pair-select{font-size:0.875rem}.key-pair-page{margin-bottom:1rem}.select-wrapper{display:flex;flex-direction:row;margin-top:0.5rem;margin-bottom:2rem;background-color:var(--calcite-ui-background);padding-top:1rem;padding-bottom:0.75rem}.source-key-pair-select{margin-left:0.75rem;margin-right:1rem;width:100%}.name-key-pair-select{margin-right:0.75rem;margin-left:1rem;width:100%}.select-and-label{display:flex;flex-direction:column}.popover-icon{color:var(--calcite-ui-text-3);cursor:pointer;margin-top:0.125rem;-webkit-margin-start:0.75rem;margin-inline-start:0.75rem}.popover-content{font-size:0.75rem;font-weight:400;margin:0}.original-field,.uploaded-field{display:flex}.original-field-header,.uploaded-field-header{font-weight:500}.original-field-popover,.uploaded-field-popover{margin-top:-0.313rem}";

const ArcgisNewItemAppendKeyValuePair = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.keyPairChange = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "keyPairChange", 7);
    this.keyPairs = undefined;
    this.i18n = undefined;
    this.sourceValues = undefined;
    this.nameValues = undefined;
    this.selectedKeyPair = undefined;
    this.selectedSource = null;
  }
  async componentWillLoad() {
    var _a;
    const { existingItem, originalFileName } = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a;
    let selectedName = _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_3__.N;
    this.i18n = _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_2__.u.i18n.appendKeyValuePair;
    if (!!_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.uidPair) {
      selectedName = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.uidPair.name;
      this.selectedSource = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.uidPair.source;
    }
    this.selectedKeyPair = this.keyPairs[selectedName];
    this.sourceValues = (_a = this.selectedKeyPair) === null || _a === void 0 ? void 0 : _a.possibleMatches;
    this.nameValues = Object.keys(this.keyPairs);
    this.originalFieldInfo = this.i18n.originalField.moreInfo.replace("${featureLayerName}", existingItem.title);
    this.uploadedFieldInfo = this.i18n.uploadedField.moreInfo.replace("${uploadedFileName}", originalFileName);
  }
  handleKeyPairChange(ev) {
    const value = ev.target.selectedOption.value;
    this.selectedKeyPair = this.keyPairs[value];
    const possibleMatches = this.selectedKeyPair.possibleMatches.length > 0
      ? [...this.selectedKeyPair.possibleMatches]
      : [_append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_3__.N];
    this.sourceValues = possibleMatches;
    this.selectedSource = possibleMatches[0];
    const payload = Object.assign(Object.assign({}, this.selectedKeyPair), { source: this.selectedSource, initialMatch: this.selectedSource });
    this.keyPairChange.emit(payload);
  }
  handleSourceKeyPairChange(ev) {
    const value = ev.target.selectedOption.value;
    const payload = Object.assign(Object.assign({}, this.selectedKeyPair), { source: value, initialMatch: value });
    this.keyPairChange.emit(payload);
  }
  render() {
    const { originalFieldInfo, uploadedFieldInfo, i18n, selectedKeyPair, selectedSource } = this;
    const names = this.nameValues;
    const sources = this.sourceValues;
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "key-pair-page" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "select-and-label" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-description", { header: i18n.selectUniqueIdentifier, content: i18n.selectUniqueIdentifierDescription }), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "select-wrapper" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { class: "name-key-pair-select" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "original-field", role: "columnheader" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "original-field-header" }, i18n.originalField.header), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-information", { class: "original-field-popover", label: originalFieldInfo, placement: "top-start", paddedContent: true }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("p", { class: "popover-content" }, originalFieldInfo))), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-select", { width: "full", label: i18n.selectUniqueIdentifier, onCalciteSelectChange: this.handleKeyPairChange.bind(this) }, names.map((nameField, idx) => {
      return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-option", { key: idx, selected: nameField === selectedKeyPair.name }, `${nameField}`));
    }))), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { class: "source-key-pair-select" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "uploaded-field" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("span", { class: "uploaded-field-header" }, i18n.uploadedField.header), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-information", { class: "uploaded-field-popover", label: uploadedFieldInfo, placement: "top-start", paddedContent: true }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("p", { class: "popover-content" }, uploadedFieldInfo))), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-select", { width: "full", label: i18n.selectUniqueIdentifier, onCalciteSelectChange: this.handleSourceKeyPairChange.bind(this) }, (sources || []).map((sourceField, idx) => {
      return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-option", { key: idx, selected: sourceField === selectedSource }, `${sourceField}`));
    })))))));
  }
  get el() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisNewItemAppendKeyValuePair.style = arcgisNewItemAppendKeyValuePairCss;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js":
/*!***********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js ***!
  \***********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createStore)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const appendToMap = (map, propName, value) => {
    const items = map.get(propName);
    if (!items) {
        map.set(propName, [value]);
    }
    else if (!items.includes(value)) {
        items.push(value);
    }
};
const debounce = (fn, ms) => {
    let timeoutId;
    return (...args) => {
        if (timeoutId) {
            clearTimeout(timeoutId);
        }
        timeoutId = setTimeout(() => {
            timeoutId = 0;
            fn(...args);
        }, ms);
    };
};

/**
 * Check if a possible element isConnected.
 * The property might not be there, so we check for it.
 *
 * We want it to return true if isConnected is not a property,
 * otherwise we would remove these elements and would not update.
 *
 * Better leak in Edge than to be useless.
 */
const isConnected = (maybeElement) => !('isConnected' in maybeElement) || maybeElement.isConnected;
const cleanupElements = debounce((map) => {
    for (let key of map.keys()) {
        map.set(key, map.get(key).filter(isConnected));
    }
}, 2000);
const stencilSubscription = () => {
    if (typeof _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.g !== 'function') {
        // If we are not in a stencil project, we do nothing.
        // This function is not really exported by @stencil/core.
        return {};
    }
    const elmsToUpdate = new Map();
    return {
        dispose: () => elmsToUpdate.clear(),
        get: (propName) => {
            const elm = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.g)();
            if (elm) {
                appendToMap(elmsToUpdate, propName, elm);
            }
        },
        set: (propName) => {
            const elements = elmsToUpdate.get(propName);
            if (elements) {
                elmsToUpdate.set(propName, elements.filter(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.f));
            }
            cleanupElements(elmsToUpdate);
        },
        reset: () => {
            elmsToUpdate.forEach((elms) => elms.forEach(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.f));
            cleanupElements(elmsToUpdate);
        },
    };
};

const unwrap = (val) => (typeof val === 'function' ? val() : val);
const createObservableMap = (defaultState, shouldUpdate = (a, b) => a !== b) => {
    const unwrappedState = unwrap(defaultState);
    let states = new Map(Object.entries(unwrappedState !== null && unwrappedState !== void 0 ? unwrappedState : {}));
    const handlers = {
        dispose: [],
        get: [],
        set: [],
        reset: [],
    };
    const reset = () => {
        var _a;
        // When resetting the state, the default state may be a function - unwrap it to invoke it.
        // otherwise, the state won't be properly reset
        states = new Map(Object.entries((_a = unwrap(defaultState)) !== null && _a !== void 0 ? _a : {}));
        handlers.reset.forEach((cb) => cb());
    };
    const dispose = () => {
        // Call first dispose as resetting the state would
        // cause less updates ;)
        handlers.dispose.forEach((cb) => cb());
        reset();
    };
    const get = (propName) => {
        handlers.get.forEach((cb) => cb(propName));
        return states.get(propName);
    };
    const set = (propName, value) => {
        const oldValue = states.get(propName);
        if (shouldUpdate(value, oldValue, propName)) {
            states.set(propName, value);
            handlers.set.forEach((cb) => cb(propName, value, oldValue));
        }
    };
    const state = (typeof Proxy === 'undefined'
        ? {}
        : new Proxy(unwrappedState, {
            get(_, propName) {
                return get(propName);
            },
            ownKeys(_) {
                return Array.from(states.keys());
            },
            getOwnPropertyDescriptor() {
                return {
                    enumerable: true,
                    configurable: true,
                };
            },
            has(_, propName) {
                return states.has(propName);
            },
            set(_, propName, value) {
                set(propName, value);
                return true;
            },
        }));
    const on = (eventName, callback) => {
        handlers[eventName].push(callback);
        return () => {
            removeFromArray(handlers[eventName], callback);
        };
    };
    const onChange = (propName, cb) => {
        const unSet = on('set', (key, newValue) => {
            if (key === propName) {
                cb(newValue);
            }
        });
        // We need to unwrap the defaultState because it might be a function.
        // Otherwise we might not be sending the right reset value.
        const unReset = on('reset', () => cb(unwrap(defaultState)[propName]));
        return () => {
            unSet();
            unReset();
        };
    };
    const use = (...subscriptions) => {
        const unsubs = subscriptions.reduce((unsubs, subscription) => {
            if (subscription.set) {
                unsubs.push(on('set', subscription.set));
            }
            if (subscription.get) {
                unsubs.push(on('get', subscription.get));
            }
            if (subscription.reset) {
                unsubs.push(on('reset', subscription.reset));
            }
            if (subscription.dispose) {
                unsubs.push(on('dispose', subscription.dispose));
            }
            return unsubs;
        }, []);
        return () => unsubs.forEach((unsub) => unsub());
    };
    const forceUpdate = (key) => {
        const oldValue = states.get(key);
        handlers.set.forEach((cb) => cb(key, oldValue, oldValue));
    };
    return {
        state,
        get,
        set,
        on,
        onChange,
        use,
        dispose,
        reset,
        forceUpdate,
    };
};
const removeFromArray = (array, item) => {
    const index = array.indexOf(item);
    if (index >= 0) {
        array[index] = array[array.length - 1];
        array.length--;
    }
};

const createStore = (defaultState, shouldUpdate) => {
    const map = createObservableMap(defaultState, shouldUpdate);
    map.use(stencilSubscription());
    return map;
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js":
/*!********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js ***!
  \********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ uiStore),
/* harmony export */   u: () => (/* binding */ uiStoreState)
/* harmony export */ });
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const uiStore = (0,_index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__.c)({
  nextText: "next",
  workflow: "content",
  scale: "m",
  disableScroll: false,
  featureFlags: { tileLayer3dTiles: false }
});
const uiStoreState = uiStore.state;




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTI0ZGE2MS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEOztBQUV2RCxxQkFBcUIscURBQVc7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwQmhHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFNOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2pDck07QUFDQTtBQUNBO0FBQ0E7QUFDa0c7QUFDdkM7QUFDTjtBQUNFO0FBQzFCOztBQUU3Qix5REFBeUQsbUJBQW1CLGdCQUFnQixtQkFBbUIsUUFBUSxnQkFBZ0IsZUFBZSwrQkFBK0IscUJBQXFCLG1CQUFtQixrQkFBa0Isa0JBQWtCLGlCQUFpQixtQkFBbUIsZUFBZSxtQkFBbUIsZ0JBQWdCLGFBQWEsbUJBQW1CLGtCQUFrQixtQkFBbUIsOENBQThDLGlCQUFpQix1QkFBdUIsd0JBQXdCLG9CQUFvQixrQkFBa0IsV0FBVyxzQkFBc0IscUJBQXFCLGlCQUFpQixXQUFXLGtCQUFrQixhQUFhLHNCQUFzQixjQUFjLCtCQUErQixlQUFlLG9CQUFvQiw2QkFBNkIsNEJBQTRCLGlCQUFpQixrQkFBa0IsZ0JBQWdCLFNBQVMsZ0NBQWdDLGFBQWEsOENBQThDLGdCQUFnQixnREFBZ0QscUJBQXFCOztBQUU1aUM7QUFDQTtBQUNBLElBQUkscURBQWdCO0FBQ3BCLHlC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QSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU0Qjs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNyTTVCO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEOztBQUV2RCxnQkFBZ0IscURBQVc7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0I7QUFDbEIsQ0FBQztBQUNEOztBQUUyQyIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FkZC1pdGVtLTk3ZDU3N2E5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FwcGVuZC01OGE3ZTdhYi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtbmV3LWl0ZW0tYXBwZW5kLWtleS12YWx1ZS1wYWlyLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2luZGV4LTgxZDU0OGI3LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL3VpLWVjZjg2YmJhLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVTdG9yZSB9IGZyb20gJy4vaW5kZXgtODFkNTQ4YjcuanMnO1xuXG5jb25zdCBhZGRJdGVtU3RvcmUgPSBjcmVhdGVTdG9yZSh7XG4gIHR5cGVLZXl3b3JkczogW10sXG4gIGN1c3RvbVBhcmFtZXRlcnM6IFtdLFxuICBhbmFseXplZExvY2F0aW9uVHlwZXM6IFtdLFxuICBhbGxvd1N0b3JlZEF1dGg6IHRydWUsXG4gIGlzU2VjdXJlZDogbnVsbCxcbiAgY2hlY2tBdXRoOiBmYWxzZVxufSk7XG4vLyBFbnRpcmUgYWRkIGl0ZW0gc3RhdGUgb2JqZWN0XG5jb25zdCBhZGRJdGVtU3RhdGUgPSBhZGRJdGVtU3RvcmUuc3RhdGU7XG4vLyBTdWJzZXRzIG9mIGFkZCBpdGVtIHN0YXRlXG5jb25zdCBhZGRJdGVtUmVxdWVzdFN0YXRlID0gYWRkSXRlbVN0b3JlLnN0YXRlO1xuY29uc3QgYWRkSXRlbVVybFN0YXRlID0gYWRkSXRlbVN0b3JlLnN0YXRlO1xuXG5leHBvcnQgeyBhZGRJdGVtU3RhdGUgYXMgYSwgYWRkSXRlbVVybFN0YXRlIGFzIGIsIGFkZEl0ZW1SZXF1ZXN0U3RhdGUgYXMgYywgYWRkSXRlbVN0b3JlIGFzIGQgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuY29uc3QgdWlkRmllbGRzID0gW1wiZXNyaUZpZWxkVHlwZU9JRFwiLCBcImVzcmlGaWVsZFR5cGVHbG9iYWxJRFwiXTtcbmNvbnN0IE5PTkVfVkFMVUUgPSBcIjxOb25lPlwiO1xuY29uc3QgQXBwZW5kT3ZlcndyaXRlUHVibGlzaFR5cGVzID0ge1xuICBcImZpbGUgZ2VvZGF0YWJhc2VcIjogXCJmaWxlZ2VvZGF0YWJhc2VcIixcbiAgc2hhcGVmaWxlOiBcInNoYXBlZmlsZVwiLFxuICBnZW9qc29uOiBcImdlb2pzb25cIixcbiAgY3N2OiBcIkNTVlwiLFxuICBcIm1pY3Jvc29mdCBleGNlbFwiOiBcImV4Y2VsXCIsXG4gIGdlb3BhY2thZ2U6IFwiZ2VvUGFja2FnZVwiXG59O1xuY29uc3QgYXBwZW5kRmlsZVR5cGVzID0ge1xuICBTaGFwZWZpbGU6IFwic2hhcGVmaWxlXCIsXG4gIFwiRmlsZSBHZW9kYXRhYmFzZVwiOiBcImZpbGVHZW9kYXRhYmFzZVwiLFxuICBDU1Y6IFwiY3N2XCIsXG4gIFwiTWljcm9zb2Z0IEV4Y2VsXCI6IFwiZXhjZWxcIixcbiAgR2VvSnNvbjogXCJnZW9qc29uXCIsXG4gIEdlb1BhY2thZ2U6IFwiZ2VvUGFja2FnZVwiXG59O1xuY29uc3QgQXBwZW5kT3ZlcndyaXRlQ2xvdWRQdWJsaXNoVHlwZXMgPSB7XG4gIGNzdjogXCJDU1ZcIixcbiAgZXhjZWw6IFwiTWljcm9zb2Z0IEV4Y2VsXCIsXG4gIHNoYXBlZmlsZTogXCJTaGFwZWZpbGVcIixcbiAgZmdkYjogXCJGaWxlIEdlb2RhdGFiYXNlXCIsXG4gIGdlb2pzb246IFwiR2VvSnNvblwiLFxuICBnb29nbGVzaGVldHM6IFwiTWljcm9zb2Z0IEV4Y2VsXCJcbn07XG5jb25zdCBhcHBlbmRFeHRlbnNpb25zID0gW1wiemlwXCIsIFwiY3N2XCIsIFwieGxzXCIsIFwieGxzeFwiLCBcImdlb2pzb25cIiwgXCJncGtnXCIsIFwianNvblwiXTtcbmNvbnN0IGFwcGVuZEV4dGVuc2lvbnNGb3JFbnRlcnByaXNlID0gW1wiemlwXCIsIFwiY3N2XCIsIFwieGxzXCIsIFwieGxzeFwiXTtcblxuZXhwb3J0IHsgQXBwZW5kT3ZlcndyaXRlQ2xvdWRQdWJsaXNoVHlwZXMgYXMgQSwgTk9ORV9WQUxVRSBhcyBOLCBhcHBlbmRGaWxlVHlwZXMgYXMgYSwgQXBwZW5kT3ZlcndyaXRlUHVibGlzaFR5cGVzIGFzIGIsIGFwcGVuZEV4dGVuc2lvbnNGb3JFbnRlcnByaXNlIGFzIGMsIGFwcGVuZEV4dGVuc2lvbnMgYXMgZCwgdWlkRmllbGRzIGFzIHUgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBkIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LTkyZWJiMzk2LmpzJztcbmltcG9ydCB7IGEgYXMgYWRkSXRlbVN0YXRlIH0gZnJvbSAnLi9hZGQtaXRlbS05N2Q1NzdhOS5qcyc7XG5pbXBvcnQgeyB1IGFzIHVpU3RvcmVTdGF0ZSB9IGZyb20gJy4vdWktZWNmODZiYmEuanMnO1xuaW1wb3J0IHsgTiBhcyBOT05FX1ZBTFVFIH0gZnJvbSAnLi9hcHBlbmQtNThhN2U3YWIuanMnO1xuaW1wb3J0ICcuL2luZGV4LTgxZDU0OGI3LmpzJztcblxuY29uc3QgYXJjZ2lzTmV3SXRlbUFwcGVuZEtleVZhbHVlUGFpckNzcyA9IFwiLmRlc2NyaXB0aW9ue2ZvbnQtc2l6ZTowLjg3NXJlbTtmb250LXdlaWdodDozMDA7bWFyZ2luLWJvdHRvbToxcmVtfS5oZWFkZXJ7Zm9udC13ZWlnaHQ6NTAwO2ZvbnQtc2l6ZToxcmVtO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKTttYXJnaW4tYm90dG9tOjAuNXJlbX0uZGVzY3JpcHRpb24tbGFiZWx7Zm9udC1zaXplOjAuNzVyZW07bWFyZ2luLXRvcDowLjVyZW19LmtleS1wYWlyLXNlbGVjdHtmb250LXNpemU6MC44NzVyZW19LmtleS1wYWlyLXBhZ2V7bWFyZ2luLWJvdHRvbToxcmVtfS5zZWxlY3Qtd3JhcHBlcntkaXNwbGF5OmZsZXg7ZmxleC1kaXJlY3Rpb246cm93O21hcmdpbi10b3A6MC41cmVtO21hcmdpbi1ib3R0b206MnJlbTtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktYmFja2dyb3VuZCk7cGFkZGluZy10b3A6MXJlbTtwYWRkaW5nLWJvdHRvbTowLjc1cmVtfS5zb3VyY2Uta2V5LXBhaXItc2VsZWN0e21hcmdpbi1sZWZ0OjAuNzVyZW07bWFyZ2luLXJpZ2h0OjFyZW07d2lkdGg6MTAwJX0ubmFtZS1rZXktcGFpci1zZWxlY3R7bWFyZ2luLXJpZ2h0OjAuNzVyZW07bWFyZ2luLWxlZnQ6MXJlbTt3aWR0aDoxMDAlfS5zZWxlY3QtYW5kLWxhYmVse2Rpc3BsYXk6ZmxleDtmbGV4LWRpcmVjdGlvbjpjb2x1bW59LnBvcG92ZXItaWNvbntjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMyk7Y3Vyc29yOnBvaW50ZXI7bWFyZ2luLXRvcDowLjEyNXJlbTstd2Via2l0LW1hcmdpbi1zdGFydDowLjc1cmVtO21hcmdpbi1pbmxpbmUtc3RhcnQ6MC43NXJlbX0ucG9wb3Zlci1jb250ZW50e2ZvbnQtc2l6ZTowLjc1cmVtO2ZvbnQtd2VpZ2h0OjQwMDttYXJnaW46MH0ub3JpZ2luYWwtZmllbGQsLnVwbG9hZGVkLWZpZWxke2Rpc3BsYXk6ZmxleH0ub3JpZ2luYWwtZmllbGQtaGVhZGVyLC51cGxvYWRlZC1maWVsZC1oZWFkZXJ7Zm9udC13ZWlnaHQ6NTAwfS5vcmlnaW5hbC1maWVsZC1wb3BvdmVyLC51cGxvYWRlZC1maWVsZC1wb3BvdmVye21hcmdpbi10b3A6LTAuMzEzcmVtfVwiO1xuXG5jb25zdCBBcmNnaXNOZXdJdGVtQXBwZW5kS2V5VmFsdWVQYWlyID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLmtleVBhaXJDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImtleVBhaXJDaGFuZ2VcIiwgNyk7XG4gICAgdGhpcy5rZXlQYWlycyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmkxOG4gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zb3VyY2VWYWx1ZXMgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5uYW1lVmFsdWVzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2VsZWN0ZWRLZXlQYWlyID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2VsZWN0ZWRTb3VyY2UgPSBudWxsO1xuICB9XG4gIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgIHZhciBfYTtcbiAgICBjb25zdCB7IGV4aXN0aW5nSXRlbSwgb3JpZ2luYWxGaWxlTmFtZSB9ID0gYWRkSXRlbVN0YXRlO1xuICAgIGxldCBzZWxlY3RlZE5hbWUgPSBOT05FX1ZBTFVFO1xuICAgIHRoaXMuaTE4biA9IHVpU3RvcmVTdGF0ZS5pMThuLmFwcGVuZEtleVZhbHVlUGFpcjtcbiAgICBpZiAoISFhZGRJdGVtU3RhdGUudWlkUGFpcikge1xuICAgICAgc2VsZWN0ZWROYW1lID0gYWRkSXRlbVN0YXRlLnVpZFBhaXIubmFtZTtcbiAgICAgIHRoaXMuc2VsZWN0ZWRTb3VyY2UgPSBhZGRJdGVtU3RhdGUudWlkUGFpci5zb3VyY2U7XG4gICAgfVxuICAgIHRoaXMuc2VsZWN0ZWRLZXlQYWlyID0gdGhpcy5rZXlQYWlyc1tzZWxlY3RlZE5hbWVdO1xuICAgIHRoaXMuc291cmNlVmFsdWVzID0gKF9hID0gdGhpcy5zZWxlY3RlZEtleVBhaXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5wb3NzaWJsZU1hdGNoZXM7XG4gICAgdGhpcy5uYW1lVmFsdWVzID0gT2JqZWN0LmtleXModGhpcy5rZXlQYWlycyk7XG4gICAgdGhpcy5vcmlnaW5hbEZpZWxkSW5mbyA9IHRoaXMuaTE4bi5vcmlnaW5hbEZpZWxkLm1vcmVJbmZvLnJlcGxhY2UoXCIke2ZlYXR1cmVMYXllck5hbWV9XCIsIGV4aXN0aW5nSXRlbS50aXRsZSk7XG4gICAgdGhpcy51cGxvYWRlZEZpZWxkSW5mbyA9IHRoaXMuaTE4bi51cGxvYWRlZEZpZWxkLm1vcmVJbmZvLnJlcGxhY2UoXCIke3VwbG9hZGVkRmlsZU5hbWV9XCIsIG9yaWdpbmFsRmlsZU5hbWUpO1xuICB9XG4gIGhhbmRsZUtleVBhaXJDaGFuZ2UoZXYpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGV2LnRhcmdldC5zZWxlY3RlZE9wdGlvbi52YWx1ZTtcbiAgICB0aGlzLnNlbGVjdGVkS2V5UGFpciA9IHRoaXMua2V5UGFpcnNbdmFsdWVdO1xuICAgIGNvbnN0IHBvc3NpYmxlTWF0Y2hlcyA9IHRoaXMuc2VsZWN0ZWRLZXlQYWlyLnBvc3NpYmxlTWF0Y2hlcy5sZW5ndGggPiAwXG4gICAgICA/IFsuLi50aGlzLnNlbGVjdGVkS2V5UGFpci5wb3NzaWJsZU1hdGNoZXNdXG4gICAgICA6IFtOT05FX1ZBTFVFXTtcbiAgICB0aGlzLnNvdXJjZVZhbHVlcyA9IHBvc3NpYmxlTWF0Y2hlcztcbiAgICB0aGlzLnNlbGVjdGVkU291cmNlID0gcG9zc2libGVNYXRjaGVzWzBdO1xuICAgIGNvbnN0IHBheWxvYWQgPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIHRoaXMuc2VsZWN0ZWRLZXlQYWlyKSwgeyBzb3VyY2U6IHRoaXMuc2VsZWN0ZWRTb3VyY2UsIGluaXRpYWxNYXRjaDogdGhpcy5zZWxlY3RlZFNvdXJjZSB9KTtcbiAgICB0aGlzLmtleVBhaXJDaGFuZ2UuZW1pdChwYXlsb2FkKTtcbiAgfVxuICBoYW5kbGVTb3VyY2VLZXlQYWlyQ2hhbmdlKGV2KSB7XG4gICAgY29uc3QgdmFsdWUgPSBldi50YXJnZXQuc2VsZWN0ZWRPcHRpb24udmFsdWU7XG4gICAgY29uc3QgcGF5bG9hZCA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5zZWxlY3RlZEtleVBhaXIpLCB7IHNvdXJjZTogdmFsdWUsIGluaXRpYWxNYXRjaDogdmFsdWUgfSk7XG4gICAgdGhpcy5rZXlQYWlyQ2hhbmdlLmVtaXQocGF5bG9hZCk7XG4gIH1cbiAgcmVuZGVyKCkge1xuICAgIGNvbnN0IHsgb3JpZ2luYWxGaWVsZEluZm8sIHVwbG9hZGVkRmllbGRJbmZvLCBpMThuLCBzZWxlY3RlZEtleVBhaXIsIHNlbGVjdGVkU291cmNlIH0gPSB0aGlzO1xuICAgIGNvbnN0IG5hbWVzID0gdGhpcy5uYW1lVmFsdWVzO1xuICAgIGNvbnN0IHNvdXJjZXMgPSB0aGlzLnNvdXJjZVZhbHVlcztcbiAgICByZXR1cm4gKGgoXCJkaXZcIiwgeyBjbGFzczogXCJrZXktcGFpci1wYWdlXCIgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBcInNlbGVjdC1hbmQtbGFiZWxcIiB9LCBoKFwiYXJjZ2lzLW5ldy1pdGVtLWRlc2NyaXB0aW9uXCIsIHsgaGVhZGVyOiBpMThuLnNlbGVjdFVuaXF1ZUlkZW50aWZpZXIsIGNvbnRlbnQ6IGkxOG4uc2VsZWN0VW5pcXVlSWRlbnRpZmllckRlc2NyaXB0aW9uIH0pLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwic2VsZWN0LXdyYXBwZXJcIiB9LCBoKFwiY2FsY2l0ZS1sYWJlbFwiLCB7IGNsYXNzOiBcIm5hbWUta2V5LXBhaXItc2VsZWN0XCIgfSwgaChcInNwYW5cIiwgeyBjbGFzczogXCJvcmlnaW5hbC1maWVsZFwiLCByb2xlOiBcImNvbHVtbmhlYWRlclwiIH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwib3JpZ2luYWwtZmllbGQtaGVhZGVyXCIgfSwgaTE4bi5vcmlnaW5hbEZpZWxkLmhlYWRlciksIGgoXCJhcmNnaXMtaW5mb3JtYXRpb25cIiwgeyBjbGFzczogXCJvcmlnaW5hbC1maWVsZC1wb3BvdmVyXCIsIGxhYmVsOiBvcmlnaW5hbEZpZWxkSW5mbywgcGxhY2VtZW50OiBcInRvcC1zdGFydFwiLCBwYWRkZWRDb250ZW50OiB0cnVlIH0sIGgoXCJwXCIsIHsgY2xhc3M6IFwicG9wb3Zlci1jb250ZW50XCIgfSwgb3JpZ2luYWxGaWVsZEluZm8pKSksIGgoXCJjYWxjaXRlLXNlbGVjdFwiLCB7IHdpZHRoOiBcImZ1bGxcIiwgbGFiZWw6IGkxOG4uc2VsZWN0VW5pcXVlSWRlbnRpZmllciwgb25DYWxjaXRlU2VsZWN0Q2hhbmdlOiB0aGlzLmhhbmRsZUtleVBhaXJDaGFuZ2UuYmluZCh0aGlzKSB9LCBuYW1lcy5tYXAoKG5hbWVGaWVsZCwgaWR4KSA9PiB7XG4gICAgICByZXR1cm4gKGgoXCJjYWxjaXRlLW9wdGlvblwiLCB7IGtleTogaWR4LCBzZWxlY3RlZDogbmFtZUZpZWxkID09PSBzZWxlY3RlZEtleVBhaXIubmFtZSB9LCBgJHtuYW1lRmllbGR9YCkpO1xuICAgIH0pKSksIGgoXCJjYWxjaXRlLWxhYmVsXCIsIHsgY2xhc3M6IFwic291cmNlLWtleS1wYWlyLXNlbGVjdFwiIH0sIGgoXCJzcGFuXCIsIHsgY2xhc3M6IFwidXBsb2FkZWQtZmllbGRcIiB9LCBoKFwic3BhblwiLCB7IGNsYXNzOiBcInVwbG9hZGVkLWZpZWxkLWhlYWRlclwiIH0sIGkxOG4udXBsb2FkZWRGaWVsZC5oZWFkZXIpLCBoKFwiYXJjZ2lzLWluZm9ybWF0aW9uXCIsIHsgY2xhc3M6IFwidXBsb2FkZWQtZmllbGQtcG9wb3ZlclwiLCBsYWJlbDogdXBsb2FkZWRGaWVsZEluZm8sIHBsYWNlbWVudDogXCJ0b3Atc3RhcnRcIiwgcGFkZGVkQ29udGVudDogdHJ1ZSB9LCBoKFwicFwiLCB7IGNsYXNzOiBcInBvcG92ZXItY29udGVudFwiIH0sIHVwbG9hZGVkRmllbGRJbmZvKSkpLCBoKFwiY2FsY2l0ZS1zZWxlY3RcIiwgeyB3aWR0aDogXCJmdWxsXCIsIGxhYmVsOiBpMThuLnNlbGVjdFVuaXF1ZUlkZW50aWZpZXIsIG9uQ2FsY2l0ZVNlbGVjdENoYW5nZTogdGhpcy5oYW5kbGVTb3VyY2VLZXlQYWlyQ2hhbmdlLmJpbmQodGhpcykgfSwgKHNvdXJjZXMgfHwgW10pLm1hcCgoc291cmNlRmllbGQsIGlkeCkgPT4ge1xuICAgICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1vcHRpb25cIiwgeyBrZXk6IGlkeCwgc2VsZWN0ZWQ6IHNvdXJjZUZpZWxkID09PSBzZWxlY3RlZFNvdXJjZSB9LCBgJHtzb3VyY2VGaWVsZH1gKSk7XG4gICAgfSkpKSkpKSk7XG4gIH1cbiAgZ2V0IGVsKCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxufTtcbkFyY2dpc05ld0l0ZW1BcHBlbmRLZXlWYWx1ZVBhaXIuc3R5bGUgPSBhcmNnaXNOZXdJdGVtQXBwZW5kS2V5VmFsdWVQYWlyQ3NzO1xuXG5leHBvcnQgeyBBcmNnaXNOZXdJdGVtQXBwZW5kS2V5VmFsdWVQYWlyIGFzIGFyY2dpc19uZXdfaXRlbV9hcHBlbmRfa2V5X3ZhbHVlX3BhaXIgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgZyBhcyBnZXRSZW5kZXJpbmdSZWYsIGYgYXMgZm9yY2VVcGRhdGUgfSBmcm9tICcuL2luZGV4LTkyZWJiMzk2LmpzJztcblxuY29uc3QgYXBwZW5kVG9NYXAgPSAobWFwLCBwcm9wTmFtZSwgdmFsdWUpID0+IHtcbiAgICBjb25zdCBpdGVtcyA9IG1hcC5nZXQocHJvcE5hbWUpO1xuICAgIGlmICghaXRlbXMpIHtcbiAgICAgICAgbWFwLnNldChwcm9wTmFtZSwgW3ZhbHVlXSk7XG4gICAgfVxuICAgIGVsc2UgaWYgKCFpdGVtcy5pbmNsdWRlcyh2YWx1ZSkpIHtcbiAgICAgICAgaXRlbXMucHVzaCh2YWx1ZSk7XG4gICAgfVxufTtcbmNvbnN0IGRlYm91bmNlID0gKGZuLCBtcykgPT4ge1xuICAgIGxldCB0aW1lb3V0SWQ7XG4gICAgcmV0dXJuICguLi5hcmdzKSA9PiB7XG4gICAgICAgIGlmICh0aW1lb3V0SWQpIHtcbiAgICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0SWQpO1xuICAgICAgICB9XG4gICAgICAgIHRpbWVvdXRJZCA9IHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgdGltZW91dElkID0gMDtcbiAgICAgICAgICAgIGZuKC4uLmFyZ3MpO1xuICAgICAgICB9LCBtcyk7XG4gICAgfTtcbn07XG5cbi8qKlxuICogQ2hlY2sgaWYgYSBwb3NzaWJsZSBlbGVtZW50IGlzQ29ubmVjdGVkLlxuICogVGhlIHByb3BlcnR5IG1pZ2h0IG5vdCBiZSB0aGVyZSwgc28gd2UgY2hlY2sgZm9yIGl0LlxuICpcbiAqIFdlIHdhbnQgaXQgdG8gcmV0dXJuIHRydWUgaWYgaXNDb25uZWN0ZWQgaXMgbm90IGEgcHJvcGVydHksXG4gKiBvdGhlcndpc2Ugd2Ugd291bGQgcmVtb3ZlIHRoZXNlIGVsZW1lbnRzIGFuZCB3b3VsZCBub3QgdXBkYXRlLlxuICpcbiAqIEJldHRlciBsZWFrIGluIEVkZ2UgdGhhbiB0byBiZSB1c2VsZXNzLlxuICovXG5jb25zdCBpc0Nvbm5lY3RlZCA9IChtYXliZUVsZW1lbnQpID0+ICEoJ2lzQ29ubmVjdGVkJyBpbiBtYXliZUVsZW1lbnQpIHx8IG1heWJlRWxlbWVudC5pc0Nvbm5lY3RlZDtcbmNvbnN0IGNsZWFudXBFbGVtZW50cyA9IGRlYm91bmNlKChtYXApID0+IHtcbiAgICBmb3IgKGxldCBrZXkgb2YgbWFwLmtleXMoKSkge1xuICAgICAgICBtYXAuc2V0KGtleSwgbWFwLmdldChrZXkpLmZpbHRlcihpc0Nvbm5lY3RlZCkpO1xuICAgIH1cbn0sIDIwMDApO1xuY29uc3Qgc3RlbmNpbFN1YnNjcmlwdGlvbiA9ICgpID0+IHtcbiAgICBpZiAodHlwZW9mIGdldFJlbmRlcmluZ1JlZiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAvLyBJZiB3ZSBhcmUgbm90IGluIGEgc3RlbmNpbCBwcm9qZWN0LCB3ZSBkbyBub3RoaW5nLlxuICAgICAgICAvLyBUaGlzIGZ1bmN0aW9uIGlzIG5vdCByZWFsbHkgZXhwb3J0ZWQgYnkgQHN0ZW5jaWwvY29yZS5cbiAgICAgICAgcmV0dXJuIHt9O1xuICAgIH1cbiAgICBjb25zdCBlbG1zVG9VcGRhdGUgPSBuZXcgTWFwKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgZGlzcG9zZTogKCkgPT4gZWxtc1RvVXBkYXRlLmNsZWFyKCksXG4gICAgICAgIGdldDogKHByb3BOYW1lKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBlbG0gPSBnZXRSZW5kZXJpbmdSZWYoKTtcbiAgICAgICAgICAgIGlmIChlbG0pIHtcbiAgICAgICAgICAgICAgICBhcHBlbmRUb01hcChlbG1zVG9VcGRhdGUsIHByb3BOYW1lLCBlbG0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICBzZXQ6IChwcm9wTmFtZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgZWxlbWVudHMgPSBlbG1zVG9VcGRhdGUuZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgICAgIGlmIChlbGVtZW50cykge1xuICAgICAgICAgICAgICAgIGVsbXNUb1VwZGF0ZS5zZXQocHJvcE5hbWUsIGVsZW1lbnRzLmZpbHRlcihmb3JjZVVwZGF0ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2xlYW51cEVsZW1lbnRzKGVsbXNUb1VwZGF0ZSk7XG4gICAgICAgIH0sXG4gICAgICAgIHJlc2V0OiAoKSA9PiB7XG4gICAgICAgICAgICBlbG1zVG9VcGRhdGUuZm9yRWFjaCgoZWxtcykgPT4gZWxtcy5mb3JFYWNoKGZvcmNlVXBkYXRlKSk7XG4gICAgICAgICAgICBjbGVhbnVwRWxlbWVudHMoZWxtc1RvVXBkYXRlKTtcbiAgICAgICAgfSxcbiAgICB9O1xufTtcblxuY29uc3QgdW53cmFwID0gKHZhbCkgPT4gKHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicgPyB2YWwoKSA6IHZhbCk7XG5jb25zdCBjcmVhdGVPYnNlcnZhYmxlTWFwID0gKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlID0gKGEsIGIpID0+IGEgIT09IGIpID0+IHtcbiAgICBjb25zdCB1bndyYXBwZWRTdGF0ZSA9IHVud3JhcChkZWZhdWx0U3RhdGUpO1xuICAgIGxldCBzdGF0ZXMgPSBuZXcgTWFwKE9iamVjdC5lbnRyaWVzKHVud3JhcHBlZFN0YXRlICE9PSBudWxsICYmIHVud3JhcHBlZFN0YXRlICE9PSB2b2lkIDAgPyB1bndyYXBwZWRTdGF0ZSA6IHt9KSk7XG4gICAgY29uc3QgaGFuZGxlcnMgPSB7XG4gICAgICAgIGRpc3Bvc2U6IFtdLFxuICAgICAgICBnZXQ6IFtdLFxuICAgICAgICBzZXQ6IFtdLFxuICAgICAgICByZXNldDogW10sXG4gICAgfTtcbiAgICBjb25zdCByZXNldCA9ICgpID0+IHtcbiAgICAgICAgdmFyIF9hO1xuICAgICAgICAvLyBXaGVuIHJlc2V0dGluZyB0aGUgc3RhdGUsIHRoZSBkZWZhdWx0IHN0YXRlIG1heSBiZSBhIGZ1bmN0aW9uIC0gdW53cmFwIGl0IHRvIGludm9rZSBpdC5cbiAgICAgICAgLy8gb3RoZXJ3aXNlLCB0aGUgc3RhdGUgd29uJ3QgYmUgcHJvcGVybHkgcmVzZXRcbiAgICAgICAgc3RhdGVzID0gbmV3IE1hcChPYmplY3QuZW50cmllcygoX2EgPSB1bndyYXAoZGVmYXVsdFN0YXRlKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDoge30pKTtcbiAgICAgICAgaGFuZGxlcnMucmVzZXQuZm9yRWFjaCgoY2IpID0+IGNiKCkpO1xuICAgIH07XG4gICAgY29uc3QgZGlzcG9zZSA9ICgpID0+IHtcbiAgICAgICAgLy8gQ2FsbCBmaXJzdCBkaXNwb3NlIGFzIHJlc2V0dGluZyB0aGUgc3RhdGUgd291bGRcbiAgICAgICAgLy8gY2F1c2UgbGVzcyB1cGRhdGVzIDspXG4gICAgICAgIGhhbmRsZXJzLmRpc3Bvc2UuZm9yRWFjaCgoY2IpID0+IGNiKCkpO1xuICAgICAgICByZXNldCgpO1xuICAgIH07XG4gICAgY29uc3QgZ2V0ID0gKHByb3BOYW1lKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzLmdldC5mb3JFYWNoKChjYikgPT4gY2IocHJvcE5hbWUpKTtcbiAgICAgICAgcmV0dXJuIHN0YXRlcy5nZXQocHJvcE5hbWUpO1xuICAgIH07XG4gICAgY29uc3Qgc2V0ID0gKHByb3BOYW1lLCB2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zdCBvbGRWYWx1ZSA9IHN0YXRlcy5nZXQocHJvcE5hbWUpO1xuICAgICAgICBpZiAoc2hvdWxkVXBkYXRlKHZhbHVlLCBvbGRWYWx1ZSwgcHJvcE5hbWUpKSB7XG4gICAgICAgICAgICBzdGF0ZXMuc2V0KHByb3BOYW1lLCB2YWx1ZSk7XG4gICAgICAgICAgICBoYW5kbGVycy5zZXQuZm9yRWFjaCgoY2IpID0+IGNiKHByb3BOYW1lLCB2YWx1ZSwgb2xkVmFsdWUpKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgY29uc3Qgc3RhdGUgPSAodHlwZW9mIFByb3h5ID09PSAndW5kZWZpbmVkJ1xuICAgICAgICA/IHt9XG4gICAgICAgIDogbmV3IFByb3h5KHVud3JhcHBlZFN0YXRlLCB7XG4gICAgICAgICAgICBnZXQoXywgcHJvcE5hbWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZ2V0KHByb3BOYW1lKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvd25LZXlzKF8pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gQXJyYXkuZnJvbShzdGF0ZXMua2V5cygpKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFzKF8sIHByb3BOYW1lKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHN0YXRlcy5oYXMocHJvcE5hbWUpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHNldChfLCBwcm9wTmFtZSwgdmFsdWUpIHtcbiAgICAgICAgICAgICAgICBzZXQocHJvcE5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pKTtcbiAgICBjb25zdCBvbiA9IChldmVudE5hbWUsIGNhbGxiYWNrKSA9PiB7XG4gICAgICAgIGhhbmRsZXJzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICByZW1vdmVGcm9tQXJyYXkoaGFuZGxlcnNbZXZlbnROYW1lXSwgY2FsbGJhY2spO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgY29uc3Qgb25DaGFuZ2UgPSAocHJvcE5hbWUsIGNiKSA9PiB7XG4gICAgICAgIGNvbnN0IHVuU2V0ID0gb24oJ3NldCcsIChrZXksIG5ld1ZhbHVlKSA9PiB7XG4gICAgICAgICAgICBpZiAoa2V5ID09PSBwcm9wTmFtZSkge1xuICAgICAgICAgICAgICAgIGNiKG5ld1ZhbHVlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICAgIC8vIFdlIG5lZWQgdG8gdW53cmFwIHRoZSBkZWZhdWx0U3RhdGUgYmVjYXVzZSBpdCBtaWdodCBiZSBhIGZ1bmN0aW9uLlxuICAgICAgICAvLyBPdGhlcndpc2Ugd2UgbWlnaHQgbm90IGJlIHNlbmRpbmcgdGhlIHJpZ2h0IHJlc2V0IHZhbHVlLlxuICAgICAgICBjb25zdCB1blJlc2V0ID0gb24oJ3Jlc2V0JywgKCkgPT4gY2IodW53cmFwKGRlZmF1bHRTdGF0ZSlbcHJvcE5hbWVdKSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB1blNldCgpO1xuICAgICAgICAgICAgdW5SZXNldCgpO1xuICAgICAgICB9O1xuICAgIH07XG4gICAgY29uc3QgdXNlID0gKC4uLnN1YnNjcmlwdGlvbnMpID0+IHtcbiAgICAgICAgY29uc3QgdW5zdWJzID0gc3Vic2NyaXB0aW9ucy5yZWR1Y2UoKHVuc3Vicywgc3Vic2NyaXB0aW9uKSA9PiB7XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnNldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdzZXQnLCBzdWJzY3JpcHRpb24uc2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLmdldCkge1xuICAgICAgICAgICAgICAgIHVuc3Vicy5wdXNoKG9uKCdnZXQnLCBzdWJzY3JpcHRpb24uZ2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLnJlc2V0KSB7XG4gICAgICAgICAgICAgICAgdW5zdWJzLnB1c2gob24oJ3Jlc2V0Jywgc3Vic2NyaXB0aW9uLnJlc2V0KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoc3Vic2NyaXB0aW9uLmRpc3Bvc2UpIHtcbiAgICAgICAgICAgICAgICB1bnN1YnMucHVzaChvbignZGlzcG9zZScsIHN1YnNjcmlwdGlvbi5kaXNwb3NlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5zdWJzO1xuICAgICAgICB9LCBbXSk7XG4gICAgICAgIHJldHVybiAoKSA9PiB1bnN1YnMuZm9yRWFjaCgodW5zdWIpID0+IHVuc3ViKCkpO1xuICAgIH07XG4gICAgY29uc3QgZm9yY2VVcGRhdGUgPSAoa2V5KSA9PiB7XG4gICAgICAgIGNvbnN0IG9sZFZhbHVlID0gc3RhdGVzLmdldChrZXkpO1xuICAgICAgICBoYW5kbGVycy5zZXQuZm9yRWFjaCgoY2IpID0+IGNiKGtleSwgb2xkVmFsdWUsIG9sZFZhbHVlKSk7XG4gICAgfTtcbiAgICByZXR1cm4ge1xuICAgICAgICBzdGF0ZSxcbiAgICAgICAgZ2V0LFxuICAgICAgICBzZXQsXG4gICAgICAgIG9uLFxuICAgICAgICBvbkNoYW5nZSxcbiAgICAgICAgdXNlLFxuICAgICAgICBkaXNwb3NlLFxuICAgICAgICByZXNldCxcbiAgICAgICAgZm9yY2VVcGRhdGUsXG4gICAgfTtcbn07XG5jb25zdCByZW1vdmVGcm9tQXJyYXkgPSAoYXJyYXksIGl0ZW0pID0+IHtcbiAgICBjb25zdCBpbmRleCA9IGFycmF5LmluZGV4T2YoaXRlbSk7XG4gICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgYXJyYXlbaW5kZXhdID0gYXJyYXlbYXJyYXkubGVuZ3RoIC0gMV07XG4gICAgICAgIGFycmF5Lmxlbmd0aC0tO1xuICAgIH1cbn07XG5cbmNvbnN0IGNyZWF0ZVN0b3JlID0gKGRlZmF1bHRTdGF0ZSwgc2hvdWxkVXBkYXRlKSA9PiB7XG4gICAgY29uc3QgbWFwID0gY3JlYXRlT2JzZXJ2YWJsZU1hcChkZWZhdWx0U3RhdGUsIHNob3VsZFVwZGF0ZSk7XG4gICAgbWFwLnVzZShzdGVuY2lsU3Vic2NyaXB0aW9uKCkpO1xuICAgIHJldHVybiBtYXA7XG59O1xuXG5leHBvcnQgeyBjcmVhdGVTdG9yZSBhcyBjIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IGMgYXMgY3JlYXRlU3RvcmUgfSBmcm9tICcuL2luZGV4LTgxZDU0OGI3LmpzJztcblxuY29uc3QgdWlTdG9yZSA9IGNyZWF0ZVN0b3JlKHtcbiAgbmV4dFRleHQ6IFwibmV4dFwiLFxuICB3b3JrZmxvdzogXCJjb250ZW50XCIsXG4gIHNjYWxlOiBcIm1cIixcbiAgZGlzYWJsZVNjcm9sbDogZmFsc2UsXG4gIGZlYXR1cmVGbGFnczogeyB0aWxlTGF5ZXIzZFRpbGVzOiBmYWxzZSB9XG59KTtcbmNvbnN0IHVpU3RvcmVTdGF0ZSA9IHVpU3RvcmUuc3RhdGU7XG5cbmV4cG9ydCB7IHVpU3RvcmUgYXMgYSwgdWlTdG9yZVN0YXRlIGFzIHUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==