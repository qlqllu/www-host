"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-53a559"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-modal-arcade.entry.js":
/*!**********************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-modal-arcade.entry.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_modal_arcade: () => (/* binding */ ArcgisModalArcade)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _locale_13e00a75_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale-13e00a75.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-13e00a75.js");
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/* harmony import */ var _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./languageUtil-22258c90.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */






const arcgisModalArcadeCss = ".arcade-modal.sc-arcgis-modal-arcade{top:7.5%;left:7.5%;right:7.5%;--calcite-modal-width:85%;--calcite-modal-height:85%}.arcade-editor.sc-arcgis-modal-arcade{width:100%;height:100%}.header.sc-arcgis-modal-arcade{width:50%}";

const ArcgisModalArcade = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.arcgisModalArcadeClose = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisModalArcadeClose", 7);
    this.hideDocumentationActions = false;
    this.arcadeScript = undefined;
    this.arcadeProfile = undefined;
    this.testData = undefined;
    this.suggestions = undefined;
    this.returnPredictOutputType = true;
    this.arcadeTitle = undefined;
    this.arcadeTitleEditable = false;
    this.arcadeTitleEditingEnabled = false;
    this.addExistingExpressions = false;
    this.layer = undefined;
    this.scriptInvalid = true;
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  async componentWillLoad() {
    var _a;
    [this.strings, this.currentLanguage] =
      await (0,_locale_13e00a75_js__WEBPACK_IMPORTED_MODULE_2__.g)(this.hostElement);
    await this.loadAllModules();
    if (this.addExistingExpressions && this.layer) {
      const existingExpressions = this.getExistingExpressions();
      if (existingExpressions) {
        if ((_a = this.suggestions) === null || _a === void 0 ? void 0 : _a.length) {
          this.suggestions.push(existingExpressions);
        }
        else {
          this.suggestions = [existingExpressions];
        }
      }
    }
  }
  // --------------------------------------------------------------------------
  //
  // Private Methods
  //
  // --------------------------------------------------------------------------
  async loadAllModules() {
    [this.arcade, this.arcadeUtils] = await (0,_loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_1__.l)([
      "esri/arcade",
      "esri/layers/support/arcadeUtils"
    ]);
  }
  async getOutputType() {
    try {
      const testResult = await this.arcadeEditor.getTestResult();
      // could be any of these arcade types:
      // "error", "unknown", "null", "array", "text", "number", "date", "time", "dateOnly",
      // "boolean", "dictionary", "geometry", "feature", "featureSet", "attachment"
      switch (testResult === null || testResult === void 0 ? void 0 : testResult.type) {
        case "boolean":
        case "date":
        case "time":
        case "dateOnly":
        case "dictionary":
        case "number":
          return testResult.type;
        case "text":
          return "string";
        default:
          return null;
      }
    }
    catch (error) {
      return null;
    }
  }
  getExistingExpressions() {
    const existingExpressions = this.arcadeUtils
      .getExpressionsFromLayer(this.layer)
      .map((currExpression) => {
      var _a;
      return {
        label: (currExpression === null || currExpression === void 0 ? void 0 : currExpression.title) || (currExpression === null || currExpression === void 0 ? void 0 : currExpression.name) || this.strings.newExpression,
        description: this.getStringFromProfileName((_a = currExpression.profileInfo) === null || _a === void 0 ? void 0 : _a.name),
        code: currExpression.expression
      };
    });
    return {
      label: this.strings.existing,
      suggestions: (existingExpressions === null || existingExpressions === void 0 ? void 0 : existingExpressions.length) ? existingExpressions : []
    };
  }
  getStringFromProfileName(profileName) {
    switch (profileName) {
      case "form-constraint":
        return this.strings.constraint;
      case "feature-z":
        return this.strings.featureZ;
      case "form-calculation":
        return this.strings.formCalculation;
      case "labeling":
        return this.strings.labeling;
      case "popup":
        return this.strings.popup;
      case "popup-element":
        return this.strings.popupElement;
      case "feature-reduction-popup":
        return this.strings.featureReductionPopup;
      case "feature-reduction-popup-element":
        return this.strings.featureReductionPopupElement;
      case "visualization":
        return this.strings.visualization;
      case "field-calculation":
        return this.strings.fieldCalculation;
      default:
        return this.strings.unknown;
    }
  }
  // --------------------------------------------------------------------------
  //
  //  Render methods
  //
  // --------------------------------------------------------------------------
  render() {
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.H, null, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-modal", { class: "arcade-modal", open: true, scale: "l", escapeDisabled: true, outsideCloseDisabled: true, role: "dialog", onCalciteModalClose: () => this.arcgisModalArcadeClose.emit() }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("h3", { slot: "header", class: "header" }, this.arcadeTitle && this.arcadeTitleEditable ? ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-inline-editable", { scale: "l", editingEnabled: this.arcadeTitleEditingEnabled, messageOverrides: {
        cancelEditing: this.strings.cancel,
        enableEditing: this.strings.edit,
        confirmChanges: this.strings.done
      } }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-input", { ref: (el) => (this.arcadeTitleInput = el), alignment: "start", placeholder: this.strings.titlePlaceHolder, scale: "l", type: "text", value: this.arcadeTitle || this.strings.newExpression }))) : (this.arcadeTitle || this.strings.newExpression)), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-arcade-editor", { slot: "content", class: "arcade-editor", ref: (el) => (this.arcadeEditor = el), hideDocumentationActions: this.hideDocumentationActions, script: this.arcadeScript, profile: this.arcadeProfile, testData: this.testData, suggestions: this.suggestions, onDiagnosticsChange: async (e) => {
        var _a;
        const diagnostics = e.detail;
        // hide Done only for errors(1). Show for warnings(2), info(3) and hints(4)
        // https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#diagnosticSeverity
        if (diagnostics === null || diagnostics === void 0 ? void 0 : diagnostics.length) {
          for (let x = 0; x < diagnostics.length; x++) {
            if (((_a = diagnostics[x]) === null || _a === void 0 ? void 0 : _a.severity) === 1) {
              this.scriptInvalid = true;
              return;
            }
          }
          this.scriptInvalid = false;
        }
        else {
          this.scriptInvalid = false;
        }
      } }), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { slot: "secondary", width: "full", appearance: "outline-fill", alignment: "center", scale: "m", onClick: () => this.arcgisModalArcadeClose.emit() }, this.strings.cancel), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { slot: "primary", width: "full", alignment: "center", appearance: "solid", scale: "m", disabled: this.scriptInvalid, onClick: async () => {
        var _a;
        this.arcgisModalArcadeClose.emit(Object.assign(Object.assign({ script: await this.arcadeEditor.getScript() }, (this.arcadeTitle && {
          title: ((_a = this.arcadeTitleInput.value) === null || _a === void 0 ? void 0 : _a.trim()) || this.strings.newExpression
        })), (this.returnPredictOutputType && {
          predictOutputType: await this.getOutputType()
        })));
      } }, this.strings.done))));
  }
  get hostElement() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisModalArcade.style = arcgisModalArcadeCss;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js":
/*!******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CSS_UTILITY),
/* harmony export */   a: () => (/* binding */ formatDate),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   g: () => (/* binding */ getElementDir),
/* harmony export */   l: () => (/* binding */ languageMap)
/* harmony export */ });
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



const languageMap = new Map([
  ["ar", "ar"],
  ["bg", "bg"],
  ["bs", "bs"],
  ["ca", "ca"],
  ["cs", "cs"],
  ["da", "da"],
  ["de", "de"],
  ["el", "el"],
  ["en", "en"],
  ["es", "es"],
  ["et", "et"],
  ["fi", "fi"],
  ["fr", "fr"],
  ["he", "he"],
  ["hr", "hr"],
  ["hu", "hu"],
  ["id", "id"],
  ["it", "it"],
  ["ja", "ja"],
  ["ko", "ko"],
  ["lt", "lt"],
  ["lv", "lv"],
  ["nb", "nb"],
  ["nl", "nl"],
  ["pl", "pl"],
  ["pt-br", "pt-BR"],
  ["pt-pt", "pt-PT"],
  ["ro", "ro"],
  ["ru", "ru"],
  ["sk", "sk"],
  ["sl", "sl"],
  ["sr", "sr"],
  ["sv", "sv"],
  ["th", "th"],
  ["tr", "tr"],
  ["uk", "uk"],
  ["vi", "vi"],
  ["zh-cn", "zh-CN"],
  ["zh-hk", "zh-HK"],
  ["zh-tw", "zh-TW"]
]);
// rtl
function getElementDir(el) {
  return getElementProp(el, "dir", "ltr");
}
function getElementProp(el, prop, value) {
  const closestWithProp = (0,_dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_1__.c)(el, `[${prop}]`);
  return closestWithProp ? closestWithProp.getAttribute(prop) : value;
}
// css
const CSS_UTILITY = {
  rtl: "arcgis--rtl"
};
async function formatNumber(number, options) {
  const { api, type, places } = options || {};
  if (api === 4) {
    const [intl] = await (0,_loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_0__.l)(["esri/intl"]);
    const numberFormatIntlOptions = intl.convertNumberFormatToIntlOptions({
      places,
      style: type,
      digitSeparator: true
    });
    return intl.formatNumber(number, Object.assign(Object.assign({}, numberFormatIntlOptions), { style: type }));
  }
  const [dojoNumber] = await (0,_loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_0__.l)(["dojo/number"]);
  return dojoNumber.format(number, {
    type,
    places,
    pattern: options === null || options === void 0 ? void 0 : options.pattern
  });
}
const cache = {};
function formatDate(date) {
  const lang = document.documentElement.lang;
  const dayShortMonthYear = {
    year: "numeric",
    month: "short",
    day: "numeric"
  };
  if (!cache[lang]) {
    cache[lang] = new Intl.DateTimeFormat(document.documentElement.lang, dayShortMonthYear);
  }
  return cache[lang].format(date);
}




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-13e00a75.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-13e00a75.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getComponentClosestLanguage),
/* harmony export */   g: () => (/* binding */ getLocaleComponentStrings)
/* harmony export */ });
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/* harmony import */ var _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./languageUtil-22258c90.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js");
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */




// https://medium.com/stencil-tricks/implementing-internationalisation-i18n-with-stencil-5e6559554117
function getComponentClosestLanguage(element) {
  var _a, _b, _c;
  const closestElement = (_a = (0,_dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
  // language set by the calling application or browser. defaults to english.
  const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
  if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
    return _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
  }
  else {
    // "ru-RU" maps to "ru" use case
    if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
      return _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang.slice(0, 2));
    }
    else {
      return "en";
    }
  }
}
function getComponentClosestLanguageIntl(element) {
  var _a, _b, _c;
  // it's OK if we don't have the 4 letter language file for it
  // 4 letter language code needed for formatting numbers
  const closestElement = (_a = (0,_dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
  // language set by the calling application or browser. defaults to english.
  const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
  if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
    return _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
  }
  else {
    if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
      // we support the 2 letter coded language
      // e.g. it-CH vs it
      return lang;
    }
    else {
      return "en";
    }
  }
}
function fetchLocaleStringsForComponent(componentName, locale) {
  return new Promise((resolve, reject) => {
    fetch((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_2__.a)(`../arcgis-app-assets/i18n/${componentName}.i18n.${locale}.json`)).then((result) => {
      if (result.ok)
        resolve(result.json());
      else
        reject();
    }, () => reject());
  });
}
const stringCache = {};
function fetchLocaleStringsFromCache(componentName, locale) {
  const id = `${componentName}${locale}`;
  if (!stringCache[id]) {
    stringCache[id] = fetchLocaleStringsForComponent(componentName, locale);
  }
  return stringCache[id];
}
/**
 * Get strings and language codes.
 * This method returns 2 language codes.
 * The first one returns a code that's also supported as a language file.
 * The second one returns a code where there is support for the first 2 letters of the code as part of a language file,
 * but will return the original 4 letter code from the page.
 * E.g. For "it-ch" it will return "it" as the first language code and "it-ch" as the second.
 * The second one is required for esri.intl.setLocale() to get the correct formatting.
 *
 * If a tagName is provided it will overwite the element's tagName
 *
 *  @return [ strings, first language code, second language code]
 */
async function getLocaleComponentStrings(element, tagName) {
  const componentName = tagName || element.tagName.toLowerCase();
  const componentLanguage = getComponentClosestLanguage(element);
  const componentLanguageIntl = getComponentClosestLanguageIntl(element);
  let strings;
  try {
    strings = await fetchLocaleStringsFromCache(componentName, componentLanguage);
  }
  catch (e) {
    console.warn(`no locale for ${componentName} (${componentLanguage}) loading default locale en.`);
    strings = await fetchLocaleStringsFromCache(componentName, "en");
  }
  return [strings, componentLanguage, componentLanguageIntl];
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTUzYTU1OS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUM2RztBQUNoRDtBQUNTO0FBQzNDO0FBQ1M7O0FBRXBDLG1FQUFtRSxTQUFTLFVBQVUsV0FBVywwQkFBMEIsMkJBQTJCLHNDQUFzQyxXQUFXLFlBQVksK0JBQStCLFVBQVU7O0FBRTVQO0FBQ0E7QUFDQSxJQUFJLHFEQUFnQjtBQUNwQixrQ0FBa0MscURBQVc7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxzREFBeUI7QUFDckM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsMkRBQVc7QUFDdkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVkscURBQUMsQ0FBQyxpREFBSSxRQUFRLHFEQUFDLG9CQUFvQixnTEFBZ0wsRUFBRSxxREFBQyxTQUFTLGlDQUFpQyxrREFBa0QscURBQUMsOEJBQThCO0FBQzdWO0FBQ0E7QUFDQTtBQUNBLFNBQVMsRUFBRSxxREFBQyxvQkFBb0IsNExBQTRMLHlEQUF5RCxxREFBQywyQkFBMkI7QUFDalQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix3QkFBd0I7QUFDbEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLEdBQUcscURBQUMscUJBQXFCLGtKQUFrSix3QkFBd0IscURBQUMscUJBQXFCO0FBQ2xPO0FBQ0EsdUVBQXVFLDZDQUE2QztBQUNwSDtBQUNBLFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxTQUFTO0FBQ1Q7QUFDQSxzQkFBc0IsT0FBTyxxREFBVTtBQUN2QztBQUNBOztBQUVvRDs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDeEtwRDtBQUNBO0FBQ0E7QUFDQTtBQUM2RDtBQUNjOztBQUUzRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLG1EQUFpQyxTQUFTLEtBQUs7QUFDekU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG9CQUFvQjtBQUM5QjtBQUNBLHlCQUF5QiwyREFBVztBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxtRUFBbUUsOEJBQThCLGFBQWE7QUFDOUc7QUFDQSw2QkFBNkIsMkRBQVc7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3RnRHO0FBQ0E7QUFDQTtBQUNBO0FBQzJFO0FBQ2I7QUFDTjs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLG1EQUFpQztBQUNoRTtBQUNBO0FBQ0EsTUFBTSx3REFBVztBQUNqQixXQUFXLHdEQUFXO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLFFBQVEsd0RBQVc7QUFDbkIsYUFBYSx3REFBVztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixtREFBaUM7QUFDaEU7QUFDQTtBQUNBLE1BQU0sd0RBQVc7QUFDakIsV0FBVyx3REFBVztBQUN0QjtBQUNBO0FBQ0EsUUFBUSx3REFBVztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxxREFBWSw4QkFBOEIsY0FBYyxRQUFRLE9BQU87QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixjQUFjLEVBQUUsT0FBTztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZUFBZSxHQUFHLGtCQUFrQjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTs7QUFFNEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtbW9kYWwtYXJjYWRlLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2xhbmd1YWdlVXRpbC0yMjI1OGM5MC5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9sb2NhbGUtMTNlMDBhNzUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCwgZCBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC05MmViYjM5Ni5qcyc7XG5pbXBvcnQgeyBsIGFzIGxvYWRNb2R1bGVzIH0gZnJvbSAnLi9sb2FkTW9kdWxlcy1hYWYzMGJkNi5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3MgfSBmcm9tICcuL2xvY2FsZS0xM2UwMGE3NS5qcyc7XG5pbXBvcnQgJy4vZG9tLTEzZjViMDBjLmpzJztcbmltcG9ydCAnLi9sYW5ndWFnZVV0aWwtMjIyNThjOTAuanMnO1xuXG5jb25zdCBhcmNnaXNNb2RhbEFyY2FkZUNzcyA9IFwiLmFyY2FkZS1tb2RhbC5zYy1hcmNnaXMtbW9kYWwtYXJjYWRle3RvcDo3LjUlO2xlZnQ6Ny41JTtyaWdodDo3LjUlOy0tY2FsY2l0ZS1tb2RhbC13aWR0aDo4NSU7LS1jYWxjaXRlLW1vZGFsLWhlaWdodDo4NSV9LmFyY2FkZS1lZGl0b3Iuc2MtYXJjZ2lzLW1vZGFsLWFyY2FkZXt3aWR0aDoxMDAlO2hlaWdodDoxMDAlfS5oZWFkZXIuc2MtYXJjZ2lzLW1vZGFsLWFyY2FkZXt3aWR0aDo1MCV9XCI7XG5cbmNvbnN0IEFyY2dpc01vZGFsQXJjYWRlID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLmFyY2dpc01vZGFsQXJjYWRlQ2xvc2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc01vZGFsQXJjYWRlQ2xvc2VcIiwgNyk7XG4gICAgdGhpcy5oaWRlRG9jdW1lbnRhdGlvbkFjdGlvbnMgPSBmYWxzZTtcbiAgICB0aGlzLmFyY2FkZVNjcmlwdCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFyY2FkZVByb2ZpbGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy50ZXN0RGF0YSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnN1Z2dlc3Rpb25zID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucmV0dXJuUHJlZGljdE91dHB1dFR5cGUgPSB0cnVlO1xuICAgIHRoaXMuYXJjYWRlVGl0bGUgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hcmNhZGVUaXRsZUVkaXRhYmxlID0gZmFsc2U7XG4gICAgdGhpcy5hcmNhZGVUaXRsZUVkaXRpbmdFbmFibGVkID0gZmFsc2U7XG4gICAgdGhpcy5hZGRFeGlzdGluZ0V4cHJlc3Npb25zID0gZmFsc2U7XG4gICAgdGhpcy5sYXllciA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNjcmlwdEludmFsaWQgPSB0cnVlO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBMaWZlY3ljbGVcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgYXN5bmMgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgdmFyIF9hO1xuICAgIFt0aGlzLnN0cmluZ3MsIHRoaXMuY3VycmVudExhbmd1YWdlXSA9XG4gICAgICBhd2FpdCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKHRoaXMuaG9zdEVsZW1lbnQpO1xuICAgIGF3YWl0IHRoaXMubG9hZEFsbE1vZHVsZXMoKTtcbiAgICBpZiAodGhpcy5hZGRFeGlzdGluZ0V4cHJlc3Npb25zICYmIHRoaXMubGF5ZXIpIHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nRXhwcmVzc2lvbnMgPSB0aGlzLmdldEV4aXN0aW5nRXhwcmVzc2lvbnMoKTtcbiAgICAgIGlmIChleGlzdGluZ0V4cHJlc3Npb25zKSB7XG4gICAgICAgIGlmICgoX2EgPSB0aGlzLnN1Z2dlc3Rpb25zKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubGVuZ3RoKSB7XG4gICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5wdXNoKGV4aXN0aW5nRXhwcmVzc2lvbnMpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSBbZXhpc3RpbmdFeHByZXNzaW9uc107XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gUHJpdmF0ZSBNZXRob2RzXG4gIC8vXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGFzeW5jIGxvYWRBbGxNb2R1bGVzKCkge1xuICAgIFt0aGlzLmFyY2FkZSwgdGhpcy5hcmNhZGVVdGlsc10gPSBhd2FpdCBsb2FkTW9kdWxlcyhbXG4gICAgICBcImVzcmkvYXJjYWRlXCIsXG4gICAgICBcImVzcmkvbGF5ZXJzL3N1cHBvcnQvYXJjYWRlVXRpbHNcIlxuICAgIF0pO1xuICB9XG4gIGFzeW5jIGdldE91dHB1dFR5cGUoKSB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHRlc3RSZXN1bHQgPSBhd2FpdCB0aGlzLmFyY2FkZUVkaXRvci5nZXRUZXN0UmVzdWx0KCk7XG4gICAgICAvLyBjb3VsZCBiZSBhbnkgb2YgdGhlc2UgYXJjYWRlIHR5cGVzOlxuICAgICAgLy8gXCJlcnJvclwiLCBcInVua25vd25cIiwgXCJudWxsXCIsIFwiYXJyYXlcIiwgXCJ0ZXh0XCIsIFwibnVtYmVyXCIsIFwiZGF0ZVwiLCBcInRpbWVcIiwgXCJkYXRlT25seVwiLFxuICAgICAgLy8gXCJib29sZWFuXCIsIFwiZGljdGlvbmFyeVwiLCBcImdlb21ldHJ5XCIsIFwiZmVhdHVyZVwiLCBcImZlYXR1cmVTZXRcIiwgXCJhdHRhY2htZW50XCJcbiAgICAgIHN3aXRjaCAodGVzdFJlc3VsdCA9PT0gbnVsbCB8fCB0ZXN0UmVzdWx0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiB0ZXN0UmVzdWx0LnR5cGUpIHtcbiAgICAgICAgY2FzZSBcImJvb2xlYW5cIjpcbiAgICAgICAgY2FzZSBcImRhdGVcIjpcbiAgICAgICAgY2FzZSBcInRpbWVcIjpcbiAgICAgICAgY2FzZSBcImRhdGVPbmx5XCI6XG4gICAgICAgIGNhc2UgXCJkaWN0aW9uYXJ5XCI6XG4gICAgICAgIGNhc2UgXCJudW1iZXJcIjpcbiAgICAgICAgICByZXR1cm4gdGVzdFJlc3VsdC50eXBlO1xuICAgICAgICBjYXNlIFwidGV4dFwiOlxuICAgICAgICAgIHJldHVybiBcInN0cmluZ1wiO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuICBnZXRFeGlzdGluZ0V4cHJlc3Npb25zKCkge1xuICAgIGNvbnN0IGV4aXN0aW5nRXhwcmVzc2lvbnMgPSB0aGlzLmFyY2FkZVV0aWxzXG4gICAgICAuZ2V0RXhwcmVzc2lvbnNGcm9tTGF5ZXIodGhpcy5sYXllcilcbiAgICAgIC5tYXAoKGN1cnJFeHByZXNzaW9uKSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBsYWJlbDogKGN1cnJFeHByZXNzaW9uID09PSBudWxsIHx8IGN1cnJFeHByZXNzaW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdXJyRXhwcmVzc2lvbi50aXRsZSkgfHwgKGN1cnJFeHByZXNzaW9uID09PSBudWxsIHx8IGN1cnJFeHByZXNzaW9uID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjdXJyRXhwcmVzc2lvbi5uYW1lKSB8fCB0aGlzLnN0cmluZ3MubmV3RXhwcmVzc2lvbixcbiAgICAgICAgZGVzY3JpcHRpb246IHRoaXMuZ2V0U3RyaW5nRnJvbVByb2ZpbGVOYW1lKChfYSA9IGN1cnJFeHByZXNzaW9uLnByb2ZpbGVJbmZvKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubmFtZSksXG4gICAgICAgIGNvZGU6IGN1cnJFeHByZXNzaW9uLmV4cHJlc3Npb25cbiAgICAgIH07XG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGxhYmVsOiB0aGlzLnN0cmluZ3MuZXhpc3RpbmcsXG4gICAgICBzdWdnZXN0aW9uczogKGV4aXN0aW5nRXhwcmVzc2lvbnMgPT09IG51bGwgfHwgZXhpc3RpbmdFeHByZXNzaW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXhpc3RpbmdFeHByZXNzaW9ucy5sZW5ndGgpID8gZXhpc3RpbmdFeHByZXNzaW9ucyA6IFtdXG4gICAgfTtcbiAgfVxuICBnZXRTdHJpbmdGcm9tUHJvZmlsZU5hbWUocHJvZmlsZU5hbWUpIHtcbiAgICBzd2l0Y2ggKHByb2ZpbGVOYW1lKSB7XG4gICAgICBjYXNlIFwiZm9ybS1jb25zdHJhaW50XCI6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MuY29uc3RyYWludDtcbiAgICAgIGNhc2UgXCJmZWF0dXJlLXpcIjpcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaW5ncy5mZWF0dXJlWjtcbiAgICAgIGNhc2UgXCJmb3JtLWNhbGN1bGF0aW9uXCI6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MuZm9ybUNhbGN1bGF0aW9uO1xuICAgICAgY2FzZSBcImxhYmVsaW5nXCI6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MubGFiZWxpbmc7XG4gICAgICBjYXNlIFwicG9wdXBcIjpcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaW5ncy5wb3B1cDtcbiAgICAgIGNhc2UgXCJwb3B1cC1lbGVtZW50XCI6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MucG9wdXBFbGVtZW50O1xuICAgICAgY2FzZSBcImZlYXR1cmUtcmVkdWN0aW9uLXBvcHVwXCI6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MuZmVhdHVyZVJlZHVjdGlvblBvcHVwO1xuICAgICAgY2FzZSBcImZlYXR1cmUtcmVkdWN0aW9uLXBvcHVwLWVsZW1lbnRcIjpcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaW5ncy5mZWF0dXJlUmVkdWN0aW9uUG9wdXBFbGVtZW50O1xuICAgICAgY2FzZSBcInZpc3VhbGl6YXRpb25cIjpcbiAgICAgICAgcmV0dXJuIHRoaXMuc3RyaW5ncy52aXN1YWxpemF0aW9uO1xuICAgICAgY2FzZSBcImZpZWxkLWNhbGN1bGF0aW9uXCI6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MuZmllbGRDYWxjdWxhdGlvbjtcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHJldHVybiB0aGlzLnN0cmluZ3MudW5rbm93bjtcbiAgICB9XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIFJlbmRlciBtZXRob2RzXG4gIC8vXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gKGgoSG9zdCwgbnVsbCwgaChcImNhbGNpdGUtbW9kYWxcIiwgeyBjbGFzczogXCJhcmNhZGUtbW9kYWxcIiwgb3BlbjogdHJ1ZSwgc2NhbGU6IFwibFwiLCBlc2NhcGVEaXNhYmxlZDogdHJ1ZSwgb3V0c2lkZUNsb3NlRGlzYWJsZWQ6IHRydWUsIHJvbGU6IFwiZGlhbG9nXCIsIG9uQ2FsY2l0ZU1vZGFsQ2xvc2U6ICgpID0+IHRoaXMuYXJjZ2lzTW9kYWxBcmNhZGVDbG9zZS5lbWl0KCkgfSwgaChcImgzXCIsIHsgc2xvdDogXCJoZWFkZXJcIiwgY2xhc3M6IFwiaGVhZGVyXCIgfSwgdGhpcy5hcmNhZGVUaXRsZSAmJiB0aGlzLmFyY2FkZVRpdGxlRWRpdGFibGUgPyAoaChcImNhbGNpdGUtaW5saW5lLWVkaXRhYmxlXCIsIHsgc2NhbGU6IFwibFwiLCBlZGl0aW5nRW5hYmxlZDogdGhpcy5hcmNhZGVUaXRsZUVkaXRpbmdFbmFibGVkLCBtZXNzYWdlT3ZlcnJpZGVzOiB7XG4gICAgICAgIGNhbmNlbEVkaXRpbmc6IHRoaXMuc3RyaW5ncy5jYW5jZWwsXG4gICAgICAgIGVuYWJsZUVkaXRpbmc6IHRoaXMuc3RyaW5ncy5lZGl0LFxuICAgICAgICBjb25maXJtQ2hhbmdlczogdGhpcy5zdHJpbmdzLmRvbmVcbiAgICAgIH0gfSwgaChcImNhbGNpdGUtaW5wdXRcIiwgeyByZWY6IChlbCkgPT4gKHRoaXMuYXJjYWRlVGl0bGVJbnB1dCA9IGVsKSwgYWxpZ25tZW50OiBcInN0YXJ0XCIsIHBsYWNlaG9sZGVyOiB0aGlzLnN0cmluZ3MudGl0bGVQbGFjZUhvbGRlciwgc2NhbGU6IFwibFwiLCB0eXBlOiBcInRleHRcIiwgdmFsdWU6IHRoaXMuYXJjYWRlVGl0bGUgfHwgdGhpcy5zdHJpbmdzLm5ld0V4cHJlc3Npb24gfSkpKSA6ICh0aGlzLmFyY2FkZVRpdGxlIHx8IHRoaXMuc3RyaW5ncy5uZXdFeHByZXNzaW9uKSksIGgoXCJhcmNnaXMtYXJjYWRlLWVkaXRvclwiLCB7IHNsb3Q6IFwiY29udGVudFwiLCBjbGFzczogXCJhcmNhZGUtZWRpdG9yXCIsIHJlZjogKGVsKSA9PiAodGhpcy5hcmNhZGVFZGl0b3IgPSBlbCksIGhpZGVEb2N1bWVudGF0aW9uQWN0aW9uczogdGhpcy5oaWRlRG9jdW1lbnRhdGlvbkFjdGlvbnMsIHNjcmlwdDogdGhpcy5hcmNhZGVTY3JpcHQsIHByb2ZpbGU6IHRoaXMuYXJjYWRlUHJvZmlsZSwgdGVzdERhdGE6IHRoaXMudGVzdERhdGEsIHN1Z2dlc3Rpb25zOiB0aGlzLnN1Z2dlc3Rpb25zLCBvbkRpYWdub3N0aWNzQ2hhbmdlOiBhc3luYyAoZSkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIGNvbnN0IGRpYWdub3N0aWNzID0gZS5kZXRhaWw7XG4gICAgICAgIC8vIGhpZGUgRG9uZSBvbmx5IGZvciBlcnJvcnMoMSkuIFNob3cgZm9yIHdhcm5pbmdzKDIpLCBpbmZvKDMpIGFuZCBoaW50cyg0KVxuICAgICAgICAvLyBodHRwczovL21pY3Jvc29mdC5naXRodWIuaW8vbGFuZ3VhZ2Utc2VydmVyLXByb3RvY29sL3NwZWNpZmljYXRpb25zL2xzcC8zLjE3L3NwZWNpZmljYXRpb24vI2RpYWdub3N0aWNTZXZlcml0eVxuICAgICAgICBpZiAoZGlhZ25vc3RpY3MgPT09IG51bGwgfHwgZGlhZ25vc3RpY3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGRpYWdub3N0aWNzLmxlbmd0aCkge1xuICAgICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgZGlhZ25vc3RpY3MubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICAgIGlmICgoKF9hID0gZGlhZ25vc3RpY3NbeF0pID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXZlcml0eSkgPT09IDEpIHtcbiAgICAgICAgICAgICAgdGhpcy5zY3JpcHRJbnZhbGlkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICB0aGlzLnNjcmlwdEludmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICB0aGlzLnNjcmlwdEludmFsaWQgPSBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgfSB9KSwgaChcImNhbGNpdGUtYnV0dG9uXCIsIHsgc2xvdDogXCJzZWNvbmRhcnlcIiwgd2lkdGg6IFwiZnVsbFwiLCBhcHBlYXJhbmNlOiBcIm91dGxpbmUtZmlsbFwiLCBhbGlnbm1lbnQ6IFwiY2VudGVyXCIsIHNjYWxlOiBcIm1cIiwgb25DbGljazogKCkgPT4gdGhpcy5hcmNnaXNNb2RhbEFyY2FkZUNsb3NlLmVtaXQoKSB9LCB0aGlzLnN0cmluZ3MuY2FuY2VsKSwgaChcImNhbGNpdGUtYnV0dG9uXCIsIHsgc2xvdDogXCJwcmltYXJ5XCIsIHdpZHRoOiBcImZ1bGxcIiwgYWxpZ25tZW50OiBcImNlbnRlclwiLCBhcHBlYXJhbmNlOiBcInNvbGlkXCIsIHNjYWxlOiBcIm1cIiwgZGlzYWJsZWQ6IHRoaXMuc2NyaXB0SW52YWxpZCwgb25DbGljazogYXN5bmMgKCkgPT4ge1xuICAgICAgICB2YXIgX2E7XG4gICAgICAgIHRoaXMuYXJjZ2lzTW9kYWxBcmNhZGVDbG9zZS5lbWl0KE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7IHNjcmlwdDogYXdhaXQgdGhpcy5hcmNhZGVFZGl0b3IuZ2V0U2NyaXB0KCkgfSwgKHRoaXMuYXJjYWRlVGl0bGUgJiYge1xuICAgICAgICAgIHRpdGxlOiAoKF9hID0gdGhpcy5hcmNhZGVUaXRsZUlucHV0LnZhbHVlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudHJpbSgpKSB8fCB0aGlzLnN0cmluZ3MubmV3RXhwcmVzc2lvblxuICAgICAgICB9KSksICh0aGlzLnJldHVyblByZWRpY3RPdXRwdXRUeXBlICYmIHtcbiAgICAgICAgICBwcmVkaWN0T3V0cHV0VHlwZTogYXdhaXQgdGhpcy5nZXRPdXRwdXRUeXBlKClcbiAgICAgICAgfSkpKTtcbiAgICAgIH0gfSwgdGhpcy5zdHJpbmdzLmRvbmUpKSkpO1xuICB9XG4gIGdldCBob3N0RWxlbWVudCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5BcmNnaXNNb2RhbEFyY2FkZS5zdHlsZSA9IGFyY2dpc01vZGFsQXJjYWRlQ3NzO1xuXG5leHBvcnQgeyBBcmNnaXNNb2RhbEFyY2FkZSBhcyBhcmNnaXNfbW9kYWxfYXJjYWRlIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IGwgYXMgbG9hZE1vZHVsZXMgfSBmcm9tICcuL2xvYWRNb2R1bGVzLWFhZjMwYmQ2LmpzJztcbmltcG9ydCB7IGMgYXMgY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5IH0gZnJvbSAnLi9kb20tMTNmNWIwMGMuanMnO1xuXG5jb25zdCBsYW5ndWFnZU1hcCA9IG5ldyBNYXAoW1xuICBbXCJhclwiLCBcImFyXCJdLFxuICBbXCJiZ1wiLCBcImJnXCJdLFxuICBbXCJic1wiLCBcImJzXCJdLFxuICBbXCJjYVwiLCBcImNhXCJdLFxuICBbXCJjc1wiLCBcImNzXCJdLFxuICBbXCJkYVwiLCBcImRhXCJdLFxuICBbXCJkZVwiLCBcImRlXCJdLFxuICBbXCJlbFwiLCBcImVsXCJdLFxuICBbXCJlblwiLCBcImVuXCJdLFxuICBbXCJlc1wiLCBcImVzXCJdLFxuICBbXCJldFwiLCBcImV0XCJdLFxuICBbXCJmaVwiLCBcImZpXCJdLFxuICBbXCJmclwiLCBcImZyXCJdLFxuICBbXCJoZVwiLCBcImhlXCJdLFxuICBbXCJoclwiLCBcImhyXCJdLFxuICBbXCJodVwiLCBcImh1XCJdLFxuICBbXCJpZFwiLCBcImlkXCJdLFxuICBbXCJpdFwiLCBcIml0XCJdLFxuICBbXCJqYVwiLCBcImphXCJdLFxuICBbXCJrb1wiLCBcImtvXCJdLFxuICBbXCJsdFwiLCBcImx0XCJdLFxuICBbXCJsdlwiLCBcImx2XCJdLFxuICBbXCJuYlwiLCBcIm5iXCJdLFxuICBbXCJubFwiLCBcIm5sXCJdLFxuICBbXCJwbFwiLCBcInBsXCJdLFxuICBbXCJwdC1iclwiLCBcInB0LUJSXCJdLFxuICBbXCJwdC1wdFwiLCBcInB0LVBUXCJdLFxuICBbXCJyb1wiLCBcInJvXCJdLFxuICBbXCJydVwiLCBcInJ1XCJdLFxuICBbXCJza1wiLCBcInNrXCJdLFxuICBbXCJzbFwiLCBcInNsXCJdLFxuICBbXCJzclwiLCBcInNyXCJdLFxuICBbXCJzdlwiLCBcInN2XCJdLFxuICBbXCJ0aFwiLCBcInRoXCJdLFxuICBbXCJ0clwiLCBcInRyXCJdLFxuICBbXCJ1a1wiLCBcInVrXCJdLFxuICBbXCJ2aVwiLCBcInZpXCJdLFxuICBbXCJ6aC1jblwiLCBcInpoLUNOXCJdLFxuICBbXCJ6aC1oa1wiLCBcInpoLUhLXCJdLFxuICBbXCJ6aC10d1wiLCBcInpoLVRXXCJdXG5dKTtcbi8vIHJ0bFxuZnVuY3Rpb24gZ2V0RWxlbWVudERpcihlbCkge1xuICByZXR1cm4gZ2V0RWxlbWVudFByb3AoZWwsIFwiZGlyXCIsIFwibHRyXCIpO1xufVxuZnVuY3Rpb24gZ2V0RWxlbWVudFByb3AoZWwsIHByb3AsIHZhbHVlKSB7XG4gIGNvbnN0IGNsb3Nlc3RXaXRoUHJvcCA9IGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeShlbCwgYFske3Byb3B9XWApO1xuICByZXR1cm4gY2xvc2VzdFdpdGhQcm9wID8gY2xvc2VzdFdpdGhQcm9wLmdldEF0dHJpYnV0ZShwcm9wKSA6IHZhbHVlO1xufVxuLy8gY3NzXG5jb25zdCBDU1NfVVRJTElUWSA9IHtcbiAgcnRsOiBcImFyY2dpcy0tcnRsXCJcbn07XG5hc3luYyBmdW5jdGlvbiBmb3JtYXROdW1iZXIobnVtYmVyLCBvcHRpb25zKSB7XG4gIGNvbnN0IHsgYXBpLCB0eXBlLCBwbGFjZXMgfSA9IG9wdGlvbnMgfHwge307XG4gIGlmIChhcGkgPT09IDQpIHtcbiAgICBjb25zdCBbaW50bF0gPSBhd2FpdCBsb2FkTW9kdWxlcyhbXCJlc3JpL2ludGxcIl0pO1xuICAgIGNvbnN0IG51bWJlckZvcm1hdEludGxPcHRpb25zID0gaW50bC5jb252ZXJ0TnVtYmVyRm9ybWF0VG9JbnRsT3B0aW9ucyh7XG4gICAgICBwbGFjZXMsXG4gICAgICBzdHlsZTogdHlwZSxcbiAgICAgIGRpZ2l0U2VwYXJhdG9yOiB0cnVlXG4gICAgfSk7XG4gICAgcmV0dXJuIGludGwuZm9ybWF0TnVtYmVyKG51bWJlciwgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBudW1iZXJGb3JtYXRJbnRsT3B0aW9ucyksIHsgc3R5bGU6IHR5cGUgfSkpO1xuICB9XG4gIGNvbnN0IFtkb2pvTnVtYmVyXSA9IGF3YWl0IGxvYWRNb2R1bGVzKFtcImRvam8vbnVtYmVyXCJdKTtcbiAgcmV0dXJuIGRvam9OdW1iZXIuZm9ybWF0KG51bWJlciwge1xuICAgIHR5cGUsXG4gICAgcGxhY2VzLFxuICAgIHBhdHRlcm46IG9wdGlvbnMgPT09IG51bGwgfHwgb3B0aW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogb3B0aW9ucy5wYXR0ZXJuXG4gIH0pO1xufVxuY29uc3QgY2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGZvcm1hdERhdGUoZGF0ZSkge1xuICBjb25zdCBsYW5nID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Lmxhbmc7XG4gIGNvbnN0IGRheVNob3J0TW9udGhZZWFyID0ge1xuICAgIHllYXI6IFwibnVtZXJpY1wiLFxuICAgIG1vbnRoOiBcInNob3J0XCIsXG4gICAgZGF5OiBcIm51bWVyaWNcIlxuICB9O1xuICBpZiAoIWNhY2hlW2xhbmddKSB7XG4gICAgY2FjaGVbbGFuZ10gPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZywgZGF5U2hvcnRNb250aFllYXIpO1xuICB9XG4gIHJldHVybiBjYWNoZVtsYW5nXS5mb3JtYXQoZGF0ZSk7XG59XG5cbmV4cG9ydCB7IENTU19VVElMSVRZIGFzIEMsIGZvcm1hdERhdGUgYXMgYSwgZm9ybWF0TnVtYmVyIGFzIGYsIGdldEVsZW1lbnREaXIgYXMgZywgbGFuZ3VhZ2VNYXAgYXMgbCB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBjIGFzIGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeSB9IGZyb20gJy4vZG9tLTEzZjViMDBjLmpzJztcbmltcG9ydCB7IGwgYXMgbGFuZ3VhZ2VNYXAgfSBmcm9tICcuL2xhbmd1YWdlVXRpbC0yMjI1OGM5MC5qcyc7XG5pbXBvcnQgeyBhIGFzIGdldEFzc2V0UGF0aCB9IGZyb20gJy4vaW5kZXgtOTJlYmIzOTYuanMnO1xuXG4vLyBodHRwczovL21lZGl1bS5jb20vc3RlbmNpbC10cmlja3MvaW1wbGVtZW50aW5nLWludGVybmF0aW9uYWxpc2F0aW9uLWkxOG4td2l0aC1zdGVuY2lsLTVlNjU1OTU1NDExN1xuZnVuY3Rpb24gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlKGVsZW1lbnQpIHtcbiAgdmFyIF9hLCBfYiwgX2M7XG4gIGNvbnN0IGNsb3Nlc3RFbGVtZW50ID0gKF9hID0gY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5KGVsZW1lbnQsIFwiW2xhbmddXCIpKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiAoX2MgPSAoX2IgPSBlbGVtZW50LnNoYWRvd1Jvb3QpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5vd25lckRvY3VtZW50KSA9PT0gbnVsbCB8fCBfYyA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2MuZG9jdW1lbnRFbGVtZW50O1xuICAvLyBsYW5ndWFnZSBzZXQgYnkgdGhlIGNhbGxpbmcgYXBwbGljYXRpb24gb3IgYnJvd3Nlci4gZGVmYXVsdHMgdG8gZW5nbGlzaC5cbiAgY29uc3QgbGFuZyA9ICgoY2xvc2VzdEVsZW1lbnQgPT09IG51bGwgfHwgY2xvc2VzdEVsZW1lbnQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGNsb3Nlc3RFbGVtZW50LmxhbmcpIHx8IChuYXZpZ2F0b3IgPT09IG51bGwgfHwgbmF2aWdhdG9yID09PSB2b2lkIDAgPyB2b2lkIDAgOiBuYXZpZ2F0b3IubGFuZ3VhZ2UpIHx8IFwiZW5cIikudG9Mb3dlckNhc2UoKTtcbiAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nKSkge1xuICAgIHJldHVybiBsYW5ndWFnZU1hcC5nZXQobGFuZyk7XG4gIH1cbiAgZWxzZSB7XG4gICAgLy8gXCJydS1SVVwiIG1hcHMgdG8gXCJydVwiIHVzZSBjYXNlXG4gICAgaWYgKGxhbmd1YWdlTWFwLmhhcyhsYW5nLnNsaWNlKDAsIDIpKSkge1xuICAgICAgcmV0dXJuIGxhbmd1YWdlTWFwLmdldChsYW5nLnNsaWNlKDAsIDIpKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICByZXR1cm4gXCJlblwiO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlSW50bChlbGVtZW50KSB7XG4gIHZhciBfYSwgX2IsIF9jO1xuICAvLyBpdCdzIE9LIGlmIHdlIGRvbid0IGhhdmUgdGhlIDQgbGV0dGVyIGxhbmd1YWdlIGZpbGUgZm9yIGl0XG4gIC8vIDQgbGV0dGVyIGxhbmd1YWdlIGNvZGUgbmVlZGVkIGZvciBmb3JtYXR0aW5nIG51bWJlcnNcbiAgY29uc3QgY2xvc2VzdEVsZW1lbnQgPSAoX2EgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWxlbWVudCwgXCJbbGFuZ11cIikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYyA9IChfYiA9IGVsZW1lbnQuc2hhZG93Um9vdCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm93bmVyRG9jdW1lbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5kb2N1bWVudEVsZW1lbnQ7XG4gIC8vIGxhbmd1YWdlIHNldCBieSB0aGUgY2FsbGluZyBhcHBsaWNhdGlvbiBvciBicm93c2VyLiBkZWZhdWx0cyB0byBlbmdsaXNoLlxuICBjb25zdCBsYW5nID0gKChjbG9zZXN0RWxlbWVudCA9PT0gbnVsbCB8fCBjbG9zZXN0RWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2xvc2VzdEVsZW1lbnQubGFuZykgfHwgKG5hdmlnYXRvciA9PT0gbnVsbCB8fCBuYXZpZ2F0b3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5hdmlnYXRvci5sYW5ndWFnZSkgfHwgXCJlblwiKS50b0xvd2VyQ2FzZSgpO1xuICBpZiAobGFuZ3VhZ2VNYXAuaGFzKGxhbmcpKSB7XG4gICAgcmV0dXJuIGxhbmd1YWdlTWFwLmdldChsYW5nKTtcbiAgfVxuICBlbHNlIHtcbiAgICBpZiAobGFuZ3VhZ2VNYXAuaGFzKGxhbmcuc2xpY2UoMCwgMikpKSB7XG4gICAgICAvLyB3ZSBzdXBwb3J0IHRoZSAyIGxldHRlciBjb2RlZCBsYW5ndWFnZVxuICAgICAgLy8gZS5nLiBpdC1DSCB2cyBpdFxuICAgICAgcmV0dXJuIGxhbmc7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgcmV0dXJuIFwiZW5cIjtcbiAgICB9XG4gIH1cbn1cbmZ1bmN0aW9uIGZldGNoTG9jYWxlU3RyaW5nc0ZvckNvbXBvbmVudChjb21wb25lbnROYW1lLCBsb2NhbGUpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBmZXRjaChnZXRBc3NldFBhdGgoYC4uL2FyY2dpcy1hcHAtYXNzZXRzL2kxOG4vJHtjb21wb25lbnROYW1lfS5pMThuLiR7bG9jYWxlfS5qc29uYCkpLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKHJlc3VsdC5vaylcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQuanNvbigpKTtcbiAgICAgIGVsc2VcbiAgICAgICAgcmVqZWN0KCk7XG4gICAgfSwgKCkgPT4gcmVqZWN0KCkpO1xuICB9KTtcbn1cbmNvbnN0IHN0cmluZ0NhY2hlID0ge307XG5mdW5jdGlvbiBmZXRjaExvY2FsZVN0cmluZ3NGcm9tQ2FjaGUoY29tcG9uZW50TmFtZSwgbG9jYWxlKSB7XG4gIGNvbnN0IGlkID0gYCR7Y29tcG9uZW50TmFtZX0ke2xvY2FsZX1gO1xuICBpZiAoIXN0cmluZ0NhY2hlW2lkXSkge1xuICAgIHN0cmluZ0NhY2hlW2lkXSA9IGZldGNoTG9jYWxlU3RyaW5nc0ZvckNvbXBvbmVudChjb21wb25lbnROYW1lLCBsb2NhbGUpO1xuICB9XG4gIHJldHVybiBzdHJpbmdDYWNoZVtpZF07XG59XG4vKipcbiAqIEdldCBzdHJpbmdzIGFuZCBsYW5ndWFnZSBjb2Rlcy5cbiAqIFRoaXMgbWV0aG9kIHJldHVybnMgMiBsYW5ndWFnZSBjb2Rlcy5cbiAqIFRoZSBmaXJzdCBvbmUgcmV0dXJucyBhIGNvZGUgdGhhdCdzIGFsc28gc3VwcG9ydGVkIGFzIGEgbGFuZ3VhZ2UgZmlsZS5cbiAqIFRoZSBzZWNvbmQgb25lIHJldHVybnMgYSBjb2RlIHdoZXJlIHRoZXJlIGlzIHN1cHBvcnQgZm9yIHRoZSBmaXJzdCAyIGxldHRlcnMgb2YgdGhlIGNvZGUgYXMgcGFydCBvZiBhIGxhbmd1YWdlIGZpbGUsXG4gKiBidXQgd2lsbCByZXR1cm4gdGhlIG9yaWdpbmFsIDQgbGV0dGVyIGNvZGUgZnJvbSB0aGUgcGFnZS5cbiAqIEUuZy4gRm9yIFwiaXQtY2hcIiBpdCB3aWxsIHJldHVybiBcIml0XCIgYXMgdGhlIGZpcnN0IGxhbmd1YWdlIGNvZGUgYW5kIFwiaXQtY2hcIiBhcyB0aGUgc2Vjb25kLlxuICogVGhlIHNlY29uZCBvbmUgaXMgcmVxdWlyZWQgZm9yIGVzcmkuaW50bC5zZXRMb2NhbGUoKSB0byBnZXQgdGhlIGNvcnJlY3QgZm9ybWF0dGluZy5cbiAqXG4gKiBJZiBhIHRhZ05hbWUgaXMgcHJvdmlkZWQgaXQgd2lsbCBvdmVyd2l0ZSB0aGUgZWxlbWVudCdzIHRhZ05hbWVcbiAqXG4gKiAgQHJldHVybiBbIHN0cmluZ3MsIGZpcnN0IGxhbmd1YWdlIGNvZGUsIHNlY29uZCBsYW5ndWFnZSBjb2RlXVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgY29uc3QgY29tcG9uZW50TmFtZSA9IHRhZ05hbWUgfHwgZWxlbWVudC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG4gIGNvbnN0IGNvbXBvbmVudExhbmd1YWdlID0gZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlKGVsZW1lbnQpO1xuICBjb25zdCBjb21wb25lbnRMYW5ndWFnZUludGwgPSBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2VJbnRsKGVsZW1lbnQpO1xuICBsZXQgc3RyaW5ncztcbiAgdHJ5IHtcbiAgICBzdHJpbmdzID0gYXdhaXQgZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIGNvbXBvbmVudExhbmd1YWdlKTtcbiAgfVxuICBjYXRjaCAoZSkge1xuICAgIGNvbnNvbGUud2Fybihgbm8gbG9jYWxlIGZvciAke2NvbXBvbmVudE5hbWV9ICgke2NvbXBvbmVudExhbmd1YWdlfSkgbG9hZGluZyBkZWZhdWx0IGxvY2FsZSBlbi5gKTtcbiAgICBzdHJpbmdzID0gYXdhaXQgZmV0Y2hMb2NhbGVTdHJpbmdzRnJvbUNhY2hlKGNvbXBvbmVudE5hbWUsIFwiZW5cIik7XG4gIH1cbiAgcmV0dXJuIFtzdHJpbmdzLCBjb21wb25lbnRMYW5ndWFnZSwgY29tcG9uZW50TGFuZ3VhZ2VJbnRsXTtcbn1cblxuZXhwb3J0IHsgZ2V0Q29tcG9uZW50Q2xvc2VzdExhbmd1YWdlIGFzIGEsIGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3MgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9