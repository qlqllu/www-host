"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_ba-infographic_node_modules_arcgis_business-analyst-components_dis-5bda86"],{

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-date-picker.entry.js":
/*!**********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-date-picker.entry.js ***!
  \**********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calcite_date_picker: () => (/* binding */ DatePicker)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./date-d7fbf7fd.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-d7fbf7fd.js");
/* harmony import */ var _locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./locale-f7b2fbb0.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-f7b2fbb0.js");
/* harmony import */ var _t9n_dc67ab96_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./t9n-dc67ab96.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/t9n-dc67ab96.js");
/* harmony import */ var _utils_b4f95c27_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./utils-b4f95c27.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/utils-b4f95c27.js");












/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const HEADING_LEVEL = 2;

const datePickerCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{position:relative;display:inline-block;inline-size:100%;overflow:visible;border-radius:0px;border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-1);background-color:var(--calcite-ui-foreground-1);vertical-align:top}:host([scale=s]){max-inline-size:216px}:host([scale=m]){max-inline-size:286px}:host([scale=l]){max-inline-size:398px}";

const DatePicker = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.calciteDatePickerChange = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDatePickerChange", 6);
    this.calciteDatePickerRangeChange = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "calciteDatePickerRangeChange", 6);
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.keyDownHandler = (event) => {
      if (event.key === "Escape") {
        this.reset();
      }
    };
    this.monthHeaderSelectChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthActiveDateChange = (event) => {
      const date = new Date(event.detail);
      if (!this.range) {
        this.activeDate = date;
      }
      else {
        if (this.activeRange === "end") {
          this.activeEndDate = date;
        }
        else {
          this.activeStartDate = date;
        }
        this.mostRecentRangeValue = date;
      }
    };
    this.monthHoverChange = (event) => {
      if (!this.range) {
        this.hoverRange = undefined;
        return;
      }
      const { valueAsDate } = this;
      const start = Array.isArray(valueAsDate) && valueAsDate[0];
      const end = Array.isArray(valueAsDate) && valueAsDate[1];
      const date = new Date(event.detail);
      this.hoverRange = {
        focused: this.activeRange || "start",
        start,
        end
      };
      if (!this.proximitySelectionDisabled) {
        if (end) {
          const startDiff = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, start);
          const endDiff = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, end);
          if (endDiff > 0) {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
          else if (startDiff < 0) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else if (startDiff > endDiff) {
            this.hoverRange.start = date;
            this.hoverRange.focused = "start";
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          if (start) {
            if (date < start) {
              this.hoverRange = {
                focused: "start",
                start: date,
                end: start
              };
            }
            else {
              this.hoverRange.end = date;
              this.hoverRange.focused = "end";
            }
          }
        }
      }
      else {
        if (!end) {
          if (date < start) {
            this.hoverRange = {
              focused: "start",
              start: date,
              end: start
            };
          }
          else {
            this.hoverRange.end = date;
            this.hoverRange.focused = "end";
          }
        }
        else {
          this.hoverRange = undefined;
        }
      }
      event.stopPropagation();
    };
    this.monthMouseOutChange = () => {
      if (this.hoverRange) {
        this.hoverRange = undefined;
      }
    };
    /**
     * Reset active date and close
     */
    this.reset = () => {
      const { valueAsDate } = this;
      if (!Array.isArray(valueAsDate) &&
        valueAsDate &&
        valueAsDate?.getTime() !== this.activeDate?.getTime()) {
        this.activeDate = new Date(valueAsDate);
      }
      if (Array.isArray(valueAsDate)) {
        if (valueAsDate[0] &&
          valueAsDate[0]?.getTime() !==
            (this.activeStartDate instanceof Date && this.activeStartDate?.getTime())) {
          this.activeStartDate = new Date(valueAsDate[0]);
        }
        if (valueAsDate[1] &&
          valueAsDate[1]?.getTime() !==
            (this.activeStartDate instanceof Date && this.activeEndDate?.getTime())) {
          this.activeEndDate = new Date(valueAsDate[1]);
        }
      }
    };
    /**
     * Event handler for when the selected date changes
     *
     * @param event
     */
    this.monthDateChange = (event) => {
      const date = new Date(event.detail);
      const isoDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.b)(date);
      if (!this.range && isoDate === (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.b)(this.valueAsDate)) {
        return;
      }
      if (!this.range) {
        this.value = isoDate || "";
        this.valueAsDate = date || null;
        this.activeDate = date || null;
        this.calciteDatePickerChange.emit();
        return;
      }
      const start = this.getStartDate();
      const end = this.getEndDate();
      if (!start || (!end && date < start)) {
        if (start) {
          this.setEndDate(new Date(start));
        }
        if (this.activeRange == "end") {
          this.setEndDate(date);
        }
        else {
          this.setStartDate(date);
        }
      }
      else if (!end) {
        this.setEndDate(date);
      }
      else {
        if (!this.proximitySelectionDisabled) {
          if (this.activeRange) {
            if (this.activeRange == "end") {
              this.setEndDate(date);
            }
            else {
              this.setStartDate(date);
            }
          }
          else {
            const startDiff = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, start);
            const endDiff = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.g)(date, end);
            if (endDiff === 0 || startDiff < 0) {
              this.setStartDate(date);
            }
            else if (startDiff === 0 || endDiff < 0) {
              this.setEndDate(date);
            }
            else if (startDiff < endDiff) {
              this.setStartDate(date);
            }
            else {
              this.setEndDate(date);
            }
          }
        }
        else {
          this.setStartDate(date);
        }
      }
      this.calciteDatePickerChange.emit();
    };
    this.activeDate = undefined;
    this.activeRange = undefined;
    this.value = undefined;
    this.headingLevel = undefined;
    this.valueAsDate = undefined;
    this.minAsDate = undefined;
    this.maxAsDate = undefined;
    this.min = undefined;
    this.max = undefined;
    this.numberingSystem = undefined;
    this.scale = "m";
    this.range = false;
    this.proximitySelectionDisabled = false;
    this.messageOverrides = undefined;
    this.messages = undefined;
    this.activeStartDate = undefined;
    this.activeEndDate = undefined;
    this.startAsDate = undefined;
    this.endAsDate = undefined;
    this.effectiveLocale = "";
    this.defaultMessages = undefined;
    this.localeData = undefined;
    this.hoverRange = undefined;
  }
  activeDateWatcher(newActiveDate) {
    if (this.activeRange === "end") {
      this.activeEndDate = newActiveDate;
    }
  }
  valueAsDateWatcher(newValueAsDate) {
    if (this.range && Array.isArray(newValueAsDate)) {
      const { activeStartDate, activeEndDate } = this;
      const newActiveStartDate = newValueAsDate[0];
      const newActiveEndDate = newValueAsDate[1];
      this.activeStartDate = activeStartDate !== newActiveStartDate && newActiveStartDate;
      this.activeEndDate = activeEndDate !== newActiveEndDate && newActiveEndDate;
    }
    else if (newValueAsDate && newValueAsDate !== this.activeDate) {
      this.activeDate = newValueAsDate;
    }
  }
  onMinChanged(min) {
    if (min) {
      this.minAsDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.c)(min);
    }
  }
  onMaxChanged(max) {
    if (max) {
      this.maxAsDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.c)(max);
    }
  }
  onMessagesChange() {
    /* wired up by t9n util */
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_2__.c)(this);
    (0,_t9n_dc67ab96_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    if (Array.isArray(this.value)) {
      this.valueAsDate = (0,_utils_b4f95c27_js__WEBPACK_IMPORTED_MODULE_4__.g)(this.value);
    }
    else if (this.value) {
      this.valueAsDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.value);
    }
    if (this.min) {
      this.minAsDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.min);
    }
    if (this.max) {
      this.maxAsDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.c)(this.max);
    }
  }
  disconnectedCallback() {
    (0,_locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_2__.d)(this);
    (0,_t9n_dc67ab96_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
  }
  async componentWillLoad() {
    await this.loadLocaleData();
    this.onMinChanged(this.min);
    this.onMaxChanged(this.max);
    await (0,_t9n_dc67ab96_js__WEBPACK_IMPORTED_MODULE_3__.s)(this);
  }
  render() {
    const date = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.range && Array.isArray(this.valueAsDate) ? this.valueAsDate[0] : this.valueAsDate, this.minAsDate, this.maxAsDate);
    let activeDate = this.getActiveDate(date, this.minAsDate, this.maxAsDate);
    const endDate = this.range && Array.isArray(this.valueAsDate)
      ? (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.valueAsDate[1], this.minAsDate, this.maxAsDate)
      : null;
    const activeEndDate = this.getActiveEndDate(endDate, this.minAsDate, this.maxAsDate);
    if ((this.activeRange === "end" ||
      (this.hoverRange?.focused === "end" && (!this.proximitySelectionDisabled || endDate))) &&
      activeEndDate) {
      activeDate = activeEndDate;
    }
    if (this.range && this.mostRecentRangeValue) {
      activeDate = this.mostRecentRangeValue;
    }
    const minDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? this.minAsDate
        : date || this.minAsDate
      : this.minAsDate;
    const maxDate = this.range && this.activeRange
      ? this.activeRange === "start"
        ? endDate || this.maxAsDate
        : this.maxAsDate
      : this.maxAsDate;
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.H, { onBlur: this.reset, onKeyDown: this.keyDownHandler, role: "application" }, this.renderCalendar(activeDate, maxDate, minDate, date, endDate)));
  }
  effectiveLocaleChange() {
    (0,_t9n_dc67ab96_js__WEBPACK_IMPORTED_MODULE_3__.u)(this, this.effectiveLocale);
  }
  valueHandler(value) {
    if (Array.isArray(value)) {
      this.valueAsDate = (0,_utils_b4f95c27_js__WEBPACK_IMPORTED_MODULE_4__.g)(value);
    }
    else if (value) {
      this.valueAsDate = (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.c)(value);
    }
  }
  async loadLocaleData() {
    _locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_2__.n.numberFormatOptions = {
      numberingSystem: this.numberingSystem,
      locale: this.effectiveLocale,
      useGrouping: false
    };
    this.localeData = await (0,_utils_b4f95c27_js__WEBPACK_IMPORTED_MODULE_4__.a)(this.effectiveLocale);
  }
  /**
   * Render calcite-date-picker-month-header and calcite-date-picker-month
   *
   * @param activeDate
   * @param maxDate
   * @param minDate
   * @param date
   * @param endDate
   */
  renderCalendar(activeDate, maxDate, minDate, date, endDate) {
    return (this.localeData && [
      (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-month-header", { activeDate: activeDate, headingLevel: this.headingLevel || HEADING_LEVEL, localeData: this.localeData, max: maxDate, messages: this.messages, min: minDate, onCalciteInternalDatePickerSelect: this.monthHeaderSelectChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date || new Date() }),
      (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-date-picker-month", { activeDate: activeDate, endDate: this.range ? endDate : undefined, hoverRange: this.hoverRange, localeData: this.localeData, max: maxDate, min: minDate, onCalciteInternalDatePickerActiveDateChange: this.monthActiveDateChange, onCalciteInternalDatePickerHover: this.monthHoverChange, onCalciteInternalDatePickerMouseOut: this.monthMouseOutChange, onCalciteInternalDatePickerSelect: this.monthDateChange, scale: this.scale, selectedDate: this.activeRange === "end" ? endDate : date, startDate: this.range ? date : undefined })
    ]);
  }
  getEndDate() {
    return (Array.isArray(this.valueAsDate) && this.valueAsDate[1]) || undefined;
  }
  setEndDate(date) {
    const startDate = this.getStartDate();
    const newEndDate = date ? (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.s)(date) : date;
    this.value = [(0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.b)(startDate), (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.b)(date)];
    this.valueAsDate = [startDate, date];
    this.mostRecentRangeValue = newEndDate;
    this.calciteDatePickerRangeChange.emit();
    this.activeEndDate = date || null;
  }
  getStartDate() {
    return Array.isArray(this.valueAsDate) && this.valueAsDate[0];
  }
  setStartDate(date) {
    const endDate = this.getEndDate();
    this.value = [(0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.b)(date), (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.b)(endDate)];
    this.valueAsDate = [date, endDate];
    this.mostRecentRangeValue = date;
    this.calciteDatePickerRangeChange.emit();
    this.activeStartDate = date || null;
  }
  /**
   * Get an active date using the value, or current date as default
   *
   * @param value
   * @param min
   * @param max
   */
  getActiveDate(value, min, max) {
    return (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.activeDate, min, max) || value || (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.e)(new Date(), min, max);
  }
  getActiveEndDate(value, min, max) {
    return ((0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.e)(this.activeEndDate, min, max) || value || (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_1__.e)(new Date(), min, max));
  }
  static get delegatesFocus() { return true; }
  static get assetsDirs() { return ["assets"]; }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.g)(this); }
  static get watchers() { return {
    "activeDate": ["activeDateWatcher"],
    "valueAsDate": ["valueAsDateWatcher"],
    "min": ["onMinChanged"],
    "max": ["onMaxChanged"],
    "messageOverrides": ["onMessagesChange"],
    "effectiveLocale": ["effectiveLocaleChange", "loadLocaleData"],
    "value": ["valueHandler"]
  }; }
};
DatePicker.style = datePickerCss;



//# sourceMappingURL=calcite-date-picker.entry.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-d7fbf7fd.js":
/*!**********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-d7fbf7fd.js ***!
  \**********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ dateFromLocalizedString),
/* harmony export */   b: () => (/* binding */ dateToISO),
/* harmony export */   c: () => (/* binding */ dateFromISO),
/* harmony export */   d: () => (/* binding */ datePartsFromLocalizedString),
/* harmony export */   e: () => (/* binding */ dateFromRange),
/* harmony export */   f: () => (/* binding */ sameDate),
/* harmony export */   g: () => (/* binding */ getDaysDiff),
/* harmony export */   h: () => (/* binding */ getOrder),
/* harmony export */   i: () => (/* binding */ inRange),
/* harmony export */   n: () => (/* binding */ nextMonth),
/* harmony export */   p: () => (/* binding */ prevMonth),
/* harmony export */   s: () => (/* binding */ setEndOfDay)
/* harmony export */ });
/* harmony import */ var _locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locale-f7b2fbb0.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-f7b2fbb0.js");


/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
/**
 * Check if date is within a min and max
 *
 * @param date
 * @param min
 * @param max
 */
function inRange(date, min, max) {
  if (!date) {
    return;
  }
  const time = date.getTime();
  const afterMin = !(min instanceof Date) || time >= min.getTime();
  const beforeMax = !(max instanceof Date) || time <= max.getTime();
  return afterMin && beforeMax;
}
/**
 * Ensures date is within range,
 * returns min or max if out of bounds
 *
 * @param date
 * @param min
 * @param max
 */
function dateFromRange(date, min, max) {
  if (!(date instanceof Date)) {
    return null;
  }
  const time = date.getTime();
  const beforeMin = min instanceof Date && time < min.getTime();
  const afterMax = max instanceof Date && time > max.getTime();
  if (beforeMin) {
    return min;
  }
  if (afterMax) {
    return max;
  }
  return date;
}
/**
 * Parse an iso8601 string (YYYY-mm-dd) into a valid date.
 * TODO: handle time when time of day UI is added
 *
 * @param iso8601
 * @param isEndDate
 */
function dateFromISO(iso8601, isEndDate = false) {
  if (iso8601 instanceof Date) {
    return iso8601;
  }
  if (!iso8601 || typeof iso8601 !== "string") {
    return null;
  }
  const d = iso8601.split(/[: T-]/).map(parseFloat);
  const date = new Date(d[0], (d[1] || 1) - 1, d[2] || 1);
  date.setFullYear(d[0]);
  if (isNaN(date.getTime())) {
    throw new Error(`Invalid ISO 8601 date: "${iso8601}"`);
  }
  if (isEndDate) {
    return setEndOfDay(date);
  }
  return date;
}
/**
 * Parse a localized date string into a valid Date.
 * return false if date is invalid, or out of range
 *
 * @param value
 * @param localeData
 */
function dateFromLocalizedString(value, localeData) {
  if (!localeData) {
    return null;
  }
  const { separator } = localeData;
  const { day, month, year } = parseDateString(value, localeData);
  const date = new Date(year, month, day);
  date.setFullYear(year);
  const validDay = day > 0;
  const validMonth = month > -1;
  const validDate = !isNaN(date.getTime());
  const validLength = value.split(separator).filter((c) => c).length > 2;
  const validYear = year.toString().length > 0;
  if (validDay && validMonth && validDate && validLength && validYear) {
    return date;
  }
  return null;
}
/**
 * Retrieve day, month, and year strings from a localized string
 *
 * @param string
 * @param localeData
 */
function datePartsFromLocalizedString(string, localeData) {
  const { separator, unitOrder } = localeData;
  const order = getOrder(unitOrder);
  const values = string.split(separator).map((part) => _locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_0__.n.delocalize(part));
  const day = values[order.indexOf("d")];
  const month = values[order.indexOf("m")];
  const year = values[order.indexOf("y")];
  return { day, month, year };
}
/**
 * Return first portion of ISO string (YYYY-mm-dd)
 *
 * @param date
 */
function dateToISO(date) {
  if (date instanceof Date) {
    return new Date(date.getTime() - date.getTimezoneOffset() * 60000).toISOString().split("T")[0];
  }
  return "";
}
/**
 * Check if two dates are the same day, month, year
 *
 * @param d1
 * @param d2
 */
function sameDate(d1, d2) {
  return (d1 instanceof Date &&
    d2 instanceof Date &&
    d1.getDate() === d2.getDate() &&
    d1.getMonth() === d2.getMonth() &&
    d1.getFullYear() === d2.getFullYear());
}
/**
 * Get a date one month in the past
 *
 * @param date
 */
function prevMonth(date) {
  const month = date.getMonth();
  const nextDate = new Date(date);
  nextDate.setMonth(month - 1);
  // date doesn't exist in new month, use last day
  if (month === nextDate.getMonth()) {
    return new Date(date.getFullYear(), month, 0);
  }
  return nextDate;
}
/**
 * Get a date one month in the future
 *
 * @param date
 */
function nextMonth(date) {
  const month = date.getMonth();
  const nextDate = new Date(date);
  nextDate.setMonth(month + 1);
  // date doesn't exist in new month, use last day
  if ((month + 2) % 7 === nextDate.getMonth() % 7) {
    return new Date(date.getFullYear(), month + 2, 0);
  }
  return nextDate;
}
/**
 * Parse numeric units for day, month, and year from a localized string
 * month starts at 0 (can pass to date constructor)
 * can return values as number or string
 *
 * @param string
 * @param localeData
 */
function parseDateString(string, localeData) {
  const { day, month, year } = datePartsFromLocalizedString(string, localeData);
  return {
    day: parseInt(day),
    month: parseInt(month) - 1,
    year: parseInt(year)
  };
}
/**
 * Based on the unitOrder string, find order of month, day, and year for locale
 *
 * @param unitOrder
 */
function getOrder(unitOrder) {
  const signifiers = ["d", "m", "y"];
  const order = unitOrder.toLowerCase();
  return signifiers.sort((a, b) => order.indexOf(a) - order.indexOf(b));
}
/**
 * Get number of days between two dates
 *
 * @param date1
 * @param date2
 */
function getDaysDiff(date1, date2) {
  const ts1 = date1.getTime();
  const ts2 = date2.getTime();
  return (ts1 - ts2) / (1000 * 3600 * 24);
}
/**
 * Set time of the day to the end.
 *
 * @param {Date} date Date.
 * @returns {Date} Date with time set to end of day .
 */
function setEndOfDay(date) {
  date.setHours(23, 59, 59, 999);
  return date;
}



//# sourceMappingURL=date-d7fbf7fd.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/t9n-dc67ab96.js":
/*!*********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/t9n-dc67ab96.js ***!
  \*********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectMessages),
/* harmony export */   d: () => (/* binding */ disconnectMessages),
/* harmony export */   s: () => (/* binding */ setUpMessages),
/* harmony export */   u: () => (/* binding */ updateMessages)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locale-f7b2fbb0.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-f7b2fbb0.js");



/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const componentLangToMessageBundleCache = {};
async function getMessageBundle(lang, component) {
  const key = `${component}_${lang}`;
  if (componentLangToMessageBundleCache[key]) {
    return componentLangToMessageBundleCache[key];
  }
  componentLangToMessageBundleCache[key] = fetch((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_0__.a)(`./assets/${component}/t9n/messages_${lang}.json`))
    .then((resp) => {
    if (!resp.ok) {
      throwMessageFetchError();
    }
    return resp.json();
  })
    .catch(() => throwMessageFetchError());
  return componentLangToMessageBundleCache[key];
}
function throwMessageFetchError() {
  throw new Error("could not fetch component message bundle");
}
function mergeMessages(component) {
  component.messages = {
    ...component.defaultMessages,
    ...component.messageOverrides
  };
}
/**
 * This utility sets up the messages used by the component. It should be awaited in the `componentWillLoad` lifecycle hook.
 *
 * @param component
 */
async function setUpMessages(component) {
  component.defaultMessages = await fetchMessages(component, component.effectiveLocale);
  mergeMessages(component);
}
async function fetchMessages(component, lang) {
  const { el } = component;
  const tag = el.tagName.toLowerCase();
  const componentName = tag.replace("calcite-", "");
  return getMessageBundle((0,_locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_1__.g)(lang, "t9n"), componentName);
}
/**
 * This utility must be set up for the component to update its default message bundle if the locale changes.
 *
 * It can be set up in **either** of the following ways:
 *
 * 1. called from `LocalizedComponent`'s `onLocaleChange` method or
 * 2. called from a watcher configured to watch `LocalizedComponent`'s `effectiveLocale` prop
 *
 * @param component
 * @param lang
 */
async function updateMessages(component, lang) {
  component.defaultMessages = await fetchMessages(component, lang);
  mergeMessages(component);
}
/**
 * This utility sets up internals for messages support.
 *
 * It needs to be called in `connectedCallback`
 *
 * **Note**: this must be called after `LocalizedComponent`'s `connectLocalized` method.
 *
 * @param component
 */
function connectMessages(component) {
  component.onMessagesChange = defaultOnMessagesChange;
}
/**
 * This utility tears down internals for messages support.
 *
 * It needs to be called in `disconnectedCallback`
 *
 * @param component
 */
function disconnectMessages(component) {
  component.onMessagesChange = undefined;
}
function defaultOnMessagesChange() {
  mergeMessages(this);
}



//# sourceMappingURL=t9n-dc67ab96.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/utils-b4f95c27.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/utils-b4f95c27.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getLocaleData),
/* harmony export */   g: () => (/* binding */ getValueAsDateRange)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./date-d7fbf7fd.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/date-d7fbf7fd.js");
/* harmony import */ var _locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./locale-f7b2fbb0.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/locale-f7b2fbb0.js");




/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
/**
 * CLDR cache.
 * Exported for testing purposes.
 *
 * @private
 */
const translationCache = {};
/**
 * CLDR request cache.
 * Exported for testing purposes.
 *
 * @private
 */
const requestCache = {};
/**
 * Fetch calendar data for a given locale from list of supported languages
 *
 * @param lang
 * @public
 */
async function getLocaleData(lang) {
  const locale = (0,_locale_f7b2fbb0_js__WEBPACK_IMPORTED_MODULE_0__.g)(lang);
  if (translationCache[locale]) {
    return translationCache[locale];
  }
  if (!requestCache[locale]) {
    requestCache[locale] = fetch((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.a)(`./assets/date-picker/nls/${locale}.json`))
      .then((resp) => resp.json())
      .catch(() => {
      console.error(`Translations for "${locale}" not found or invalid, falling back to english`);
      return getLocaleData("en");
    });
  }
  const data = await requestCache[locale];
  translationCache[locale] = data;
  return data;
}
/**
 *  Maps value to valueAsDate
 *
 * @param value
 */
function getValueAsDateRange(value) {
  return value.map((v, index) => (0,_date_d7fbf7fd_js__WEBPACK_IMPORTED_MODULE_2__.c)(v, index === 1));
}



//# sourceMappingURL=utils-b4f95c27.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYmEtaW5mb2dyYXBoaWNfbm9kZV9tb2R1bGVzX2FyY2dpc19idXNpbmVzcy1hbmFseXN0LWNvbXBvbmVudHNfZGlzLTViZGE4Ni5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBNkc7QUFDaUI7QUFDWDtBQUNRO0FBQ3hDO0FBQ3hEO0FBQ007QUFDTDtBQUNLO0FBQ047QUFDTTs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBLHFDQUFxQyxHQUFHLFVBQVUsS0FBSyxXQUFXLG1CQUFtQixHQUFHLFVBQVUsa0NBQWtDLEtBQUssVUFBVSxnQ0FBZ0MsaUJBQWlCLEdBQUcsVUFBVSxpQ0FBaUMsS0FBSyxVQUFVLGdDQUFnQyxvQkFBb0IsR0FBRyxVQUFVLGlDQUFpQyxLQUFLLFVBQVUsNEJBQTRCLE1BQU0saUZBQWlGLHFFQUFxRSwrRkFBK0YsaUdBQWlHLCtGQUErRixpQkFBaUIsVUFBVSx5QkFBeUIsbURBQW1ELHFCQUFxQixrQkFBa0IsMEJBQTBCLHVCQUF1Qix3QkFBd0IscUJBQXFCLDJCQUEyQix3QkFBd0Isd0NBQXdDLE1BQU0sc0NBQXNDLE1BQU0saUVBQWlFLGtDQUFrQyxnQkFBZ0IsYUFBYSxNQUFNLGtCQUFrQixxQkFBcUIsaUJBQWlCLGlCQUFpQixrQkFBa0IsaUJBQWlCLG1CQUFtQix3Q0FBd0MsZ0RBQWdELG1CQUFtQixpQkFBaUIsc0JBQXNCLGlCQUFpQixzQkFBc0IsaUJBQWlCLHNCQUFzQjs7QUFFdnFEO0FBQ0E7QUFDQSxJQUFJLHFEQUFnQjtBQUNwQixtQ0FBbUMscURBQVc7QUFDOUMsd0NBQXdDLHFEQUFXO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtB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Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQ0FBK0MsUUFBUTtBQUN2RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxZQUFZO0FBQ3RCLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSx1QkFBdUI7QUFDakM7QUFDQSx1REFBdUQsa0RBQXFCO0FBQzVFO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsbUJBQW1CO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsTUFBTTtBQUNqQixhQUFhLE1BQU07QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFaVA7O0FBRWpQOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDdk53RDtBQUNPOztBQUUvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQixVQUFVLEdBQUcsS0FBSztBQUNuQztBQUNBO0FBQ0E7QUFDQSxpREFBaUQscURBQVksYUFBYSxVQUFVLGdCQUFnQixLQUFLO0FBQ3pHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLEtBQUs7QUFDZjtBQUNBO0FBQ0EsMEJBQTBCLHNEQUFrQjtBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVrRzs7QUFFbEc7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQzNGd0Q7QUFDRjtBQUNTOztBQUUvRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLHNEQUFrQjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxxREFBWSw2QkFBNkIsT0FBTztBQUNqRjtBQUNBO0FBQ0EseUNBQXlDLE9BQU87QUFDaEQ7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlDQUFpQyxvREFBVztBQUM1Qzs7QUFFd0Q7O0FBRXhEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9iYS1pbmZvZ3JhcGhpYy9ub2RlX21vZHVsZXMvQGFyY2dpcy9idXNpbmVzcy1hbmFseXN0LWNvbXBvbmVudHMvZGlzdC9zdGVuY2lsLWNvbXBvbmVudHMvZGlzdC9lc20vY2FsY2l0ZS1kYXRlLXBpY2tlci5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS9kYXRlLWQ3ZmJmN2ZkLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYmEtaW5mb2dyYXBoaWMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYnVzaW5lc3MtYW5hbHlzdC1jb21wb25lbnRzL2Rpc3Qvc3RlbmNpbC1jb21wb25lbnRzL2Rpc3QvZXNtL3Q5bi1kYzY3YWI5Ni5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS91dGlscy1iNGY5NWMyNy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIEggYXMgSG9zdCwgZyBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC00ZTY0NzQxMS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldERheXNEaWZmLCBiIGFzIGRhdGVUb0lTTywgYyBhcyBkYXRlRnJvbUlTTywgZSBhcyBkYXRlRnJvbVJhbmdlLCBzIGFzIHNldEVuZE9mRGF5IH0gZnJvbSAnLi9kYXRlLWQ3ZmJmN2ZkLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdExvY2FsaXplZCwgZCBhcyBkaXNjb25uZWN0TG9jYWxpemVkLCBuIGFzIG51bWJlclN0cmluZ0Zvcm1hdHRlciB9IGZyb20gJy4vbG9jYWxlLWY3YjJmYmIwLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdE1lc3NhZ2VzLCBkIGFzIGRpc2Nvbm5lY3RNZXNzYWdlcywgcyBhcyBzZXRVcE1lc3NhZ2VzLCB1IGFzIHVwZGF0ZU1lc3NhZ2VzIH0gZnJvbSAnLi90OW4tZGM2N2FiOTYuanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRWYWx1ZUFzRGF0ZVJhbmdlLCBhIGFzIGdldExvY2FsZURhdGEgfSBmcm9tICcuL3V0aWxzLWI0Zjk1YzI3LmpzJztcbmltcG9ydCAnLi9kb20tZjFlZTRkMDQuanMnO1xuaW1wb3J0ICcuL2luZGV4LmVzbS0xYzY1ZDhjNy5qcyc7XG5pbXBvcnQgJy4vZ3VpZC04OGEzNzI5Zi5qcyc7XG5pbXBvcnQgJy4vcmVzb3VyY2VzLTQ4NDM2ZWVhLmpzJztcbmltcG9ydCAnLi9rZXktYjc1NDkxYzQuanMnO1xuaW1wb3J0ICcuL29ic2VydmVycy01Njc0MGU5OS5qcyc7XG5cbi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjAuNVxuICovXG5jb25zdCBIRUFESU5HX0xFVkVMID0gMjtcblxuY29uc3QgZGF0ZVBpY2tlckNzcyA9IFwiQGtleWZyYW1lcyBpbnswJXtvcGFjaXR5OjB9MTAwJXtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgaW4tZG93bnswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIC01cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi11cHswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDVweCwgMCl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDAsIDApfX1Aa2V5ZnJhbWVzIGluLXNjYWxlezAle29wYWNpdHk6MDt0cmFuc2Zvcm06c2NhbGUzRCgwLjk1LCAwLjk1LCAxKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06c2NhbGUzRCgxLCAxLCAxKX19OnJvb3R7LS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmc6Y2FsYygxNTBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3Rvcjp2YXIoLS1jYWxjaXRlLWR1cmF0aW9uLWZhY3RvciwgMSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctZmFzdDpjYWxjKDEwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1tZWRpdW06Y2FsYygyMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdzpjYWxjKDMwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKX0uY2FsY2l0ZS1hbmltYXRle29wYWNpdHk6MDthbmltYXRpb24tZmlsbC1tb2RlOmJvdGg7YW5pbWF0aW9uLWR1cmF0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyl9LmNhbGNpdGUtYW5pbWF0ZV9faW57YW5pbWF0aW9uLW5hbWU6aW59LmNhbGNpdGUtYW5pbWF0ZV9faW4tZG93bnthbmltYXRpb24tbmFtZTppbi1kb3dufS5jYWxjaXRlLWFuaW1hdGVfX2luLXVwe2FuaW1hdGlvbi1uYW1lOmluLXVwfS5jYWxjaXRlLWFuaW1hdGVfX2luLXNjYWxle2FuaW1hdGlvbi1uYW1lOmluLXNjYWxlfUBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKXs6cm9vdHstLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yOjB9fTpyb290ey0tY2FsY2l0ZS1mbG9hdGluZy11aS10cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyk7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6NjAwfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9Omhvc3R7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTppbmxpbmUtYmxvY2s7aW5saW5lLXNpemU6MTAwJTtvdmVyZmxvdzp2aXNpYmxlO2JvcmRlci1yYWRpdXM6MHB4O2JvcmRlci13aWR0aDoxcHg7Ym9yZGVyLXN0eWxlOnNvbGlkO2JvcmRlci1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0xKTtiYWNrZ3JvdW5kLWNvbG9yOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKTt2ZXJ0aWNhbC1hbGlnbjp0b3B9Omhvc3QoW3NjYWxlPXNdKXttYXgtaW5saW5lLXNpemU6MjE2cHh9Omhvc3QoW3NjYWxlPW1dKXttYXgtaW5saW5lLXNpemU6Mjg2cHh9Omhvc3QoW3NjYWxlPWxdKXttYXgtaW5saW5lLXNpemU6Mzk4cHh9XCI7XG5cbmNvbnN0IERhdGVQaWNrZXIgPSBjbGFzcyB7XHJcbiAgY29uc3RydWN0b3IoaG9zdFJlZikge1xyXG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcclxuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVEYXRlUGlja2VyQ2hhbmdlXCIsIDYpO1xyXG4gICAgdGhpcy5jYWxjaXRlRGF0ZVBpY2tlclJhbmdlQ2hhbmdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlRGF0ZVBpY2tlclJhbmdlQ2hhbmdlXCIsIDYpO1xyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgLy9cclxuICAgIC8vICBQcml2YXRlIE1ldGhvZHNcclxuICAgIC8vXHJcbiAgICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgICB0aGlzLmtleURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChldmVudC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgICB0aGlzLnJlc2V0KCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLm1vbnRoSGVhZGVyU2VsZWN0Q2hhbmdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShldmVudC5kZXRhaWwpO1xyXG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcclxuICAgICAgICB0aGlzLmFjdGl2ZURhdGUgPSBkYXRlO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2Uge1xyXG4gICAgICAgIGlmICh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiKSB7XHJcbiAgICAgICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBkYXRlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuYWN0aXZlU3RhcnREYXRlID0gZGF0ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5tb3N0UmVjZW50UmFuZ2VWYWx1ZSA9IGRhdGU7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLm1vbnRoQWN0aXZlRGF0ZUNoYW5nZSA9IChldmVudCkgPT4ge1xyXG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZXZlbnQuZGV0YWlsKTtcclxuICAgICAgaWYgKCF0aGlzLnJhbmdlKSB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gZGF0ZTtcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIikge1xyXG4gICAgICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gZGF0ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUgPSBkYXRlO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5tb250aEhvdmVyQ2hhbmdlID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmICghdGhpcy5yYW5nZSkge1xyXG4gICAgICAgIHRoaXMuaG92ZXJSYW5nZSA9IHVuZGVmaW5lZDtcclxuICAgICAgICByZXR1cm47XHJcbiAgICAgIH1cclxuICAgICAgY29uc3QgeyB2YWx1ZUFzRGF0ZSB9ID0gdGhpcztcclxuICAgICAgY29uc3Qgc3RhcnQgPSBBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSAmJiB2YWx1ZUFzRGF0ZVswXTtcclxuICAgICAgY29uc3QgZW5kID0gQXJyYXkuaXNBcnJheSh2YWx1ZUFzRGF0ZSkgJiYgdmFsdWVBc0RhdGVbMV07XHJcbiAgICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZShldmVudC5kZXRhaWwpO1xyXG4gICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB7XHJcbiAgICAgICAgZm9jdXNlZDogdGhpcy5hY3RpdmVSYW5nZSB8fCBcInN0YXJ0XCIsXHJcbiAgICAgICAgc3RhcnQsXHJcbiAgICAgICAgZW5kXHJcbiAgICAgIH07XHJcbiAgICAgIGlmICghdGhpcy5wcm94aW1pdHlTZWxlY3Rpb25EaXNhYmxlZCkge1xyXG4gICAgICAgIGlmIChlbmQpIHtcclxuICAgICAgICAgIGNvbnN0IHN0YXJ0RGlmZiA9IGdldERheXNEaWZmKGRhdGUsIHN0YXJ0KTtcclxuICAgICAgICAgIGNvbnN0IGVuZERpZmYgPSBnZXREYXlzRGlmZihkYXRlLCBlbmQpO1xyXG4gICAgICAgICAgaWYgKGVuZERpZmYgPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5lbmQgPSBkYXRlO1xyXG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIGlmIChzdGFydERpZmYgPCAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5zdGFydCA9IGRhdGU7XHJcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5mb2N1c2VkID0gXCJzdGFydFwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgZWxzZSBpZiAoc3RhcnREaWZmID4gZW5kRGlmZikge1xyXG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2Uuc3RhcnQgPSBkYXRlO1xyXG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwic3RhcnRcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZW5kID0gZGF0ZTtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmZvY3VzZWQgPSBcImVuZFwiO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgIGlmIChzdGFydCkge1xyXG4gICAgICAgICAgICBpZiAoZGF0ZSA8IHN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0ge1xyXG4gICAgICAgICAgICAgICAgZm9jdXNlZDogXCJzdGFydFwiLFxyXG4gICAgICAgICAgICAgICAgc3RhcnQ6IGRhdGUsXHJcbiAgICAgICAgICAgICAgICBlbmQ6IHN0YXJ0XHJcbiAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZW5kID0gZGF0ZTtcclxuICAgICAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UuZm9jdXNlZCA9IFwiZW5kXCI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKCFlbmQpIHtcclxuICAgICAgICAgIGlmIChkYXRlIDwgc3RhcnQpIHtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlID0ge1xyXG4gICAgICAgICAgICAgIGZvY3VzZWQ6IFwic3RhcnRcIixcclxuICAgICAgICAgICAgICBzdGFydDogZGF0ZSxcclxuICAgICAgICAgICAgICBlbmQ6IHN0YXJ0XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5ob3ZlclJhbmdlLmVuZCA9IGRhdGU7XHJcbiAgICAgICAgICAgIHRoaXMuaG92ZXJSYW5nZS5mb2N1c2VkID0gXCJlbmRcIjtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICB0aGlzLmhvdmVyUmFuZ2UgPSB1bmRlZmluZWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfTtcclxuICAgIHRoaXMubW9udGhNb3VzZU91dENoYW5nZSA9ICgpID0+IHtcclxuICAgICAgaWYgKHRoaXMuaG92ZXJSYW5nZSkge1xyXG4gICAgICAgIHRoaXMuaG92ZXJSYW5nZSA9IHVuZGVmaW5lZDtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIC8qKlxyXG4gICAgICogUmVzZXQgYWN0aXZlIGRhdGUgYW5kIGNsb3NlXHJcbiAgICAgKi9cclxuICAgIHRoaXMucmVzZXQgPSAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgdmFsdWVBc0RhdGUgfSA9IHRoaXM7XHJcbiAgICAgIGlmICghQXJyYXkuaXNBcnJheSh2YWx1ZUFzRGF0ZSkgJiZcclxuICAgICAgICB2YWx1ZUFzRGF0ZSAmJlxyXG4gICAgICAgIHZhbHVlQXNEYXRlPy5nZXRUaW1lKCkgIT09IHRoaXMuYWN0aXZlRGF0ZT8uZ2V0VGltZSgpKSB7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gbmV3IERhdGUodmFsdWVBc0RhdGUpO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlQXNEYXRlKSkge1xyXG4gICAgICAgIGlmICh2YWx1ZUFzRGF0ZVswXSAmJlxyXG4gICAgICAgICAgdmFsdWVBc0RhdGVbMF0/LmdldFRpbWUoKSAhPT1cclxuICAgICAgICAgICAgKHRoaXMuYWN0aXZlU3RhcnREYXRlIGluc3RhbmNlb2YgRGF0ZSAmJiB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZT8uZ2V0VGltZSgpKSkge1xyXG4gICAgICAgICAgdGhpcy5hY3RpdmVTdGFydERhdGUgPSBuZXcgRGF0ZSh2YWx1ZUFzRGF0ZVswXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh2YWx1ZUFzRGF0ZVsxXSAmJlxyXG4gICAgICAgICAgdmFsdWVBc0RhdGVbMV0/LmdldFRpbWUoKSAhPT1cclxuICAgICAgICAgICAgKHRoaXMuYWN0aXZlU3RhcnREYXRlIGluc3RhbmNlb2YgRGF0ZSAmJiB0aGlzLmFjdGl2ZUVuZERhdGU/LmdldFRpbWUoKSkpIHtcclxuICAgICAgICAgIHRoaXMuYWN0aXZlRW5kRGF0ZSA9IG5ldyBEYXRlKHZhbHVlQXNEYXRlWzFdKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICAvKipcclxuICAgICAqIEV2ZW50IGhhbmRsZXIgZm9yIHdoZW4gdGhlIHNlbGVjdGVkIGRhdGUgY2hhbmdlc1xyXG4gICAgICpcclxuICAgICAqIEBwYXJhbSBldmVudFxyXG4gICAgICovXHJcbiAgICB0aGlzLm1vbnRoRGF0ZUNoYW5nZSA9IChldmVudCkgPT4ge1xyXG4gICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoZXZlbnQuZGV0YWlsKTtcclxuICAgICAgY29uc3QgaXNvRGF0ZSA9IGRhdGVUb0lTTyhkYXRlKTtcclxuICAgICAgaWYgKCF0aGlzLnJhbmdlICYmIGlzb0RhdGUgPT09IGRhdGVUb0lTTyh0aGlzLnZhbHVlQXNEYXRlKSkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoIXRoaXMucmFuZ2UpIHtcclxuICAgICAgICB0aGlzLnZhbHVlID0gaXNvRGF0ZSB8fCBcIlwiO1xyXG4gICAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBkYXRlIHx8IG51bGw7XHJcbiAgICAgICAgdGhpcy5hY3RpdmVEYXRlID0gZGF0ZSB8fCBudWxsO1xyXG4gICAgICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJDaGFuZ2UuZW1pdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBzdGFydCA9IHRoaXMuZ2V0U3RhcnREYXRlKCk7XHJcbiAgICAgIGNvbnN0IGVuZCA9IHRoaXMuZ2V0RW5kRGF0ZSgpO1xyXG4gICAgICBpZiAoIXN0YXJ0IHx8ICghZW5kICYmIGRhdGUgPCBzdGFydCkpIHtcclxuICAgICAgICBpZiAoc3RhcnQpIHtcclxuICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShuZXcgRGF0ZShzdGFydCkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PSBcImVuZFwiKSB7XHJcbiAgICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCFlbmQpIHtcclxuICAgICAgICB0aGlzLnNldEVuZERhdGUoZGF0ZSk7XHJcbiAgICAgIH1cclxuICAgICAgZWxzZSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLnByb3hpbWl0eVNlbGVjdGlvbkRpc2FibGVkKSB7XHJcbiAgICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PSBcImVuZFwiKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgY29uc3Qgc3RhcnREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgc3RhcnQpO1xyXG4gICAgICAgICAgICBjb25zdCBlbmREaWZmID0gZ2V0RGF5c0RpZmYoZGF0ZSwgZW5kKTtcclxuICAgICAgICAgICAgaWYgKGVuZERpZmYgPT09IDAgfHwgc3RhcnREaWZmIDwgMCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0U3RhcnREYXRlKGRhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHN0YXJ0RGlmZiA9PT0gMCB8fCBlbmREaWZmIDwgMCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0RW5kRGF0ZShkYXRlKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIGlmIChzdGFydERpZmYgPCBlbmREaWZmKSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgdGhpcy5zZXRFbmREYXRlKGRhdGUpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5zZXRTdGFydERhdGUoZGF0ZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJDaGFuZ2UuZW1pdCgpO1xyXG4gICAgfTtcclxuICAgIHRoaXMuYWN0aXZlRGF0ZSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuYWN0aXZlUmFuZ2UgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnZhbHVlID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5oZWFkaW5nTGV2ZWwgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnZhbHVlQXNEYXRlID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5taW5Bc0RhdGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLm1heEFzRGF0ZSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMubWluID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5tYXggPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLm51bWJlcmluZ1N5c3RlbSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuc2NhbGUgPSBcIm1cIjtcclxuICAgIHRoaXMucmFuZ2UgPSBmYWxzZTtcclxuICAgIHRoaXMucHJveGltaXR5U2VsZWN0aW9uRGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIHRoaXMubWVzc2FnZU92ZXJyaWRlcyA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMubWVzc2FnZXMgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuYWN0aXZlRW5kRGF0ZSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuc3RhcnRBc0RhdGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmVuZEFzRGF0ZSA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuZWZmZWN0aXZlTG9jYWxlID0gXCJcIjtcclxuICAgIHRoaXMuZGVmYXVsdE1lc3NhZ2VzID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5sb2NhbGVEYXRhID0gdW5kZWZpbmVkO1xyXG4gICAgdGhpcy5ob3ZlclJhbmdlID0gdW5kZWZpbmVkO1xyXG4gIH1cclxuICBhY3RpdmVEYXRlV2F0Y2hlcihuZXdBY3RpdmVEYXRlKSB7XHJcbiAgICBpZiAodGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIikge1xyXG4gICAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBuZXdBY3RpdmVEYXRlO1xyXG4gICAgfVxyXG4gIH1cclxuICB2YWx1ZUFzRGF0ZVdhdGNoZXIobmV3VmFsdWVBc0RhdGUpIHtcclxuICAgIGlmICh0aGlzLnJhbmdlICYmIEFycmF5LmlzQXJyYXkobmV3VmFsdWVBc0RhdGUpKSB7XHJcbiAgICAgIGNvbnN0IHsgYWN0aXZlU3RhcnREYXRlLCBhY3RpdmVFbmREYXRlIH0gPSB0aGlzO1xyXG4gICAgICBjb25zdCBuZXdBY3RpdmVTdGFydERhdGUgPSBuZXdWYWx1ZUFzRGF0ZVswXTtcclxuICAgICAgY29uc3QgbmV3QWN0aXZlRW5kRGF0ZSA9IG5ld1ZhbHVlQXNEYXRlWzFdO1xyXG4gICAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGFjdGl2ZVN0YXJ0RGF0ZSAhPT0gbmV3QWN0aXZlU3RhcnREYXRlICYmIG5ld0FjdGl2ZVN0YXJ0RGF0ZTtcclxuICAgICAgdGhpcy5hY3RpdmVFbmREYXRlID0gYWN0aXZlRW5kRGF0ZSAhPT0gbmV3QWN0aXZlRW5kRGF0ZSAmJiBuZXdBY3RpdmVFbmREYXRlO1xyXG4gICAgfVxyXG4gICAgZWxzZSBpZiAobmV3VmFsdWVBc0RhdGUgJiYgbmV3VmFsdWVBc0RhdGUgIT09IHRoaXMuYWN0aXZlRGF0ZSkge1xyXG4gICAgICB0aGlzLmFjdGl2ZURhdGUgPSBuZXdWYWx1ZUFzRGF0ZTtcclxuICAgIH1cclxuICB9XHJcbiAgb25NaW5DaGFuZ2VkKG1pbikge1xyXG4gICAgaWYgKG1pbikge1xyXG4gICAgICB0aGlzLm1pbkFzRGF0ZSA9IGRhdGVGcm9tSVNPKG1pbik7XHJcbiAgICB9XHJcbiAgfVxyXG4gIG9uTWF4Q2hhbmdlZChtYXgpIHtcclxuICAgIGlmIChtYXgpIHtcclxuICAgICAgdGhpcy5tYXhBc0RhdGUgPSBkYXRlRnJvbUlTTyhtYXgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBvbk1lc3NhZ2VzQ2hhbmdlKCkge1xyXG4gICAgLyogd2lyZWQgdXAgYnkgdDluIHV0aWwgKi9cclxuICB9XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBMaWZlY3ljbGVcclxuICAvL1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICBjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xyXG4gICAgY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodGhpcy52YWx1ZSkpIHtcclxuICAgICAgdGhpcy52YWx1ZUFzRGF0ZSA9IGdldFZhbHVlQXNEYXRlUmFuZ2UodGhpcy52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIGlmICh0aGlzLnZhbHVlKSB7XHJcbiAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBkYXRlRnJvbUlTTyh0aGlzLnZhbHVlKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLm1pbikge1xyXG4gICAgICB0aGlzLm1pbkFzRGF0ZSA9IGRhdGVGcm9tSVNPKHRoaXMubWluKTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLm1heCkge1xyXG4gICAgICB0aGlzLm1heEFzRGF0ZSA9IGRhdGVGcm9tSVNPKHRoaXMubWF4KTtcclxuICAgIH1cclxuICB9XHJcbiAgZGlzY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICBkaXNjb25uZWN0TG9jYWxpemVkKHRoaXMpO1xyXG4gICAgZGlzY29ubmVjdE1lc3NhZ2VzKHRoaXMpO1xyXG4gIH1cclxuICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcclxuICAgIGF3YWl0IHRoaXMubG9hZExvY2FsZURhdGEoKTtcclxuICAgIHRoaXMub25NaW5DaGFuZ2VkKHRoaXMubWluKTtcclxuICAgIHRoaXMub25NYXhDaGFuZ2VkKHRoaXMubWF4KTtcclxuICAgIGF3YWl0IHNldFVwTWVzc2FnZXModGhpcyk7XHJcbiAgfVxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IGRhdGUgPSBkYXRlRnJvbVJhbmdlKHRoaXMucmFuZ2UgJiYgQXJyYXkuaXNBcnJheSh0aGlzLnZhbHVlQXNEYXRlKSA/IHRoaXMudmFsdWVBc0RhdGVbMF0gOiB0aGlzLnZhbHVlQXNEYXRlLCB0aGlzLm1pbkFzRGF0ZSwgdGhpcy5tYXhBc0RhdGUpO1xyXG4gICAgbGV0IGFjdGl2ZURhdGUgPSB0aGlzLmdldEFjdGl2ZURhdGUoZGF0ZSwgdGhpcy5taW5Bc0RhdGUsIHRoaXMubWF4QXNEYXRlKTtcclxuICAgIGNvbnN0IGVuZERhdGUgPSB0aGlzLnJhbmdlICYmIEFycmF5LmlzQXJyYXkodGhpcy52YWx1ZUFzRGF0ZSlcclxuICAgICAgPyBkYXRlRnJvbVJhbmdlKHRoaXMudmFsdWVBc0RhdGVbMV0sIHRoaXMubWluQXNEYXRlLCB0aGlzLm1heEFzRGF0ZSlcclxuICAgICAgOiBudWxsO1xyXG4gICAgY29uc3QgYWN0aXZlRW5kRGF0ZSA9IHRoaXMuZ2V0QWN0aXZlRW5kRGF0ZShlbmREYXRlLCB0aGlzLm1pbkFzRGF0ZSwgdGhpcy5tYXhBc0RhdGUpO1xyXG4gICAgaWYgKCh0aGlzLmFjdGl2ZVJhbmdlID09PSBcImVuZFwiIHx8XHJcbiAgICAgICh0aGlzLmhvdmVyUmFuZ2U/LmZvY3VzZWQgPT09IFwiZW5kXCIgJiYgKCF0aGlzLnByb3hpbWl0eVNlbGVjdGlvbkRpc2FibGVkIHx8IGVuZERhdGUpKSkgJiZcclxuICAgICAgYWN0aXZlRW5kRGF0ZSkge1xyXG4gICAgICBhY3RpdmVEYXRlID0gYWN0aXZlRW5kRGF0ZTtcclxuICAgIH1cclxuICAgIGlmICh0aGlzLnJhbmdlICYmIHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWUpIHtcclxuICAgICAgYWN0aXZlRGF0ZSA9IHRoaXMubW9zdFJlY2VudFJhbmdlVmFsdWU7XHJcbiAgICB9XHJcbiAgICBjb25zdCBtaW5EYXRlID0gdGhpcy5yYW5nZSAmJiB0aGlzLmFjdGl2ZVJhbmdlXHJcbiAgICAgID8gdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJzdGFydFwiXHJcbiAgICAgICAgPyB0aGlzLm1pbkFzRGF0ZVxyXG4gICAgICAgIDogZGF0ZSB8fCB0aGlzLm1pbkFzRGF0ZVxyXG4gICAgICA6IHRoaXMubWluQXNEYXRlO1xyXG4gICAgY29uc3QgbWF4RGF0ZSA9IHRoaXMucmFuZ2UgJiYgdGhpcy5hY3RpdmVSYW5nZVxyXG4gICAgICA/IHRoaXMuYWN0aXZlUmFuZ2UgPT09IFwic3RhcnRcIlxyXG4gICAgICAgID8gZW5kRGF0ZSB8fCB0aGlzLm1heEFzRGF0ZVxyXG4gICAgICAgIDogdGhpcy5tYXhBc0RhdGVcclxuICAgICAgOiB0aGlzLm1heEFzRGF0ZTtcclxuICAgIHJldHVybiAoaChIb3N0LCB7IG9uQmx1cjogdGhpcy5yZXNldCwgb25LZXlEb3duOiB0aGlzLmtleURvd25IYW5kbGVyLCByb2xlOiBcImFwcGxpY2F0aW9uXCIgfSwgdGhpcy5yZW5kZXJDYWxlbmRhcihhY3RpdmVEYXRlLCBtYXhEYXRlLCBtaW5EYXRlLCBkYXRlLCBlbmREYXRlKSkpO1xyXG4gIH1cclxuICBlZmZlY3RpdmVMb2NhbGVDaGFuZ2UoKSB7XHJcbiAgICB1cGRhdGVNZXNzYWdlcyh0aGlzLCB0aGlzLmVmZmVjdGl2ZUxvY2FsZSk7XHJcbiAgfVxyXG4gIHZhbHVlSGFuZGxlcih2YWx1ZSkge1xyXG4gICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBnZXRWYWx1ZUFzRGF0ZVJhbmdlKHZhbHVlKTtcclxuICAgIH1cclxuICAgIGVsc2UgaWYgKHZhbHVlKSB7XHJcbiAgICAgIHRoaXMudmFsdWVBc0RhdGUgPSBkYXRlRnJvbUlTTyh2YWx1ZSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGFzeW5jIGxvYWRMb2NhbGVEYXRhKCkge1xyXG4gICAgbnVtYmVyU3RyaW5nRm9ybWF0dGVyLm51bWJlckZvcm1hdE9wdGlvbnMgPSB7XHJcbiAgICAgIG51bWJlcmluZ1N5c3RlbTogdGhpcy5udW1iZXJpbmdTeXN0ZW0sXHJcbiAgICAgIGxvY2FsZTogdGhpcy5lZmZlY3RpdmVMb2NhbGUsXHJcbiAgICAgIHVzZUdyb3VwaW5nOiBmYWxzZVxyXG4gICAgfTtcclxuICAgIHRoaXMubG9jYWxlRGF0YSA9IGF3YWl0IGdldExvY2FsZURhdGEodGhpcy5lZmZlY3RpdmVMb2NhbGUpO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBSZW5kZXIgY2FsY2l0ZS1kYXRlLXBpY2tlci1tb250aC1oZWFkZXIgYW5kIGNhbGNpdGUtZGF0ZS1waWNrZXItbW9udGhcclxuICAgKlxyXG4gICAqIEBwYXJhbSBhY3RpdmVEYXRlXHJcbiAgICogQHBhcmFtIG1heERhdGVcclxuICAgKiBAcGFyYW0gbWluRGF0ZVxyXG4gICAqIEBwYXJhbSBkYXRlXHJcbiAgICogQHBhcmFtIGVuZERhdGVcclxuICAgKi9cclxuICByZW5kZXJDYWxlbmRhcihhY3RpdmVEYXRlLCBtYXhEYXRlLCBtaW5EYXRlLCBkYXRlLCBlbmREYXRlKSB7XHJcbiAgICByZXR1cm4gKHRoaXMubG9jYWxlRGF0YSAmJiBbXHJcbiAgICAgIGgoXCJjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoLWhlYWRlclwiLCB7IGFjdGl2ZURhdGU6IGFjdGl2ZURhdGUsIGhlYWRpbmdMZXZlbDogdGhpcy5oZWFkaW5nTGV2ZWwgfHwgSEVBRElOR19MRVZFTCwgbG9jYWxlRGF0YTogdGhpcy5sb2NhbGVEYXRhLCBtYXg6IG1heERhdGUsIG1lc3NhZ2VzOiB0aGlzLm1lc3NhZ2VzLCBtaW46IG1pbkRhdGUsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlclNlbGVjdDogdGhpcy5tb250aEhlYWRlclNlbGVjdENoYW5nZSwgc2NhbGU6IHRoaXMuc2NhbGUsIHNlbGVjdGVkRGF0ZTogdGhpcy5hY3RpdmVSYW5nZSA9PT0gXCJlbmRcIiA/IGVuZERhdGUgOiBkYXRlIHx8IG5ldyBEYXRlKCkgfSksXHJcbiAgICAgIGgoXCJjYWxjaXRlLWRhdGUtcGlja2VyLW1vbnRoXCIsIHsgYWN0aXZlRGF0ZTogYWN0aXZlRGF0ZSwgZW5kRGF0ZTogdGhpcy5yYW5nZSA/IGVuZERhdGUgOiB1bmRlZmluZWQsIGhvdmVyUmFuZ2U6IHRoaXMuaG92ZXJSYW5nZSwgbG9jYWxlRGF0YTogdGhpcy5sb2NhbGVEYXRhLCBtYXg6IG1heERhdGUsIG1pbjogbWluRGF0ZSwgb25DYWxjaXRlSW50ZXJuYWxEYXRlUGlja2VyQWN0aXZlRGF0ZUNoYW5nZTogdGhpcy5tb250aEFjdGl2ZURhdGVDaGFuZ2UsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlckhvdmVyOiB0aGlzLm1vbnRoSG92ZXJDaGFuZ2UsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlck1vdXNlT3V0OiB0aGlzLm1vbnRoTW91c2VPdXRDaGFuZ2UsIG9uQ2FsY2l0ZUludGVybmFsRGF0ZVBpY2tlclNlbGVjdDogdGhpcy5tb250aERhdGVDaGFuZ2UsIHNjYWxlOiB0aGlzLnNjYWxlLCBzZWxlY3RlZERhdGU6IHRoaXMuYWN0aXZlUmFuZ2UgPT09IFwiZW5kXCIgPyBlbmREYXRlIDogZGF0ZSwgc3RhcnREYXRlOiB0aGlzLnJhbmdlID8gZGF0ZSA6IHVuZGVmaW5lZCB9KVxyXG4gICAgXSk7XHJcbiAgfVxyXG4gIGdldEVuZERhdGUoKSB7XHJcbiAgICByZXR1cm4gKEFycmF5LmlzQXJyYXkodGhpcy52YWx1ZUFzRGF0ZSkgJiYgdGhpcy52YWx1ZUFzRGF0ZVsxXSkgfHwgdW5kZWZpbmVkO1xyXG4gIH1cclxuICBzZXRFbmREYXRlKGRhdGUpIHtcclxuICAgIGNvbnN0IHN0YXJ0RGF0ZSA9IHRoaXMuZ2V0U3RhcnREYXRlKCk7XHJcbiAgICBjb25zdCBuZXdFbmREYXRlID0gZGF0ZSA/IHNldEVuZE9mRGF5KGRhdGUpIDogZGF0ZTtcclxuICAgIHRoaXMudmFsdWUgPSBbZGF0ZVRvSVNPKHN0YXJ0RGF0ZSksIGRhdGVUb0lTTyhkYXRlKV07XHJcbiAgICB0aGlzLnZhbHVlQXNEYXRlID0gW3N0YXJ0RGF0ZSwgZGF0ZV07XHJcbiAgICB0aGlzLm1vc3RSZWNlbnRSYW5nZVZhbHVlID0gbmV3RW5kRGF0ZTtcclxuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZS5lbWl0KCk7XHJcbiAgICB0aGlzLmFjdGl2ZUVuZERhdGUgPSBkYXRlIHx8IG51bGw7XHJcbiAgfVxyXG4gIGdldFN0YXJ0RGF0ZSgpIHtcclxuICAgIHJldHVybiBBcnJheS5pc0FycmF5KHRoaXMudmFsdWVBc0RhdGUpICYmIHRoaXMudmFsdWVBc0RhdGVbMF07XHJcbiAgfVxyXG4gIHNldFN0YXJ0RGF0ZShkYXRlKSB7XHJcbiAgICBjb25zdCBlbmREYXRlID0gdGhpcy5nZXRFbmREYXRlKCk7XHJcbiAgICB0aGlzLnZhbHVlID0gW2RhdGVUb0lTTyhkYXRlKSwgZGF0ZVRvSVNPKGVuZERhdGUpXTtcclxuICAgIHRoaXMudmFsdWVBc0RhdGUgPSBbZGF0ZSwgZW5kRGF0ZV07XHJcbiAgICB0aGlzLm1vc3RSZWNlbnRSYW5nZVZhbHVlID0gZGF0ZTtcclxuICAgIHRoaXMuY2FsY2l0ZURhdGVQaWNrZXJSYW5nZUNoYW5nZS5lbWl0KCk7XHJcbiAgICB0aGlzLmFjdGl2ZVN0YXJ0RGF0ZSA9IGRhdGUgfHwgbnVsbDtcclxuICB9XHJcbiAgLyoqXHJcbiAgICogR2V0IGFuIGFjdGl2ZSBkYXRlIHVzaW5nIHRoZSB2YWx1ZSwgb3IgY3VycmVudCBkYXRlIGFzIGRlZmF1bHRcclxuICAgKlxyXG4gICAqIEBwYXJhbSB2YWx1ZVxyXG4gICAqIEBwYXJhbSBtaW5cclxuICAgKiBAcGFyYW0gbWF4XHJcbiAgICovXHJcbiAgZ2V0QWN0aXZlRGF0ZSh2YWx1ZSwgbWluLCBtYXgpIHtcclxuICAgIHJldHVybiBkYXRlRnJvbVJhbmdlKHRoaXMuYWN0aXZlRGF0ZSwgbWluLCBtYXgpIHx8IHZhbHVlIHx8IGRhdGVGcm9tUmFuZ2UobmV3IERhdGUoKSwgbWluLCBtYXgpO1xyXG4gIH1cclxuICBnZXRBY3RpdmVFbmREYXRlKHZhbHVlLCBtaW4sIG1heCkge1xyXG4gICAgcmV0dXJuIChkYXRlRnJvbVJhbmdlKHRoaXMuYWN0aXZlRW5kRGF0ZSwgbWluLCBtYXgpIHx8IHZhbHVlIHx8IGRhdGVGcm9tUmFuZ2UobmV3IERhdGUoKSwgbWluLCBtYXgpKTtcclxuICB9XHJcbiAgc3RhdGljIGdldCBkZWxlZ2F0ZXNGb2N1cygpIHsgcmV0dXJuIHRydWU7IH1cclxuICBzdGF0aWMgZ2V0IGFzc2V0c0RpcnMoKSB7IHJldHVybiBbXCJhc3NldHNcIl07IH1cclxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XHJcbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcclxuICAgIFwiYWN0aXZlRGF0ZVwiOiBbXCJhY3RpdmVEYXRlV2F0Y2hlclwiXSxcclxuICAgIFwidmFsdWVBc0RhdGVcIjogW1widmFsdWVBc0RhdGVXYXRjaGVyXCJdLFxyXG4gICAgXCJtaW5cIjogW1wib25NaW5DaGFuZ2VkXCJdLFxyXG4gICAgXCJtYXhcIjogW1wib25NYXhDaGFuZ2VkXCJdLFxyXG4gICAgXCJtZXNzYWdlT3ZlcnJpZGVzXCI6IFtcIm9uTWVzc2FnZXNDaGFuZ2VcIl0sXHJcbiAgICBcImVmZmVjdGl2ZUxvY2FsZVwiOiBbXCJlZmZlY3RpdmVMb2NhbGVDaGFuZ2VcIiwgXCJsb2FkTG9jYWxlRGF0YVwiXSxcclxuICAgIFwidmFsdWVcIjogW1widmFsdWVIYW5kbGVyXCJdXHJcbiAgfTsgfVxyXG59O1xyXG5EYXRlUGlja2VyLnN0eWxlID0gZGF0ZVBpY2tlckNzcztcblxuZXhwb3J0IHsgRGF0ZVBpY2tlciBhcyBjYWxjaXRlX2RhdGVfcGlja2VyIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNhbGNpdGUtZGF0ZS1waWNrZXIuZW50cnkuanMubWFwIiwiaW1wb3J0IHsgbiBhcyBudW1iZXJTdHJpbmdGb3JtYXR0ZXIgfSBmcm9tICcuL2xvY2FsZS1mN2IyZmJiMC5qcyc7XG5cbi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIFNlZSBodHRwczovL2dpdGh1Yi5jb20vRXNyaS9jYWxjaXRlLWNvbXBvbmVudHMvYmxvYi9tYXN0ZXIvTElDRU5TRS5tZCBmb3IgZGV0YWlscy5cbiAqIHYxLjAuNVxuICovXG4vKipcbiAqIENoZWNrIGlmIGRhdGUgaXMgd2l0aGluIGEgbWluIGFuZCBtYXhcbiAqXG4gKiBAcGFyYW0gZGF0ZVxuICogQHBhcmFtIG1pblxuICogQHBhcmFtIG1heFxuICovXG5mdW5jdGlvbiBpblJhbmdlKGRhdGUsIG1pbiwgbWF4KSB7XG4gIGlmICghZGF0ZSkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB0aW1lID0gZGF0ZS5nZXRUaW1lKCk7XG4gIGNvbnN0IGFmdGVyTWluID0gIShtaW4gaW5zdGFuY2VvZiBEYXRlKSB8fCB0aW1lID49IG1pbi5nZXRUaW1lKCk7XG4gIGNvbnN0IGJlZm9yZU1heCA9ICEobWF4IGluc3RhbmNlb2YgRGF0ZSkgfHwgdGltZSA8PSBtYXguZ2V0VGltZSgpO1xuICByZXR1cm4gYWZ0ZXJNaW4gJiYgYmVmb3JlTWF4O1xufVxuLyoqXG4gKiBFbnN1cmVzIGRhdGUgaXMgd2l0aGluIHJhbmdlLFxuICogcmV0dXJucyBtaW4gb3IgbWF4IGlmIG91dCBvZiBib3VuZHNcbiAqXG4gKiBAcGFyYW0gZGF0ZVxuICogQHBhcmFtIG1pblxuICogQHBhcmFtIG1heFxuICovXG5mdW5jdGlvbiBkYXRlRnJvbVJhbmdlKGRhdGUsIG1pbiwgbWF4KSB7XG4gIGlmICghKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSkge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHRpbWUgPSBkYXRlLmdldFRpbWUoKTtcbiAgY29uc3QgYmVmb3JlTWluID0gbWluIGluc3RhbmNlb2YgRGF0ZSAmJiB0aW1lIDwgbWluLmdldFRpbWUoKTtcbiAgY29uc3QgYWZ0ZXJNYXggPSBtYXggaW5zdGFuY2VvZiBEYXRlICYmIHRpbWUgPiBtYXguZ2V0VGltZSgpO1xuICBpZiAoYmVmb3JlTWluKSB7XG4gICAgcmV0dXJuIG1pbjtcbiAgfVxuICBpZiAoYWZ0ZXJNYXgpIHtcbiAgICByZXR1cm4gbWF4O1xuICB9XG4gIHJldHVybiBkYXRlO1xufVxuLyoqXG4gKiBQYXJzZSBhbiBpc284NjAxIHN0cmluZyAoWVlZWS1tbS1kZCkgaW50byBhIHZhbGlkIGRhdGUuXG4gKiBUT0RPOiBoYW5kbGUgdGltZSB3aGVuIHRpbWUgb2YgZGF5IFVJIGlzIGFkZGVkXG4gKlxuICogQHBhcmFtIGlzbzg2MDFcbiAqIEBwYXJhbSBpc0VuZERhdGVcbiAqL1xuZnVuY3Rpb24gZGF0ZUZyb21JU08oaXNvODYwMSwgaXNFbmREYXRlID0gZmFsc2UpIHtcbiAgaWYgKGlzbzg2MDEgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgcmV0dXJuIGlzbzg2MDE7XG4gIH1cbiAgaWYgKCFpc284NjAxIHx8IHR5cGVvZiBpc284NjAxICE9PSBcInN0cmluZ1wiKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgZCA9IGlzbzg2MDEuc3BsaXQoL1s6IFQtXS8pLm1hcChwYXJzZUZsb2F0KTtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKGRbMF0sIChkWzFdIHx8IDEpIC0gMSwgZFsyXSB8fCAxKTtcbiAgZGF0ZS5zZXRGdWxsWWVhcihkWzBdKTtcbiAgaWYgKGlzTmFOKGRhdGUuZ2V0VGltZSgpKSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBJU08gODYwMSBkYXRlOiBcIiR7aXNvODYwMX1cImApO1xuICB9XG4gIGlmIChpc0VuZERhdGUpIHtcbiAgICByZXR1cm4gc2V0RW5kT2ZEYXkoZGF0ZSk7XG4gIH1cbiAgcmV0dXJuIGRhdGU7XG59XG4vKipcbiAqIFBhcnNlIGEgbG9jYWxpemVkIGRhdGUgc3RyaW5nIGludG8gYSB2YWxpZCBEYXRlLlxuICogcmV0dXJuIGZhbHNlIGlmIGRhdGUgaXMgaW52YWxpZCwgb3Igb3V0IG9mIHJhbmdlXG4gKlxuICogQHBhcmFtIHZhbHVlXG4gKiBAcGFyYW0gbG9jYWxlRGF0YVxuICovXG5mdW5jdGlvbiBkYXRlRnJvbUxvY2FsaXplZFN0cmluZyh2YWx1ZSwgbG9jYWxlRGF0YSkge1xuICBpZiAoIWxvY2FsZURhdGEpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBjb25zdCB7IHNlcGFyYXRvciB9ID0gbG9jYWxlRGF0YTtcbiAgY29uc3QgeyBkYXksIG1vbnRoLCB5ZWFyIH0gPSBwYXJzZURhdGVTdHJpbmcodmFsdWUsIGxvY2FsZURhdGEpO1xuICBjb25zdCBkYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGgsIGRheSk7XG4gIGRhdGUuc2V0RnVsbFllYXIoeWVhcik7XG4gIGNvbnN0IHZhbGlkRGF5ID0gZGF5ID4gMDtcbiAgY29uc3QgdmFsaWRNb250aCA9IG1vbnRoID4gLTE7XG4gIGNvbnN0IHZhbGlkRGF0ZSA9ICFpc05hTihkYXRlLmdldFRpbWUoKSk7XG4gIGNvbnN0IHZhbGlkTGVuZ3RoID0gdmFsdWUuc3BsaXQoc2VwYXJhdG9yKS5maWx0ZXIoKGMpID0+IGMpLmxlbmd0aCA+IDI7XG4gIGNvbnN0IHZhbGlkWWVhciA9IHllYXIudG9TdHJpbmcoKS5sZW5ndGggPiAwO1xuICBpZiAodmFsaWREYXkgJiYgdmFsaWRNb250aCAmJiB2YWxpZERhdGUgJiYgdmFsaWRMZW5ndGggJiYgdmFsaWRZZWFyKSB7XG4gICAgcmV0dXJuIGRhdGU7XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59XG4vKipcbiAqIFJldHJpZXZlIGRheSwgbW9udGgsIGFuZCB5ZWFyIHN0cmluZ3MgZnJvbSBhIGxvY2FsaXplZCBzdHJpbmdcbiAqXG4gKiBAcGFyYW0gc3RyaW5nXG4gKiBAcGFyYW0gbG9jYWxlRGF0YVxuICovXG5mdW5jdGlvbiBkYXRlUGFydHNGcm9tTG9jYWxpemVkU3RyaW5nKHN0cmluZywgbG9jYWxlRGF0YSkge1xuICBjb25zdCB7IHNlcGFyYXRvciwgdW5pdE9yZGVyIH0gPSBsb2NhbGVEYXRhO1xuICBjb25zdCBvcmRlciA9IGdldE9yZGVyKHVuaXRPcmRlcik7XG4gIGNvbnN0IHZhbHVlcyA9IHN0cmluZy5zcGxpdChzZXBhcmF0b3IpLm1hcCgocGFydCkgPT4gbnVtYmVyU3RyaW5nRm9ybWF0dGVyLmRlbG9jYWxpemUocGFydCkpO1xuICBjb25zdCBkYXkgPSB2YWx1ZXNbb3JkZXIuaW5kZXhPZihcImRcIildO1xuICBjb25zdCBtb250aCA9IHZhbHVlc1tvcmRlci5pbmRleE9mKFwibVwiKV07XG4gIGNvbnN0IHllYXIgPSB2YWx1ZXNbb3JkZXIuaW5kZXhPZihcInlcIildO1xuICByZXR1cm4geyBkYXksIG1vbnRoLCB5ZWFyIH07XG59XG4vKipcbiAqIFJldHVybiBmaXJzdCBwb3J0aW9uIG9mIElTTyBzdHJpbmcgKFlZWVktbW0tZGQpXG4gKlxuICogQHBhcmFtIGRhdGVcbiAqL1xuZnVuY3Rpb24gZGF0ZVRvSVNPKGRhdGUpIHtcbiAgaWYgKGRhdGUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUuZ2V0VGltZSgpIC0gZGF0ZS5nZXRUaW1lem9uZU9mZnNldCgpICogNjAwMDApLnRvSVNPU3RyaW5nKCkuc3BsaXQoXCJUXCIpWzBdO1xuICB9XG4gIHJldHVybiBcIlwiO1xufVxuLyoqXG4gKiBDaGVjayBpZiB0d28gZGF0ZXMgYXJlIHRoZSBzYW1lIGRheSwgbW9udGgsIHllYXJcbiAqXG4gKiBAcGFyYW0gZDFcbiAqIEBwYXJhbSBkMlxuICovXG5mdW5jdGlvbiBzYW1lRGF0ZShkMSwgZDIpIHtcbiAgcmV0dXJuIChkMSBpbnN0YW5jZW9mIERhdGUgJiZcbiAgICBkMiBpbnN0YW5jZW9mIERhdGUgJiZcbiAgICBkMS5nZXREYXRlKCkgPT09IGQyLmdldERhdGUoKSAmJlxuICAgIGQxLmdldE1vbnRoKCkgPT09IGQyLmdldE1vbnRoKCkgJiZcbiAgICBkMS5nZXRGdWxsWWVhcigpID09PSBkMi5nZXRGdWxsWWVhcigpKTtcbn1cbi8qKlxuICogR2V0IGEgZGF0ZSBvbmUgbW9udGggaW4gdGhlIHBhc3RcbiAqXG4gKiBAcGFyYW0gZGF0ZVxuICovXG5mdW5jdGlvbiBwcmV2TW9udGgoZGF0ZSkge1xuICBjb25zdCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgY29uc3QgbmV4dERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgbmV4dERhdGUuc2V0TW9udGgobW9udGggLSAxKTtcbiAgLy8gZGF0ZSBkb2Vzbid0IGV4aXN0IGluIG5ldyBtb250aCwgdXNlIGxhc3QgZGF5XG4gIGlmIChtb250aCA9PT0gbmV4dERhdGUuZ2V0TW9udGgoKSkge1xuICAgIHJldHVybiBuZXcgRGF0ZShkYXRlLmdldEZ1bGxZZWFyKCksIG1vbnRoLCAwKTtcbiAgfVxuICByZXR1cm4gbmV4dERhdGU7XG59XG4vKipcbiAqIEdldCBhIGRhdGUgb25lIG1vbnRoIGluIHRoZSBmdXR1cmVcbiAqXG4gKiBAcGFyYW0gZGF0ZVxuICovXG5mdW5jdGlvbiBuZXh0TW9udGgoZGF0ZSkge1xuICBjb25zdCBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgY29uc3QgbmV4dERhdGUgPSBuZXcgRGF0ZShkYXRlKTtcbiAgbmV4dERhdGUuc2V0TW9udGgobW9udGggKyAxKTtcbiAgLy8gZGF0ZSBkb2Vzbid0IGV4aXN0IGluIG5ldyBtb250aCwgdXNlIGxhc3QgZGF5XG4gIGlmICgobW9udGggKyAyKSAlIDcgPT09IG5leHREYXRlLmdldE1vbnRoKCkgJSA3KSB7XG4gICAgcmV0dXJuIG5ldyBEYXRlKGRhdGUuZ2V0RnVsbFllYXIoKSwgbW9udGggKyAyLCAwKTtcbiAgfVxuICByZXR1cm4gbmV4dERhdGU7XG59XG4vKipcbiAqIFBhcnNlIG51bWVyaWMgdW5pdHMgZm9yIGRheSwgbW9udGgsIGFuZCB5ZWFyIGZyb20gYSBsb2NhbGl6ZWQgc3RyaW5nXG4gKiBtb250aCBzdGFydHMgYXQgMCAoY2FuIHBhc3MgdG8gZGF0ZSBjb25zdHJ1Y3RvcilcbiAqIGNhbiByZXR1cm4gdmFsdWVzIGFzIG51bWJlciBvciBzdHJpbmdcbiAqXG4gKiBAcGFyYW0gc3RyaW5nXG4gKiBAcGFyYW0gbG9jYWxlRGF0YVxuICovXG5mdW5jdGlvbiBwYXJzZURhdGVTdHJpbmcoc3RyaW5nLCBsb2NhbGVEYXRhKSB7XG4gIGNvbnN0IHsgZGF5LCBtb250aCwgeWVhciB9ID0gZGF0ZVBhcnRzRnJvbUxvY2FsaXplZFN0cmluZyhzdHJpbmcsIGxvY2FsZURhdGEpO1xuICByZXR1cm4ge1xuICAgIGRheTogcGFyc2VJbnQoZGF5KSxcbiAgICBtb250aDogcGFyc2VJbnQobW9udGgpIC0gMSxcbiAgICB5ZWFyOiBwYXJzZUludCh5ZWFyKVxuICB9O1xufVxuLyoqXG4gKiBCYXNlZCBvbiB0aGUgdW5pdE9yZGVyIHN0cmluZywgZmluZCBvcmRlciBvZiBtb250aCwgZGF5LCBhbmQgeWVhciBmb3IgbG9jYWxlXG4gKlxuICogQHBhcmFtIHVuaXRPcmRlclxuICovXG5mdW5jdGlvbiBnZXRPcmRlcih1bml0T3JkZXIpIHtcbiAgY29uc3Qgc2lnbmlmaWVycyA9IFtcImRcIiwgXCJtXCIsIFwieVwiXTtcbiAgY29uc3Qgb3JkZXIgPSB1bml0T3JkZXIudG9Mb3dlckNhc2UoKTtcbiAgcmV0dXJuIHNpZ25pZmllcnMuc29ydCgoYSwgYikgPT4gb3JkZXIuaW5kZXhPZihhKSAtIG9yZGVyLmluZGV4T2YoYikpO1xufVxuLyoqXG4gKiBHZXQgbnVtYmVyIG9mIGRheXMgYmV0d2VlbiB0d28gZGF0ZXNcbiAqXG4gKiBAcGFyYW0gZGF0ZTFcbiAqIEBwYXJhbSBkYXRlMlxuICovXG5mdW5jdGlvbiBnZXREYXlzRGlmZihkYXRlMSwgZGF0ZTIpIHtcbiAgY29uc3QgdHMxID0gZGF0ZTEuZ2V0VGltZSgpO1xuICBjb25zdCB0czIgPSBkYXRlMi5nZXRUaW1lKCk7XG4gIHJldHVybiAodHMxIC0gdHMyKSAvICgxMDAwICogMzYwMCAqIDI0KTtcbn1cbi8qKlxuICogU2V0IHRpbWUgb2YgdGhlIGRheSB0byB0aGUgZW5kLlxuICpcbiAqIEBwYXJhbSB7RGF0ZX0gZGF0ZSBEYXRlLlxuICogQHJldHVybnMge0RhdGV9IERhdGUgd2l0aCB0aW1lIHNldCB0byBlbmQgb2YgZGF5IC5cbiAqL1xuZnVuY3Rpb24gc2V0RW5kT2ZEYXkoZGF0ZSkge1xuICBkYXRlLnNldEhvdXJzKDIzLCA1OSwgNTksIDk5OSk7XG4gIHJldHVybiBkYXRlO1xufVxuXG5leHBvcnQgeyBkYXRlRnJvbUxvY2FsaXplZFN0cmluZyBhcyBhLCBkYXRlVG9JU08gYXMgYiwgZGF0ZUZyb21JU08gYXMgYywgZGF0ZVBhcnRzRnJvbUxvY2FsaXplZFN0cmluZyBhcyBkLCBkYXRlRnJvbVJhbmdlIGFzIGUsIHNhbWVEYXRlIGFzIGYsIGdldERheXNEaWZmIGFzIGcsIGdldE9yZGVyIGFzIGgsIGluUmFuZ2UgYXMgaSwgbmV4dE1vbnRoIGFzIG4sIHByZXZNb250aCBhcyBwLCBzZXRFbmRPZkRheSBhcyBzIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWRhdGUtZDdmYmY3ZmQuanMubWFwIiwiaW1wb3J0IHsgYSBhcyBnZXRBc3NldFBhdGggfSBmcm9tICcuL2luZGV4LTRlNjQ3NDExLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0U3VwcG9ydGVkTG9jYWxlIH0gZnJvbSAnLi9sb2NhbGUtZjdiMmZiYjAuanMnO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuY29uc3QgY29tcG9uZW50TGFuZ1RvTWVzc2FnZUJ1bmRsZUNhY2hlID0ge307XG5hc3luYyBmdW5jdGlvbiBnZXRNZXNzYWdlQnVuZGxlKGxhbmcsIGNvbXBvbmVudCkge1xuICBjb25zdCBrZXkgPSBgJHtjb21wb25lbnR9XyR7bGFuZ31gO1xuICBpZiAoY29tcG9uZW50TGFuZ1RvTWVzc2FnZUJ1bmRsZUNhY2hlW2tleV0pIHtcbiAgICByZXR1cm4gY29tcG9uZW50TGFuZ1RvTWVzc2FnZUJ1bmRsZUNhY2hlW2tleV07XG4gIH1cbiAgY29tcG9uZW50TGFuZ1RvTWVzc2FnZUJ1bmRsZUNhY2hlW2tleV0gPSBmZXRjaChnZXRBc3NldFBhdGgoYC4vYXNzZXRzLyR7Y29tcG9uZW50fS90OW4vbWVzc2FnZXNfJHtsYW5nfS5qc29uYCkpXG4gICAgLnRoZW4oKHJlc3ApID0+IHtcbiAgICBpZiAoIXJlc3Aub2spIHtcbiAgICAgIHRocm93TWVzc2FnZUZldGNoRXJyb3IoKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3AuanNvbigpO1xuICB9KVxuICAgIC5jYXRjaCgoKSA9PiB0aHJvd01lc3NhZ2VGZXRjaEVycm9yKCkpO1xuICByZXR1cm4gY29tcG9uZW50TGFuZ1RvTWVzc2FnZUJ1bmRsZUNhY2hlW2tleV07XG59XG5mdW5jdGlvbiB0aHJvd01lc3NhZ2VGZXRjaEVycm9yKCkge1xuICB0aHJvdyBuZXcgRXJyb3IoXCJjb3VsZCBub3QgZmV0Y2ggY29tcG9uZW50IG1lc3NhZ2UgYnVuZGxlXCIpO1xufVxuZnVuY3Rpb24gbWVyZ2VNZXNzYWdlcyhjb21wb25lbnQpIHtcbiAgY29tcG9uZW50Lm1lc3NhZ2VzID0ge1xuICAgIC4uLmNvbXBvbmVudC5kZWZhdWx0TWVzc2FnZXMsXG4gICAgLi4uY29tcG9uZW50Lm1lc3NhZ2VPdmVycmlkZXNcbiAgfTtcbn1cbi8qKlxuICogVGhpcyB1dGlsaXR5IHNldHMgdXAgdGhlIG1lc3NhZ2VzIHVzZWQgYnkgdGhlIGNvbXBvbmVudC4gSXQgc2hvdWxkIGJlIGF3YWl0ZWQgaW4gdGhlIGBjb21wb25lbnRXaWxsTG9hZGAgbGlmZWN5Y2xlIGhvb2suXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICovXG5hc3luYyBmdW5jdGlvbiBzZXRVcE1lc3NhZ2VzKGNvbXBvbmVudCkge1xuICBjb21wb25lbnQuZGVmYXVsdE1lc3NhZ2VzID0gYXdhaXQgZmV0Y2hNZXNzYWdlcyhjb21wb25lbnQsIGNvbXBvbmVudC5lZmZlY3RpdmVMb2NhbGUpO1xuICBtZXJnZU1lc3NhZ2VzKGNvbXBvbmVudCk7XG59XG5hc3luYyBmdW5jdGlvbiBmZXRjaE1lc3NhZ2VzKGNvbXBvbmVudCwgbGFuZykge1xuICBjb25zdCB7IGVsIH0gPSBjb21wb25lbnQ7XG4gIGNvbnN0IHRhZyA9IGVsLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgY29tcG9uZW50TmFtZSA9IHRhZy5yZXBsYWNlKFwiY2FsY2l0ZS1cIiwgXCJcIik7XG4gIHJldHVybiBnZXRNZXNzYWdlQnVuZGxlKGdldFN1cHBvcnRlZExvY2FsZShsYW5nLCBcInQ5blwiKSwgY29tcG9uZW50TmFtZSk7XG59XG4vKipcbiAqIFRoaXMgdXRpbGl0eSBtdXN0IGJlIHNldCB1cCBmb3IgdGhlIGNvbXBvbmVudCB0byB1cGRhdGUgaXRzIGRlZmF1bHQgbWVzc2FnZSBidW5kbGUgaWYgdGhlIGxvY2FsZSBjaGFuZ2VzLlxuICpcbiAqIEl0IGNhbiBiZSBzZXQgdXAgaW4gKiplaXRoZXIqKiBvZiB0aGUgZm9sbG93aW5nIHdheXM6XG4gKlxuICogMS4gY2FsbGVkIGZyb20gYExvY2FsaXplZENvbXBvbmVudGAncyBgb25Mb2NhbGVDaGFuZ2VgIG1ldGhvZCBvclxuICogMi4gY2FsbGVkIGZyb20gYSB3YXRjaGVyIGNvbmZpZ3VyZWQgdG8gd2F0Y2ggYExvY2FsaXplZENvbXBvbmVudGAncyBgZWZmZWN0aXZlTG9jYWxlYCBwcm9wXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICogQHBhcmFtIGxhbmdcbiAqL1xuYXN5bmMgZnVuY3Rpb24gdXBkYXRlTWVzc2FnZXMoY29tcG9uZW50LCBsYW5nKSB7XG4gIGNvbXBvbmVudC5kZWZhdWx0TWVzc2FnZXMgPSBhd2FpdCBmZXRjaE1lc3NhZ2VzKGNvbXBvbmVudCwgbGFuZyk7XG4gIG1lcmdlTWVzc2FnZXMoY29tcG9uZW50KTtcbn1cbi8qKlxuICogVGhpcyB1dGlsaXR5IHNldHMgdXAgaW50ZXJuYWxzIGZvciBtZXNzYWdlcyBzdXBwb3J0LlxuICpcbiAqIEl0IG5lZWRzIHRvIGJlIGNhbGxlZCBpbiBgY29ubmVjdGVkQ2FsbGJhY2tgXG4gKlxuICogKipOb3RlKio6IHRoaXMgbXVzdCBiZSBjYWxsZWQgYWZ0ZXIgYExvY2FsaXplZENvbXBvbmVudGAncyBgY29ubmVjdExvY2FsaXplZGAgbWV0aG9kLlxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqL1xuZnVuY3Rpb24gY29ubmVjdE1lc3NhZ2VzKGNvbXBvbmVudCkge1xuICBjb21wb25lbnQub25NZXNzYWdlc0NoYW5nZSA9IGRlZmF1bHRPbk1lc3NhZ2VzQ2hhbmdlO1xufVxuLyoqXG4gKiBUaGlzIHV0aWxpdHkgdGVhcnMgZG93biBpbnRlcm5hbHMgZm9yIG1lc3NhZ2VzIHN1cHBvcnQuXG4gKlxuICogSXQgbmVlZHMgdG8gYmUgY2FsbGVkIGluIGBkaXNjb25uZWN0ZWRDYWxsYmFja2BcbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKi9cbmZ1bmN0aW9uIGRpc2Nvbm5lY3RNZXNzYWdlcyhjb21wb25lbnQpIHtcbiAgY29tcG9uZW50Lm9uTWVzc2FnZXNDaGFuZ2UgPSB1bmRlZmluZWQ7XG59XG5mdW5jdGlvbiBkZWZhdWx0T25NZXNzYWdlc0NoYW5nZSgpIHtcbiAgbWVyZ2VNZXNzYWdlcyh0aGlzKTtcbn1cblxuZXhwb3J0IHsgY29ubmVjdE1lc3NhZ2VzIGFzIGMsIGRpc2Nvbm5lY3RNZXNzYWdlcyBhcyBkLCBzZXRVcE1lc3NhZ2VzIGFzIHMsIHVwZGF0ZU1lc3NhZ2VzIGFzIHUgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dDluLWRjNjdhYjk2LmpzLm1hcCIsImltcG9ydCB7IGEgYXMgZ2V0QXNzZXRQYXRoIH0gZnJvbSAnLi9pbmRleC00ZTY0NzQxMS5qcyc7XG5pbXBvcnQgeyBjIGFzIGRhdGVGcm9tSVNPIH0gZnJvbSAnLi9kYXRlLWQ3ZmJmN2ZkLmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0U3VwcG9ydGVkTG9jYWxlIH0gZnJvbSAnLi9sb2NhbGUtZjdiMmZiYjAuanMnO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuLyoqXG4gKiBDTERSIGNhY2hlLlxuICogRXhwb3J0ZWQgZm9yIHRlc3RpbmcgcHVycG9zZXMuXG4gKlxuICogQHByaXZhdGVcbiAqL1xuY29uc3QgdHJhbnNsYXRpb25DYWNoZSA9IHt9O1xuLyoqXG4gKiBDTERSIHJlcXVlc3QgY2FjaGUuXG4gKiBFeHBvcnRlZCBmb3IgdGVzdGluZyBwdXJwb3Nlcy5cbiAqXG4gKiBAcHJpdmF0ZVxuICovXG5jb25zdCByZXF1ZXN0Q2FjaGUgPSB7fTtcbi8qKlxuICogRmV0Y2ggY2FsZW5kYXIgZGF0YSBmb3IgYSBnaXZlbiBsb2NhbGUgZnJvbSBsaXN0IG9mIHN1cHBvcnRlZCBsYW5ndWFnZXNcbiAqXG4gKiBAcGFyYW0gbGFuZ1xuICogQHB1YmxpY1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRMb2NhbGVEYXRhKGxhbmcpIHtcbiAgY29uc3QgbG9jYWxlID0gZ2V0U3VwcG9ydGVkTG9jYWxlKGxhbmcpO1xuICBpZiAodHJhbnNsYXRpb25DYWNoZVtsb2NhbGVdKSB7XG4gICAgcmV0dXJuIHRyYW5zbGF0aW9uQ2FjaGVbbG9jYWxlXTtcbiAgfVxuICBpZiAoIXJlcXVlc3RDYWNoZVtsb2NhbGVdKSB7XG4gICAgcmVxdWVzdENhY2hlW2xvY2FsZV0gPSBmZXRjaChnZXRBc3NldFBhdGgoYC4vYXNzZXRzL2RhdGUtcGlja2VyL25scy8ke2xvY2FsZX0uanNvbmApKVxuICAgICAgLnRoZW4oKHJlc3ApID0+IHJlc3AuanNvbigpKVxuICAgICAgLmNhdGNoKCgpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYFRyYW5zbGF0aW9ucyBmb3IgXCIke2xvY2FsZX1cIiBub3QgZm91bmQgb3IgaW52YWxpZCwgZmFsbGluZyBiYWNrIHRvIGVuZ2xpc2hgKTtcbiAgICAgIHJldHVybiBnZXRMb2NhbGVEYXRhKFwiZW5cIik7XG4gICAgfSk7XG4gIH1cbiAgY29uc3QgZGF0YSA9IGF3YWl0IHJlcXVlc3RDYWNoZVtsb2NhbGVdO1xuICB0cmFuc2xhdGlvbkNhY2hlW2xvY2FsZV0gPSBkYXRhO1xuICByZXR1cm4gZGF0YTtcbn1cbi8qKlxuICogIE1hcHMgdmFsdWUgdG8gdmFsdWVBc0RhdGVcbiAqXG4gKiBAcGFyYW0gdmFsdWVcbiAqL1xuZnVuY3Rpb24gZ2V0VmFsdWVBc0RhdGVSYW5nZSh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUubWFwKCh2LCBpbmRleCkgPT4gZGF0ZUZyb21JU08odiwgaW5kZXggPT09IDEpKTtcbn1cblxuZXhwb3J0IHsgZ2V0TG9jYWxlRGF0YSBhcyBhLCBnZXRWYWx1ZUFzRGF0ZVJhbmdlIGFzIGcgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dXRpbHMtYjRmOTVjMjcuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9