"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_ba-infographic_node_modules_arcgis_business-analyst-components_dis-7e0a0d"],{

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-tooltip_3.entry.js":
/*!********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/calcite-tooltip_3.entry.js ***!
  \********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   calcite_tooltip: () => (/* binding */ Tooltip),
/* harmony export */   calcite_tree: () => (/* binding */ Tree),
/* harmony export */   calcite_tree_item: () => (/* binding */ TreeItem)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-f1ee4d04.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/dom-f1ee4d04.js");
/* harmony import */ var _floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./floating-ui-f29517e7.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/floating-ui-f29517e7.js");
/* harmony import */ var _guid_88a3729f_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./guid-88a3729f.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/guid-88a3729f.js");
/* harmony import */ var _openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./openCloseComponent-7d58834c.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/openCloseComponent-7d58834c.js");
/* harmony import */ var _conditionalSlot_a4837caf_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./conditionalSlot-a4837caf.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/conditionalSlot-a4837caf.js");
/* harmony import */ var _interactive_29995522_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./interactive-29995522.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/interactive-29995522.js");
/* harmony import */ var _resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./resources-48436eea.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/resources-48436eea.js");












/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const CSS$1 = {
  container: "container",
  arrow: "arrow"
};
const TOOLTIP_DELAY_MS = 500;
const ARIA_DESCRIBED_BY = "aria-describedby";

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
function getEffectiveReferenceElement(tooltip) {
  const { referenceElement } = tooltip;
  return ((typeof referenceElement === "string" ? (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.q)(tooltip, { id: referenceElement }) : referenceElement) ||
    null);
}

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
class TooltipManager {
  constructor() {
    // --------------------------------------------------------------------------
    //
    //  Private Properties
    //
    // --------------------------------------------------------------------------
    this.registeredElements = new WeakMap();
    this.hoverTimeout = null;
    this.registeredElementCount = 0;
    // --------------------------------------------------------------------------
    //
    //  Private Methods
    //
    // --------------------------------------------------------------------------
    this.queryTooltip = (composedPath) => {
      const { registeredElements } = this;
      const registeredElement = composedPath.find((pathEl) => registeredElements.has(pathEl));
      return registeredElements.get(registeredElement);
    };
    this.keyDownHandler = (event) => {
      if (event.key === "Escape" && !event.defaultPrevented) {
        const { activeTooltipEl } = this;
        if (activeTooltipEl && activeTooltipEl.open) {
          this.clearHoverTimeout();
          this.toggleTooltip(activeTooltipEl, false);
          const referenceElement = getEffectiveReferenceElement(activeTooltipEl);
          if (referenceElement instanceof Element && referenceElement.contains(event.target)) {
            event.preventDefault();
          }
        }
      }
    };
    this.queryHoveredTooltip = (composedPath) => {
      const { activeTooltipEl } = this;
      if (activeTooltipEl && composedPath.includes(activeTooltipEl)) {
        this.clearHoverTimeout();
        return;
      }
      const tooltip = this.queryTooltip(composedPath);
      if (tooltip) {
        this.toggleHoveredTooltip(tooltip, true);
      }
      else if (activeTooltipEl) {
        this.toggleHoveredTooltip(activeTooltipEl, false);
      }
    };
    this.pointerMoveHandler = (event) => {
      const composedPath = event.composedPath();
      this.clearHoverTimeout();
      this.hoverTimeout = window.setTimeout(() => this.queryHoveredTooltip(composedPath), TOOLTIP_DELAY_MS );
    };
    this.pointerDownHandler = (event) => {
      if (!(0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.i)(event)) {
        return;
      }
      const clickedTooltip = this.queryTooltip(event.composedPath());
      this.clickedTooltip = clickedTooltip;
      if (clickedTooltip?.closeOnClick) {
        this.toggleTooltip(clickedTooltip, false);
        this.clearHoverTimeout();
      }
    };
    this.focusInHandler = (event) => {
      this.queryFocusedTooltip(event, true);
    };
    this.focusOutHandler = (event) => {
      this.queryFocusedTooltip(event, false);
    };
    this.toggleHoveredTooltip = (tooltip, value) => {
      if (value) {
        this.closeExistingTooltip();
      }
      this.toggleTooltip(tooltip, value);
    };
  }
  // --------------------------------------------------------------------------
  //
  //  Public Methods
  //
  // --------------------------------------------------------------------------
  registerElement(referenceEl, tooltip) {
    this.registeredElementCount++;
    this.registeredElements.set(referenceEl, tooltip);
    if (this.registeredElementCount === 1) {
      this.addListeners();
    }
  }
  unregisterElement(referenceEl) {
    if (this.registeredElements.delete(referenceEl)) {
      this.registeredElementCount--;
    }
    if (this.registeredElementCount === 0) {
      this.removeListeners();
    }
  }
  addListeners() {
    document.addEventListener("keydown", this.keyDownHandler, { capture: true });
    document.addEventListener("pointermove", this.pointerMoveHandler, { capture: true });
    document.addEventListener("pointerdown", this.pointerDownHandler, { capture: true });
    document.addEventListener("focusin", this.focusInHandler, { capture: true });
    document.addEventListener("focusout", this.focusOutHandler, { capture: true });
  }
  removeListeners() {
    document.removeEventListener("keydown", this.keyDownHandler, { capture: true });
    document.removeEventListener("pointermove", this.pointerMoveHandler, { capture: true });
    document.removeEventListener("pointerdown", this.pointerDownHandler, { capture: true });
    document.removeEventListener("focusin", this.focusInHandler, { capture: true });
    document.removeEventListener("focusout", this.focusOutHandler, { capture: true });
  }
  clearHoverTimeout() {
    window.clearTimeout(this.hoverTimeout);
  }
  closeExistingTooltip() {
    const { activeTooltipEl } = this;
    if (activeTooltipEl) {
      this.toggleTooltip(activeTooltipEl, false);
    }
  }
  toggleFocusedTooltip(tooltip, value) {
    this.closeExistingTooltip();
    if (value) {
      this.clearHoverTimeout();
    }
    this.toggleTooltip(tooltip, value);
  }
  toggleTooltip(tooltip, value) {
    tooltip.open = value;
    if (value) {
      this.activeTooltipEl = tooltip;
    }
  }
  queryFocusedTooltip(event, value) {
    const tooltip = this.queryTooltip(event.composedPath());
    if (!tooltip || tooltip === this.clickedTooltip) {
      this.clickedTooltip = null;
      return;
    }
    this.toggleFocusedTooltip(tooltip, value);
  }
}

const tooltipCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{--calcite-floating-ui-z-index:var(--calcite-tooltip-z-index, 901);display:block;position:absolute;z-index:var(--calcite-floating-ui-z-index)}.calcite-floating-ui-anim{position:relative;transition:var(--calcite-floating-ui-transition);transition-property:transform, visibility, opacity;opacity:0;box-shadow:0 0 16px 0 rgba(0, 0, 0, 0.16);z-index:1;border-radius:0.25rem}:host([data-placement^=bottom]) .calcite-floating-ui-anim{transform:translateY(-5px)}:host([data-placement^=top]) .calcite-floating-ui-anim{transform:translateY(5px)}:host([data-placement^=left]) .calcite-floating-ui-anim{transform:translateX(5px)}:host([data-placement^=right]) .calcite-floating-ui-anim{transform:translateX(-5px)}:host([data-placement]) .calcite-floating-ui-anim--active{opacity:1;transform:translate(0)}:host([calcite-hydrated-hidden]){visibility:hidden !important;pointer-events:none}.arrow,.arrow::before{position:absolute;inline-size:8px;block-size:8px;z-index:-1}.arrow::before{content:\"\";--tw-shadow:0 4px 8px -1px rgba(0, 0, 0, 0.08), 0 2px 4px -1px rgba(0, 0, 0, 0.04);--tw-shadow-colored:0 4px 8px -1px var(--tw-shadow-color), 0 2px 4px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow, 0 0 #0000), var(--tw-ring-shadow, 0 0 #0000), var(--tw-shadow);transform:rotate(45deg);background:var(--calcite-ui-foreground-1)}:host([data-placement^=top]) .arrow{inset-block-end:-4px}:host([data-placement^=bottom]) .arrow{inset-block-start:-4px}:host([data-placement^=right]) .arrow,:host([data-placement^=left]) .arrow{direction:ltr;text-align:start}:host([data-placement^=left]) .arrow{inset-inline-end:-4px}:host([data-placement^=right]) .arrow{inset-inline-start:-4px}.container{position:relative;overflow:hidden;border-radius:0.25rem;background-color:var(--calcite-ui-foreground-1);padding-block:0.75rem;padding-inline:1rem;font-size:var(--calcite-font-size--2);line-height:1.375;font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1);max-inline-size:20rem;max-block-size:20rem;text-align:start}.calcite-floating-ui-anim{border-radius:0.25rem;border-width:1px;border-style:solid;border-color:var(--calcite-ui-border-3);background-color:var(--calcite-ui-foreground-1)}.arrow::before{outline:1px solid var(--calcite-ui-border-3)}";

const manager = new TooltipManager();
const Tooltip = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.r)(this, hostRef);
    this.calciteTooltipBeforeClose = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipBeforeClose", 6);
    this.calciteTooltipClose = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipClose", 6);
    this.calciteTooltipBeforeOpen = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipBeforeOpen", 6);
    this.calciteTooltipOpen = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTooltipOpen", 6);
    this.guid = `calcite-tooltip-${(0,_guid_88a3729f_js__WEBPACK_IMPORTED_MODULE_2__.g)()}`;
    this.hasLoaded = false;
    this.openTransitionProp = "opacity";
    this.setTransitionEl = (el) => {
      this.transitionEl = el;
      (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    };
    this.setUpReferenceElement = (warn = true) => {
      this.removeReferences();
      this.effectiveReferenceElement = getEffectiveReferenceElement(this.el);
      (0,_floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.c)(this, this.effectiveReferenceElement, this.el);
      const { el, referenceElement, effectiveReferenceElement } = this;
      if (warn && referenceElement && !effectiveReferenceElement) {
        console.warn(`${el.tagName}: reference-element id "${referenceElement}" was not found.`, {
          el
        });
      }
      this.addReferences();
    };
    this.getId = () => {
      return this.el.id || this.guid;
    };
    this.addReferences = () => {
      const { effectiveReferenceElement } = this;
      if (!effectiveReferenceElement) {
        return;
      }
      const id = this.getId();
      if ("setAttribute" in effectiveReferenceElement) {
        effectiveReferenceElement.setAttribute(ARIA_DESCRIBED_BY, id);
      }
      manager.registerElement(effectiveReferenceElement, this.el);
    };
    this.removeReferences = () => {
      const { effectiveReferenceElement } = this;
      if (!effectiveReferenceElement) {
        return;
      }
      if ("removeAttribute" in effectiveReferenceElement) {
        effectiveReferenceElement.removeAttribute(ARIA_DESCRIBED_BY);
      }
      manager.unregisterElement(effectiveReferenceElement);
    };
    this.closeOnClick = false;
    this.label = undefined;
    this.offsetDistance = _floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.b;
    this.offsetSkidding = 0;
    this.open = false;
    this.overlayPositioning = "absolute";
    this.placement = "auto";
    this.referenceElement = undefined;
    this.effectiveReferenceElement = undefined;
  }
  offsetDistanceOffsetHandler() {
    this.reposition(true);
  }
  offsetSkiddingHandler() {
    this.reposition(true);
  }
  openHandler(value) {
    if (value) {
      this.reposition(true);
    }
    else {
      (0,_floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.u)(this.el);
    }
  }
  overlayPositioningHandler() {
    this.reposition(true);
  }
  placementHandler() {
    this.reposition(true);
  }
  referenceElementHandler() {
    this.setUpReferenceElement();
  }
  // --------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  // --------------------------------------------------------------------------
  connectedCallback() {
    (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.c)(this);
    this.setUpReferenceElement(this.hasLoaded);
  }
  componentDidLoad() {
    if (this.referenceElement && !this.effectiveReferenceElement) {
      this.setUpReferenceElement();
    }
    this.reposition(true);
    this.hasLoaded = true;
  }
  disconnectedCallback() {
    this.removeReferences();
    (0,_floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.a)(this, this.effectiveReferenceElement, this.el);
    (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.d)(this);
  }
  // --------------------------------------------------------------------------
  //
  //  Public Methods
  //
  // --------------------------------------------------------------------------
  /**
   * Updates the position of the component.
   *
   * @param delayed
   */
  async reposition(delayed = false) {
    const { el, effectiveReferenceElement, placement, overlayPositioning, offsetDistance, offsetSkidding, arrowEl } = this;
    return (0,_floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.r)(this, {
      floatingEl: el,
      referenceEl: effectiveReferenceElement,
      overlayPositioning,
      placement,
      offsetDistance,
      offsetSkidding,
      includeArrow: true,
      arrowEl,
      type: "tooltip"
    }, delayed);
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  // --------------------------------------------------------------------------
  onBeforeOpen() {
    this.calciteTooltipBeforeOpen.emit();
  }
  onOpen() {
    this.calciteTooltipOpen.emit();
  }
  onBeforeClose() {
    this.calciteTooltipBeforeClose.emit();
  }
  onClose() {
    this.calciteTooltipClose.emit();
  }
  // --------------------------------------------------------------------------
  //
  //  Render Methods
  //
  // --------------------------------------------------------------------------
  render() {
    const { effectiveReferenceElement, label, open } = this;
    const displayed = effectiveReferenceElement && open;
    const hidden = !displayed;
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.H, { "aria-hidden": (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.t)(hidden), "aria-label": label, "aria-live": "polite", "calcite-hydrated-hidden": hidden, id: this.getId(), role: "tooltip" }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: {
        [_floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.F.animation]: true,
        [_floating_ui_f29517e7_js__WEBPACK_IMPORTED_MODULE_4__.F.animationActive]: displayed
      }, ref: this.setTransitionEl }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: CSS$1.arrow, ref: (arrowEl) => (this.arrowEl = arrowEl) }), (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: CSS$1.container }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", null)))));
  }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.g)(this); }
  static get watchers() { return {
    "offsetDistance": ["offsetDistanceOffsetHandler"],
    "offsetSkidding": ["offsetSkiddingHandler"],
    "open": ["openHandler"],
    "overlayPositioning": ["overlayPositioningHandler"],
    "placement": ["placementHandler"],
    "referenceElement": ["referenceElementHandler"]
  }; }
};
Tooltip.style = tooltipCss;

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
function isTreeItem(element) {
  return element?.matches("calcite-tree-item");
}
function getEnabledSiblingItem(el, direction) {
  const directionProp = direction === "down" ? "nextElementSibling" : "previousElementSibling";
  let currentEl = el;
  let enabledEl = null;
  while (isTreeItem(currentEl)) {
    if (!currentEl.disabled) {
      enabledEl = currentEl;
      break;
    }
    currentEl = currentEl[directionProp];
  }
  return enabledEl;
}

const treeCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host{display:block}:host(:focus){outline:2px solid transparent;outline-offset:2px}";

const Tree = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.r)(this, hostRef);
    this.calciteTreeSelect = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteTreeSelect", 6);
    this.lines = false;
    this.child = undefined;
    this.scale = "m";
    this.selectionMode = "single";
    this.selectedItems = [];
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  componentWillRender() {
    const parent = this.el.parentElement?.closest("calcite-tree");
    this.lines = parent ? parent.lines : this.lines;
    this.scale = parent ? parent.scale : this.scale;
    this.selectionMode = parent ? parent.selectionMode : this.selectionMode;
    this.child = !!parent;
  }
  render() {
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.H, { "aria-multiselectable": this.child
        ? undefined
        : (this.selectionMode === "multiple" || this.selectionMode === "multichildren").toString(), role: !this.child ? "tree" : undefined, tabIndex: this.getRootTabIndex() }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", null)));
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  onFocus() {
    if (!this.child) {
      const focusTarget = this.el.querySelector("calcite-tree-item[selected]:not([disabled])") || this.el.querySelector("calcite-tree-item:not([disabled])");
      (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.h)(focusTarget);
    }
  }
  onFocusIn(event) {
    const focusedFromRootOrOutsideTree = event.relatedTarget === this.el || !this.el.contains(event.relatedTarget);
    if (focusedFromRootOrOutsideTree) {
      // gives user the ability to tab into external elements (modifying tabindex property will not work in firefox)
      this.el.removeAttribute("tabindex");
    }
  }
  onFocusOut(event) {
    const willFocusOutsideTree = !this.el.contains(event.relatedTarget);
    if (willFocusOutsideTree) {
      this.el.tabIndex = this.getRootTabIndex();
    }
  }
  onClick(event) {
    const target = event.target;
    const childItems = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(target.querySelectorAll("calcite-tree-item"));
    if (this.child) {
      return;
    }
    if (!this.child) {
      event.preventDefault();
      event.stopPropagation();
    }
    if (this.selectionMode === "ancestors" && !this.child) {
      this.updateAncestorTree(event);
      return;
    }
    const isNoneSelectionMode = this.selectionMode === "none";
    const shouldSelect = this.selectionMode !== null &&
      (!target.hasChildren ||
        (target.hasChildren &&
          (this.selectionMode === "children" || this.selectionMode === "multichildren")));
    const shouldModifyToCurrentSelection = !isNoneSelectionMode &&
      event.detail.modifyCurrentSelection &&
      (this.selectionMode === "multiple" || this.selectionMode === "multichildren");
    const shouldSelectChildren = this.selectionMode === "multichildren" || this.selectionMode === "children";
    const shouldClearCurrentSelection = !shouldModifyToCurrentSelection &&
      (((this.selectionMode === "single" || this.selectionMode === "multiple") &&
        childItems.length <= 0) ||
        this.selectionMode === "children" ||
        this.selectionMode === "multichildren");
    const shouldExpandTarget = this.selectionMode === "children" || this.selectionMode === "multichildren";
    if (!this.child) {
      const targetItems = [];
      if (shouldSelect) {
        targetItems.push(target);
      }
      if (shouldSelectChildren) {
        childItems.forEach((treeItem) => {
          targetItems.push(treeItem);
        });
      }
      if (shouldClearCurrentSelection) {
        const selectedItems = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.querySelectorAll("calcite-tree-item[selected]"));
        selectedItems.forEach((treeItem) => {
          if (!targetItems.includes(treeItem)) {
            treeItem.selected = false;
          }
        });
      }
      if (shouldExpandTarget && !event.detail.forceToggle) {
        target.expanded = true;
      }
      if (shouldModifyToCurrentSelection) {
        window.getSelection().removeAllRanges();
      }
      if ((shouldModifyToCurrentSelection && target.selected) ||
        (shouldSelectChildren && event.detail.forceToggle)) {
        targetItems.forEach((treeItem) => {
          if (!treeItem.disabled) {
            treeItem.selected = false;
          }
        });
      }
      else if (!isNoneSelectionMode) {
        targetItems.forEach((treeItem) => {
          if (!treeItem.disabled) {
            treeItem.selected = true;
          }
        });
      }
    }
    this.selectedItems = isNoneSelectionMode
      ? [target]
      : (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.querySelectorAll("calcite-tree-item")).filter((i) => i.selected);
    this.calciteTreeSelect.emit();
    event.stopPropagation();
  }
  keyDownHandler(event) {
    const root = this.el.closest("calcite-tree:not([child])");
    const target = event.target;
    if (!(root === this.el && target.tagName === "CALCITE-TREE-ITEM" && this.el.contains(target))) {
      return;
    }
    if (event.key === "ArrowDown") {
      const next = getEnabledSiblingItem(target.nextElementSibling, "down");
      if (next) {
        next.focus();
        event.preventDefault();
      }
      return;
    }
    if (event.key === "ArrowUp") {
      const previous = getEnabledSiblingItem(target.previousElementSibling, "up");
      if (previous) {
        previous.focus();
        event.preventDefault();
      }
    }
    if (event.key === "ArrowLeft" && !target.disabled) {
      // When focus is on an open node, closes the node.
      if (target.hasChildren && target.expanded) {
        target.expanded = false;
        event.preventDefault();
        return;
      }
      // When focus is on a child node that is also either an end node or a closed node, moves focus to its parent node.
      const parentItem = target.parentElement.closest("calcite-tree-item");
      if (parentItem && (!target.hasChildren || target.expanded === false)) {
        parentItem.focus();
        event.preventDefault();
        return;
      }
      // When focus is on a root node that is also either an end node or a closed node, does nothing.
      return;
    }
    if (event.key === "ArrowRight" && !target.disabled) {
      if (target.hasChildren) {
        if (target.expanded && (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.u)(this.el).activeElement === target) {
          // When focus is on an open node, moves focus to the first child node.
          getEnabledSiblingItem(target.querySelector("calcite-tree-item"), "down")?.focus();
          event.preventDefault();
        }
        else {
          // When focus is on a closed node, opens the node; focus does not move.
          target.expanded = true;
          event.preventDefault();
        }
      }
      return;
    }
  }
  updateAncestorTree(event) {
    const item = event.target;
    if (item.disabled) {
      return;
    }
    const ancestors = [];
    let parent = item.parentElement.closest("calcite-tree-item");
    while (parent) {
      ancestors.push(parent);
      parent = parent.parentElement.closest("calcite-tree-item");
    }
    const childItems = Array.from(item.querySelectorAll("calcite-tree-item:not([disabled])"));
    const childItemsWithNoChildren = childItems.filter((child) => !child.hasChildren);
    const childItemsWithChildren = childItems.filter((child) => child.hasChildren);
    const futureSelected = item.hasChildren
      ? !(item.selected || item.indeterminate)
      : !item.selected;
    childItemsWithNoChildren.forEach((el) => {
      el.selected = futureSelected;
      el.indeterminate = false;
    });
    function updateItemState(childItems, item) {
      const selected = childItems.filter((child) => child.selected);
      const unselected = childItems.filter((child) => !child.selected);
      item.selected = selected.length === childItems.length;
      item.indeterminate = selected.length > 0 && unselected.length > 0;
    }
    childItemsWithChildren.forEach((el) => {
      const directChildItems = Array.from(el.querySelectorAll(":scope > calcite-tree > calcite-tree-item"));
      updateItemState(directChildItems, el);
    });
    if (item.hasChildren) {
      updateItemState(childItems, item);
    }
    else {
      item.selected = futureSelected;
      item.indeterminate = false;
    }
    ancestors.forEach((ancestor) => {
      const descendants = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(ancestor.querySelectorAll("calcite-tree-item"));
      const activeDescendants = descendants.filter((el) => el.selected);
      if (activeDescendants.length === 0) {
        ancestor.selected = false;
        ancestor.indeterminate = false;
        return;
      }
      const indeterminate = activeDescendants.length < descendants.length;
      ancestor.indeterminate = indeterminate;
      ancestor.selected = !indeterminate;
    });
    this.selectedItems = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.querySelectorAll("calcite-tree-item")).filter((i) => i.selected);
    this.calciteTreeSelect.emit();
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  getRootTabIndex() {
    return !this.child ? 0 : -1;
  }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.g)(this); }
};
Tree.style = treeCss;

/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const CSS = {
  actionsEnd: "actions-end",
  checkboxLabel: "checkbox-label",
  checkbox: "checkbox",
  chevron: "chevron",
  nodeContainer: "node-container",
  childrenContainer: "children-container",
  bulletPointIcon: "bullet-point",
  checkmarkIcon: "checkmark",
  itemExpanded: "item--expanded",
  iconStart: "icon-start"
};
const SLOTS = {
  actionsEnd: "actions-end",
  children: "children"
};
const ICONS = {
  bulletPoint: "bullet-point",
  checkmark: "check",
  chevronRight: "chevron-right",
  blank: "blank"
};

const treeItemCss = "@keyframes in{0%{opacity:0}100%{opacity:1}}@keyframes in-down{0%{opacity:0;transform:translate3D(0, -5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-up{0%{opacity:0;transform:translate3D(0, 5px, 0)}100%{opacity:1;transform:translate3D(0, 0, 0)}}@keyframes in-scale{0%{opacity:0;transform:scale3D(0.95, 0.95, 1)}100%{opacity:1;transform:scale3D(1, 1, 1)}}:root{--calcite-animation-timing:calc(150ms * var(--calcite-internal-duration-factor));--calcite-internal-duration-factor:var(--calcite-duration-factor, 1);--calcite-internal-animation-timing-fast:calc(100ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-medium:calc(200ms * var(--calcite-internal-duration-factor));--calcite-internal-animation-timing-slow:calc(300ms * var(--calcite-internal-duration-factor))}.calcite-animate{opacity:0;animation-fill-mode:both;animation-duration:var(--calcite-animation-timing)}.calcite-animate__in{animation-name:in}.calcite-animate__in-down{animation-name:in-down}.calcite-animate__in-up{animation-name:in-up}.calcite-animate__in-scale{animation-name:in-scale}@media (prefers-reduced-motion: reduce){:root{--calcite-internal-duration-factor:0}}:root{--calcite-floating-ui-transition:var(--calcite-animation-timing);--calcite-floating-ui-z-index:600}:host([hidden]){display:none}:host([disabled]){pointer-events:none;cursor:default;-webkit-user-select:none;user-select:none;opacity:var(--calcite-ui-opacity-disabled)}:host{display:block;max-inline-size:100%;cursor:pointer;color:var(--calcite-ui-text-3)}[hidden]{display:none}:host([calcite-hydrated-hidden]){visibility:hidden !important;pointer-events:none}:host([disabled]) ::slotted([calcite-hydrated][disabled]),:host([disabled]) [calcite-hydrated][disabled]{opacity:1}:host([scale=s]){font-size:var(--calcite-font-size--2);line-height:1rem}:host([scale=s]) .node-container{--calcite-tree-padding-y:0.25rem}:host([scale=s]) .node-container .checkbox,:host([scale=s]) .node-container .chevron,:host([scale=s]) .node-container .checkmark,:host([scale=s]) .node-container .bullet-point{margin-inline:0.25rem}:host([scale=s]) .node-container .icon-start,:host([scale=s]) .node-container .actions-end{margin-inline:0.25rem}:host([scale=m]){font-size:var(--calcite-font-size--1);line-height:1rem}:host([scale=m]) .node-container{--calcite-tree-padding-y:0.5rem}:host([scale=m]) .node-container .checkbox,:host([scale=m]) .node-container .chevron,:host([scale=m]) .node-container .checkmark,:host([scale=m]) .node-container .bullet-point{margin-inline:0.5rem}:host([scale=m]) .node-container .icon-start,:host([scale=m]) .node-container .actions-end{margin-inline:0.5rem}:host([scale=l]){font-size:var(--calcite-font-size-0);line-height:1.25rem}:host([scale=l]) .node-container{--calcite-tree-padding-y:0.75rem}:host([scale=l]) .node-container .checkbox,:host([scale=l]) .node-container .chevron,:host([scale=l]) .node-container .checkmark,:host([scale=l]) .node-container .bullet-point{margin-inline:0.75rem}:host([scale=l]) .node-container .icon-start,:host([scale=l]) .node-container .actions-end{margin-inline:0.75rem}:host([lines]) .children-container:after{position:absolute;inset-block-start:0px;z-index:1;inline-size:1px;transition-property:color, background-color, border-color, text-decoration-color, fill, stroke;transition-timing-function:cubic-bezier(0.4, 0, 0.2, 1);transition-duration:150ms;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;block-size:96%;content:\"\";background-color:var(--calcite-ui-border-2)}:host(:not([lines])) .node-container:after{display:none}::slotted(*){min-inline-size:0px;max-inline-size:100%;overflow-wrap:break-word;color:inherit;text-decoration:none !important}::slotted(*):hover{text-decoration:none !important}::slotted(a){inline-size:100%;text-decoration-line:none}:host{outline-color:transparent}:host(:focus){outline:2px solid transparent;outline:2px solid var(--calcite-ui-brand);outline-offset:-2px}slot[name=actions-end]::slotted(*),.actions-end{display:flex;flex-direction:row;align-items:center;align-self:stretch;overflow:visible}.checkbox{line-height:0}.checkbox-label{pointer-events:none;display:flex;align-items:center}.checkbox:focus{outline:2px solid transparent;outline-offset:2px}.children-container{position:relative;block-size:0px;overflow:hidden;margin-inline-start:1.25rem;transform:scaleY(0);opacity:0;transition:var(--calcite-animation-timing) cubic-bezier(0.215, 0.44, 0.42, 0.88), opacity var(--calcite-animation-timing) cubic-bezier(0.215, 0.44, 0.42, 0.88), all var(--calcite-animation-timing) ease-in-out;transform-origin:top}.item--expanded>.children-container{overflow:visible;opacity:1;block-size:auto}.node-container{position:relative;display:flex;align-items:center;padding-block:var(--calcite-tree-padding-y);padding-inline:0}.node-container .checkmark,.node-container .bullet-point{opacity:0;transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;color:var(--calcite-ui-border-1)}.node-container:hover .checkmark,.node-container:hover .bullet-point,:host([selected]) .node-container:hover .checkmark,:host([selected]) .node-container:hover .bullet-point,:host(:focus:not([disabled])) .node-container .checkmark,:host(:focus:not([disabled])) .node-container .bullet-point{opacity:1}:host([selected]) .node-container,:host([selected]) .node-container:hover{font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1)}:host([selected]) .node-container .bullet-point,:host([selected]) .node-container .checkmark,:host([selected]) .node-container:hover .bullet-point,:host([selected]) .node-container:hover .checkmark{opacity:1;color:var(--calcite-ui-brand)}:host([selection-mode=none]:not([has-children])):host([scale=s]) .node-container{padding-inline-start:0.5rem}:host([selection-mode=none]:not([has-children])):host([scale=m]) .node-container{padding-inline-start:1rem}:host([selection-mode=none]:not([has-children])):host([scale=l]) .node-container{padding-inline-start:1.5rem}:host(:not([has-children])):host([scale=s]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.25rem}:host(:not([has-children])):host([scale=m]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.5rem}:host(:not([has-children])):host([scale=l]) .node-container[data-selection-mode=ancestors] .checkbox{padding-inline-start:1.75rem}:host([has-children]) .node-container[data-selection-mode=ancestors] .checkbox{margin-inline-start:0}:host([has-children]) .node-container .bullet-point,:host([has-children]) .node-container .checkmark{display:none}:host([has-children][expanded]:not([selected]):not([selection-mode=none])) .node-container ::slotted(*){font-weight:var(--calcite-font-weight-medium);color:var(--calcite-ui-text-1)}:host([has-children][selected]) .node-container[data-selection-mode=children],:host([has-children][selected]) .node-container[data-selection-mode=multichildren]{color:var(--calcite-ui-brand)}.chevron{position:relative;align-self:center;color:var(--calcite-ui-text-3);transition:all var(--calcite-animation-timing) ease-in-out 0s, outline 0s, outline-offset 0s;flex:0 0 auto;transform:rotate(0deg)}.calcite--rtl .chevron{transform:rotate(180deg)}.item--expanded>.node-container>.chevron{transform:rotate(90deg)}:host([selected]) .checkmark,:host([selected]) .bullet-point{color:var(--calcite-ui-brand)}";

const TreeItem = class {
  constructor(hostRef) {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.r)(this, hostRef);
    this.calciteInternalTreeItemSelect = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.c)(this, "calciteInternalTreeItemSelect", 6);
    this.openTransitionProp = "opacity";
    this.transitionProp = "expanded";
    this.iconClickHandler = (event) => {
      event.stopPropagation();
      this.expanded = !this.expanded;
    };
    this.childrenClickHandler = (event) => event.stopPropagation();
    //--------------------------------------------------------------------------
    //
    //  Private Methods
    //
    //--------------------------------------------------------------------------
    this.updateParentIsExpanded = (el, expanded) => {
      const items = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.g)(el, SLOTS.children, {
        all: true,
        selector: "calcite-tree-item"
      });
      items.forEach((item) => (item.parentExpanded = expanded));
    };
    this.updateAncestorTree = () => {
      if (this.selected && this.selectionMode === "ancestors") {
        const ancestors = [];
        let parent = this.parentTreeItem;
        while (parent) {
          ancestors.push(parent);
          parent = parent.parentElement?.closest("calcite-tree-item");
        }
        ancestors.forEach((item) => (item.indeterminate = true));
        return;
      }
    };
    this.actionsEndSlotChangeHandler = (event) => {
      this.hasEndActions = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.s)(event);
    };
    this.disabled = false;
    this.expanded = false;
    this.iconFlipRtl = undefined;
    this.iconStart = undefined;
    this.selected = false;
    this.parentExpanded = false;
    this.depth = -1;
    this.hasChildren = null;
    this.lines = undefined;
    this.scale = undefined;
    this.indeterminate = undefined;
    this.selectionMode = undefined;
    this.updateAfterInitialRender = false;
    this.hasEndActions = false;
  }
  expandedHandler(newValue) {
    this.updateParentIsExpanded(this.el, newValue);
    (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.o)(this, true);
  }
  getselectionMode() {
    this.isSelectionMultiLike =
      this.selectionMode === "multiple" || this.selectionMode === "multichildren";
  }
  /**
   * Defines method for `beforeOpen` event handler.
   */
  onBeforeOpen() {
    this.transitionEl.style.transform = "scaleY(1)";
  }
  /**
   * Defines method for `open` event handler:
   */
  onOpen() {
    this.transitionEl.style.transform = "none";
  }
  /**
   * Defines method for `beforeClose` event handler:
   */
  onBeforeClose() {
    // pattern needs to be defined on how we emit events for components without `open` prop.
  }
  /**
   * Defines method for `close` event handler:
   */
  onClose() {
    this.transitionEl.style.transform = "scaleY(0)";
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  connectedCallback() {
    this.parentTreeItem = this.el.parentElement?.closest("calcite-tree-item");
    if (this.parentTreeItem) {
      const { expanded } = this.parentTreeItem;
      this.updateParentIsExpanded(this.parentTreeItem, expanded);
    }
    (0,_conditionalSlot_a4837caf_js__WEBPACK_IMPORTED_MODULE_5__.c)(this);
  }
  disconnectedCallback() {
    (0,_conditionalSlot_a4837caf_js__WEBPACK_IMPORTED_MODULE_5__.d)(this);
  }
  componentWillRender() {
    this.hasChildren = !!this.el.querySelector("calcite-tree");
    this.depth = 0;
    let parentTree = this.el.closest("calcite-tree");
    if (!parentTree) {
      return;
    }
    this.selectionMode = parentTree.selectionMode;
    this.scale = parentTree.scale || "m";
    this.lines = parentTree.lines;
    let nextParentTree;
    while (parentTree) {
      nextParentTree = parentTree.parentElement?.closest("calcite-tree");
      if (nextParentTree === parentTree) {
        break;
      }
      else {
        parentTree = nextParentTree;
        this.depth = this.depth + 1;
      }
    }
  }
  componentWillLoad() {
    if (this.expanded) {
      (0,_openCloseComponent_7d58834c_js__WEBPACK_IMPORTED_MODULE_3__.o)(this, true);
    }
    requestAnimationFrame(() => (this.updateAfterInitialRender = true));
  }
  componentDidLoad() {
    this.updateAncestorTree();
  }
  componentDidRender() {
    (0,_interactive_29995522_js__WEBPACK_IMPORTED_MODULE_6__.u)(this, () => this.parentExpanded || this.depth === 1);
  }
  render() {
    const rtl = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.b)(this.el) === "rtl";
    const showBulletPoint = this.selectionMode === "single" || this.selectionMode === "children";
    const showCheckmark = this.selectionMode === "multiple" || this.selectionMode === "multichildren";
    const showBlank = this.selectionMode === "none" && !this.hasChildren;
    const chevron = this.hasChildren ? ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-icon", { class: {
        [CSS.chevron]: true,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, "data-test-id": "icon", icon: ICONS.chevronRight, onClick: this.iconClickHandler, scale: this.scale === "l" ? "m" : "s" })) : null;
    const defaultSlotNode = (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", { key: "default-slot" });
    const checkbox = this.selectionMode === "ancestors" ? ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("label", { class: CSS.checkboxLabel, key: "checkbox-label" }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-checkbox", { checked: this.selected, class: CSS.checkbox, "data-test-id": "checkbox", indeterminate: this.hasChildren && this.indeterminate, scale: this.scale, tabIndex: -1 }), defaultSlotNode)) : null;
    const selectedIcon = showBulletPoint
      ? ICONS.bulletPoint
      : showCheckmark
        ? ICONS.checkmark
        : showBlank
          ? ICONS.blank
          : null;
    const itemIndicator = selectedIcon ? ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-icon", { class: {
        [CSS.bulletPointIcon]: selectedIcon === ICONS.bulletPoint,
        [CSS.checkmarkIcon]: selectedIcon === ICONS.checkmark,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, icon: selectedIcon, scale: this.scale === "l" ? "m" : "s" })) : null;
    const hidden = !(this.parentExpanded || this.depth === 1);
    const isExpanded = this.updateAfterInitialRender && this.expanded;
    const { hasEndActions } = this;
    const slotNode = ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", { key: "actionsEndSlot", name: SLOTS.actionsEnd, onSlotchange: this.actionsEndSlotChangeHandler }));
    const iconStartEl = ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("calcite-icon", { class: CSS.iconStart, flipRtl: this.iconFlipRtl === "start" || this.iconFlipRtl === "both", icon: this.iconStart, scale: this.scale === "l" ? "m" : "s" }));
    return ((0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)(_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.H, { "aria-expanded": this.hasChildren ? (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.t)(isExpanded) : undefined, "aria-hidden": (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.t)(hidden), "aria-selected": this.selected ? "true" : showCheckmark ? "false" : undefined, "calcite-hydrated-hidden": hidden, role: "treeitem" }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: { [CSS.itemExpanded]: isExpanded } }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: {
        [CSS.nodeContainer]: true,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, "data-selection-mode": this.selectionMode, ref: (el) => (this.defaultSlotWrapper = el) }, chevron, itemIndicator, this.iconStart ? iconStartEl : null, checkbox ? checkbox : defaultSlotNode, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: CSS.actionsEnd, hidden: !hasEndActions }, slotNode)), (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("div", { class: {
        [CSS.childrenContainer]: true,
        [_resources_48436eea_js__WEBPACK_IMPORTED_MODULE_7__.C.rtl]: rtl
      }, "data-test-id": "calcite-tree-children", onClick: this.childrenClickHandler, ref: (el) => this.setTransitionEl(el), role: this.hasChildren ? "group" : undefined }, (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.h)("slot", { name: SLOTS.children })))));
  }
  setTransitionEl(el) {
    this.transitionEl = el;
  }
  //--------------------------------------------------------------------------
  //
  //  Event Listeners
  //
  //--------------------------------------------------------------------------
  onClick(event) {
    // Solve for if the item is clicked somewhere outside the slotted anchor.
    // Anchor is triggered anywhere you click
    const [link] = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.r)(this.el, "a");
    if (link && event.composedPath()[0].tagName.toLowerCase() !== "a") {
      const target = link.target === "" ? "_self" : link.target;
      window.open(link.href, target);
    }
    this.calciteInternalTreeItemSelect.emit({
      modifyCurrentSelection: this.selectionMode === "ancestors" || this.isSelectionMultiLike,
      forceToggle: false
    });
  }
  keyDownHandler(event) {
    let root;
    switch (event.key) {
      case " ":
        if (this.selectionMode === "none") {
          return;
        }
        this.calciteInternalTreeItemSelect.emit({
          modifyCurrentSelection: this.isSelectionMultiLike,
          forceToggle: false
        });
        event.preventDefault();
        break;
      case "Enter":
        if (this.selectionMode === "none") {
          return;
        }
        // activates a node, i.e., performs its default action. For parent nodes, one possible default action is to open or close the node. In single-select trees where selection does not follow focus (see note below), the default action is typically to select the focused node.
        const link = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(this.el.children).find((el) => el.matches("a"));
        if (link) {
          link.click();
          this.selected = true;
        }
        else {
          this.calciteInternalTreeItemSelect.emit({
            modifyCurrentSelection: this.isSelectionMultiLike,
            forceToggle: false
          });
        }
        event.preventDefault();
        break;
      case "Home":
        root = this.el.closest("calcite-tree:not([child])");
        const firstNode = root.querySelector("calcite-tree-item");
        firstNode?.focus();
        break;
      case "End":
        root = this.el.closest("calcite-tree:not([child])");
        let currentNode = root.children[root.children.length - 1]; // last child
        let currentTree = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(currentNode.children).find((el) => el.matches("calcite-tree"));
        while (currentTree) {
          currentNode = currentTree.children[root.children.length - 1];
          currentTree = (0,_dom_f1ee4d04_js__WEBPACK_IMPORTED_MODULE_0__.n)(currentNode.children).find((el) => el.matches("calcite-tree"));
        }
        currentNode?.focus();
        break;
    }
  }
  get el() { return (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.g)(this); }
  static get watchers() { return {
    "expanded": ["expandedHandler"],
    "selectionMode": ["getselectionMode"]
  }; }
};
TreeItem.style = treeItemCss;



//# sourceMappingURL=calcite-tooltip_3.entry.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/conditionalSlot-a4837caf.js":
/*!*********************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/conditionalSlot-a4837caf.js ***!
  \*********************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ connectConditionalSlotComponent),
/* harmony export */   d: () => (/* binding */ disconnectConditionalSlotComponent)
/* harmony export */ });
/* harmony import */ var _index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./index-4e647411.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/index-4e647411.js");
/* harmony import */ var _observers_56740e99_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./observers-56740e99.js */ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/observers-56740e99.js");



/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
const observed = new Set();
let mutationObserver;
const observerOptions = { childList: true };
/**
 * Helper to set up a conditional slot component on connectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function connectConditionalSlotComponent(component) {
  if (!mutationObserver) {
    mutationObserver = (0,_observers_56740e99_js__WEBPACK_IMPORTED_MODULE_0__.c)("mutation", processMutations);
  }
  mutationObserver.observe(component.el, observerOptions);
}
/**
 * Helper to tear down a conditional slot component on disconnectedCallback.
 *
 * @param component
 * @deprecated Use `onSlotchange` event with `slotChangeHasAssignedElement` DOM utility instead.
 *
 * ```
 * <slot onSlotchange={(event) => this.mySlotHasElement = slotChangeHasAssignedElement(event)} />}
 * ```
 */
function disconnectConditionalSlotComponent(component) {
  observed.delete(component.el);
  // we explicitly process queued mutations and disconnect and reconnect
  // the observer until MutationObserver gets an `unobserve` method
  // see https://github.com/whatwg/dom/issues/126
  processMutations(mutationObserver.takeRecords());
  mutationObserver.disconnect();
  for (const [element] of observed.entries()) {
    mutationObserver.observe(element, observerOptions);
  }
}
function processMutations(mutations) {
  mutations.forEach(({ target }) => {
    (0,_index_4e647411_js__WEBPACK_IMPORTED_MODULE_1__.f)(target);
  });
}



//# sourceMappingURL=conditionalSlot-a4837caf.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/interactive-29995522.js":
/*!*****************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/interactive-29995522.js ***!
  \*****************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   u: () => (/* binding */ updateHostInteraction)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
function noopClick() {
  /** noop */
}
/**
 * This helper updates the host element to prevent keyboard interaction on its subtree and sets the appropriate aria attribute for accessibility.
 *
 * This should be used in the `componentDidRender` lifecycle hook.
 *
 * **Notes**
 *
 * this util is not needed for simple components whose root element or elements are an interactive component (custom element or native control). For those cases, set the `disabled` props on the root components instead.
 * technically, users can override `tabindex` and restore keyboard navigation, but this will be considered user error
 *
 * @param component
 * @param hostIsTabbable
 */
function updateHostInteraction(component, hostIsTabbable = false) {
  if (component.disabled) {
    component.el.setAttribute("tabindex", "-1");
    component.el.setAttribute("aria-disabled", "true");
    if (component.el.contains(document.activeElement)) {
      document.activeElement.blur();
    }
    component.el.click = noopClick;
    return;
  }
  component.el.click = HTMLElement.prototype.click;
  if (typeof hostIsTabbable === "function") {
    component.el.setAttribute("tabindex", hostIsTabbable.call(component) ? "0" : "-1");
  }
  else if (hostIsTabbable === true) {
    component.el.setAttribute("tabindex", "0");
  }
  else if (hostIsTabbable === false) {
    component.el.removeAttribute("tabindex");
  }
  else ;
  component.el.removeAttribute("aria-disabled");
}



//# sourceMappingURL=interactive-29995522.js.map

/***/ }),

/***/ "./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/observers-56740e99.js":
/*!***************************************************************************************************************************************************!*\
  !*** ./extensions/widgets/ba-infographic/node_modules/@arcgis/business-analyst-components/dist/stencil-components/dist/esm/observers-56740e99.js ***!
  \***************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ createObserver)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See https://github.com/Esri/calcite-components/blob/master/LICENSE.md for details.
 * v1.0.5
 */
/**
 * This utility ensures observers are created only for browser contexts.
 *
 * @param type - the type of observer to create
 * @param callback - the observer callback
 * @param options - the observer options
 */
function createObserver(type, callback, options) {
  const Observer = getObserver(type);
  return new Observer(callback, options);
}
function getObserver(type) {
  // based on https://github.com/whatwg/dom/issues/126#issuecomment-1049814948
  class ExtendedMutationObserver extends window.MutationObserver {
    constructor(callback) {
      super(callback);
      this.observedEntry = [];
      this.callback = callback;
    }
    observe(target, options) {
      this.observedEntry.push({ target, options });
      return super.observe(target, options);
    }
    unobserve(target) {
      const newObservedEntries = this.observedEntry.filter((observed) => observed.target !== target);
      this.observedEntry = [];
      this.callback(super.takeRecords(), this);
      this.disconnect();
      newObservedEntries.forEach((observed) => this.observe(observed.target, observed.options));
    }
  }
  return (function () {
    return (type === "intersection"
      ? window.IntersectionObserver
      : type === "mutation"
        ? ExtendedMutationObserver
        : window.ResizeObserver);
  })();
}



//# sourceMappingURL=observers-56740e99.js.map

/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYmEtaW5mb2dyYXBoaWNfbm9kZV9tb2R1bGVzX2FyY2dpc19idXNpbmVzcy1hbmFseXN0LWNvbXBvbmVudHNfZGlzLTdlMGEwZC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE2RztBQUM2SjtBQUN0RjtBQUNySTtBQUN1RztBQUN4QjtBQUN2RDtBQUNaO0FBQzFCO0FBQ0Q7QUFDQzs7QUFFakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QixrREFBa0QsbURBQWlCLFlBQVksc0JBQXNCO0FBQ3JHO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxxQkFBcUI7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixrQkFBa0I7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsa0JBQWtCO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVcsbURBQXNCO0FBQ2pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1Qix3RUFBd0U7QUFDL0Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVCQUF1QixRQUFRO0FBQy9CLElBQUkscURBQVc7QUFDZixHQUFHO0FBQ0g7O0FBRXlGOztBQUV6Rjs7Ozs7Ozs7Ozs7Ozs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0M7O0FBRXRDOzs7Ozs7Ozs7Ozs7OztBQy9DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyxpQkFBaUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRStCOztBQUUvQiIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYmEtaW5mb2dyYXBoaWMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYnVzaW5lc3MtYW5hbHlzdC1jb21wb25lbnRzL2Rpc3Qvc3RlbmNpbC1jb21wb25lbnRzL2Rpc3QvZXNtL2NhbGNpdGUtdG9vbHRpcF8zLmVudHJ5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYmEtaW5mb2dyYXBoaWMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYnVzaW5lc3MtYW5hbHlzdC1jb21wb25lbnRzL2Rpc3Qvc3RlbmNpbC1jb21wb25lbnRzL2Rpc3QvZXNtL2NvbmRpdGlvbmFsU2xvdC1hNDgzN2NhZi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS9pbnRlcmFjdGl2ZS0yOTk5NTUyMi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2JhLWluZm9ncmFwaGljL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2J1c2luZXNzLWFuYWx5c3QtY29tcG9uZW50cy9kaXN0L3N0ZW5jaWwtY29tcG9uZW50cy9kaXN0L2VzbS9vYnNlcnZlcnMtNTY3NDBlOTkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBIIGFzIEhvc3QsIGcgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtNGU2NDc0MTEuanMnO1xuaW1wb3J0IHsgcSBhcyBxdWVyeUVsZW1lbnRSb290cywgaSBhcyBpc1ByaW1hcnlQb2ludGVyQnV0dG9uLCB0IGFzIHRvQXJpYUJvb2xlYW4sIGggYXMgZm9jdXNFbGVtZW50LCBuIGFzIG5vZGVMaXN0VG9BcnJheSwgdSBhcyBnZXRSb290Tm9kZSwgZyBhcyBnZXRTbG90dGVkLCBzIGFzIHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQsIGIgYXMgZ2V0RWxlbWVudERpciwgciBhcyBmaWx0ZXJEaXJlY3RDaGlsZHJlbiB9IGZyb20gJy4vZG9tLWYxZWU0ZDA0LmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdEZsb2F0aW5nVUksIGIgYXMgZGVmYXVsdE9mZnNldERpc3RhbmNlLCB1IGFzIHVwZGF0ZUFmdGVyQ2xvc2UsIGEgYXMgZGlzY29ubmVjdEZsb2F0aW5nVUksIHIgYXMgcmVwb3NpdGlvbiwgRiBhcyBGbG9hdGluZ0NTUyB9IGZyb20gJy4vZmxvYXRpbmctdWktZjI5NTE3ZTcuanMnO1xuaW1wb3J0IHsgZyBhcyBndWlkIH0gZnJvbSAnLi9ndWlkLTg4YTM3MjlmLmpzJztcbmltcG9ydCB7IGMgYXMgY29ubmVjdE9wZW5DbG9zZUNvbXBvbmVudCwgZCBhcyBkaXNjb25uZWN0T3BlbkNsb3NlQ29tcG9uZW50LCBvIGFzIG9uVG9nZ2xlT3BlbkNsb3NlQ29tcG9uZW50IH0gZnJvbSAnLi9vcGVuQ2xvc2VDb21wb25lbnQtN2Q1ODgzNGMuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25uZWN0Q29uZGl0aW9uYWxTbG90Q29tcG9uZW50LCBkIGFzIGRpc2Nvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQgfSBmcm9tICcuL2NvbmRpdGlvbmFsU2xvdC1hNDgzN2NhZi5qcyc7XG5pbXBvcnQgeyB1IGFzIHVwZGF0ZUhvc3RJbnRlcmFjdGlvbiB9IGZyb20gJy4vaW50ZXJhY3RpdmUtMjk5OTU1MjIuanMnO1xuaW1wb3J0IHsgQyBhcyBDU1NfVVRJTElUWSB9IGZyb20gJy4vcmVzb3VyY2VzLTQ4NDM2ZWVhLmpzJztcbmltcG9ydCAnLi9pbmRleC5lc20tMWM2NWQ4YzcuanMnO1xuaW1wb3J0ICcuL2RlYm91bmNlLTA0N2UwOWY0LmpzJztcbmltcG9ydCAnLi9vYnNlcnZlcnMtNTY3NDBlOTkuanMnO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuY29uc3QgQ1NTJDEgPSB7XG4gIGNvbnRhaW5lcjogXCJjb250YWluZXJcIixcbiAgYXJyb3c6IFwiYXJyb3dcIlxufTtcbmNvbnN0IFRPT0xUSVBfREVMQVlfTVMgPSA1MDA7XG5jb25zdCBBUklBX0RFU0NSSUJFRF9CWSA9IFwiYXJpYS1kZXNjcmliZWRieVwiO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuZnVuY3Rpb24gZ2V0RWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCh0b29sdGlwKSB7XG4gIGNvbnN0IHsgcmVmZXJlbmNlRWxlbWVudCB9ID0gdG9vbHRpcDtcbiAgcmV0dXJuICgodHlwZW9mIHJlZmVyZW5jZUVsZW1lbnQgPT09IFwic3RyaW5nXCIgPyBxdWVyeUVsZW1lbnRSb290cyh0b29sdGlwLCB7IGlkOiByZWZlcmVuY2VFbGVtZW50IH0pIDogcmVmZXJlbmNlRWxlbWVudCkgfHxcbiAgICBudWxsKTtcbn1cblxuLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtY29tcG9uZW50cy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuMC41XG4gKi9cbmNsYXNzIFRvb2x0aXBNYW5hZ2VyIHtcbiAgY29uc3RydWN0b3IoKSB7XG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgICAvL1xuICAgIC8vICBQcml2YXRlIFByb3BlcnRpZXNcbiAgICAvL1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgdGhpcy5yZWdpc3RlcmVkRWxlbWVudHMgPSBuZXcgV2Vha01hcCgpO1xuICAgIHRoaXMuaG92ZXJUaW1lb3V0ID0gbnVsbDtcbiAgICB0aGlzLnJlZ2lzdGVyZWRFbGVtZW50Q291bnQgPSAwO1xuICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAgLy9cbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXG4gICAgLy9cbiAgICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgIHRoaXMucXVlcnlUb29sdGlwID0gKGNvbXBvc2VkUGF0aCkgPT4ge1xuICAgICAgY29uc3QgeyByZWdpc3RlcmVkRWxlbWVudHMgfSA9IHRoaXM7XG4gICAgICBjb25zdCByZWdpc3RlcmVkRWxlbWVudCA9IGNvbXBvc2VkUGF0aC5maW5kKChwYXRoRWwpID0+IHJlZ2lzdGVyZWRFbGVtZW50cy5oYXMocGF0aEVsKSk7XG4gICAgICByZXR1cm4gcmVnaXN0ZXJlZEVsZW1lbnRzLmdldChyZWdpc3RlcmVkRWxlbWVudCk7XG4gICAgfTtcbiAgICB0aGlzLmtleURvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoZXZlbnQua2V5ID09PSBcIkVzY2FwZVwiICYmICFldmVudC5kZWZhdWx0UHJldmVudGVkKSB7XG4gICAgICAgIGNvbnN0IHsgYWN0aXZlVG9vbHRpcEVsIH0gPSB0aGlzO1xuICAgICAgICBpZiAoYWN0aXZlVG9vbHRpcEVsICYmIGFjdGl2ZVRvb2x0aXBFbC5vcGVuKSB7XG4gICAgICAgICAgdGhpcy5jbGVhckhvdmVyVGltZW91dCgpO1xuICAgICAgICAgIHRoaXMudG9nZ2xlVG9vbHRpcChhY3RpdmVUb29sdGlwRWwsIGZhbHNlKTtcbiAgICAgICAgICBjb25zdCByZWZlcmVuY2VFbGVtZW50ID0gZ2V0RWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudChhY3RpdmVUb29sdGlwRWwpO1xuICAgICAgICAgIGlmIChyZWZlcmVuY2VFbGVtZW50IGluc3RhbmNlb2YgRWxlbWVudCAmJiByZWZlcmVuY2VFbGVtZW50LmNvbnRhaW5zKGV2ZW50LnRhcmdldCkpIHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfTtcbiAgICB0aGlzLnF1ZXJ5SG92ZXJlZFRvb2x0aXAgPSAoY29tcG9zZWRQYXRoKSA9PiB7XG4gICAgICBjb25zdCB7IGFjdGl2ZVRvb2x0aXBFbCB9ID0gdGhpcztcbiAgICAgIGlmIChhY3RpdmVUb29sdGlwRWwgJiYgY29tcG9zZWRQYXRoLmluY2x1ZGVzKGFjdGl2ZVRvb2x0aXBFbCkpIHtcbiAgICAgICAgdGhpcy5jbGVhckhvdmVyVGltZW91dCgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCB0b29sdGlwID0gdGhpcy5xdWVyeVRvb2x0aXAoY29tcG9zZWRQYXRoKTtcbiAgICAgIGlmICh0b29sdGlwKSB7XG4gICAgICAgIHRoaXMudG9nZ2xlSG92ZXJlZFRvb2x0aXAodG9vbHRpcCwgdHJ1ZSk7XG4gICAgICB9XG4gICAgICBlbHNlIGlmIChhY3RpdmVUb29sdGlwRWwpIHtcbiAgICAgICAgdGhpcy50b2dnbGVIb3ZlcmVkVG9vbHRpcChhY3RpdmVUb29sdGlwRWwsIGZhbHNlKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMucG9pbnRlck1vdmVIYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBjb21wb3NlZFBhdGggPSBldmVudC5jb21wb3NlZFBhdGgoKTtcbiAgICAgIHRoaXMuY2xlYXJIb3ZlclRpbWVvdXQoKTtcbiAgICAgIHRoaXMuaG92ZXJUaW1lb3V0ID0gd2luZG93LnNldFRpbWVvdXQoKCkgPT4gdGhpcy5xdWVyeUhvdmVyZWRUb29sdGlwKGNvbXBvc2VkUGF0aCksIFRPT0xUSVBfREVMQVlfTVMgKTtcbiAgICB9O1xuICAgIHRoaXMucG9pbnRlckRvd25IYW5kbGVyID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIWlzUHJpbWFyeVBvaW50ZXJCdXR0b24oZXZlbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNsaWNrZWRUb29sdGlwID0gdGhpcy5xdWVyeVRvb2x0aXAoZXZlbnQuY29tcG9zZWRQYXRoKCkpO1xuICAgICAgdGhpcy5jbGlja2VkVG9vbHRpcCA9IGNsaWNrZWRUb29sdGlwO1xuICAgICAgaWYgKGNsaWNrZWRUb29sdGlwPy5jbG9zZU9uQ2xpY2spIHtcbiAgICAgICAgdGhpcy50b2dnbGVUb29sdGlwKGNsaWNrZWRUb29sdGlwLCBmYWxzZSk7XG4gICAgICAgIHRoaXMuY2xlYXJIb3ZlclRpbWVvdXQoKTtcbiAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuZm9jdXNJbkhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMucXVlcnlGb2N1c2VkVG9vbHRpcChldmVudCwgdHJ1ZSk7XG4gICAgfTtcbiAgICB0aGlzLmZvY3VzT3V0SGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5xdWVyeUZvY3VzZWRUb29sdGlwKGV2ZW50LCBmYWxzZSk7XG4gICAgfTtcbiAgICB0aGlzLnRvZ2dsZUhvdmVyZWRUb29sdGlwID0gKHRvb2x0aXAsIHZhbHVlKSA9PiB7XG4gICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgdGhpcy5jbG9zZUV4aXN0aW5nVG9vbHRpcCgpO1xuICAgICAgfVxuICAgICAgdGhpcy50b2dnbGVUb29sdGlwKHRvb2x0aXAsIHZhbHVlKTtcbiAgICB9O1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQdWJsaWMgTWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICByZWdpc3RlckVsZW1lbnQocmVmZXJlbmNlRWwsIHRvb2x0aXApIHtcbiAgICB0aGlzLnJlZ2lzdGVyZWRFbGVtZW50Q291bnQrKztcbiAgICB0aGlzLnJlZ2lzdGVyZWRFbGVtZW50cy5zZXQocmVmZXJlbmNlRWwsIHRvb2x0aXApO1xuICAgIGlmICh0aGlzLnJlZ2lzdGVyZWRFbGVtZW50Q291bnQgPT09IDEpIHtcbiAgICAgIHRoaXMuYWRkTGlzdGVuZXJzKCk7XG4gICAgfVxuICB9XG4gIHVucmVnaXN0ZXJFbGVtZW50KHJlZmVyZW5jZUVsKSB7XG4gICAgaWYgKHRoaXMucmVnaXN0ZXJlZEVsZW1lbnRzLmRlbGV0ZShyZWZlcmVuY2VFbCkpIHtcbiAgICAgIHRoaXMucmVnaXN0ZXJlZEVsZW1lbnRDb3VudC0tO1xuICAgIH1cbiAgICBpZiAodGhpcy5yZWdpc3RlcmVkRWxlbWVudENvdW50ID09PSAwKSB7XG4gICAgICB0aGlzLnJlbW92ZUxpc3RlbmVycygpO1xuICAgIH1cbiAgfVxuICBhZGRMaXN0ZW5lcnMoKSB7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5rZXlEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLnBvaW50ZXJNb3ZlSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLnBvaW50ZXJEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsIHRoaXMuZm9jdXNJbkhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgdGhpcy5mb2N1c091dEhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgfVxuICByZW1vdmVMaXN0ZW5lcnMoKSB7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5rZXlEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVybW92ZVwiLCB0aGlzLnBvaW50ZXJNb3ZlSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJwb2ludGVyZG93blwiLCB0aGlzLnBvaW50ZXJEb3duSGFuZGxlciwgeyBjYXB0dXJlOiB0cnVlIH0pO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJmb2N1c2luXCIsIHRoaXMuZm9jdXNJbkhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwiZm9jdXNvdXRcIiwgdGhpcy5mb2N1c091dEhhbmRsZXIsIHsgY2FwdHVyZTogdHJ1ZSB9KTtcbiAgfVxuICBjbGVhckhvdmVyVGltZW91dCgpIHtcbiAgICB3aW5kb3cuY2xlYXJUaW1lb3V0KHRoaXMuaG92ZXJUaW1lb3V0KTtcbiAgfVxuICBjbG9zZUV4aXN0aW5nVG9vbHRpcCgpIHtcbiAgICBjb25zdCB7IGFjdGl2ZVRvb2x0aXBFbCB9ID0gdGhpcztcbiAgICBpZiAoYWN0aXZlVG9vbHRpcEVsKSB7XG4gICAgICB0aGlzLnRvZ2dsZVRvb2x0aXAoYWN0aXZlVG9vbHRpcEVsLCBmYWxzZSk7XG4gICAgfVxuICB9XG4gIHRvZ2dsZUZvY3VzZWRUb29sdGlwKHRvb2x0aXAsIHZhbHVlKSB7XG4gICAgdGhpcy5jbG9zZUV4aXN0aW5nVG9vbHRpcCgpO1xuICAgIGlmICh2YWx1ZSkge1xuICAgICAgdGhpcy5jbGVhckhvdmVyVGltZW91dCgpO1xuICAgIH1cbiAgICB0aGlzLnRvZ2dsZVRvb2x0aXAodG9vbHRpcCwgdmFsdWUpO1xuICB9XG4gIHRvZ2dsZVRvb2x0aXAodG9vbHRpcCwgdmFsdWUpIHtcbiAgICB0b29sdGlwLm9wZW4gPSB2YWx1ZTtcbiAgICBpZiAodmFsdWUpIHtcbiAgICAgIHRoaXMuYWN0aXZlVG9vbHRpcEVsID0gdG9vbHRpcDtcbiAgICB9XG4gIH1cbiAgcXVlcnlGb2N1c2VkVG9vbHRpcChldmVudCwgdmFsdWUpIHtcbiAgICBjb25zdCB0b29sdGlwID0gdGhpcy5xdWVyeVRvb2x0aXAoZXZlbnQuY29tcG9zZWRQYXRoKCkpO1xuICAgIGlmICghdG9vbHRpcCB8fCB0b29sdGlwID09PSB0aGlzLmNsaWNrZWRUb29sdGlwKSB7XG4gICAgICB0aGlzLmNsaWNrZWRUb29sdGlwID0gbnVsbDtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy50b2dnbGVGb2N1c2VkVG9vbHRpcCh0b29sdGlwLCB2YWx1ZSk7XG4gIH1cbn1cblxuY29uc3QgdG9vbHRpcENzcyA9IFwiQGtleWZyYW1lcyBpbnswJXtvcGFjaXR5OjB9MTAwJXtvcGFjaXR5OjF9fUBrZXlmcmFtZXMgaW4tZG93bnswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIC01cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi11cHswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDVweCwgMCl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDAsIDApfX1Aa2V5ZnJhbWVzIGluLXNjYWxlezAle29wYWNpdHk6MDt0cmFuc2Zvcm06c2NhbGUzRCgwLjk1LCAwLjk1LCAxKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06c2NhbGUzRCgxLCAxLCAxKX19OnJvb3R7LS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmc6Y2FsYygxNTBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3Rvcjp2YXIoLS1jYWxjaXRlLWR1cmF0aW9uLWZhY3RvciwgMSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctZmFzdDpjYWxjKDEwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1tZWRpdW06Y2FsYygyMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctc2xvdzpjYWxjKDMwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKX0uY2FsY2l0ZS1hbmltYXRle29wYWNpdHk6MDthbmltYXRpb24tZmlsbC1tb2RlOmJvdGg7YW5pbWF0aW9uLWR1cmF0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyl9LmNhbGNpdGUtYW5pbWF0ZV9faW57YW5pbWF0aW9uLW5hbWU6aW59LmNhbGNpdGUtYW5pbWF0ZV9faW4tZG93bnthbmltYXRpb24tbmFtZTppbi1kb3dufS5jYWxjaXRlLWFuaW1hdGVfX2luLXVwe2FuaW1hdGlvbi1uYW1lOmluLXVwfS5jYWxjaXRlLWFuaW1hdGVfX2luLXNjYWxle2FuaW1hdGlvbi1uYW1lOmluLXNjYWxlfUBtZWRpYSAocHJlZmVycy1yZWR1Y2VkLW1vdGlvbjogcmVkdWNlKXs6cm9vdHstLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yOjB9fTpyb290ey0tY2FsY2l0ZS1mbG9hdGluZy11aS10cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZyk7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6NjAwfTpob3N0KFtoaWRkZW5dKXtkaXNwbGF5Om5vbmV9Omhvc3R7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXotaW5kZXg6dmFyKC0tY2FsY2l0ZS10b29sdGlwLXotaW5kZXgsIDkwMSk7ZGlzcGxheTpibG9jaztwb3NpdGlvbjphYnNvbHV0ZTt6LWluZGV4OnZhcigtLWNhbGNpdGUtZmxvYXRpbmctdWktei1pbmRleCl9LmNhbGNpdGUtZmxvYXRpbmctdWktYW5pbXtwb3NpdGlvbjpyZWxhdGl2ZTt0cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtZmxvYXRpbmctdWktdHJhbnNpdGlvbik7dHJhbnNpdGlvbi1wcm9wZXJ0eTp0cmFuc2Zvcm0sIHZpc2liaWxpdHksIG9wYWNpdHk7b3BhY2l0eTowO2JveC1zaGFkb3c6MCAwIDE2cHggMCByZ2JhKDAsIDAsIDAsIDAuMTYpO3otaW5kZXg6MTtib3JkZXItcmFkaXVzOjAuMjVyZW19Omhvc3QoW2RhdGEtcGxhY2VtZW50Xj1ib3R0b21dKSAuY2FsY2l0ZS1mbG9hdGluZy11aS1hbmlte3RyYW5zZm9ybTp0cmFuc2xhdGVZKC01cHgpfTpob3N0KFtkYXRhLXBsYWNlbWVudF49dG9wXSkgLmNhbGNpdGUtZmxvYXRpbmctdWktYW5pbXt0cmFuc2Zvcm06dHJhbnNsYXRlWSg1cHgpfTpob3N0KFtkYXRhLXBsYWNlbWVudF49bGVmdF0pIC5jYWxjaXRlLWZsb2F0aW5nLXVpLWFuaW17dHJhbnNmb3JtOnRyYW5zbGF0ZVgoNXB4KX06aG9zdChbZGF0YS1wbGFjZW1lbnRePXJpZ2h0XSkgLmNhbGNpdGUtZmxvYXRpbmctdWktYW5pbXt0cmFuc2Zvcm06dHJhbnNsYXRlWCgtNXB4KX06aG9zdChbZGF0YS1wbGFjZW1lbnRdKSAuY2FsY2l0ZS1mbG9hdGluZy11aS1hbmltLS1hY3RpdmV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUoMCl9Omhvc3QoW2NhbGNpdGUtaHlkcmF0ZWQtaGlkZGVuXSl7dmlzaWJpbGl0eTpoaWRkZW4gIWltcG9ydGFudDtwb2ludGVyLWV2ZW50czpub25lfS5hcnJvdywuYXJyb3c6OmJlZm9yZXtwb3NpdGlvbjphYnNvbHV0ZTtpbmxpbmUtc2l6ZTo4cHg7YmxvY2stc2l6ZTo4cHg7ei1pbmRleDotMX0uYXJyb3c6OmJlZm9yZXtjb250ZW50OlxcXCJcXFwiOy0tdHctc2hhZG93OjAgNHB4IDhweCAtMXB4IHJnYmEoMCwgMCwgMCwgMC4wOCksIDAgMnB4IDRweCAtMXB4IHJnYmEoMCwgMCwgMCwgMC4wNCk7LS10dy1zaGFkb3ctY29sb3JlZDowIDRweCA4cHggLTFweCB2YXIoLS10dy1zaGFkb3ctY29sb3IpLCAwIDJweCA0cHggLTFweCB2YXIoLS10dy1zaGFkb3ctY29sb3IpO2JveC1zaGFkb3c6dmFyKC0tdHctcmluZy1vZmZzZXQtc2hhZG93LCAwIDAgIzAwMDApLCB2YXIoLS10dy1yaW5nLXNoYWRvdywgMCAwICMwMDAwKSwgdmFyKC0tdHctc2hhZG93KTt0cmFuc2Zvcm06cm90YXRlKDQ1ZGVnKTtiYWNrZ3JvdW5kOnZhcigtLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0xKX06aG9zdChbZGF0YS1wbGFjZW1lbnRePXRvcF0pIC5hcnJvd3tpbnNldC1ibG9jay1lbmQ6LTRweH06aG9zdChbZGF0YS1wbGFjZW1lbnRePWJvdHRvbV0pIC5hcnJvd3tpbnNldC1ibG9jay1zdGFydDotNHB4fTpob3N0KFtkYXRhLXBsYWNlbWVudF49cmlnaHRdKSAuYXJyb3csOmhvc3QoW2RhdGEtcGxhY2VtZW50Xj1sZWZ0XSkgLmFycm93e2RpcmVjdGlvbjpsdHI7dGV4dC1hbGlnbjpzdGFydH06aG9zdChbZGF0YS1wbGFjZW1lbnRePWxlZnRdKSAuYXJyb3d7aW5zZXQtaW5saW5lLWVuZDotNHB4fTpob3N0KFtkYXRhLXBsYWNlbWVudF49cmlnaHRdKSAuYXJyb3d7aW5zZXQtaW5saW5lLXN0YXJ0Oi00cHh9LmNvbnRhaW5lcntwb3NpdGlvbjpyZWxhdGl2ZTtvdmVyZmxvdzpoaWRkZW47Ym9yZGVyLXJhZGl1czowLjI1cmVtO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1mb3JlZ3JvdW5kLTEpO3BhZGRpbmctYmxvY2s6MC43NXJlbTtwYWRkaW5nLWlubGluZToxcmVtO2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMik7bGluZS1oZWlnaHQ6MS4zNzU7Zm9udC13ZWlnaHQ6dmFyKC0tY2FsY2l0ZS1mb250LXdlaWdodC1tZWRpdW0pO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKTttYXgtaW5saW5lLXNpemU6MjByZW07bWF4LWJsb2NrLXNpemU6MjByZW07dGV4dC1hbGlnbjpzdGFydH0uY2FsY2l0ZS1mbG9hdGluZy11aS1hbmlte2JvcmRlci1yYWRpdXM6MC4yNXJlbTtib3JkZXItd2lkdGg6MXB4O2JvcmRlci1zdHlsZTpzb2xpZDtib3JkZXItY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMyk7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWZvcmVncm91bmQtMSl9LmFycm93OjpiZWZvcmV7b3V0bGluZToxcHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMyl9XCI7XG5cbmNvbnN0IG1hbmFnZXIgPSBuZXcgVG9vbHRpcE1hbmFnZXIoKTtcclxuY29uc3QgVG9vbHRpcCA9IGNsYXNzIHtcclxuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XHJcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xyXG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcEJlZm9yZUNsb3NlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlVG9vbHRpcEJlZm9yZUNsb3NlXCIsIDYpO1xyXG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcENsb3NlID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlVG9vbHRpcENsb3NlXCIsIDYpO1xyXG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcEJlZm9yZU9wZW4gPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVUb29sdGlwQmVmb3JlT3BlblwiLCA2KTtcclxuICAgIHRoaXMuY2FsY2l0ZVRvb2x0aXBPcGVuID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlVG9vbHRpcE9wZW5cIiwgNik7XHJcbiAgICB0aGlzLmd1aWQgPSBgY2FsY2l0ZS10b29sdGlwLSR7Z3VpZCgpfWA7XHJcbiAgICB0aGlzLmhhc0xvYWRlZCA9IGZhbHNlO1xyXG4gICAgdGhpcy5vcGVuVHJhbnNpdGlvblByb3AgPSBcIm9wYWNpdHlcIjtcclxuICAgIHRoaXMuc2V0VHJhbnNpdGlvbkVsID0gKGVsKSA9PiB7XHJcbiAgICAgIHRoaXMudHJhbnNpdGlvbkVsID0gZWw7XHJcbiAgICAgIGNvbm5lY3RPcGVuQ2xvc2VDb21wb25lbnQodGhpcyk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5zZXRVcFJlZmVyZW5jZUVsZW1lbnQgPSAod2FybiA9IHRydWUpID0+IHtcclxuICAgICAgdGhpcy5yZW1vdmVSZWZlcmVuY2VzKCk7XHJcbiAgICAgIHRoaXMuZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCA9IGdldEVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQodGhpcy5lbCk7XHJcbiAgICAgIGNvbm5lY3RGbG9hdGluZ1VJKHRoaXMsIHRoaXMuZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCwgdGhpcy5lbCk7XHJcbiAgICAgIGNvbnN0IHsgZWwsIHJlZmVyZW5jZUVsZW1lbnQsIGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQgfSA9IHRoaXM7XHJcbiAgICAgIGlmICh3YXJuICYmIHJlZmVyZW5jZUVsZW1lbnQgJiYgIWVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQpIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oYCR7ZWwudGFnTmFtZX06IHJlZmVyZW5jZS1lbGVtZW50IGlkIFwiJHtyZWZlcmVuY2VFbGVtZW50fVwiIHdhcyBub3QgZm91bmQuYCwge1xyXG4gICAgICAgICAgZWxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgICB0aGlzLmFkZFJlZmVyZW5jZXMoKTtcclxuICAgIH07XHJcbiAgICB0aGlzLmdldElkID0gKCkgPT4ge1xyXG4gICAgICByZXR1cm4gdGhpcy5lbC5pZCB8fCB0aGlzLmd1aWQ7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5hZGRSZWZlcmVuY2VzID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQgfSA9IHRoaXM7XHJcbiAgICAgIGlmICghZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBpZCA9IHRoaXMuZ2V0SWQoKTtcclxuICAgICAgaWYgKFwic2V0QXR0cmlidXRlXCIgaW4gZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xyXG4gICAgICAgIGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQuc2V0QXR0cmlidXRlKEFSSUFfREVTQ1JJQkVEX0JZLCBpZCk7XHJcbiAgICAgIH1cclxuICAgICAgbWFuYWdlci5yZWdpc3RlckVsZW1lbnQoZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCwgdGhpcy5lbCk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5yZW1vdmVSZWZlcmVuY2VzID0gKCkgPT4ge1xyXG4gICAgICBjb25zdCB7IGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQgfSA9IHRoaXM7XHJcbiAgICAgIGlmICghZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBpZiAoXCJyZW1vdmVBdHRyaWJ1dGVcIiBpbiBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50KSB7XHJcbiAgICAgICAgZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoQVJJQV9ERVNDUklCRURfQlkpO1xyXG4gICAgICB9XHJcbiAgICAgIG1hbmFnZXIudW5yZWdpc3RlckVsZW1lbnQoZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCk7XHJcbiAgICB9O1xyXG4gICAgdGhpcy5jbG9zZU9uQ2xpY2sgPSBmYWxzZTtcclxuICAgIHRoaXMubGFiZWwgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLm9mZnNldERpc3RhbmNlID0gZGVmYXVsdE9mZnNldERpc3RhbmNlO1xyXG4gICAgdGhpcy5vZmZzZXRTa2lkZGluZyA9IDA7XHJcbiAgICB0aGlzLm9wZW4gPSBmYWxzZTtcclxuICAgIHRoaXMub3ZlcmxheVBvc2l0aW9uaW5nID0gXCJhYnNvbHV0ZVwiO1xyXG4gICAgdGhpcy5wbGFjZW1lbnQgPSBcImF1dG9cIjtcclxuICAgIHRoaXMucmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCA9IHVuZGVmaW5lZDtcclxuICB9XHJcbiAgb2Zmc2V0RGlzdGFuY2VPZmZzZXRIYW5kbGVyKCkge1xyXG4gICAgdGhpcy5yZXBvc2l0aW9uKHRydWUpO1xyXG4gIH1cclxuICBvZmZzZXRTa2lkZGluZ0hhbmRsZXIoKSB7XHJcbiAgICB0aGlzLnJlcG9zaXRpb24odHJ1ZSk7XHJcbiAgfVxyXG4gIG9wZW5IYW5kbGVyKHZhbHVlKSB7XHJcbiAgICBpZiAodmFsdWUpIHtcclxuICAgICAgdGhpcy5yZXBvc2l0aW9uKHRydWUpO1xyXG4gICAgfVxyXG4gICAgZWxzZSB7XHJcbiAgICAgIHVwZGF0ZUFmdGVyQ2xvc2UodGhpcy5lbCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIG92ZXJsYXlQb3NpdGlvbmluZ0hhbmRsZXIoKSB7XHJcbiAgICB0aGlzLnJlcG9zaXRpb24odHJ1ZSk7XHJcbiAgfVxyXG4gIHBsYWNlbWVudEhhbmRsZXIoKSB7XHJcbiAgICB0aGlzLnJlcG9zaXRpb24odHJ1ZSk7XHJcbiAgfVxyXG4gIHJlZmVyZW5jZUVsZW1lbnRIYW5kbGVyKCkge1xyXG4gICAgdGhpcy5zZXRVcFJlZmVyZW5jZUVsZW1lbnQoKTtcclxuICB9XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBMaWZlY3ljbGVcclxuICAvL1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgY29ubmVjdGVkQ2FsbGJhY2soKSB7XHJcbiAgICBjb25uZWN0T3BlbkNsb3NlQ29tcG9uZW50KHRoaXMpO1xyXG4gICAgdGhpcy5zZXRVcFJlZmVyZW5jZUVsZW1lbnQodGhpcy5oYXNMb2FkZWQpO1xyXG4gIH1cclxuICBjb21wb25lbnREaWRMb2FkKCkge1xyXG4gICAgaWYgKHRoaXMucmVmZXJlbmNlRWxlbWVudCAmJiAhdGhpcy5lZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50KSB7XHJcbiAgICAgIHRoaXMuc2V0VXBSZWZlcmVuY2VFbGVtZW50KCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLnJlcG9zaXRpb24odHJ1ZSk7XHJcbiAgICB0aGlzLmhhc0xvYWRlZCA9IHRydWU7XHJcbiAgfVxyXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgdGhpcy5yZW1vdmVSZWZlcmVuY2VzKCk7XHJcbiAgICBkaXNjb25uZWN0RmxvYXRpbmdVSSh0aGlzLCB0aGlzLmVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQsIHRoaXMuZWwpO1xyXG4gICAgZGlzY29ubmVjdE9wZW5DbG9zZUNvbXBvbmVudCh0aGlzKTtcclxuICB9XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBQdWJsaWMgTWV0aG9kc1xyXG4gIC8vXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvKipcclxuICAgKiBVcGRhdGVzIHRoZSBwb3NpdGlvbiBvZiB0aGUgY29tcG9uZW50LlxyXG4gICAqXHJcbiAgICogQHBhcmFtIGRlbGF5ZWRcclxuICAgKi9cclxuICBhc3luYyByZXBvc2l0aW9uKGRlbGF5ZWQgPSBmYWxzZSkge1xyXG4gICAgY29uc3QgeyBlbCwgZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCwgcGxhY2VtZW50LCBvdmVybGF5UG9zaXRpb25pbmcsIG9mZnNldERpc3RhbmNlLCBvZmZzZXRTa2lkZGluZywgYXJyb3dFbCB9ID0gdGhpcztcclxuICAgIHJldHVybiByZXBvc2l0aW9uKHRoaXMsIHtcclxuICAgICAgZmxvYXRpbmdFbDogZWwsXHJcbiAgICAgIHJlZmVyZW5jZUVsOiBlZmZlY3RpdmVSZWZlcmVuY2VFbGVtZW50LFxyXG4gICAgICBvdmVybGF5UG9zaXRpb25pbmcsXHJcbiAgICAgIHBsYWNlbWVudCxcclxuICAgICAgb2Zmc2V0RGlzdGFuY2UsXHJcbiAgICAgIG9mZnNldFNraWRkaW5nLFxyXG4gICAgICBpbmNsdWRlQXJyb3c6IHRydWUsXHJcbiAgICAgIGFycm93RWwsXHJcbiAgICAgIHR5cGU6IFwidG9vbHRpcFwiXHJcbiAgICB9LCBkZWxheWVkKTtcclxuICB9XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBQcml2YXRlIE1ldGhvZHNcclxuICAvL1xyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgb25CZWZvcmVPcGVuKCkge1xyXG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcEJlZm9yZU9wZW4uZW1pdCgpO1xyXG4gIH1cclxuICBvbk9wZW4oKSB7XHJcbiAgICB0aGlzLmNhbGNpdGVUb29sdGlwT3Blbi5lbWl0KCk7XHJcbiAgfVxyXG4gIG9uQmVmb3JlQ2xvc2UoKSB7XHJcbiAgICB0aGlzLmNhbGNpdGVUb29sdGlwQmVmb3JlQ2xvc2UuZW1pdCgpO1xyXG4gIH1cclxuICBvbkNsb3NlKCkge1xyXG4gICAgdGhpcy5jYWxjaXRlVG9vbHRpcENsb3NlLmVtaXQoKTtcclxuICB9XHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBSZW5kZXIgTWV0aG9kc1xyXG4gIC8vXHJcbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICByZW5kZXIoKSB7XHJcbiAgICBjb25zdCB7IGVmZmVjdGl2ZVJlZmVyZW5jZUVsZW1lbnQsIGxhYmVsLCBvcGVuIH0gPSB0aGlzO1xyXG4gICAgY29uc3QgZGlzcGxheWVkID0gZWZmZWN0aXZlUmVmZXJlbmNlRWxlbWVudCAmJiBvcGVuO1xyXG4gICAgY29uc3QgaGlkZGVuID0gIWRpc3BsYXllZDtcclxuICAgIHJldHVybiAoaChIb3N0LCB7IFwiYXJpYS1oaWRkZW5cIjogdG9BcmlhQm9vbGVhbihoaWRkZW4pLCBcImFyaWEtbGFiZWxcIjogbGFiZWwsIFwiYXJpYS1saXZlXCI6IFwicG9saXRlXCIsIFwiY2FsY2l0ZS1oeWRyYXRlZC1oaWRkZW5cIjogaGlkZGVuLCBpZDogdGhpcy5nZXRJZCgpLCByb2xlOiBcInRvb2x0aXBcIiB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IHtcclxuICAgICAgICBbRmxvYXRpbmdDU1MuYW5pbWF0aW9uXTogdHJ1ZSxcclxuICAgICAgICBbRmxvYXRpbmdDU1MuYW5pbWF0aW9uQWN0aXZlXTogZGlzcGxheWVkXHJcbiAgICAgIH0sIHJlZjogdGhpcy5zZXRUcmFuc2l0aW9uRWwgfSwgaChcImRpdlwiLCB7IGNsYXNzOiBDU1MkMS5hcnJvdywgcmVmOiAoYXJyb3dFbCkgPT4gKHRoaXMuYXJyb3dFbCA9IGFycm93RWwpIH0pLCBoKFwiZGl2XCIsIHsgY2xhc3M6IENTUyQxLmNvbnRhaW5lciB9LCBoKFwic2xvdFwiLCBudWxsKSkpKSk7XHJcbiAgfVxyXG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cclxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xyXG4gICAgXCJvZmZzZXREaXN0YW5jZVwiOiBbXCJvZmZzZXREaXN0YW5jZU9mZnNldEhhbmRsZXJcIl0sXHJcbiAgICBcIm9mZnNldFNraWRkaW5nXCI6IFtcIm9mZnNldFNraWRkaW5nSGFuZGxlclwiXSxcclxuICAgIFwib3BlblwiOiBbXCJvcGVuSGFuZGxlclwiXSxcclxuICAgIFwib3ZlcmxheVBvc2l0aW9uaW5nXCI6IFtcIm92ZXJsYXlQb3NpdGlvbmluZ0hhbmRsZXJcIl0sXHJcbiAgICBcInBsYWNlbWVudFwiOiBbXCJwbGFjZW1lbnRIYW5kbGVyXCJdLFxyXG4gICAgXCJyZWZlcmVuY2VFbGVtZW50XCI6IFtcInJlZmVyZW5jZUVsZW1lbnRIYW5kbGVyXCJdXHJcbiAgfTsgfVxyXG59O1xyXG5Ub29sdGlwLnN0eWxlID0gdG9vbHRpcENzcztcblxuLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtY29tcG9uZW50cy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuMC41XG4gKi9cbmZ1bmN0aW9uIGlzVHJlZUl0ZW0oZWxlbWVudCkge1xuICByZXR1cm4gZWxlbWVudD8ubWF0Y2hlcyhcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xufVxuZnVuY3Rpb24gZ2V0RW5hYmxlZFNpYmxpbmdJdGVtKGVsLCBkaXJlY3Rpb24pIHtcbiAgY29uc3QgZGlyZWN0aW9uUHJvcCA9IGRpcmVjdGlvbiA9PT0gXCJkb3duXCIgPyBcIm5leHRFbGVtZW50U2libGluZ1wiIDogXCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nXCI7XG4gIGxldCBjdXJyZW50RWwgPSBlbDtcbiAgbGV0IGVuYWJsZWRFbCA9IG51bGw7XG4gIHdoaWxlIChpc1RyZWVJdGVtKGN1cnJlbnRFbCkpIHtcbiAgICBpZiAoIWN1cnJlbnRFbC5kaXNhYmxlZCkge1xuICAgICAgZW5hYmxlZEVsID0gY3VycmVudEVsO1xuICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGN1cnJlbnRFbCA9IGN1cnJlbnRFbFtkaXJlY3Rpb25Qcm9wXTtcbiAgfVxuICByZXR1cm4gZW5hYmxlZEVsO1xufVxuXG5jb25zdCB0cmVlQ3NzID0gXCJAa2V5ZnJhbWVzIGluezAle29wYWNpdHk6MH0xMDAle29wYWNpdHk6MX19QGtleWZyYW1lcyBpbi1kb3duezAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM0QoMCwgLTVweCwgMCl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnRyYW5zbGF0ZTNEKDAsIDAsIDApfX1Aa2V5ZnJhbWVzIGluLXVwezAle29wYWNpdHk6MDt0cmFuc2Zvcm06dHJhbnNsYXRlM0QoMCwgNXB4LCAwKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM0QoMCwgMCwgMCl9fUBrZXlmcmFtZXMgaW4tc2NhbGV7MCV7b3BhY2l0eTowO3RyYW5zZm9ybTpzY2FsZTNEKDAuOTUsIDAuOTUsIDEpfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTpzY2FsZTNEKDEsIDEsIDEpfX06cm9vdHstLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZzpjYWxjKDE1MG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yOnZhcigtLWNhbGNpdGUtZHVyYXRpb24tZmFjdG9yLCAxKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1mYXN0OmNhbGMoMTAwbXMgKiB2YXIoLS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcikpOy0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLW1lZGl1bTpjYWxjKDIwMG1zICogdmFyKC0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3IpKTstLWNhbGNpdGUtaW50ZXJuYWwtYW5pbWF0aW9uLXRpbWluZy1zbG93OmNhbGMoMzAwbXMgKiB2YXIoLS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcikpfS5jYWxjaXRlLWFuaW1hdGV7b3BhY2l0eTowO2FuaW1hdGlvbi1maWxsLW1vZGU6Ym90aDthbmltYXRpb24tZHVyYXRpb246dmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKX0uY2FsY2l0ZS1hbmltYXRlX19pbnthbmltYXRpb24tbmFtZTppbn0uY2FsY2l0ZS1hbmltYXRlX19pbi1kb3due2FuaW1hdGlvbi1uYW1lOmluLWRvd259LmNhbGNpdGUtYW5pbWF0ZV9faW4tdXB7YW5pbWF0aW9uLW5hbWU6aW4tdXB9LmNhbGNpdGUtYW5pbWF0ZV9faW4tc2NhbGV7YW5pbWF0aW9uLW5hbWU6aW4tc2NhbGV9QG1lZGlhIChwcmVmZXJzLXJlZHVjZWQtbW90aW9uOiByZWR1Y2Upezpyb290ey0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3I6MH19OnJvb3R7LS1jYWxjaXRlLWZsb2F0aW5nLXVpLXRyYW5zaXRpb246dmFyKC0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nKTstLWNhbGNpdGUtZmxvYXRpbmctdWktei1pbmRleDo2MDB9Omhvc3QoW2hpZGRlbl0pe2Rpc3BsYXk6bm9uZX06aG9zdHtkaXNwbGF5OmJsb2NrfTpob3N0KDpmb2N1cyl7b3V0bGluZToycHggc29saWQgdHJhbnNwYXJlbnQ7b3V0bGluZS1vZmZzZXQ6MnB4fVwiO1xuXG5jb25zdCBUcmVlID0gY2xhc3Mge1xyXG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcclxuICAgIHJlZ2lzdGVySW5zdGFuY2UodGhpcywgaG9zdFJlZik7XHJcbiAgICB0aGlzLmNhbGNpdGVUcmVlU2VsZWN0ID0gY3JlYXRlRXZlbnQodGhpcywgXCJjYWxjaXRlVHJlZVNlbGVjdFwiLCA2KTtcclxuICAgIHRoaXMubGluZXMgPSBmYWxzZTtcclxuICAgIHRoaXMuY2hpbGQgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnNjYWxlID0gXCJtXCI7XHJcbiAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPSBcInNpbmdsZVwiO1xyXG4gICAgdGhpcy5zZWxlY3RlZEl0ZW1zID0gW107XHJcbiAgfVxyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBMaWZlY3ljbGVcclxuICAvL1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBjb21wb25lbnRXaWxsUmVuZGVyKCkge1xyXG4gICAgY29uc3QgcGFyZW50ID0gdGhpcy5lbC5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlXCIpO1xyXG4gICAgdGhpcy5saW5lcyA9IHBhcmVudCA/IHBhcmVudC5saW5lcyA6IHRoaXMubGluZXM7XHJcbiAgICB0aGlzLnNjYWxlID0gcGFyZW50ID8gcGFyZW50LnNjYWxlIDogdGhpcy5zY2FsZTtcclxuICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9IHBhcmVudCA/IHBhcmVudC5zZWxlY3Rpb25Nb2RlIDogdGhpcy5zZWxlY3Rpb25Nb2RlO1xyXG4gICAgdGhpcy5jaGlsZCA9ICEhcGFyZW50O1xyXG4gIH1cclxuICByZW5kZXIoKSB7XHJcbiAgICByZXR1cm4gKGgoSG9zdCwgeyBcImFyaWEtbXVsdGlzZWxlY3RhYmxlXCI6IHRoaXMuY2hpbGRcclxuICAgICAgICA/IHVuZGVmaW5lZFxyXG4gICAgICAgIDogKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aXBsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIpLnRvU3RyaW5nKCksIHJvbGU6ICF0aGlzLmNoaWxkID8gXCJ0cmVlXCIgOiB1bmRlZmluZWQsIHRhYkluZGV4OiB0aGlzLmdldFJvb3RUYWJJbmRleCgpIH0sIGgoXCJzbG90XCIsIG51bGwpKSk7XHJcbiAgfVxyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBFdmVudCBMaXN0ZW5lcnNcclxuICAvL1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBvbkZvY3VzKCkge1xyXG4gICAgaWYgKCF0aGlzLmNoaWxkKSB7XHJcbiAgICAgIGNvbnN0IGZvY3VzVGFyZ2V0ID0gdGhpcy5lbC5xdWVyeVNlbGVjdG9yKFwiY2FsY2l0ZS10cmVlLWl0ZW1bc2VsZWN0ZWRdOm5vdChbZGlzYWJsZWRdKVwiKSB8fCB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3IoXCJjYWxjaXRlLXRyZWUtaXRlbTpub3QoW2Rpc2FibGVkXSlcIik7XHJcbiAgICAgIGZvY3VzRWxlbWVudChmb2N1c1RhcmdldCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIG9uRm9jdXNJbihldmVudCkge1xyXG4gICAgY29uc3QgZm9jdXNlZEZyb21Sb290T3JPdXRzaWRlVHJlZSA9IGV2ZW50LnJlbGF0ZWRUYXJnZXQgPT09IHRoaXMuZWwgfHwgIXRoaXMuZWwuY29udGFpbnMoZXZlbnQucmVsYXRlZFRhcmdldCk7XHJcbiAgICBpZiAoZm9jdXNlZEZyb21Sb290T3JPdXRzaWRlVHJlZSkge1xyXG4gICAgICAvLyBnaXZlcyB1c2VyIHRoZSBhYmlsaXR5IHRvIHRhYiBpbnRvIGV4dGVybmFsIGVsZW1lbnRzIChtb2RpZnlpbmcgdGFiaW5kZXggcHJvcGVydHkgd2lsbCBub3Qgd29yayBpbiBmaXJlZm94KVxyXG4gICAgICB0aGlzLmVsLnJlbW92ZUF0dHJpYnV0ZShcInRhYmluZGV4XCIpO1xyXG4gICAgfVxyXG4gIH1cclxuICBvbkZvY3VzT3V0KGV2ZW50KSB7XHJcbiAgICBjb25zdCB3aWxsRm9jdXNPdXRzaWRlVHJlZSA9ICF0aGlzLmVsLmNvbnRhaW5zKGV2ZW50LnJlbGF0ZWRUYXJnZXQpO1xyXG4gICAgaWYgKHdpbGxGb2N1c091dHNpZGVUcmVlKSB7XHJcbiAgICAgIHRoaXMuZWwudGFiSW5kZXggPSB0aGlzLmdldFJvb3RUYWJJbmRleCgpO1xyXG4gICAgfVxyXG4gIH1cclxuICBvbkNsaWNrKGV2ZW50KSB7XHJcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XHJcbiAgICBjb25zdCBjaGlsZEl0ZW1zID0gbm9kZUxpc3RUb0FycmF5KHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW1cIikpO1xyXG4gICAgaWYgKHRoaXMuY2hpbGQpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgaWYgKCF0aGlzLmNoaWxkKSB7XHJcbiAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgfVxyXG4gICAgaWYgKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJhbmNlc3RvcnNcIiAmJiAhdGhpcy5jaGlsZCkge1xyXG4gICAgICB0aGlzLnVwZGF0ZUFuY2VzdG9yVHJlZShldmVudCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGlzTm9uZVNlbGVjdGlvbk1vZGUgPSB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibm9uZVwiO1xyXG4gICAgY29uc3Qgc2hvdWxkU2VsZWN0ID0gdGhpcy5zZWxlY3Rpb25Nb2RlICE9PSBudWxsICYmXHJcbiAgICAgICghdGFyZ2V0Lmhhc0NoaWxkcmVuIHx8XHJcbiAgICAgICAgKHRhcmdldC5oYXNDaGlsZHJlbiAmJlxyXG4gICAgICAgICAgKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJjaGlsZHJlblwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIpKSk7XHJcbiAgICBjb25zdCBzaG91bGRNb2RpZnlUb0N1cnJlbnRTZWxlY3Rpb24gPSAhaXNOb25lU2VsZWN0aW9uTW9kZSAmJlxyXG4gICAgICBldmVudC5kZXRhaWwubW9kaWZ5Q3VycmVudFNlbGVjdGlvbiAmJlxyXG4gICAgICAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpcGxlXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpY2hpbGRyZW5cIik7XHJcbiAgICBjb25zdCBzaG91bGRTZWxlY3RDaGlsZHJlbiA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImNoaWxkcmVuXCI7XHJcbiAgICBjb25zdCBzaG91bGRDbGVhckN1cnJlbnRTZWxlY3Rpb24gPSAhc2hvdWxkTW9kaWZ5VG9DdXJyZW50U2VsZWN0aW9uICYmXHJcbiAgICAgICgoKHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJzaW5nbGVcIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGlwbGVcIikgJiZcclxuICAgICAgICBjaGlsZEl0ZW1zLmxlbmd0aCA8PSAwKSB8fFxyXG4gICAgICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJjaGlsZHJlblwiIHx8XHJcbiAgICAgICAgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpY2hpbGRyZW5cIik7XHJcbiAgICBjb25zdCBzaG91bGRFeHBhbmRUYXJnZXQgPSB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwiY2hpbGRyZW5cIiB8fCB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibXVsdGljaGlsZHJlblwiO1xyXG4gICAgaWYgKCF0aGlzLmNoaWxkKSB7XHJcbiAgICAgIGNvbnN0IHRhcmdldEl0ZW1zID0gW107XHJcbiAgICAgIGlmIChzaG91bGRTZWxlY3QpIHtcclxuICAgICAgICB0YXJnZXRJdGVtcy5wdXNoKHRhcmdldCk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHNob3VsZFNlbGVjdENoaWxkcmVuKSB7XHJcbiAgICAgICAgY2hpbGRJdGVtcy5mb3JFYWNoKCh0cmVlSXRlbSkgPT4ge1xyXG4gICAgICAgICAgdGFyZ2V0SXRlbXMucHVzaCh0cmVlSXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHNob3VsZENsZWFyQ3VycmVudFNlbGVjdGlvbikge1xyXG4gICAgICAgIGNvbnN0IHNlbGVjdGVkSXRlbXMgPSBub2RlTGlzdFRvQXJyYXkodGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW1bc2VsZWN0ZWRdXCIpKTtcclxuICAgICAgICBzZWxlY3RlZEl0ZW1zLmZvckVhY2goKHRyZWVJdGVtKSA9PiB7XHJcbiAgICAgICAgICBpZiAoIXRhcmdldEl0ZW1zLmluY2x1ZGVzKHRyZWVJdGVtKSkge1xyXG4gICAgICAgICAgICB0cmVlSXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGlmIChzaG91bGRFeHBhbmRUYXJnZXQgJiYgIWV2ZW50LmRldGFpbC5mb3JjZVRvZ2dsZSkge1xyXG4gICAgICAgIHRhcmdldC5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgIH1cclxuICAgICAgaWYgKHNob3VsZE1vZGlmeVRvQ3VycmVudFNlbGVjdGlvbikge1xyXG4gICAgICAgIHdpbmRvdy5nZXRTZWxlY3Rpb24oKS5yZW1vdmVBbGxSYW5nZXMoKTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoKHNob3VsZE1vZGlmeVRvQ3VycmVudFNlbGVjdGlvbiAmJiB0YXJnZXQuc2VsZWN0ZWQpIHx8XHJcbiAgICAgICAgKHNob3VsZFNlbGVjdENoaWxkcmVuICYmIGV2ZW50LmRldGFpbC5mb3JjZVRvZ2dsZSkpIHtcclxuICAgICAgICB0YXJnZXRJdGVtcy5mb3JFYWNoKCh0cmVlSXRlbSkgPT4ge1xyXG4gICAgICAgICAgaWYgKCF0cmVlSXRlbS5kaXNhYmxlZCkge1xyXG4gICAgICAgICAgICB0cmVlSXRlbS5zZWxlY3RlZCA9IGZhbHNlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGVsc2UgaWYgKCFpc05vbmVTZWxlY3Rpb25Nb2RlKSB7XHJcbiAgICAgICAgdGFyZ2V0SXRlbXMuZm9yRWFjaCgodHJlZUl0ZW0pID0+IHtcclxuICAgICAgICAgIGlmICghdHJlZUl0ZW0uZGlzYWJsZWQpIHtcclxuICAgICAgICAgICAgdHJlZUl0ZW0uc2VsZWN0ZWQgPSB0cnVlO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnNlbGVjdGVkSXRlbXMgPSBpc05vbmVTZWxlY3Rpb25Nb2RlXHJcbiAgICAgID8gW3RhcmdldF1cclxuICAgICAgOiBub2RlTGlzdFRvQXJyYXkodGhpcy5lbC5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW1cIikpLmZpbHRlcigoaSkgPT4gaS5zZWxlY3RlZCk7XHJcbiAgICB0aGlzLmNhbGNpdGVUcmVlU2VsZWN0LmVtaXQoKTtcclxuICAgIGV2ZW50LnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gIH1cclxuICBrZXlEb3duSGFuZGxlcihldmVudCkge1xyXG4gICAgY29uc3Qgcm9vdCA9IHRoaXMuZWwuY2xvc2VzdChcImNhbGNpdGUtdHJlZTpub3QoW2NoaWxkXSlcIik7XHJcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XHJcbiAgICBpZiAoIShyb290ID09PSB0aGlzLmVsICYmIHRhcmdldC50YWdOYW1lID09PSBcIkNBTENJVEUtVFJFRS1JVEVNXCIgJiYgdGhpcy5lbC5jb250YWlucyh0YXJnZXQpKSkge1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93RG93blwiKSB7XHJcbiAgICAgIGNvbnN0IG5leHQgPSBnZXRFbmFibGVkU2libGluZ0l0ZW0odGFyZ2V0Lm5leHRFbGVtZW50U2libGluZywgXCJkb3duXCIpO1xyXG4gICAgICBpZiAobmV4dCkge1xyXG4gICAgICAgIG5leHQuZm9jdXMoKTtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dVcFwiKSB7XHJcbiAgICAgIGNvbnN0IHByZXZpb3VzID0gZ2V0RW5hYmxlZFNpYmxpbmdJdGVtKHRhcmdldC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nLCBcInVwXCIpO1xyXG4gICAgICBpZiAocHJldmlvdXMpIHtcclxuICAgICAgICBwcmV2aW91cy5mb2N1cygpO1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIGlmIChldmVudC5rZXkgPT09IFwiQXJyb3dMZWZ0XCIgJiYgIXRhcmdldC5kaXNhYmxlZCkge1xyXG4gICAgICAvLyBXaGVuIGZvY3VzIGlzIG9uIGFuIG9wZW4gbm9kZSwgY2xvc2VzIHRoZSBub2RlLlxyXG4gICAgICBpZiAodGFyZ2V0Lmhhc0NoaWxkcmVuICYmIHRhcmdldC5leHBhbmRlZCkge1xyXG4gICAgICAgIHRhcmdldC5leHBhbmRlZCA9IGZhbHNlO1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgICB9XHJcbiAgICAgIC8vIFdoZW4gZm9jdXMgaXMgb24gYSBjaGlsZCBub2RlIHRoYXQgaXMgYWxzbyBlaXRoZXIgYW4gZW5kIG5vZGUgb3IgYSBjbG9zZWQgbm9kZSwgbW92ZXMgZm9jdXMgdG8gaXRzIHBhcmVudCBub2RlLlxyXG4gICAgICBjb25zdCBwYXJlbnRJdGVtID0gdGFyZ2V0LnBhcmVudEVsZW1lbnQuY2xvc2VzdChcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xyXG4gICAgICBpZiAocGFyZW50SXRlbSAmJiAoIXRhcmdldC5oYXNDaGlsZHJlbiB8fCB0YXJnZXQuZXhwYW5kZWQgPT09IGZhbHNlKSkge1xyXG4gICAgICAgIHBhcmVudEl0ZW0uZm9jdXMoKTtcclxuICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICAvLyBXaGVuIGZvY3VzIGlzIG9uIGEgcm9vdCBub2RlIHRoYXQgaXMgYWxzbyBlaXRoZXIgYW4gZW5kIG5vZGUgb3IgYSBjbG9zZWQgbm9kZSwgZG9lcyBub3RoaW5nLlxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgICBpZiAoZXZlbnQua2V5ID09PSBcIkFycm93UmlnaHRcIiAmJiAhdGFyZ2V0LmRpc2FibGVkKSB7XHJcbiAgICAgIGlmICh0YXJnZXQuaGFzQ2hpbGRyZW4pIHtcclxuICAgICAgICBpZiAodGFyZ2V0LmV4cGFuZGVkICYmIGdldFJvb3ROb2RlKHRoaXMuZWwpLmFjdGl2ZUVsZW1lbnQgPT09IHRhcmdldCkge1xyXG4gICAgICAgICAgLy8gV2hlbiBmb2N1cyBpcyBvbiBhbiBvcGVuIG5vZGUsIG1vdmVzIGZvY3VzIHRvIHRoZSBmaXJzdCBjaGlsZCBub2RlLlxyXG4gICAgICAgICAgZ2V0RW5hYmxlZFNpYmxpbmdJdGVtKHRhcmdldC5xdWVyeVNlbGVjdG9yKFwiY2FsY2l0ZS10cmVlLWl0ZW1cIiksIFwiZG93blwiKT8uZm9jdXMoKTtcclxuICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgLy8gV2hlbiBmb2N1cyBpcyBvbiBhIGNsb3NlZCBub2RlLCBvcGVucyB0aGUgbm9kZTsgZm9jdXMgZG9lcyBub3QgbW92ZS5cclxuICAgICAgICAgIHRhcmdldC5leHBhbmRlZCA9IHRydWU7XHJcbiAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcbiAgfVxyXG4gIHVwZGF0ZUFuY2VzdG9yVHJlZShldmVudCkge1xyXG4gICAgY29uc3QgaXRlbSA9IGV2ZW50LnRhcmdldDtcclxuICAgIGlmIChpdGVtLmRpc2FibGVkKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIGNvbnN0IGFuY2VzdG9ycyA9IFtdO1xyXG4gICAgbGV0IHBhcmVudCA9IGl0ZW0ucGFyZW50RWxlbWVudC5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlLWl0ZW1cIik7XHJcbiAgICB3aGlsZSAocGFyZW50KSB7XHJcbiAgICAgIGFuY2VzdG9ycy5wdXNoKHBhcmVudCk7XHJcbiAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnRFbGVtZW50LmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKTtcclxuICAgIH1cclxuICAgIGNvbnN0IGNoaWxkSXRlbXMgPSBBcnJheS5mcm9tKGl0ZW0ucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtOm5vdChbZGlzYWJsZWRdKVwiKSk7XHJcbiAgICBjb25zdCBjaGlsZEl0ZW1zV2l0aE5vQ2hpbGRyZW4gPSBjaGlsZEl0ZW1zLmZpbHRlcigoY2hpbGQpID0+ICFjaGlsZC5oYXNDaGlsZHJlbik7XHJcbiAgICBjb25zdCBjaGlsZEl0ZW1zV2l0aENoaWxkcmVuID0gY2hpbGRJdGVtcy5maWx0ZXIoKGNoaWxkKSA9PiBjaGlsZC5oYXNDaGlsZHJlbik7XHJcbiAgICBjb25zdCBmdXR1cmVTZWxlY3RlZCA9IGl0ZW0uaGFzQ2hpbGRyZW5cclxuICAgICAgPyAhKGl0ZW0uc2VsZWN0ZWQgfHwgaXRlbS5pbmRldGVybWluYXRlKVxyXG4gICAgICA6ICFpdGVtLnNlbGVjdGVkO1xyXG4gICAgY2hpbGRJdGVtc1dpdGhOb0NoaWxkcmVuLmZvckVhY2goKGVsKSA9PiB7XHJcbiAgICAgIGVsLnNlbGVjdGVkID0gZnV0dXJlU2VsZWN0ZWQ7XHJcbiAgICAgIGVsLmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcclxuICAgIH0pO1xyXG4gICAgZnVuY3Rpb24gdXBkYXRlSXRlbVN0YXRlKGNoaWxkSXRlbXMsIGl0ZW0pIHtcclxuICAgICAgY29uc3Qgc2VsZWN0ZWQgPSBjaGlsZEl0ZW1zLmZpbHRlcigoY2hpbGQpID0+IGNoaWxkLnNlbGVjdGVkKTtcclxuICAgICAgY29uc3QgdW5zZWxlY3RlZCA9IGNoaWxkSXRlbXMuZmlsdGVyKChjaGlsZCkgPT4gIWNoaWxkLnNlbGVjdGVkKTtcclxuICAgICAgaXRlbS5zZWxlY3RlZCA9IHNlbGVjdGVkLmxlbmd0aCA9PT0gY2hpbGRJdGVtcy5sZW5ndGg7XHJcbiAgICAgIGl0ZW0uaW5kZXRlcm1pbmF0ZSA9IHNlbGVjdGVkLmxlbmd0aCA+IDAgJiYgdW5zZWxlY3RlZC5sZW5ndGggPiAwO1xyXG4gICAgfVxyXG4gICAgY2hpbGRJdGVtc1dpdGhDaGlsZHJlbi5mb3JFYWNoKChlbCkgPT4ge1xyXG4gICAgICBjb25zdCBkaXJlY3RDaGlsZEl0ZW1zID0gQXJyYXkuZnJvbShlbC5xdWVyeVNlbGVjdG9yQWxsKFwiOnNjb3BlID4gY2FsY2l0ZS10cmVlID4gY2FsY2l0ZS10cmVlLWl0ZW1cIikpO1xyXG4gICAgICB1cGRhdGVJdGVtU3RhdGUoZGlyZWN0Q2hpbGRJdGVtcywgZWwpO1xyXG4gICAgfSk7XHJcbiAgICBpZiAoaXRlbS5oYXNDaGlsZHJlbikge1xyXG4gICAgICB1cGRhdGVJdGVtU3RhdGUoY2hpbGRJdGVtcywgaXRlbSk7XHJcbiAgICB9XHJcbiAgICBlbHNlIHtcclxuICAgICAgaXRlbS5zZWxlY3RlZCA9IGZ1dHVyZVNlbGVjdGVkO1xyXG4gICAgICBpdGVtLmluZGV0ZXJtaW5hdGUgPSBmYWxzZTtcclxuICAgIH1cclxuICAgIGFuY2VzdG9ycy5mb3JFYWNoKChhbmNlc3RvcikgPT4ge1xyXG4gICAgICBjb25zdCBkZXNjZW5kYW50cyA9IG5vZGVMaXN0VG9BcnJheShhbmNlc3Rvci5xdWVyeVNlbGVjdG9yQWxsKFwiY2FsY2l0ZS10cmVlLWl0ZW1cIikpO1xyXG4gICAgICBjb25zdCBhY3RpdmVEZXNjZW5kYW50cyA9IGRlc2NlbmRhbnRzLmZpbHRlcigoZWwpID0+IGVsLnNlbGVjdGVkKTtcclxuICAgICAgaWYgKGFjdGl2ZURlc2NlbmRhbnRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIGFuY2VzdG9yLnNlbGVjdGVkID0gZmFsc2U7XHJcbiAgICAgICAgYW5jZXN0b3IuaW5kZXRlcm1pbmF0ZSA9IGZhbHNlO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgICBjb25zdCBpbmRldGVybWluYXRlID0gYWN0aXZlRGVzY2VuZGFudHMubGVuZ3RoIDwgZGVzY2VuZGFudHMubGVuZ3RoO1xyXG4gICAgICBhbmNlc3Rvci5pbmRldGVybWluYXRlID0gaW5kZXRlcm1pbmF0ZTtcclxuICAgICAgYW5jZXN0b3Iuc2VsZWN0ZWQgPSAhaW5kZXRlcm1pbmF0ZTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5zZWxlY3RlZEl0ZW1zID0gbm9kZUxpc3RUb0FycmF5KHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbChcImNhbGNpdGUtdHJlZS1pdGVtXCIpKS5maWx0ZXIoKGkpID0+IGkuc2VsZWN0ZWQpO1xyXG4gICAgdGhpcy5jYWxjaXRlVHJlZVNlbGVjdC5lbWl0KCk7XHJcbiAgfVxyXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgLy9cclxuICAvLyAgUHJpdmF0ZSBNZXRob2RzXHJcbiAgLy9cclxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcbiAgZ2V0Um9vdFRhYkluZGV4KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLmNoaWxkID8gMCA6IC0xO1xyXG4gIH1cclxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XHJcbn07XHJcblRyZWUuc3R5bGUgPSB0cmVlQ3NzO1xuXG4vKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuY29uc3QgQ1NTID0ge1xuICBhY3Rpb25zRW5kOiBcImFjdGlvbnMtZW5kXCIsXG4gIGNoZWNrYm94TGFiZWw6IFwiY2hlY2tib3gtbGFiZWxcIixcbiAgY2hlY2tib3g6IFwiY2hlY2tib3hcIixcbiAgY2hldnJvbjogXCJjaGV2cm9uXCIsXG4gIG5vZGVDb250YWluZXI6IFwibm9kZS1jb250YWluZXJcIixcbiAgY2hpbGRyZW5Db250YWluZXI6IFwiY2hpbGRyZW4tY29udGFpbmVyXCIsXG4gIGJ1bGxldFBvaW50SWNvbjogXCJidWxsZXQtcG9pbnRcIixcbiAgY2hlY2ttYXJrSWNvbjogXCJjaGVja21hcmtcIixcbiAgaXRlbUV4cGFuZGVkOiBcIml0ZW0tLWV4cGFuZGVkXCIsXG4gIGljb25TdGFydDogXCJpY29uLXN0YXJ0XCJcbn07XG5jb25zdCBTTE9UUyA9IHtcbiAgYWN0aW9uc0VuZDogXCJhY3Rpb25zLWVuZFwiLFxuICBjaGlsZHJlbjogXCJjaGlsZHJlblwiXG59O1xuY29uc3QgSUNPTlMgPSB7XG4gIGJ1bGxldFBvaW50OiBcImJ1bGxldC1wb2ludFwiLFxuICBjaGVja21hcms6IFwiY2hlY2tcIixcbiAgY2hldnJvblJpZ2h0OiBcImNoZXZyb24tcmlnaHRcIixcbiAgYmxhbms6IFwiYmxhbmtcIlxufTtcblxuY29uc3QgdHJlZUl0ZW1Dc3MgPSBcIkBrZXlmcmFtZXMgaW57MCV7b3BhY2l0eTowfTEwMCV7b3BhY2l0eToxfX1Aa2V5ZnJhbWVzIGluLWRvd257MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAtNXB4LCAwKX0xMDAle29wYWNpdHk6MTt0cmFuc2Zvcm06dHJhbnNsYXRlM0QoMCwgMCwgMCl9fUBrZXlmcmFtZXMgaW4tdXB7MCV7b3BhY2l0eTowO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCA1cHgsIDApfTEwMCV7b3BhY2l0eToxO3RyYW5zZm9ybTp0cmFuc2xhdGUzRCgwLCAwLCAwKX19QGtleWZyYW1lcyBpbi1zY2FsZXswJXtvcGFjaXR5OjA7dHJhbnNmb3JtOnNjYWxlM0QoMC45NSwgMC45NSwgMSl9MTAwJXtvcGFjaXR5OjE7dHJhbnNmb3JtOnNjYWxlM0QoMSwgMSwgMSl9fTpyb290ey0tY2FsY2l0ZS1hbmltYXRpb24tdGltaW5nOmNhbGMoMTUwbXMgKiB2YXIoLS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcikpOy0tY2FsY2l0ZS1pbnRlcm5hbC1kdXJhdGlvbi1mYWN0b3I6dmFyKC0tY2FsY2l0ZS1kdXJhdGlvbi1mYWN0b3IsIDEpOy0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLWZhc3Q6Y2FsYygxMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSk7LS1jYWxjaXRlLWludGVybmFsLWFuaW1hdGlvbi10aW1pbmctbWVkaXVtOmNhbGMoMjAwbXMgKiB2YXIoLS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcikpOy0tY2FsY2l0ZS1pbnRlcm5hbC1hbmltYXRpb24tdGltaW5nLXNsb3c6Y2FsYygzMDBtcyAqIHZhcigtLWNhbGNpdGUtaW50ZXJuYWwtZHVyYXRpb24tZmFjdG9yKSl9LmNhbGNpdGUtYW5pbWF0ZXtvcGFjaXR5OjA7YW5pbWF0aW9uLWZpbGwtbW9kZTpib3RoO2FuaW1hdGlvbi1kdXJhdGlvbjp2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpfS5jYWxjaXRlLWFuaW1hdGVfX2lue2FuaW1hdGlvbi1uYW1lOmlufS5jYWxjaXRlLWFuaW1hdGVfX2luLWRvd257YW5pbWF0aW9uLW5hbWU6aW4tZG93bn0uY2FsY2l0ZS1hbmltYXRlX19pbi11cHthbmltYXRpb24tbmFtZTppbi11cH0uY2FsY2l0ZS1hbmltYXRlX19pbi1zY2FsZXthbmltYXRpb24tbmFtZTppbi1zY2FsZX1AbWVkaWEgKHByZWZlcnMtcmVkdWNlZC1tb3Rpb246IHJlZHVjZSl7OnJvb3R7LS1jYWxjaXRlLWludGVybmFsLWR1cmF0aW9uLWZhY3RvcjowfX06cm9vdHstLWNhbGNpdGUtZmxvYXRpbmctdWktdHJhbnNpdGlvbjp2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpOy0tY2FsY2l0ZS1mbG9hdGluZy11aS16LWluZGV4OjYwMH06aG9zdChbaGlkZGVuXSl7ZGlzcGxheTpub25lfTpob3N0KFtkaXNhYmxlZF0pe3BvaW50ZXItZXZlbnRzOm5vbmU7Y3Vyc29yOmRlZmF1bHQ7LXdlYmtpdC11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmU7b3BhY2l0eTp2YXIoLS1jYWxjaXRlLXVpLW9wYWNpdHktZGlzYWJsZWQpfTpob3N0e2Rpc3BsYXk6YmxvY2s7bWF4LWlubGluZS1zaXplOjEwMCU7Y3Vyc29yOnBvaW50ZXI7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTMpfVtoaWRkZW5de2Rpc3BsYXk6bm9uZX06aG9zdChbY2FsY2l0ZS1oeWRyYXRlZC1oaWRkZW5dKXt2aXNpYmlsaXR5OmhpZGRlbiAhaW1wb3J0YW50O3BvaW50ZXItZXZlbnRzOm5vbmV9Omhvc3QoW2Rpc2FibGVkXSkgOjpzbG90dGVkKFtjYWxjaXRlLWh5ZHJhdGVkXVtkaXNhYmxlZF0pLDpob3N0KFtkaXNhYmxlZF0pIFtjYWxjaXRlLWh5ZHJhdGVkXVtkaXNhYmxlZF17b3BhY2l0eToxfTpob3N0KFtzY2FsZT1zXSl7Zm9udC1zaXplOnZhcigtLWNhbGNpdGUtZm9udC1zaXplLS0yKTtsaW5lLWhlaWdodDoxcmVtfTpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyey0tY2FsY2l0ZS10cmVlLXBhZGRpbmcteTowLjI1cmVtfTpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyIC5jaGVja2JveCw6aG9zdChbc2NhbGU9c10pIC5ub2RlLWNvbnRhaW5lciAuY2hldnJvbiw6aG9zdChbc2NhbGU9c10pIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJrLDpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7bWFyZ2luLWlubGluZTowLjI1cmVtfTpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyIC5pY29uLXN0YXJ0LDpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVyIC5hY3Rpb25zLWVuZHttYXJnaW4taW5saW5lOjAuMjVyZW19Omhvc3QoW3NjYWxlPW1dKXtmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTEpO2xpbmUtaGVpZ2h0OjFyZW19Omhvc3QoW3NjYWxlPW1dKSAubm9kZS1jb250YWluZXJ7LS1jYWxjaXRlLXRyZWUtcGFkZGluZy15OjAuNXJlbX06aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lciAuY2hlY2tib3gsOmhvc3QoW3NjYWxlPW1dKSAubm9kZS1jb250YWluZXIgLmNoZXZyb24sOmhvc3QoW3NjYWxlPW1dKSAubm9kZS1jb250YWluZXIgLmNoZWNrbWFyayw6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lciAuYnVsbGV0LXBvaW50e21hcmdpbi1pbmxpbmU6MC41cmVtfTpob3N0KFtzY2FsZT1tXSkgLm5vZGUtY29udGFpbmVyIC5pY29uLXN0YXJ0LDpob3N0KFtzY2FsZT1tXSkgLm5vZGUtY29udGFpbmVyIC5hY3Rpb25zLWVuZHttYXJnaW4taW5saW5lOjAuNXJlbX06aG9zdChbc2NhbGU9bF0pe2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0wKTtsaW5lLWhlaWdodDoxLjI1cmVtfTpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyey0tY2FsY2l0ZS10cmVlLXBhZGRpbmcteTowLjc1cmVtfTpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyIC5jaGVja2JveCw6aG9zdChbc2NhbGU9bF0pIC5ub2RlLWNvbnRhaW5lciAuY2hldnJvbiw6aG9zdChbc2NhbGU9bF0pIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJrLDpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7bWFyZ2luLWlubGluZTowLjc1cmVtfTpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyIC5pY29uLXN0YXJ0LDpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVyIC5hY3Rpb25zLWVuZHttYXJnaW4taW5saW5lOjAuNzVyZW19Omhvc3QoW2xpbmVzXSkgLmNoaWxkcmVuLWNvbnRhaW5lcjphZnRlcntwb3NpdGlvbjphYnNvbHV0ZTtpbnNldC1ibG9jay1zdGFydDowcHg7ei1pbmRleDoxO2lubGluZS1zaXplOjFweDt0cmFuc2l0aW9uLXByb3BlcnR5OmNvbG9yLCBiYWNrZ3JvdW5kLWNvbG9yLCBib3JkZXItY29sb3IsIHRleHQtZGVjb3JhdGlvbi1jb2xvciwgZmlsbCwgc3Ryb2tlO3RyYW5zaXRpb24tdGltaW5nLWZ1bmN0aW9uOmN1YmljLWJlemllcigwLjQsIDAsIDAuMiwgMSk7dHJhbnNpdGlvbi1kdXJhdGlvbjoxNTBtczt0cmFuc2l0aW9uOmFsbCB2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGVhc2UtaW4tb3V0IDBzLCBvdXRsaW5lIDBzLCBvdXRsaW5lLW9mZnNldCAwcztibG9jay1zaXplOjk2JTtjb250ZW50OlxcXCJcXFwiO2JhY2tncm91bmQtY29sb3I6dmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMil9Omhvc3QoOm5vdChbbGluZXNdKSkgLm5vZGUtY29udGFpbmVyOmFmdGVye2Rpc3BsYXk6bm9uZX06OnNsb3R0ZWQoKil7bWluLWlubGluZS1zaXplOjBweDttYXgtaW5saW5lLXNpemU6MTAwJTtvdmVyZmxvdy13cmFwOmJyZWFrLXdvcmQ7Y29sb3I6aW5oZXJpdDt0ZXh0LWRlY29yYXRpb246bm9uZSAhaW1wb3J0YW50fTo6c2xvdHRlZCgqKTpob3Zlcnt0ZXh0LWRlY29yYXRpb246bm9uZSAhaW1wb3J0YW50fTo6c2xvdHRlZChhKXtpbmxpbmUtc2l6ZToxMDAlO3RleHQtZGVjb3JhdGlvbi1saW5lOm5vbmV9Omhvc3R7b3V0bGluZS1jb2xvcjp0cmFuc3BhcmVudH06aG9zdCg6Zm9jdXMpe291dGxpbmU6MnB4IHNvbGlkIHRyYW5zcGFyZW50O291dGxpbmU6MnB4IHNvbGlkIHZhcigtLWNhbGNpdGUtdWktYnJhbmQpO291dGxpbmUtb2Zmc2V0Oi0ycHh9c2xvdFtuYW1lPWFjdGlvbnMtZW5kXTo6c2xvdHRlZCgqKSwuYWN0aW9ucy1lbmR7ZGlzcGxheTpmbGV4O2ZsZXgtZGlyZWN0aW9uOnJvdzthbGlnbi1pdGVtczpjZW50ZXI7YWxpZ24tc2VsZjpzdHJldGNoO292ZXJmbG93OnZpc2libGV9LmNoZWNrYm94e2xpbmUtaGVpZ2h0OjB9LmNoZWNrYm94LWxhYmVse3BvaW50ZXItZXZlbnRzOm5vbmU7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcn0uY2hlY2tib3g6Zm9jdXN7b3V0bGluZToycHggc29saWQgdHJhbnNwYXJlbnQ7b3V0bGluZS1vZmZzZXQ6MnB4fS5jaGlsZHJlbi1jb250YWluZXJ7cG9zaXRpb246cmVsYXRpdmU7YmxvY2stc2l6ZTowcHg7b3ZlcmZsb3c6aGlkZGVuO21hcmdpbi1pbmxpbmUtc3RhcnQ6MS4yNXJlbTt0cmFuc2Zvcm06c2NhbGVZKDApO29wYWNpdHk6MDt0cmFuc2l0aW9uOnZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgY3ViaWMtYmV6aWVyKDAuMjE1LCAwLjQ0LCAwLjQyLCAwLjg4KSwgb3BhY2l0eSB2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGN1YmljLWJlemllcigwLjIxNSwgMC40NCwgMC40MiwgMC44OCksIGFsbCB2YXIoLS1jYWxjaXRlLWFuaW1hdGlvbi10aW1pbmcpIGVhc2UtaW4tb3V0O3RyYW5zZm9ybS1vcmlnaW46dG9wfS5pdGVtLS1leHBhbmRlZD4uY2hpbGRyZW4tY29udGFpbmVye292ZXJmbG93OnZpc2libGU7b3BhY2l0eToxO2Jsb2NrLXNpemU6YXV0b30ubm9kZS1jb250YWluZXJ7cG9zaXRpb246cmVsYXRpdmU7ZGlzcGxheTpmbGV4O2FsaWduLWl0ZW1zOmNlbnRlcjtwYWRkaW5nLWJsb2NrOnZhcigtLWNhbGNpdGUtdHJlZS1wYWRkaW5nLXkpO3BhZGRpbmctaW5saW5lOjB9Lm5vZGUtY29udGFpbmVyIC5jaGVja21hcmssLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnR7b3BhY2l0eTowO3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktYm9yZGVyLTEpfS5ub2RlLWNvbnRhaW5lcjpob3ZlciAuY2hlY2ttYXJrLC5ub2RlLWNvbnRhaW5lcjpob3ZlciAuYnVsbGV0LXBvaW50LDpob3N0KFtzZWxlY3RlZF0pIC5ub2RlLWNvbnRhaW5lcjpob3ZlciAuY2hlY2ttYXJrLDpob3N0KFtzZWxlY3RlZF0pIC5ub2RlLWNvbnRhaW5lcjpob3ZlciAuYnVsbGV0LXBvaW50LDpob3N0KDpmb2N1czpub3QoW2Rpc2FibGVkXSkpIC5ub2RlLWNvbnRhaW5lciAuY2hlY2ttYXJrLDpob3N0KDpmb2N1czpub3QoW2Rpc2FibGVkXSkpIC5ub2RlLWNvbnRhaW5lciAuYnVsbGV0LXBvaW50e29wYWNpdHk6MX06aG9zdChbc2VsZWN0ZWRdKSAubm9kZS1jb250YWluZXIsOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVye2ZvbnQtd2VpZ2h0OnZhcigtLWNhbGNpdGUtZm9udC13ZWlnaHQtbWVkaXVtKTtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMSl9Omhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyIC5jaGVja21hcmssOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVyIC5idWxsZXQtcG9pbnQsOmhvc3QoW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyOmhvdmVyIC5jaGVja21hcmt7b3BhY2l0eToxO2NvbG9yOnZhcigtLWNhbGNpdGUtdWktYnJhbmQpfTpob3N0KFtzZWxlY3Rpb24tbW9kZT1ub25lXTpub3QoW2hhcy1jaGlsZHJlbl0pKTpob3N0KFtzY2FsZT1zXSkgLm5vZGUtY29udGFpbmVye3BhZGRpbmctaW5saW5lLXN0YXJ0OjAuNXJlbX06aG9zdChbc2VsZWN0aW9uLW1vZGU9bm9uZV06bm90KFtoYXMtY2hpbGRyZW5dKSk6aG9zdChbc2NhbGU9bV0pIC5ub2RlLWNvbnRhaW5lcntwYWRkaW5nLWlubGluZS1zdGFydDoxcmVtfTpob3N0KFtzZWxlY3Rpb24tbW9kZT1ub25lXTpub3QoW2hhcy1jaGlsZHJlbl0pKTpob3N0KFtzY2FsZT1sXSkgLm5vZGUtY29udGFpbmVye3BhZGRpbmctaW5saW5lLXN0YXJ0OjEuNXJlbX06aG9zdCg6bm90KFtoYXMtY2hpbGRyZW5dKSk6aG9zdChbc2NhbGU9c10pIC5ub2RlLWNvbnRhaW5lcltkYXRhLXNlbGVjdGlvbi1tb2RlPWFuY2VzdG9yc10gLmNoZWNrYm94e3BhZGRpbmctaW5saW5lLXN0YXJ0OjEuMjVyZW19Omhvc3QoOm5vdChbaGFzLWNoaWxkcmVuXSkpOmhvc3QoW3NjYWxlPW1dKSAubm9kZS1jb250YWluZXJbZGF0YS1zZWxlY3Rpb24tbW9kZT1hbmNlc3RvcnNdIC5jaGVja2JveHtwYWRkaW5nLWlubGluZS1zdGFydDoxLjVyZW19Omhvc3QoOm5vdChbaGFzLWNoaWxkcmVuXSkpOmhvc3QoW3NjYWxlPWxdKSAubm9kZS1jb250YWluZXJbZGF0YS1zZWxlY3Rpb24tbW9kZT1hbmNlc3RvcnNdIC5jaGVja2JveHtwYWRkaW5nLWlubGluZS1zdGFydDoxLjc1cmVtfTpob3N0KFtoYXMtY2hpbGRyZW5dKSAubm9kZS1jb250YWluZXJbZGF0YS1zZWxlY3Rpb24tbW9kZT1hbmNlc3RvcnNdIC5jaGVja2JveHttYXJnaW4taW5saW5lLXN0YXJ0OjB9Omhvc3QoW2hhcy1jaGlsZHJlbl0pIC5ub2RlLWNvbnRhaW5lciAuYnVsbGV0LXBvaW50LDpob3N0KFtoYXMtY2hpbGRyZW5dKSAubm9kZS1jb250YWluZXIgLmNoZWNrbWFya3tkaXNwbGF5Om5vbmV9Omhvc3QoW2hhcy1jaGlsZHJlbl1bZXhwYW5kZWRdOm5vdChbc2VsZWN0ZWRdKTpub3QoW3NlbGVjdGlvbi1tb2RlPW5vbmVdKSkgLm5vZGUtY29udGFpbmVyIDo6c2xvdHRlZCgqKXtmb250LXdlaWdodDp2YXIoLS1jYWxjaXRlLWZvbnQtd2VpZ2h0LW1lZGl1bSk7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTEpfTpob3N0KFtoYXMtY2hpbGRyZW5dW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyW2RhdGEtc2VsZWN0aW9uLW1vZGU9Y2hpbGRyZW5dLDpob3N0KFtoYXMtY2hpbGRyZW5dW3NlbGVjdGVkXSkgLm5vZGUtY29udGFpbmVyW2RhdGEtc2VsZWN0aW9uLW1vZGU9bXVsdGljaGlsZHJlbl17Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS1icmFuZCl9LmNoZXZyb257cG9zaXRpb246cmVsYXRpdmU7YWxpZ24tc2VsZjpjZW50ZXI7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTMpO3RyYW5zaXRpb246YWxsIHZhcigtLWNhbGNpdGUtYW5pbWF0aW9uLXRpbWluZykgZWFzZS1pbi1vdXQgMHMsIG91dGxpbmUgMHMsIG91dGxpbmUtb2Zmc2V0IDBzO2ZsZXg6MCAwIGF1dG87dHJhbnNmb3JtOnJvdGF0ZSgwZGVnKX0uY2FsY2l0ZS0tcnRsIC5jaGV2cm9ue3RyYW5zZm9ybTpyb3RhdGUoMTgwZGVnKX0uaXRlbS0tZXhwYW5kZWQ+Lm5vZGUtY29udGFpbmVyPi5jaGV2cm9ue3RyYW5zZm9ybTpyb3RhdGUoOTBkZWcpfTpob3N0KFtzZWxlY3RlZF0pIC5jaGVja21hcmssOmhvc3QoW3NlbGVjdGVkXSkgLmJ1bGxldC1wb2ludHtjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJyYW5kKX1cIjtcblxuY29uc3QgVHJlZUl0ZW0gPSBjbGFzcyB7XHJcbiAgY29uc3RydWN0b3IoaG9zdFJlZikge1xyXG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcclxuICAgIHRoaXMuY2FsY2l0ZUludGVybmFsVHJlZUl0ZW1TZWxlY3QgPSBjcmVhdGVFdmVudCh0aGlzLCBcImNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0XCIsIDYpO1xyXG4gICAgdGhpcy5vcGVuVHJhbnNpdGlvblByb3AgPSBcIm9wYWNpdHlcIjtcclxuICAgIHRoaXMudHJhbnNpdGlvblByb3AgPSBcImV4cGFuZGVkXCI7XHJcbiAgICB0aGlzLmljb25DbGlja0hhbmRsZXIgPSAoZXZlbnQpID0+IHtcclxuICAgICAgZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgIHRoaXMuZXhwYW5kZWQgPSAhdGhpcy5leHBhbmRlZDtcclxuICAgIH07XHJcbiAgICB0aGlzLmNoaWxkcmVuQ2xpY2tIYW5kbGVyID0gKGV2ZW50KSA9PiBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAgIC8vXHJcbiAgICAvLyAgUHJpdmF0ZSBNZXRob2RzXHJcbiAgICAvL1xyXG4gICAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gICAgdGhpcy51cGRhdGVQYXJlbnRJc0V4cGFuZGVkID0gKGVsLCBleHBhbmRlZCkgPT4ge1xyXG4gICAgICBjb25zdCBpdGVtcyA9IGdldFNsb3R0ZWQoZWwsIFNMT1RTLmNoaWxkcmVuLCB7XHJcbiAgICAgICAgYWxsOiB0cnVlLFxyXG4gICAgICAgIHNlbGVjdG9yOiBcImNhbGNpdGUtdHJlZS1pdGVtXCJcclxuICAgICAgfSk7XHJcbiAgICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IChpdGVtLnBhcmVudEV4cGFuZGVkID0gZXhwYW5kZWQpKTtcclxuICAgIH07XHJcbiAgICB0aGlzLnVwZGF0ZUFuY2VzdG9yVHJlZSA9ICgpID0+IHtcclxuICAgICAgaWYgKHRoaXMuc2VsZWN0ZWQgJiYgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImFuY2VzdG9yc1wiKSB7XHJcbiAgICAgICAgY29uc3QgYW5jZXN0b3JzID0gW107XHJcbiAgICAgICAgbGV0IHBhcmVudCA9IHRoaXMucGFyZW50VHJlZUl0ZW07XHJcbiAgICAgICAgd2hpbGUgKHBhcmVudCkge1xyXG4gICAgICAgICAgYW5jZXN0b3JzLnB1c2gocGFyZW50KTtcclxuICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlLWl0ZW1cIik7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGFuY2VzdG9ycy5mb3JFYWNoKChpdGVtKSA9PiAoaXRlbS5pbmRldGVybWluYXRlID0gdHJ1ZSkpO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMuYWN0aW9uc0VuZFNsb3RDaGFuZ2VIYW5kbGVyID0gKGV2ZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuaGFzRW5kQWN0aW9ucyA9IHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnQoZXZlbnQpO1xyXG4gICAgfTtcclxuICAgIHRoaXMuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuZXhwYW5kZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuaWNvbkZsaXBSdGwgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmljb25TdGFydCA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuc2VsZWN0ZWQgPSBmYWxzZTtcclxuICAgIHRoaXMucGFyZW50RXhwYW5kZWQgPSBmYWxzZTtcclxuICAgIHRoaXMuZGVwdGggPSAtMTtcclxuICAgIHRoaXMuaGFzQ2hpbGRyZW4gPSBudWxsO1xyXG4gICAgdGhpcy5saW5lcyA9IHVuZGVmaW5lZDtcclxuICAgIHRoaXMuc2NhbGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLmluZGV0ZXJtaW5hdGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnNlbGVjdGlvbk1vZGUgPSB1bmRlZmluZWQ7XHJcbiAgICB0aGlzLnVwZGF0ZUFmdGVySW5pdGlhbFJlbmRlciA9IGZhbHNlO1xyXG4gICAgdGhpcy5oYXNFbmRBY3Rpb25zID0gZmFsc2U7XHJcbiAgfVxyXG4gIGV4cGFuZGVkSGFuZGxlcihuZXdWYWx1ZSkge1xyXG4gICAgdGhpcy51cGRhdGVQYXJlbnRJc0V4cGFuZGVkKHRoaXMuZWwsIG5ld1ZhbHVlKTtcclxuICAgIG9uVG9nZ2xlT3BlbkNsb3NlQ29tcG9uZW50KHRoaXMsIHRydWUpO1xyXG4gIH1cclxuICBnZXRzZWxlY3Rpb25Nb2RlKCkge1xyXG4gICAgdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSA9XHJcbiAgICAgIHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aXBsZVwiIHx8IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJtdWx0aWNoaWxkcmVuXCI7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIERlZmluZXMgbWV0aG9kIGZvciBgYmVmb3JlT3BlbmAgZXZlbnQgaGFuZGxlci5cclxuICAgKi9cclxuICBvbkJlZm9yZU9wZW4oKSB7XHJcbiAgICB0aGlzLnRyYW5zaXRpb25FbC5zdHlsZS50cmFuc2Zvcm0gPSBcInNjYWxlWSgxKVwiO1xyXG4gIH1cclxuICAvKipcclxuICAgKiBEZWZpbmVzIG1ldGhvZCBmb3IgYG9wZW5gIGV2ZW50IGhhbmRsZXI6XHJcbiAgICovXHJcbiAgb25PcGVuKCkge1xyXG4gICAgdGhpcy50cmFuc2l0aW9uRWwuc3R5bGUudHJhbnNmb3JtID0gXCJub25lXCI7XHJcbiAgfVxyXG4gIC8qKlxyXG4gICAqIERlZmluZXMgbWV0aG9kIGZvciBgYmVmb3JlQ2xvc2VgIGV2ZW50IGhhbmRsZXI6XHJcbiAgICovXHJcbiAgb25CZWZvcmVDbG9zZSgpIHtcclxuICAgIC8vIHBhdHRlcm4gbmVlZHMgdG8gYmUgZGVmaW5lZCBvbiBob3cgd2UgZW1pdCBldmVudHMgZm9yIGNvbXBvbmVudHMgd2l0aG91dCBgb3BlbmAgcHJvcC5cclxuICB9XHJcbiAgLyoqXHJcbiAgICogRGVmaW5lcyBtZXRob2QgZm9yIGBjbG9zZWAgZXZlbnQgaGFuZGxlcjpcclxuICAgKi9cclxuICBvbkNsb3NlKCkge1xyXG4gICAgdGhpcy50cmFuc2l0aW9uRWwuc3R5bGUudHJhbnNmb3JtID0gXCJzY2FsZVkoMClcIjtcclxuICB9XHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIC8vXHJcbiAgLy8gIExpZmVjeWNsZVxyXG4gIC8vXHJcbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG4gIGNvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgdGhpcy5wYXJlbnRUcmVlSXRlbSA9IHRoaXMuZWwucGFyZW50RWxlbWVudD8uY2xvc2VzdChcImNhbGNpdGUtdHJlZS1pdGVtXCIpO1xyXG4gICAgaWYgKHRoaXMucGFyZW50VHJlZUl0ZW0pIHtcclxuICAgICAgY29uc3QgeyBleHBhbmRlZCB9ID0gdGhpcy5wYXJlbnRUcmVlSXRlbTtcclxuICAgICAgdGhpcy51cGRhdGVQYXJlbnRJc0V4cGFuZGVkKHRoaXMucGFyZW50VHJlZUl0ZW0sIGV4cGFuZGVkKTtcclxuICAgIH1cclxuICAgIGNvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQodGhpcyk7XHJcbiAgfVxyXG4gIGRpc2Nvbm5lY3RlZENhbGxiYWNrKCkge1xyXG4gICAgZGlzY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCh0aGlzKTtcclxuICB9XHJcbiAgY29tcG9uZW50V2lsbFJlbmRlcigpIHtcclxuICAgIHRoaXMuaGFzQ2hpbGRyZW4gPSAhIXRoaXMuZWwucXVlcnlTZWxlY3RvcihcImNhbGNpdGUtdHJlZVwiKTtcclxuICAgIHRoaXMuZGVwdGggPSAwO1xyXG4gICAgbGV0IHBhcmVudFRyZWUgPSB0aGlzLmVsLmNsb3Nlc3QoXCJjYWxjaXRlLXRyZWVcIik7XHJcbiAgICBpZiAoIXBhcmVudFRyZWUpIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5zZWxlY3Rpb25Nb2RlID0gcGFyZW50VHJlZS5zZWxlY3Rpb25Nb2RlO1xyXG4gICAgdGhpcy5zY2FsZSA9IHBhcmVudFRyZWUuc2NhbGUgfHwgXCJtXCI7XHJcbiAgICB0aGlzLmxpbmVzID0gcGFyZW50VHJlZS5saW5lcztcclxuICAgIGxldCBuZXh0UGFyZW50VHJlZTtcclxuICAgIHdoaWxlIChwYXJlbnRUcmVlKSB7XHJcbiAgICAgIG5leHRQYXJlbnRUcmVlID0gcGFyZW50VHJlZS5wYXJlbnRFbGVtZW50Py5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlXCIpO1xyXG4gICAgICBpZiAobmV4dFBhcmVudFRyZWUgPT09IHBhcmVudFRyZWUpIHtcclxuICAgICAgICBicmVhaztcclxuICAgICAgfVxyXG4gICAgICBlbHNlIHtcclxuICAgICAgICBwYXJlbnRUcmVlID0gbmV4dFBhcmVudFRyZWU7XHJcbiAgICAgICAgdGhpcy5kZXB0aCA9IHRoaXMuZGVwdGggKyAxO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG4gIGNvbXBvbmVudFdpbGxMb2FkKCkge1xyXG4gICAgaWYgKHRoaXMuZXhwYW5kZWQpIHtcclxuICAgICAgb25Ub2dnbGVPcGVuQ2xvc2VDb21wb25lbnQodGhpcywgdHJ1ZSk7XHJcbiAgICB9XHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gKHRoaXMudXBkYXRlQWZ0ZXJJbml0aWFsUmVuZGVyID0gdHJ1ZSkpO1xyXG4gIH1cclxuICBjb21wb25lbnREaWRMb2FkKCkge1xyXG4gICAgdGhpcy51cGRhdGVBbmNlc3RvclRyZWUoKTtcclxuICB9XHJcbiAgY29tcG9uZW50RGlkUmVuZGVyKCkge1xyXG4gICAgdXBkYXRlSG9zdEludGVyYWN0aW9uKHRoaXMsICgpID0+IHRoaXMucGFyZW50RXhwYW5kZWQgfHwgdGhpcy5kZXB0aCA9PT0gMSk7XHJcbiAgfVxyXG4gIHJlbmRlcigpIHtcclxuICAgIGNvbnN0IHJ0bCA9IGdldEVsZW1lbnREaXIodGhpcy5lbCkgPT09IFwicnRsXCI7XHJcbiAgICBjb25zdCBzaG93QnVsbGV0UG9pbnQgPSB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwic2luZ2xlXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImNoaWxkcmVuXCI7XHJcbiAgICBjb25zdCBzaG93Q2hlY2ttYXJrID0gdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpcGxlXCIgfHwgdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm11bHRpY2hpbGRyZW5cIjtcclxuICAgIGNvbnN0IHNob3dCbGFuayA9IHRoaXMuc2VsZWN0aW9uTW9kZSA9PT0gXCJub25lXCIgJiYgIXRoaXMuaGFzQ2hpbGRyZW47XHJcbiAgICBjb25zdCBjaGV2cm9uID0gdGhpcy5oYXNDaGlsZHJlbiA/IChoKFwiY2FsY2l0ZS1pY29uXCIsIHsgY2xhc3M6IHtcclxuICAgICAgICBbQ1NTLmNoZXZyb25dOiB0cnVlLFxyXG4gICAgICAgIFtDU1NfVVRJTElUWS5ydGxdOiBydGxcclxuICAgICAgfSwgXCJkYXRhLXRlc3QtaWRcIjogXCJpY29uXCIsIGljb246IElDT05TLmNoZXZyb25SaWdodCwgb25DbGljazogdGhpcy5pY29uQ2xpY2tIYW5kbGVyLCBzY2FsZTogdGhpcy5zY2FsZSA9PT0gXCJsXCIgPyBcIm1cIiA6IFwic1wiIH0pKSA6IG51bGw7XHJcbiAgICBjb25zdCBkZWZhdWx0U2xvdE5vZGUgPSBoKFwic2xvdFwiLCB7IGtleTogXCJkZWZhdWx0LXNsb3RcIiB9KTtcclxuICAgIGNvbnN0IGNoZWNrYm94ID0gdGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcImFuY2VzdG9yc1wiID8gKGgoXCJsYWJlbFwiLCB7IGNsYXNzOiBDU1MuY2hlY2tib3hMYWJlbCwga2V5OiBcImNoZWNrYm94LWxhYmVsXCIgfSwgaChcImNhbGNpdGUtY2hlY2tib3hcIiwgeyBjaGVja2VkOiB0aGlzLnNlbGVjdGVkLCBjbGFzczogQ1NTLmNoZWNrYm94LCBcImRhdGEtdGVzdC1pZFwiOiBcImNoZWNrYm94XCIsIGluZGV0ZXJtaW5hdGU6IHRoaXMuaGFzQ2hpbGRyZW4gJiYgdGhpcy5pbmRldGVybWluYXRlLCBzY2FsZTogdGhpcy5zY2FsZSwgdGFiSW5kZXg6IC0xIH0pLCBkZWZhdWx0U2xvdE5vZGUpKSA6IG51bGw7XHJcbiAgICBjb25zdCBzZWxlY3RlZEljb24gPSBzaG93QnVsbGV0UG9pbnRcclxuICAgICAgPyBJQ09OUy5idWxsZXRQb2ludFxyXG4gICAgICA6IHNob3dDaGVja21hcmtcclxuICAgICAgICA/IElDT05TLmNoZWNrbWFya1xyXG4gICAgICAgIDogc2hvd0JsYW5rXHJcbiAgICAgICAgICA/IElDT05TLmJsYW5rXHJcbiAgICAgICAgICA6IG51bGw7XHJcbiAgICBjb25zdCBpdGVtSW5kaWNhdG9yID0gc2VsZWN0ZWRJY29uID8gKGgoXCJjYWxjaXRlLWljb25cIiwgeyBjbGFzczoge1xyXG4gICAgICAgIFtDU1MuYnVsbGV0UG9pbnRJY29uXTogc2VsZWN0ZWRJY29uID09PSBJQ09OUy5idWxsZXRQb2ludCxcclxuICAgICAgICBbQ1NTLmNoZWNrbWFya0ljb25dOiBzZWxlY3RlZEljb24gPT09IElDT05TLmNoZWNrbWFyayxcclxuICAgICAgICBbQ1NTX1VUSUxJVFkucnRsXTogcnRsXHJcbiAgICAgIH0sIGljb246IHNlbGVjdGVkSWNvbiwgc2NhbGU6IHRoaXMuc2NhbGUgPT09IFwibFwiID8gXCJtXCIgOiBcInNcIiB9KSkgOiBudWxsO1xyXG4gICAgY29uc3QgaGlkZGVuID0gISh0aGlzLnBhcmVudEV4cGFuZGVkIHx8IHRoaXMuZGVwdGggPT09IDEpO1xyXG4gICAgY29uc3QgaXNFeHBhbmRlZCA9IHRoaXMudXBkYXRlQWZ0ZXJJbml0aWFsUmVuZGVyICYmIHRoaXMuZXhwYW5kZWQ7XHJcbiAgICBjb25zdCB7IGhhc0VuZEFjdGlvbnMgfSA9IHRoaXM7XHJcbiAgICBjb25zdCBzbG90Tm9kZSA9IChoKFwic2xvdFwiLCB7IGtleTogXCJhY3Rpb25zRW5kU2xvdFwiLCBuYW1lOiBTTE9UUy5hY3Rpb25zRW5kLCBvblNsb3RjaGFuZ2U6IHRoaXMuYWN0aW9uc0VuZFNsb3RDaGFuZ2VIYW5kbGVyIH0pKTtcclxuICAgIGNvbnN0IGljb25TdGFydEVsID0gKGgoXCJjYWxjaXRlLWljb25cIiwgeyBjbGFzczogQ1NTLmljb25TdGFydCwgZmxpcFJ0bDogdGhpcy5pY29uRmxpcFJ0bCA9PT0gXCJzdGFydFwiIHx8IHRoaXMuaWNvbkZsaXBSdGwgPT09IFwiYm90aFwiLCBpY29uOiB0aGlzLmljb25TdGFydCwgc2NhbGU6IHRoaXMuc2NhbGUgPT09IFwibFwiID8gXCJtXCIgOiBcInNcIiB9KSk7XHJcbiAgICByZXR1cm4gKGgoSG9zdCwgeyBcImFyaWEtZXhwYW5kZWRcIjogdGhpcy5oYXNDaGlsZHJlbiA/IHRvQXJpYUJvb2xlYW4oaXNFeHBhbmRlZCkgOiB1bmRlZmluZWQsIFwiYXJpYS1oaWRkZW5cIjogdG9BcmlhQm9vbGVhbihoaWRkZW4pLCBcImFyaWEtc2VsZWN0ZWRcIjogdGhpcy5zZWxlY3RlZCA/IFwidHJ1ZVwiIDogc2hvd0NoZWNrbWFyayA/IFwiZmFsc2VcIiA6IHVuZGVmaW5lZCwgXCJjYWxjaXRlLWh5ZHJhdGVkLWhpZGRlblwiOiBoaWRkZW4sIHJvbGU6IFwidHJlZWl0ZW1cIiB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IHsgW0NTUy5pdGVtRXhwYW5kZWRdOiBpc0V4cGFuZGVkIH0gfSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XHJcbiAgICAgICAgW0NTUy5ub2RlQ29udGFpbmVyXTogdHJ1ZSxcclxuICAgICAgICBbQ1NTX1VUSUxJVFkucnRsXTogcnRsXHJcbiAgICAgIH0sIFwiZGF0YS1zZWxlY3Rpb24tbW9kZVwiOiB0aGlzLnNlbGVjdGlvbk1vZGUsIHJlZjogKGVsKSA9PiAodGhpcy5kZWZhdWx0U2xvdFdyYXBwZXIgPSBlbCkgfSwgY2hldnJvbiwgaXRlbUluZGljYXRvciwgdGhpcy5pY29uU3RhcnQgPyBpY29uU3RhcnRFbCA6IG51bGwsIGNoZWNrYm94ID8gY2hlY2tib3ggOiBkZWZhdWx0U2xvdE5vZGUsIGgoXCJkaXZcIiwgeyBjbGFzczogQ1NTLmFjdGlvbnNFbmQsIGhpZGRlbjogIWhhc0VuZEFjdGlvbnMgfSwgc2xvdE5vZGUpKSwgaChcImRpdlwiLCB7IGNsYXNzOiB7XHJcbiAgICAgICAgW0NTUy5jaGlsZHJlbkNvbnRhaW5lcl06IHRydWUsXHJcbiAgICAgICAgW0NTU19VVElMSVRZLnJ0bF06IHJ0bFxyXG4gICAgICB9LCBcImRhdGEtdGVzdC1pZFwiOiBcImNhbGNpdGUtdHJlZS1jaGlsZHJlblwiLCBvbkNsaWNrOiB0aGlzLmNoaWxkcmVuQ2xpY2tIYW5kbGVyLCByZWY6IChlbCkgPT4gdGhpcy5zZXRUcmFuc2l0aW9uRWwoZWwpLCByb2xlOiB0aGlzLmhhc0NoaWxkcmVuID8gXCJncm91cFwiIDogdW5kZWZpbmVkIH0sIGgoXCJzbG90XCIsIHsgbmFtZTogU0xPVFMuY2hpbGRyZW4gfSkpKSkpO1xyXG4gIH1cclxuICBzZXRUcmFuc2l0aW9uRWwoZWwpIHtcclxuICAgIHRoaXMudHJhbnNpdGlvbkVsID0gZWw7XHJcbiAgfVxyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICAvL1xyXG4gIC8vICBFdmVudCBMaXN0ZW5lcnNcclxuICAvL1xyXG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICBvbkNsaWNrKGV2ZW50KSB7XHJcbiAgICAvLyBTb2x2ZSBmb3IgaWYgdGhlIGl0ZW0gaXMgY2xpY2tlZCBzb21ld2hlcmUgb3V0c2lkZSB0aGUgc2xvdHRlZCBhbmNob3IuXHJcbiAgICAvLyBBbmNob3IgaXMgdHJpZ2dlcmVkIGFueXdoZXJlIHlvdSBjbGlja1xyXG4gICAgY29uc3QgW2xpbmtdID0gZmlsdGVyRGlyZWN0Q2hpbGRyZW4odGhpcy5lbCwgXCJhXCIpO1xyXG4gICAgaWYgKGxpbmsgJiYgZXZlbnQuY29tcG9zZWRQYXRoKClbMF0udGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9PSBcImFcIikge1xyXG4gICAgICBjb25zdCB0YXJnZXQgPSBsaW5rLnRhcmdldCA9PT0gXCJcIiA/IFwiX3NlbGZcIiA6IGxpbmsudGFyZ2V0O1xyXG4gICAgICB3aW5kb3cub3BlbihsaW5rLmhyZWYsIHRhcmdldCk7XHJcbiAgICB9XHJcbiAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xyXG4gICAgICBtb2RpZnlDdXJyZW50U2VsZWN0aW9uOiB0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwiYW5jZXN0b3JzXCIgfHwgdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSxcclxuICAgICAgZm9yY2VUb2dnbGU6IGZhbHNlXHJcbiAgICB9KTtcclxuICB9XHJcbiAga2V5RG93bkhhbmRsZXIoZXZlbnQpIHtcclxuICAgIGxldCByb290O1xyXG4gICAgc3dpdGNoIChldmVudC5rZXkpIHtcclxuICAgICAgY2FzZSBcIiBcIjpcclxuICAgICAgICBpZiAodGhpcy5zZWxlY3Rpb25Nb2RlID09PSBcIm5vbmVcIikge1xyXG4gICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNhbGNpdGVJbnRlcm5hbFRyZWVJdGVtU2VsZWN0LmVtaXQoe1xyXG4gICAgICAgICAgbW9kaWZ5Q3VycmVudFNlbGVjdGlvbjogdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSxcclxuICAgICAgICAgIGZvcmNlVG9nZ2xlOiBmYWxzZVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJFbnRlclwiOlxyXG4gICAgICAgIGlmICh0aGlzLnNlbGVjdGlvbk1vZGUgPT09IFwibm9uZVwiKSB7XHJcbiAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIGFjdGl2YXRlcyBhIG5vZGUsIGkuZS4sIHBlcmZvcm1zIGl0cyBkZWZhdWx0IGFjdGlvbi4gRm9yIHBhcmVudCBub2Rlcywgb25lIHBvc3NpYmxlIGRlZmF1bHQgYWN0aW9uIGlzIHRvIG9wZW4gb3IgY2xvc2UgdGhlIG5vZGUuIEluIHNpbmdsZS1zZWxlY3QgdHJlZXMgd2hlcmUgc2VsZWN0aW9uIGRvZXMgbm90IGZvbGxvdyBmb2N1cyAoc2VlIG5vdGUgYmVsb3cpLCB0aGUgZGVmYXVsdCBhY3Rpb24gaXMgdHlwaWNhbGx5IHRvIHNlbGVjdCB0aGUgZm9jdXNlZCBub2RlLlxyXG4gICAgICAgIGNvbnN0IGxpbmsgPSBub2RlTGlzdFRvQXJyYXkodGhpcy5lbC5jaGlsZHJlbikuZmluZCgoZWwpID0+IGVsLm1hdGNoZXMoXCJhXCIpKTtcclxuICAgICAgICBpZiAobGluaykge1xyXG4gICAgICAgICAgbGluay5jbGljaygpO1xyXG4gICAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHRydWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgdGhpcy5jYWxjaXRlSW50ZXJuYWxUcmVlSXRlbVNlbGVjdC5lbWl0KHtcclxuICAgICAgICAgICAgbW9kaWZ5Q3VycmVudFNlbGVjdGlvbjogdGhpcy5pc1NlbGVjdGlvbk11bHRpTGlrZSxcclxuICAgICAgICAgICAgZm9yY2VUb2dnbGU6IGZhbHNlXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICBicmVhaztcclxuICAgICAgY2FzZSBcIkhvbWVcIjpcclxuICAgICAgICByb290ID0gdGhpcy5lbC5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlOm5vdChbY2hpbGRdKVwiKTtcclxuICAgICAgICBjb25zdCBmaXJzdE5vZGUgPSByb290LnF1ZXJ5U2VsZWN0b3IoXCJjYWxjaXRlLXRyZWUtaXRlbVwiKTtcclxuICAgICAgICBmaXJzdE5vZGU/LmZvY3VzKCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICAgIGNhc2UgXCJFbmRcIjpcclxuICAgICAgICByb290ID0gdGhpcy5lbC5jbG9zZXN0KFwiY2FsY2l0ZS10cmVlOm5vdChbY2hpbGRdKVwiKTtcclxuICAgICAgICBsZXQgY3VycmVudE5vZGUgPSByb290LmNoaWxkcmVuW3Jvb3QuY2hpbGRyZW4ubGVuZ3RoIC0gMV07IC8vIGxhc3QgY2hpbGRcclxuICAgICAgICBsZXQgY3VycmVudFRyZWUgPSBub2RlTGlzdFRvQXJyYXkoY3VycmVudE5vZGUuY2hpbGRyZW4pLmZpbmQoKGVsKSA9PiBlbC5tYXRjaGVzKFwiY2FsY2l0ZS10cmVlXCIpKTtcclxuICAgICAgICB3aGlsZSAoY3VycmVudFRyZWUpIHtcclxuICAgICAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudFRyZWUuY2hpbGRyZW5bcm9vdC5jaGlsZHJlbi5sZW5ndGggLSAxXTtcclxuICAgICAgICAgIGN1cnJlbnRUcmVlID0gbm9kZUxpc3RUb0FycmF5KGN1cnJlbnROb2RlLmNoaWxkcmVuKS5maW5kKChlbCkgPT4gZWwubWF0Y2hlcyhcImNhbGNpdGUtdHJlZVwiKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGN1cnJlbnROb2RlPy5mb2N1cygpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG4gIH1cclxuICBnZXQgZWwoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XHJcbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcclxuICAgIFwiZXhwYW5kZWRcIjogW1wiZXhwYW5kZWRIYW5kbGVyXCJdLFxyXG4gICAgXCJzZWxlY3Rpb25Nb2RlXCI6IFtcImdldHNlbGVjdGlvbk1vZGVcIl1cclxuICB9OyB9XHJcbn07XHJcblRyZWVJdGVtLnN0eWxlID0gdHJlZUl0ZW1Dc3M7XG5cbmV4cG9ydCB7IFRvb2x0aXAgYXMgY2FsY2l0ZV90b29sdGlwLCBUcmVlIGFzIGNhbGNpdGVfdHJlZSwgVHJlZUl0ZW0gYXMgY2FsY2l0ZV90cmVlX2l0ZW0gfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y2FsY2l0ZS10b29sdGlwXzMuZW50cnkuanMubWFwIiwiaW1wb3J0IHsgZiBhcyBmb3JjZVVwZGF0ZSB9IGZyb20gJy4vaW5kZXgtNGU2NDc0MTEuanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVPYnNlcnZlciB9IGZyb20gJy4vb2JzZXJ2ZXJzLTU2NzQwZTk5LmpzJztcblxuLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogU2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9Fc3JpL2NhbGNpdGUtY29tcG9uZW50cy9ibG9iL21hc3Rlci9MSUNFTlNFLm1kIGZvciBkZXRhaWxzLlxuICogdjEuMC41XG4gKi9cbmNvbnN0IG9ic2VydmVkID0gbmV3IFNldCgpO1xubGV0IG11dGF0aW9uT2JzZXJ2ZXI7XG5jb25zdCBvYnNlcnZlck9wdGlvbnMgPSB7IGNoaWxkTGlzdDogdHJ1ZSB9O1xuLyoqXG4gKiBIZWxwZXIgdG8gc2V0IHVwIGEgY29uZGl0aW9uYWwgc2xvdCBjb21wb25lbnQgb24gY29ubmVjdGVkQ2FsbGJhY2suXG4gKlxuICogQHBhcmFtIGNvbXBvbmVudFxuICogQGRlcHJlY2F0ZWQgVXNlIGBvblNsb3RjaGFuZ2VgIGV2ZW50IHdpdGggYHNsb3RDaGFuZ2VIYXNBc3NpZ25lZEVsZW1lbnRgIERPTSB1dGlsaXR5IGluc3RlYWQuXG4gKlxuICogYGBgXG4gKiA8c2xvdCBvblNsb3RjaGFuZ2U9eyhldmVudCkgPT4gdGhpcy5teVNsb3RIYXNFbGVtZW50ID0gc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudChldmVudCl9IC8+fVxuICogYGBgXG4gKi9cbmZ1bmN0aW9uIGNvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQoY29tcG9uZW50KSB7XG4gIGlmICghbXV0YXRpb25PYnNlcnZlcikge1xuICAgIG11dGF0aW9uT2JzZXJ2ZXIgPSBjcmVhdGVPYnNlcnZlcihcIm11dGF0aW9uXCIsIHByb2Nlc3NNdXRhdGlvbnMpO1xuICB9XG4gIG11dGF0aW9uT2JzZXJ2ZXIub2JzZXJ2ZShjb21wb25lbnQuZWwsIG9ic2VydmVyT3B0aW9ucyk7XG59XG4vKipcbiAqIEhlbHBlciB0byB0ZWFyIGRvd24gYSBjb25kaXRpb25hbCBzbG90IGNvbXBvbmVudCBvbiBkaXNjb25uZWN0ZWRDYWxsYmFjay5cbiAqXG4gKiBAcGFyYW0gY29tcG9uZW50XG4gKiBAZGVwcmVjYXRlZCBVc2UgYG9uU2xvdGNoYW5nZWAgZXZlbnQgd2l0aCBgc2xvdENoYW5nZUhhc0Fzc2lnbmVkRWxlbWVudGAgRE9NIHV0aWxpdHkgaW5zdGVhZC5cbiAqXG4gKiBgYGBcbiAqIDxzbG90IG9uU2xvdGNoYW5nZT17KGV2ZW50KSA9PiB0aGlzLm15U2xvdEhhc0VsZW1lbnQgPSBzbG90Q2hhbmdlSGFzQXNzaWduZWRFbGVtZW50KGV2ZW50KX0gLz59XG4gKiBgYGBcbiAqL1xuZnVuY3Rpb24gZGlzY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudChjb21wb25lbnQpIHtcbiAgb2JzZXJ2ZWQuZGVsZXRlKGNvbXBvbmVudC5lbCk7XG4gIC8vIHdlIGV4cGxpY2l0bHkgcHJvY2VzcyBxdWV1ZWQgbXV0YXRpb25zIGFuZCBkaXNjb25uZWN0IGFuZCByZWNvbm5lY3RcbiAgLy8gdGhlIG9ic2VydmVyIHVudGlsIE11dGF0aW9uT2JzZXJ2ZXIgZ2V0cyBhbiBgdW5vYnNlcnZlYCBtZXRob2RcbiAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS93aGF0d2cvZG9tL2lzc3Vlcy8xMjZcbiAgcHJvY2Vzc011dGF0aW9ucyhtdXRhdGlvbk9ic2VydmVyLnRha2VSZWNvcmRzKCkpO1xuICBtdXRhdGlvbk9ic2VydmVyLmRpc2Nvbm5lY3QoKTtcbiAgZm9yIChjb25zdCBbZWxlbWVudF0gb2Ygb2JzZXJ2ZWQuZW50cmllcygpKSB7XG4gICAgbXV0YXRpb25PYnNlcnZlci5vYnNlcnZlKGVsZW1lbnQsIG9ic2VydmVyT3B0aW9ucyk7XG4gIH1cbn1cbmZ1bmN0aW9uIHByb2Nlc3NNdXRhdGlvbnMobXV0YXRpb25zKSB7XG4gIG11dGF0aW9ucy5mb3JFYWNoKCh7IHRhcmdldCB9KSA9PiB7XG4gICAgZm9yY2VVcGRhdGUodGFyZ2V0KTtcbiAgfSk7XG59XG5cbmV4cG9ydCB7IGNvbm5lY3RDb25kaXRpb25hbFNsb3RDb21wb25lbnQgYXMgYywgZGlzY29ubmVjdENvbmRpdGlvbmFsU2xvdENvbXBvbmVudCBhcyBkIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWNvbmRpdGlvbmFsU2xvdC1hNDgzN2NhZi5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuZnVuY3Rpb24gbm9vcENsaWNrKCkge1xuICAvKiogbm9vcCAqL1xufVxuLyoqXG4gKiBUaGlzIGhlbHBlciB1cGRhdGVzIHRoZSBob3N0IGVsZW1lbnQgdG8gcHJldmVudCBrZXlib2FyZCBpbnRlcmFjdGlvbiBvbiBpdHMgc3VidHJlZSBhbmQgc2V0cyB0aGUgYXBwcm9wcmlhdGUgYXJpYSBhdHRyaWJ1dGUgZm9yIGFjY2Vzc2liaWxpdHkuXG4gKlxuICogVGhpcyBzaG91bGQgYmUgdXNlZCBpbiB0aGUgYGNvbXBvbmVudERpZFJlbmRlcmAgbGlmZWN5Y2xlIGhvb2suXG4gKlxuICogKipOb3RlcyoqXG4gKlxuICogdGhpcyB1dGlsIGlzIG5vdCBuZWVkZWQgZm9yIHNpbXBsZSBjb21wb25lbnRzIHdob3NlIHJvb3QgZWxlbWVudCBvciBlbGVtZW50cyBhcmUgYW4gaW50ZXJhY3RpdmUgY29tcG9uZW50IChjdXN0b20gZWxlbWVudCBvciBuYXRpdmUgY29udHJvbCkuIEZvciB0aG9zZSBjYXNlcywgc2V0IHRoZSBgZGlzYWJsZWRgIHByb3BzIG9uIHRoZSByb290IGNvbXBvbmVudHMgaW5zdGVhZC5cbiAqIHRlY2huaWNhbGx5LCB1c2VycyBjYW4gb3ZlcnJpZGUgYHRhYmluZGV4YCBhbmQgcmVzdG9yZSBrZXlib2FyZCBuYXZpZ2F0aW9uLCBidXQgdGhpcyB3aWxsIGJlIGNvbnNpZGVyZWQgdXNlciBlcnJvclxuICpcbiAqIEBwYXJhbSBjb21wb25lbnRcbiAqIEBwYXJhbSBob3N0SXNUYWJiYWJsZVxuICovXG5mdW5jdGlvbiB1cGRhdGVIb3N0SW50ZXJhY3Rpb24oY29tcG9uZW50LCBob3N0SXNUYWJiYWJsZSA9IGZhbHNlKSB7XG4gIGlmIChjb21wb25lbnQuZGlzYWJsZWQpIHtcbiAgICBjb21wb25lbnQuZWwuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgXCItMVwiKTtcbiAgICBjb21wb25lbnQuZWwuc2V0QXR0cmlidXRlKFwiYXJpYS1kaXNhYmxlZFwiLCBcInRydWVcIik7XG4gICAgaWYgKGNvbXBvbmVudC5lbC5jb250YWlucyhkb2N1bWVudC5hY3RpdmVFbGVtZW50KSkge1xuICAgICAgZG9jdW1lbnQuYWN0aXZlRWxlbWVudC5ibHVyKCk7XG4gICAgfVxuICAgIGNvbXBvbmVudC5lbC5jbGljayA9IG5vb3BDbGljaztcbiAgICByZXR1cm47XG4gIH1cbiAgY29tcG9uZW50LmVsLmNsaWNrID0gSFRNTEVsZW1lbnQucHJvdG90eXBlLmNsaWNrO1xuICBpZiAodHlwZW9mIGhvc3RJc1RhYmJhYmxlID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICBjb21wb25lbnQuZWwuc2V0QXR0cmlidXRlKFwidGFiaW5kZXhcIiwgaG9zdElzVGFiYmFibGUuY2FsbChjb21wb25lbnQpID8gXCIwXCIgOiBcIi0xXCIpO1xuICB9XG4gIGVsc2UgaWYgKGhvc3RJc1RhYmJhYmxlID09PSB0cnVlKSB7XG4gICAgY29tcG9uZW50LmVsLnNldEF0dHJpYnV0ZShcInRhYmluZGV4XCIsIFwiMFwiKTtcbiAgfVxuICBlbHNlIGlmIChob3N0SXNUYWJiYWJsZSA9PT0gZmFsc2UpIHtcbiAgICBjb21wb25lbnQuZWwucmVtb3ZlQXR0cmlidXRlKFwidGFiaW5kZXhcIik7XG4gIH1cbiAgZWxzZSA7XG4gIGNvbXBvbmVudC5lbC5yZW1vdmVBdHRyaWJ1dGUoXCJhcmlhLWRpc2FibGVkXCIpO1xufVxuXG5leHBvcnQgeyB1cGRhdGVIb3N0SW50ZXJhY3Rpb24gYXMgdSB9O1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbnRlcmFjdGl2ZS0yOTk5NTUyMi5qcy5tYXAiLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL0VzcmkvY2FsY2l0ZS1jb21wb25lbnRzL2Jsb2IvbWFzdGVyL0xJQ0VOU0UubWQgZm9yIGRldGFpbHMuXG4gKiB2MS4wLjVcbiAqL1xuLyoqXG4gKiBUaGlzIHV0aWxpdHkgZW5zdXJlcyBvYnNlcnZlcnMgYXJlIGNyZWF0ZWQgb25seSBmb3IgYnJvd3NlciBjb250ZXh0cy5cbiAqXG4gKiBAcGFyYW0gdHlwZSAtIHRoZSB0eXBlIG9mIG9ic2VydmVyIHRvIGNyZWF0ZVxuICogQHBhcmFtIGNhbGxiYWNrIC0gdGhlIG9ic2VydmVyIGNhbGxiYWNrXG4gKiBAcGFyYW0gb3B0aW9ucyAtIHRoZSBvYnNlcnZlciBvcHRpb25zXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZU9ic2VydmVyKHR5cGUsIGNhbGxiYWNrLCBvcHRpb25zKSB7XG4gIGNvbnN0IE9ic2VydmVyID0gZ2V0T2JzZXJ2ZXIodHlwZSk7XG4gIHJldHVybiBuZXcgT2JzZXJ2ZXIoY2FsbGJhY2ssIG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gZ2V0T2JzZXJ2ZXIodHlwZSkge1xuICAvLyBiYXNlZCBvbiBodHRwczovL2dpdGh1Yi5jb20vd2hhdHdnL2RvbS9pc3N1ZXMvMTI2I2lzc3VlY29tbWVudC0xMDQ5ODE0OTQ4XG4gIGNsYXNzIEV4dGVuZGVkTXV0YXRpb25PYnNlcnZlciBleHRlbmRzIHdpbmRvdy5NdXRhdGlvbk9ic2VydmVyIHtcbiAgICBjb25zdHJ1Y3RvcihjYWxsYmFjaykge1xuICAgICAgc3VwZXIoY2FsbGJhY2spO1xuICAgICAgdGhpcy5vYnNlcnZlZEVudHJ5ID0gW107XG4gICAgICB0aGlzLmNhbGxiYWNrID0gY2FsbGJhY2s7XG4gICAgfVxuICAgIG9ic2VydmUodGFyZ2V0LCBvcHRpb25zKSB7XG4gICAgICB0aGlzLm9ic2VydmVkRW50cnkucHVzaCh7IHRhcmdldCwgb3B0aW9ucyB9KTtcbiAgICAgIHJldHVybiBzdXBlci5vYnNlcnZlKHRhcmdldCwgb3B0aW9ucyk7XG4gICAgfVxuICAgIHVub2JzZXJ2ZSh0YXJnZXQpIHtcbiAgICAgIGNvbnN0IG5ld09ic2VydmVkRW50cmllcyA9IHRoaXMub2JzZXJ2ZWRFbnRyeS5maWx0ZXIoKG9ic2VydmVkKSA9PiBvYnNlcnZlZC50YXJnZXQgIT09IHRhcmdldCk7XG4gICAgICB0aGlzLm9ic2VydmVkRW50cnkgPSBbXTtcbiAgICAgIHRoaXMuY2FsbGJhY2soc3VwZXIudGFrZVJlY29yZHMoKSwgdGhpcyk7XG4gICAgICB0aGlzLmRpc2Nvbm5lY3QoKTtcbiAgICAgIG5ld09ic2VydmVkRW50cmllcy5mb3JFYWNoKChvYnNlcnZlZCkgPT4gdGhpcy5vYnNlcnZlKG9ic2VydmVkLnRhcmdldCwgb2JzZXJ2ZWQub3B0aW9ucykpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gKGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gKHR5cGUgPT09IFwiaW50ZXJzZWN0aW9uXCJcbiAgICAgID8gd2luZG93LkludGVyc2VjdGlvbk9ic2VydmVyXG4gICAgICA6IHR5cGUgPT09IFwibXV0YXRpb25cIlxuICAgICAgICA/IEV4dGVuZGVkTXV0YXRpb25PYnNlcnZlclxuICAgICAgICA6IHdpbmRvdy5SZXNpemVPYnNlcnZlcik7XG4gIH0pKCk7XG59XG5cbmV4cG9ydCB7IGNyZWF0ZU9ic2VydmVyIGFzIGMgfTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9b2JzZXJ2ZXJzLTU2NzQwZTk5LmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==