"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-0bcff5"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-raster-multidimensional-variable-info.entry.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-raster-multidimensional-variable-info.entry.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_raster_multidimensional_variable_info: () => (/* binding */ ArcgisRasterMultidimensionalVariableInfo)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _multidimensional_279ffd6e_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./multidimensional-279ffd6e.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/multidimensional-279ffd6e.js");
/* harmony import */ var _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./languageUtil-22258c90.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js");
/* harmony import */ var _commonFunctions_5262b094_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./commonFunctions-5262b094.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-5262b094.js");
/* harmony import */ var _commonEnums_f98a323c_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./commonEnums-f98a323c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonEnums-f98a323c.js");
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */








const arcgisRasterMultidimensionalVariableInfoCss = ":host{display:flex;flex:1 1 auto}:host .accordion-item-content,:host .accordion-item-header{--calcite-accordion-item-border:transparent}.info-section-container{border:none;--calcite-ui-border-2:transparent}.info-section{padding-bottom:0.5rem;overflow-y:auto;--calcite-accordion-item-border:transparent;background-color:white}.info-general{padding:10px 15px;background-color:white}.info-content{margin:10px 10px}.info-content .info-block{color:var(--calcite-ui-text-3, gray);max-height:4rem;min-height:1rem;overflow:hidden}.info-content .info-block .info-text{width:100%;word-break:normal;text-overflow:ellipsis;font-size:var(--calcite-font-size--2)}.popover{z-index:100}.table{width:100%;background-color:#ffffff;border-collapse:collapse;border-spacing:0;border:1px solid var(--calcite-ui-border-1);text-align:left;overflow:auto;font-size:var(--calcite-font-size--2);color:var(--calcite-ui-text-1);line-height:1.5rem}.table caption{text-align:left;margin-top:5px}.table td{display:table-cell;vertical-align:inherit}.table td:first-child{width:30%}.table th,.table td{font-weight:300;padding:2px 5px;text-align:left}.table tr:nth-child(odd){background-color:#f8f8f8}.table.table-bordered tr{border-bottom:1px solid var(--calcite-ui-border-1)}.table.table-bordered tr:last-child{border-bottom:none}.table.table-bordered tr td:first-child{border-right:1px solid var(--calcite-ui-border-1)}.table.table-borderless{border:none}.arcgis--rtl .table.table-bordered tr td:first-child{border-left:1px solid var(--calcite-ui-border-1);border-right:none}";

const ArcgisRasterMultidimensionalVariableInfo = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.arcgisRasterMultidimensionalVariableInfoDismiss = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisRasterMultidimensionalVariableInfoDismiss", 7);
    this.variableInfo = undefined;
    this.popoverProps = undefined;
    this.showStatistics = false;
    this.showDimensionSummary = false;
    this.useTable = true;
    this.keepActiveDimension = true;
    this.strings = undefined;
    this.activeDimensionName = null;
    this.isOpen = false;
  }
  watchVariableInfo(_newValue, oldValue) {
    if (this.keepActiveDimension && this.dimensionEL && oldValue) {
      // calcite-accordion doesn't expose active/expanded item or public item select/close event
      const activeItem = this.dimensionEL.querySelector("calcite-accordion-item[active]");
      if (activeItem) {
        const index = activeItem.getAttribute("dimension-index");
        const dimension = oldValue.dimensions[index];
        this.activeDimensionName = dimension.name;
      }
      else {
        this.activeDimensionName = null;
      }
    }
    else {
      this.activeDimensionName = null;
    }
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  async componentWillLoad() {
    [this.intl] = await (0,_loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_1__.l)(["esri/intl"]);
    this.messages = await this.intl.fetchMessageBundle("esri/core/t9n/Units");
  }
  componentDidLoad() {
    this.isOpen = true;
  }
  // --------------------------------------------------------------------------
  //
  // Public Methods
  //
  // --------------------------------------------------------------------------
  async setFocus(focusId) {
    var _a, _b;
    if (focusId === "dismiss-button") {
      (_a = this.panelElement) === null || _a === void 0 ? void 0 : _a.setFocus();
      return;
    }
    (_b = this.hostElement) === null || _b === void 0 ? void 0 : _b.focus();
  }
  async reposition() {
    var _a;
    (_a = this.popoverNode) === null || _a === void 0 ? void 0 : _a.reposition();
  }
  // --------------------------------------------------------------------------
  //
  //  Render methods
  //
  // --------------------------------------------------------------------------
  render() {
    const statsTable = this.showStatistics && this.renderStatistics();
    const dimensionsList = this.renderDimensions();
    const variableInfoBlock = ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-accordion", { class: "info-section-container", selectionMode: "single", ref: (el) => (this.dimensionEL = el) }, statsTable, dimensionsList));
    const { popoverProps, variableInfo } = this;
    const width = `${popoverProps.refElement.getBoundingClientRect().width}px`;
    const label = variableInfo.unit
      ? `${variableInfo.name} (${variableInfo.unit})`
      : `${variableInfo.name}`;
    const summary = this.showDimensionSummary
      ? variableInfo.dimensions
        .map((dimInfo) => `${dimInfo.name}: ${dimInfo.values.length}`)
        .join(", ")
      : null;
    const generalInfoBlock = this.renderGeneralInfo();
    const dir = (0,_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_3__.g)(this.hostElement);
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.H, { class: "js-app-flyout" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-popover", { dir: dir, placement: popoverProps.placement || "leading-start", open: this.isOpen, pointerDisabled: true, referenceElement: popoverProps.refElement, offsetDistance: popoverProps.offsetDistance || 0, offsetSkidding: popoverProps.offsetSkidding || 0, triggerDisabled: true, label: label, class: "popover", style: { width }, ref: (node) => (this.popoverNode = node) }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-panel", { ref: (el) => (this.panelElement = el), heading: label, description: summary, class: {
        panel: true,
        [_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_3__.C.rtl]: dir === "rtl"
      }, closable: true, onCalcitePanelClose: () => this.arcgisRasterMultidimensionalVariableInfoDismiss.emit() }, generalInfoBlock, variableInfoBlock))));
  }
  renderGeneralInfo() {
    const strings = this.strings.multidimensionalInfo;
    const { unit, description } = this.variableInfo;
    const hasColormap = !!this.variableInfo.colormap;
    return this.renderInfoSection([
      { name: strings.description, description: description || strings.none },
      { name: strings.unit, description: unit || strings.none },
      { name: strings.colormap, description: hasColormap ? strings.present : strings.none }
    ], null, "info-general");
  }
  renderInfoSection(nameDescriptions, caption, css) {
    return this.useTable ? ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: css }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("table", { class: "table table-bordered" }, caption && (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("caption", null, caption), nameDescriptions.map(({ name, description }) => ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("tr", null, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("td", null, name), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("td", null, description))))))) : ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: `info-content ${css !== null && css !== void 0 ? css : ""}` }, nameDescriptions.map(({ name, description }) => ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", { scale: "s" }, name, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "info-block" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "info-text" }, description)))))));
  }
  renderStatistics() {
    const { name, statistics } = this.variableInfo;
    if (!(statistics === null || statistics === void 0 ? void 0 : statistics.length)) {
      return null;
    }
    const strings = this.strings.multidimensionalInfo;
    const mins = this._formatStats(statistics.map(({ min }) => min));
    const maxs = this._formatStats(statistics.map(({ max }) => max));
    const means = this._formatStats(statistics.map(({ avg }) => avg));
    const stddevs = this._formatStats(statistics.map(({ stddev }) => stddev));
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-accordion-item", { "icon-position": "start", heading: strings.statistics, key: `${name}-stats}`, class: "info-section" }, this.renderInfoSection([
      { name: strings.minimum, description: mins },
      { name: strings.maximum, description: maxs },
      { name: strings.mean, description: means },
      { name: strings.stddev, description: stddevs }
    ])));
  }
  renderDimensions() {
    const { multidimensionalInfo: strings } = this.strings;
    const { name, dimensions } = this.variableInfo;
    return dimensions.map((dimensionInfo, i) => {
      const { name: dimName, values, interval, intervalUnit, hasRegularIntervals, extent } = dimensionInfo;
      let dimensionLabel = dimName === "StdTime"
        ? strings.stdTimeDimension
        : dimName === "StdZ"
          ? strings.stdZDimension
          : strings.generalDimension.replace("${dimensionName}", dimName);
      dimensionLabel += ` (${values.length})`;
      const intervalUnitLabel = this._formatUnit(intervalUnit);
      const intervalLabel = interval
        ? `${interval} (${hasRegularIntervals ? strings.regular : strings.irregular})`
        : "";
      const from = (0,_multidimensional_279ffd6e_js__WEBPACK_IMPORTED_MODULE_2__.f)(extent[0], dimensionInfo, { intl: this.intl });
      const to = (0,_multidimensional_279ffd6e_js__WEBPACK_IMPORTED_MODULE_2__.f)(extent[1], dimensionInfo, { intl: this.intl });
      const extentLabel = `${from} - ${to}`;
      return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-accordion-item", { "icon-position": "start", expanded: dimName === this.activeDimensionName, heading: dimensionLabel, "dimension-index": i, key: `${name}-${dimName}`, class: "info-section" }, this.renderInfoSection([
        { name: strings.interval, description: intervalLabel },
        { name: strings.intervalUnit, description: intervalUnitLabel },
        { name: strings.extent, description: extentLabel }
      ])));
    });
  }
  // --------------------------------------------------------------------------
  //
  //  Private methods
  //
  // --------------------------------------------------------------------------
  _formatStats(values) {
    return values.map((value) => this.intl.formatNumber(value)).join("; ");
  }
  _formatUnit(unit) {
    var _a, _b, _c;
    if (unit) {
      const srcUnit = unit.replace("esri", "");
      unit = srcUnit.toLowerCase();
      unit = (_c = (_a = this.strings.time[unit]) !== null && _a !== void 0 ? _a : (_b = this.messages.units[unit]) === null || _b === void 0 ? void 0 : _b.plural) !== null && _c !== void 0 ? _c : srcUnit;
    }
    return unit !== null && unit !== void 0 ? unit : "";
  }
  get hostElement() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
  static get watchers() { return {
    "variableInfo": ["watchVariableInfo"]
  }; }
};
ArcgisRasterMultidimensionalVariableInfo.style = arcgisRasterMultidimensionalVariableInfoCss;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/multidimensional-279ffd6e.js":
/*!**********************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/multidimensional-279ffd6e.js ***!
  \**********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getMultidimensionalInfo),
/* harmony export */   b: () => (/* binding */ getDefaultDimensionSliceValue),
/* harmony export */   c: () => (/* binding */ getMultidimensionalDefinition),
/* harmony export */   f: () => (/* binding */ formatDimensionValue),
/* harmony export */   g: () => (/* binding */ getClippedDimensionInfo),
/* harmony export */   i: () => (/* binding */ isTimeDimension),
/* harmony export */   m: () => (/* binding */ minVersionRFTMultidimensionalInfo),
/* harmony export */   u: () => (/* binding */ updateDimensionalDefinition)
/* harmony export */ });
/* harmony import */ var _commonFunctions_5262b094_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./commonFunctions-5262b094.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/commonFunctions-5262b094.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const minVersionRFTMultidimensionalInfo = 10.9;
function formatTime(value, options) {
  const date = new Date(value);
  const { useFriendlyISOFormat, intl, format } = options;
  if (useFriendlyISOFormat && intl) {
    return intl.formatDate(date, Object.assign(Object.assign({}, intl.convertDateFormatToIntlOptions(format !== null && format !== void 0 ? format : "short-date-long-time")), { timeZone: "UTC" }));
  }
  let isoTimeString = new Date(value).toISOString();
  isoTimeString = isoTimeString.slice(0, isoTimeString.indexOf(".")) + "Z";
  return isoTimeString;
}
function formatMonth(value_base1, intl, format = "long") {
  // using an arbitrary date (the day the code was written) to avoid side effects of setMonth near the end of the month
  // setMonth will move the date to the next month when new month doesn't have current date (e.g. 9/31, 2/30)
  // date = new Date(2002, 9, 31); date.setMonth(8); console.log(date.toLocaleDateString())
  const date = new Date(2022, 9, 10);
  date.setMonth(value_base1 - 1);
  return intl.formatDate(date, { month: format });
}
function formatQuarter(value_base1, intl) {
  const startMonth = formatMonth((value_base1 - 1) * 3 + 1, intl, "short");
  const endMonth = formatMonth(value_base1 * 3, intl, "short");
  return `${startMonth} - ${endMonth}`;
}
function formatDimensionValue(value, dimensionInfo, options = {}) {
  var _a, _b, _c, _d;
  if (value == null) {
    return "";
  }
  const { intl, useRecurringTimeLabel } = options;
  if (useRecurringTimeLabel && intl && !Array.isArray(value)) {
    const intervalUnit = (_a = dimensionInfo.intervalUnit) === null || _a === void 0 ? void 0 : _a.toLowerCase().trim();
    // weekly and daily are not supported yet
    const canUseRecurringTimeLabel = isRecurringTimeDimension(dimensionInfo) && (intervalUnit === "months" || intervalUnit === "quarters");
    if (canUseRecurringTimeLabel) {
      return intervalUnit === "months" ? formatMonth(value, intl) : formatQuarter(value, intl);
    }
  }
  // this is prefered when labeling a slider alike control
  const lastElement = (_b = dimensionInfo.values) === null || _b === void 0 ? void 0 : _b[dimensionInfo.values.length - 1];
  if (options.useStartOrEndForRangedValue && Array.isArray(value) && value.length === 2 && Array.isArray(lastElement)) {
    const isLastElement = value.join("-") === lastElement.join("-");
    value = isLastElement ? value[1] : value[0];
  }
  const isTime = isTimeDimension(dimensionInfo);
  if (!isTime) {
    return Array.isArray(value)
      ? value.map((element) => { var _a; return (_a = intl === null || intl === void 0 ? void 0 : intl.formatNumber(element)) !== null && _a !== void 0 ? _a : String(element); }).join(" - ")
      : (_c = intl === null || intl === void 0 ? void 0 : intl.formatNumber(value)) !== null && _c !== void 0 ? _c : String(value);
  }
  if (options.useFriendlyISOFormat && !options.format) {
    let resolution = (_d = dimensionInfo.intervalUnit) === null || _d === void 0 ? void 0 : _d.toLowerCase().trim();
    let { interval, extent } = dimensionInfo;
    if (resolution === "months") {
      if (interval > 11) {
        resolution = "year";
      }
    }
    else if (resolution === "days") {
      if (interval > 364) {
        resolution = "year";
      }
      else if (interval > 27) {
        resolution = "months";
      }
    }
    else if (resolution === "hours") {
      resolution = "days";
    }
    if (!["years", "months", "days"].includes(resolution) && (extent === null || extent === void 0 ? void 0 : extent.length)) {
      const interval = (extent[1] - extent[0]) / dimensionInfo.values.length;
      const day = 86400000;
      if (interval >= 365 * day) {
        resolution = "years";
      }
      else if (interval >= 28 * day) {
        resolution = "months";
      }
    }
    const format = resolution === "years" ? "year" : resolution === "months" ? "short-month-year" : "short-date";
    options = Object.assign({ format }, options);
  }
  return Array.isArray(value)
    ? value.map((element) => formatTime(element, options)).join(" - ")
    : formatTime(value, options);
}
function getClippedDimensionInfo(dimensionInfo, multidimensionalSubset) {
  var _a;
  const constraint = (_a = multidimensionalSubset === null || multidimensionalSubset === void 0 ? void 0 : multidimensionalSubset.dimensions) === null || _a === void 0 ? void 0 : _a.find(({ name }) => name === dimensionInfo.name);
  if (!(constraint === null || constraint === void 0 ? void 0 : constraint.extent)) {
    return dimensionInfo;
  }
  const extent = [...constraint.extent];
  const values = dimensionInfo.values.filter((value) => {
    // must be contained, intersection is not sufficient
    if (Array.isArray(value)) {
      if (!(0,_commonFunctions_5262b094_js__WEBPACK_IMPORTED_MODULE_0__.i)(extent[1]) || extent[0] === extent[1]) {
        return value[0] === extent[0];
      }
      return value[0] >= extent[0] && value[0] <= extent[1] && value[1] >= extent[0] && value[1] <= extent[1];
    }
    return value >= extent[0] && value <= extent[1];
  });
  // this is a special case, when last slice of a ranged dimension series is used
  if (values.length === 0) {
    const lastValue = dimensionInfo.values[dimensionInfo.values.length - 1];
    if (Array.isArray(lastValue) && lastValue[1] === extent[0]) {
      values.push(lastValue);
    }
  }
  return Object.assign(Object.assign({}, dimensionInfo), { extent, values });
}
function getDefaultDimensionSliceValue(dimensionInfo) {
  var _a;
  const { values, extent, name } = dimensionInfo;
  let value = (_a = values === null || values === void 0 ? void 0 : values[0]) !== null && _a !== void 0 ? _a : extent[0];
  if (name.toLowerCase() === "stdz" &&
    !dimensionInfo.hasRanges &&
    Math.abs(extent[1]) <= Math.abs(extent[0])) {
    if (values === null || values === void 0 ? void 0 : values.length) {
      value = values[values.length - 1];
    }
    else {
      value = extent[1];
    }
  }
  return value;
}
function getMultidimensionalDefinition(layer) {
  var _a, _b;
  return layer.type === "imagery-tile"
    ? layer.multidimensionalDefinition
    : (_b = ((_a = layer.mosaicRule) !== null && _a !== void 0 ? _a : layer._defaultServiceMosaicRule)) === null || _b === void 0 ? void 0 : _b.multidimensionalDefinition;
}
async function getMultidimensionalInfo(layer, useRawSourceInfo) {
  var _a, _b;
  if (layer.type === "imagery-tile") {
    return layer.rasterInfo.multidimensionalInfo;
  }
  const { rasterFunction, version } = layer;
  if (useRawSourceInfo ||
    version <= minVersionRFTMultidimensionalInfo ||
    !rasterFunction ||
    ((_a = rasterFunction.functionName) === null || _a === void 0 ? void 0 : _a.toLowerCase()) === "none") {
    return layer.serviceRasterInfo.multidimensionalInfo;
  }
  const rasterInfo = (_b = (await layer.generateRasterInfo(layer.rasterFunction))) !== null && _b !== void 0 ? _b : layer.serviceRasterInfo;
  return rasterInfo.multidimensionalInfo;
}
function isTimeDimension(dimensionInfo, ignoreRecuring = false) {
  return dimensionInfo.name === "StdTime" && (ignoreRecuring || !dimensionInfo.recurring);
}
function isRecurringTimeDimension(dimensionInfo) {
  return dimensionInfo.name === "StdTime" && !!dimensionInfo.recurring;
}
function updateDimensionalDefinition(def, dimensionInfo, activeMultidimensionalSubset) {
  dimensionInfo = getClippedDimensionInfo(dimensionInfo, activeMultidimensionalSubset);
  const originalFormattedValue = formatDimensionValue(def.values[0], dimensionInfo);
  const hasOriginalFormattedValue = dimensionInfo.values.some((val) => originalFormattedValue === formatDimensionValue(val, dimensionInfo));
  if (!hasOriginalFormattedValue) {
    // get default slice value when def.values is invalid
    const value = getDefaultDimensionSliceValue(dimensionInfo);
    def.values = [value];
  }
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTBiY2ZmNS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQzZHO0FBQ2hEO0FBQ2M7QUFDTztBQUMzQztBQUNKO0FBQ1I7O0FBRTNCLDJEQUEyRCxhQUFhLGNBQWMsMkRBQTJELDRDQUE0Qyx3QkFBd0IsWUFBWSxrQ0FBa0MsY0FBYyxzQkFBc0IsZ0JBQWdCLDRDQUE0Qyx1QkFBdUIsY0FBYyxrQkFBa0IsdUJBQXVCLGNBQWMsaUJBQWlCLDBCQUEwQixxQ0FBcUMsZ0JBQWdCLGdCQUFnQixnQkFBZ0IscUNBQXFDLFdBQVcsa0JBQWtCLHVCQUF1QixzQ0FBc0MsU0FBUyxZQUFZLE9BQU8sV0FBVyx5QkFBeUIseUJBQXlCLGlCQUFpQiw0Q0FBNEMsZ0JBQWdCLGNBQWMsc0NBQXNDLCtCQUErQixtQkFBbUIsZUFBZSxnQkFBZ0IsZUFBZSxVQUFVLG1CQUFtQix1QkFBdUIsc0JBQXNCLFVBQVUsb0JBQW9CLGdCQUFnQixnQkFBZ0IsZ0JBQWdCLHlCQUF5Qix5QkFBeUIseUJBQXlCLG1EQUFtRCxvQ0FBb0MsbUJBQW1CLHdDQUF3QyxrREFBa0Qsd0JBQXdCLFlBQVkscURBQXFELGlEQUFpRCxrQkFBa0I7O0FBRTNqRDtBQUNBO0FBQ0EsSUFBSSxxREFBZ0I7QUFDcEIsMkRBQTJELHFEQUFXO0FBQ3RFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QiwyREFBVztBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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Y2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtcmFzdGVyLW11bHRpZGltZW5zaW9uYWwtdmFyaWFibGUtaW5mby5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9tdWx0aWRpbWVuc2lvbmFsLTI3OWZmZDZlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBIIGFzIEhvc3QsIGQgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtOTJlYmIzOTYuanMnO1xuaW1wb3J0IHsgbCBhcyBsb2FkTW9kdWxlcyB9IGZyb20gJy4vbG9hZE1vZHVsZXMtYWFmMzBiZDYuanMnO1xuaW1wb3J0IHsgZiBhcyBmb3JtYXREaW1lbnNpb25WYWx1ZSB9IGZyb20gJy4vbXVsdGlkaW1lbnNpb25hbC0yNzlmZmQ2ZS5qcyc7XG5pbXBvcnQgeyBnIGFzIGdldEVsZW1lbnREaXIsIEMgYXMgQ1NTX1VUSUxJVFkgfSBmcm9tICcuL2xhbmd1YWdlVXRpbC0yMjI1OGM5MC5qcyc7XG5pbXBvcnQgJy4vY29tbW9uRnVuY3Rpb25zLTUyNjJiMDk0LmpzJztcbmltcG9ydCAnLi9jb21tb25FbnVtcy1mOThhMzIzYy5qcyc7XG5pbXBvcnQgJy4vZG9tLTEzZjViMDBjLmpzJztcblxuY29uc3QgYXJjZ2lzUmFzdGVyTXVsdGlkaW1lbnNpb25hbFZhcmlhYmxlSW5mb0NzcyA9IFwiOmhvc3R7ZGlzcGxheTpmbGV4O2ZsZXg6MSAxIGF1dG99Omhvc3QgLmFjY29yZGlvbi1pdGVtLWNvbnRlbnQsOmhvc3QgLmFjY29yZGlvbi1pdGVtLWhlYWRlcnstLWNhbGNpdGUtYWNjb3JkaW9uLWl0ZW0tYm9yZGVyOnRyYW5zcGFyZW50fS5pbmZvLXNlY3Rpb24tY29udGFpbmVye2JvcmRlcjpub25lOy0tY2FsY2l0ZS11aS1ib3JkZXItMjp0cmFuc3BhcmVudH0uaW5mby1zZWN0aW9ue3BhZGRpbmctYm90dG9tOjAuNXJlbTtvdmVyZmxvdy15OmF1dG87LS1jYWxjaXRlLWFjY29yZGlvbi1pdGVtLWJvcmRlcjp0cmFuc3BhcmVudDtiYWNrZ3JvdW5kLWNvbG9yOndoaXRlfS5pbmZvLWdlbmVyYWx7cGFkZGluZzoxMHB4IDE1cHg7YmFja2dyb3VuZC1jb2xvcjp3aGl0ZX0uaW5mby1jb250ZW50e21hcmdpbjoxMHB4IDEwcHh9LmluZm8tY29udGVudCAuaW5mby1ibG9ja3tjb2xvcjp2YXIoLS1jYWxjaXRlLXVpLXRleHQtMywgZ3JheSk7bWF4LWhlaWdodDo0cmVtO21pbi1oZWlnaHQ6MXJlbTtvdmVyZmxvdzpoaWRkZW59LmluZm8tY29udGVudCAuaW5mby1ibG9jayAuaW5mby10ZXh0e3dpZHRoOjEwMCU7d29yZC1icmVhazpub3JtYWw7dGV4dC1vdmVyZmxvdzplbGxpcHNpcztmb250LXNpemU6dmFyKC0tY2FsY2l0ZS1mb250LXNpemUtLTIpfS5wb3BvdmVye3otaW5kZXg6MTAwfS50YWJsZXt3aWR0aDoxMDAlO2JhY2tncm91bmQtY29sb3I6I2ZmZmZmZjtib3JkZXItY29sbGFwc2U6Y29sbGFwc2U7Ym9yZGVyLXNwYWNpbmc6MDtib3JkZXI6MXB4IHNvbGlkIHZhcigtLWNhbGNpdGUtdWktYm9yZGVyLTEpO3RleHQtYWxpZ246bGVmdDtvdmVyZmxvdzphdXRvO2ZvbnQtc2l6ZTp2YXIoLS1jYWxjaXRlLWZvbnQtc2l6ZS0tMik7Y29sb3I6dmFyKC0tY2FsY2l0ZS11aS10ZXh0LTEpO2xpbmUtaGVpZ2h0OjEuNXJlbX0udGFibGUgY2FwdGlvbnt0ZXh0LWFsaWduOmxlZnQ7bWFyZ2luLXRvcDo1cHh9LnRhYmxlIHRke2Rpc3BsYXk6dGFibGUtY2VsbDt2ZXJ0aWNhbC1hbGlnbjppbmhlcml0fS50YWJsZSB0ZDpmaXJzdC1jaGlsZHt3aWR0aDozMCV9LnRhYmxlIHRoLC50YWJsZSB0ZHtmb250LXdlaWdodDozMDA7cGFkZGluZzoycHggNXB4O3RleHQtYWxpZ246bGVmdH0udGFibGUgdHI6bnRoLWNoaWxkKG9kZCl7YmFja2dyb3VuZC1jb2xvcjojZjhmOGY4fS50YWJsZS50YWJsZS1ib3JkZXJlZCB0cntib3JkZXItYm90dG9tOjFweCBzb2xpZCB2YXIoLS1jYWxjaXRlLXVpLWJvcmRlci0xKX0udGFibGUudGFibGUtYm9yZGVyZWQgdHI6bGFzdC1jaGlsZHtib3JkZXItYm90dG9tOm5vbmV9LnRhYmxlLnRhYmxlLWJvcmRlcmVkIHRyIHRkOmZpcnN0LWNoaWxke2JvcmRlci1yaWdodDoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSl9LnRhYmxlLnRhYmxlLWJvcmRlcmxlc3N7Ym9yZGVyOm5vbmV9LmFyY2dpcy0tcnRsIC50YWJsZS50YWJsZS1ib3JkZXJlZCB0ciB0ZDpmaXJzdC1jaGlsZHtib3JkZXItbGVmdDoxcHggc29saWQgdmFyKC0tY2FsY2l0ZS11aS1ib3JkZXItMSk7Ym9yZGVyLXJpZ2h0Om5vbmV9XCI7XG5cbmNvbnN0IEFyY2dpc1Jhc3Rlck11bHRpZGltZW5zaW9uYWxWYXJpYWJsZUluZm8gPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgIHRoaXMuYXJjZ2lzUmFzdGVyTXVsdGlkaW1lbnNpb25hbFZhcmlhYmxlSW5mb0Rpc21pc3MgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc1Jhc3Rlck11bHRpZGltZW5zaW9uYWxWYXJpYWJsZUluZm9EaXNtaXNzXCIsIDcpO1xuICAgIHRoaXMudmFyaWFibGVJbmZvID0gdW5kZWZpbmVkO1xuICAgIHRoaXMucG9wb3ZlclByb3BzID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2hvd1N0YXRpc3RpY3MgPSBmYWxzZTtcbiAgICB0aGlzLnNob3dEaW1lbnNpb25TdW1tYXJ5ID0gZmFsc2U7XG4gICAgdGhpcy51c2VUYWJsZSA9IHRydWU7XG4gICAgdGhpcy5rZWVwQWN0aXZlRGltZW5zaW9uID0gdHJ1ZTtcbiAgICB0aGlzLnN0cmluZ3MgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmVEaW1lbnNpb25OYW1lID0gbnVsbDtcbiAgICB0aGlzLmlzT3BlbiA9IGZhbHNlO1xuICB9XG4gIHdhdGNoVmFyaWFibGVJbmZvKF9uZXdWYWx1ZSwgb2xkVmFsdWUpIHtcbiAgICBpZiAodGhpcy5rZWVwQWN0aXZlRGltZW5zaW9uICYmIHRoaXMuZGltZW5zaW9uRUwgJiYgb2xkVmFsdWUpIHtcbiAgICAgIC8vIGNhbGNpdGUtYWNjb3JkaW9uIGRvZXNuJ3QgZXhwb3NlIGFjdGl2ZS9leHBhbmRlZCBpdGVtIG9yIHB1YmxpYyBpdGVtIHNlbGVjdC9jbG9zZSBldmVudFxuICAgICAgY29uc3QgYWN0aXZlSXRlbSA9IHRoaXMuZGltZW5zaW9uRUwucXVlcnlTZWxlY3RvcihcImNhbGNpdGUtYWNjb3JkaW9uLWl0ZW1bYWN0aXZlXVwiKTtcbiAgICAgIGlmIChhY3RpdmVJdGVtKSB7XG4gICAgICAgIGNvbnN0IGluZGV4ID0gYWN0aXZlSXRlbS5nZXRBdHRyaWJ1dGUoXCJkaW1lbnNpb24taW5kZXhcIik7XG4gICAgICAgIGNvbnN0IGRpbWVuc2lvbiA9IG9sZFZhbHVlLmRpbWVuc2lvbnNbaW5kZXhdO1xuICAgICAgICB0aGlzLmFjdGl2ZURpbWVuc2lvbk5hbWUgPSBkaW1lbnNpb24ubmFtZTtcbiAgICAgIH1cbiAgICAgIGVsc2Uge1xuICAgICAgICB0aGlzLmFjdGl2ZURpbWVuc2lvbk5hbWUgPSBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuYWN0aXZlRGltZW5zaW9uTmFtZSA9IG51bGw7XG4gICAgfVxuICB9XG4gIC8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gIExpZmVjeWNsZVxuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIGFzeW5jIGNvbXBvbmVudFdpbGxMb2FkKCkge1xuICAgIFt0aGlzLmludGxdID0gYXdhaXQgbG9hZE1vZHVsZXMoW1wiZXNyaS9pbnRsXCJdKTtcbiAgICB0aGlzLm1lc3NhZ2VzID0gYXdhaXQgdGhpcy5pbnRsLmZldGNoTWVzc2FnZUJ1bmRsZShcImVzcmkvY29yZS90OW4vVW5pdHNcIik7XG4gIH1cbiAgY29tcG9uZW50RGlkTG9hZCgpIHtcbiAgICB0aGlzLmlzT3BlbiA9IHRydWU7XG4gIH1cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgLy9cbiAgLy8gUHVibGljIE1ldGhvZHNcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgYXN5bmMgc2V0Rm9jdXMoZm9jdXNJZCkge1xuICAgIHZhciBfYSwgX2I7XG4gICAgaWYgKGZvY3VzSWQgPT09IFwiZGlzbWlzcy1idXR0b25cIikge1xuICAgICAgKF9hID0gdGhpcy5wYW5lbEVsZW1lbnQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXRGb2N1cygpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAoX2IgPSB0aGlzLmhvc3RFbGVtZW50KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IuZm9jdXMoKTtcbiAgfVxuICBhc3luYyByZXBvc2l0aW9uKCkge1xuICAgIHZhciBfYTtcbiAgICAoX2EgPSB0aGlzLnBvcG92ZXJOb2RlKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EucmVwb3NpdGlvbigpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBSZW5kZXIgbWV0aG9kc1xuICAvL1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICByZW5kZXIoKSB7XG4gICAgY29uc3Qgc3RhdHNUYWJsZSA9IHRoaXMuc2hvd1N0YXRpc3RpY3MgJiYgdGhpcy5yZW5kZXJTdGF0aXN0aWNzKCk7XG4gICAgY29uc3QgZGltZW5zaW9uc0xpc3QgPSB0aGlzLnJlbmRlckRpbWVuc2lvbnMoKTtcbiAgICBjb25zdCB2YXJpYWJsZUluZm9CbG9jayA9IChoKFwiY2FsY2l0ZS1hY2NvcmRpb25cIiwgeyBjbGFzczogXCJpbmZvLXNlY3Rpb24tY29udGFpbmVyXCIsIHNlbGVjdGlvbk1vZGU6IFwic2luZ2xlXCIsIHJlZjogKGVsKSA9PiAodGhpcy5kaW1lbnNpb25FTCA9IGVsKSB9LCBzdGF0c1RhYmxlLCBkaW1lbnNpb25zTGlzdCkpO1xuICAgIGNvbnN0IHsgcG9wb3ZlclByb3BzLCB2YXJpYWJsZUluZm8gfSA9IHRoaXM7XG4gICAgY29uc3Qgd2lkdGggPSBgJHtwb3BvdmVyUHJvcHMucmVmRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKS53aWR0aH1weGA7XG4gICAgY29uc3QgbGFiZWwgPSB2YXJpYWJsZUluZm8udW5pdFxuICAgICAgPyBgJHt2YXJpYWJsZUluZm8ubmFtZX0gKCR7dmFyaWFibGVJbmZvLnVuaXR9KWBcbiAgICAgIDogYCR7dmFyaWFibGVJbmZvLm5hbWV9YDtcbiAgICBjb25zdCBzdW1tYXJ5ID0gdGhpcy5zaG93RGltZW5zaW9uU3VtbWFyeVxuICAgICAgPyB2YXJpYWJsZUluZm8uZGltZW5zaW9uc1xuICAgICAgICAubWFwKChkaW1JbmZvKSA9PiBgJHtkaW1JbmZvLm5hbWV9OiAke2RpbUluZm8udmFsdWVzLmxlbmd0aH1gKVxuICAgICAgICAuam9pbihcIiwgXCIpXG4gICAgICA6IG51bGw7XG4gICAgY29uc3QgZ2VuZXJhbEluZm9CbG9jayA9IHRoaXMucmVuZGVyR2VuZXJhbEluZm8oKTtcbiAgICBjb25zdCBkaXIgPSBnZXRFbGVtZW50RGlyKHRoaXMuaG9zdEVsZW1lbnQpO1xuICAgIHJldHVybiAoaChIb3N0LCB7IGNsYXNzOiBcImpzLWFwcC1mbHlvdXRcIiB9LCBoKFwiY2FsY2l0ZS1wb3BvdmVyXCIsIHsgZGlyOiBkaXIsIHBsYWNlbWVudDogcG9wb3ZlclByb3BzLnBsYWNlbWVudCB8fCBcImxlYWRpbmctc3RhcnRcIiwgb3BlbjogdGhpcy5pc09wZW4sIHBvaW50ZXJEaXNhYmxlZDogdHJ1ZSwgcmVmZXJlbmNlRWxlbWVudDogcG9wb3ZlclByb3BzLnJlZkVsZW1lbnQsIG9mZnNldERpc3RhbmNlOiBwb3BvdmVyUHJvcHMub2Zmc2V0RGlzdGFuY2UgfHwgMCwgb2Zmc2V0U2tpZGRpbmc6IHBvcG92ZXJQcm9wcy5vZmZzZXRTa2lkZGluZyB8fCAwLCB0cmlnZ2VyRGlzYWJsZWQ6IHRydWUsIGxhYmVsOiBsYWJlbCwgY2xhc3M6IFwicG9wb3ZlclwiLCBzdHlsZTogeyB3aWR0aCB9LCByZWY6IChub2RlKSA9PiAodGhpcy5wb3BvdmVyTm9kZSA9IG5vZGUpIH0sIGgoXCJjYWxjaXRlLXBhbmVsXCIsIHsgcmVmOiAoZWwpID0+ICh0aGlzLnBhbmVsRWxlbWVudCA9IGVsKSwgaGVhZGluZzogbGFiZWwsIGRlc2NyaXB0aW9uOiBzdW1tYXJ5LCBjbGFzczoge1xuICAgICAgICBwYW5lbDogdHJ1ZSxcbiAgICAgICAgW0NTU19VVElMSVRZLnJ0bF06IGRpciA9PT0gXCJydGxcIlxuICAgICAgfSwgY2xvc2FibGU6IHRydWUsIG9uQ2FsY2l0ZVBhbmVsQ2xvc2U6ICgpID0+IHRoaXMuYXJjZ2lzUmFzdGVyTXVsdGlkaW1lbnNpb25hbFZhcmlhYmxlSW5mb0Rpc21pc3MuZW1pdCgpIH0sIGdlbmVyYWxJbmZvQmxvY2ssIHZhcmlhYmxlSW5mb0Jsb2NrKSkpKTtcbiAgfVxuICByZW5kZXJHZW5lcmFsSW5mbygpIHtcbiAgICBjb25zdCBzdHJpbmdzID0gdGhpcy5zdHJpbmdzLm11bHRpZGltZW5zaW9uYWxJbmZvO1xuICAgIGNvbnN0IHsgdW5pdCwgZGVzY3JpcHRpb24gfSA9IHRoaXMudmFyaWFibGVJbmZvO1xuICAgIGNvbnN0IGhhc0NvbG9ybWFwID0gISF0aGlzLnZhcmlhYmxlSW5mby5jb2xvcm1hcDtcbiAgICByZXR1cm4gdGhpcy5yZW5kZXJJbmZvU2VjdGlvbihbXG4gICAgICB7IG5hbWU6IHN0cmluZ3MuZGVzY3JpcHRpb24sIGRlc2NyaXB0aW9uOiBkZXNjcmlwdGlvbiB8fCBzdHJpbmdzLm5vbmUgfSxcbiAgICAgIHsgbmFtZTogc3RyaW5ncy51bml0LCBkZXNjcmlwdGlvbjogdW5pdCB8fCBzdHJpbmdzLm5vbmUgfSxcbiAgICAgIHsgbmFtZTogc3RyaW5ncy5jb2xvcm1hcCwgZGVzY3JpcHRpb246IGhhc0NvbG9ybWFwID8gc3RyaW5ncy5wcmVzZW50IDogc3RyaW5ncy5ub25lIH1cbiAgICBdLCBudWxsLCBcImluZm8tZ2VuZXJhbFwiKTtcbiAgfVxuICByZW5kZXJJbmZvU2VjdGlvbihuYW1lRGVzY3JpcHRpb25zLCBjYXB0aW9uLCBjc3MpIHtcbiAgICByZXR1cm4gdGhpcy51c2VUYWJsZSA/IChoKFwiZGl2XCIsIHsgY2xhc3M6IGNzcyB9LCBoKFwidGFibGVcIiwgeyBjbGFzczogXCJ0YWJsZSB0YWJsZS1ib3JkZXJlZFwiIH0sIGNhcHRpb24gJiYgaChcImNhcHRpb25cIiwgbnVsbCwgY2FwdGlvbiksIG5hbWVEZXNjcmlwdGlvbnMubWFwKCh7IG5hbWUsIGRlc2NyaXB0aW9uIH0pID0+IChoKFwidHJcIiwgbnVsbCwgaChcInRkXCIsIG51bGwsIG5hbWUpLCBoKFwidGRcIiwgbnVsbCwgZGVzY3JpcHRpb24pKSkpKSkpIDogKGgoXCJkaXZcIiwgeyBjbGFzczogYGluZm8tY29udGVudCAke2NzcyAhPT0gbnVsbCAmJiBjc3MgIT09IHZvaWQgMCA/IGNzcyA6IFwiXCJ9YCB9LCBuYW1lRGVzY3JpcHRpb25zLm1hcCgoeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSA9PiAoaChcImNhbGNpdGUtbGFiZWxcIiwgeyBzY2FsZTogXCJzXCIgfSwgbmFtZSwgaChcImRpdlwiLCB7IGNsYXNzOiBcImluZm8tYmxvY2tcIiB9LCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwiaW5mby10ZXh0XCIgfSwgZGVzY3JpcHRpb24pKSkpKSkpO1xuICB9XG4gIHJlbmRlclN0YXRpc3RpY3MoKSB7XG4gICAgY29uc3QgeyBuYW1lLCBzdGF0aXN0aWNzIH0gPSB0aGlzLnZhcmlhYmxlSW5mbztcbiAgICBpZiAoIShzdGF0aXN0aWNzID09PSBudWxsIHx8IHN0YXRpc3RpY3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHN0YXRpc3RpY3MubGVuZ3RoKSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGNvbnN0IHN0cmluZ3MgPSB0aGlzLnN0cmluZ3MubXVsdGlkaW1lbnNpb25hbEluZm87XG4gICAgY29uc3QgbWlucyA9IHRoaXMuX2Zvcm1hdFN0YXRzKHN0YXRpc3RpY3MubWFwKCh7IG1pbiB9KSA9PiBtaW4pKTtcbiAgICBjb25zdCBtYXhzID0gdGhpcy5fZm9ybWF0U3RhdHMoc3RhdGlzdGljcy5tYXAoKHsgbWF4IH0pID0+IG1heCkpO1xuICAgIGNvbnN0IG1lYW5zID0gdGhpcy5fZm9ybWF0U3RhdHMoc3RhdGlzdGljcy5tYXAoKHsgYXZnIH0pID0+IGF2ZykpO1xuICAgIGNvbnN0IHN0ZGRldnMgPSB0aGlzLl9mb3JtYXRTdGF0cyhzdGF0aXN0aWNzLm1hcCgoeyBzdGRkZXYgfSkgPT4gc3RkZGV2KSk7XG4gICAgcmV0dXJuIChoKFwiY2FsY2l0ZS1hY2NvcmRpb24taXRlbVwiLCB7IFwiaWNvbi1wb3NpdGlvblwiOiBcInN0YXJ0XCIsIGhlYWRpbmc6IHN0cmluZ3Muc3RhdGlzdGljcywga2V5OiBgJHtuYW1lfS1zdGF0c31gLCBjbGFzczogXCJpbmZvLXNlY3Rpb25cIiB9LCB0aGlzLnJlbmRlckluZm9TZWN0aW9uKFtcbiAgICAgIHsgbmFtZTogc3RyaW5ncy5taW5pbXVtLCBkZXNjcmlwdGlvbjogbWlucyB9LFxuICAgICAgeyBuYW1lOiBzdHJpbmdzLm1heGltdW0sIGRlc2NyaXB0aW9uOiBtYXhzIH0sXG4gICAgICB7IG5hbWU6IHN0cmluZ3MubWVhbiwgZGVzY3JpcHRpb246IG1lYW5zIH0sXG4gICAgICB7IG5hbWU6IHN0cmluZ3Muc3RkZGV2LCBkZXNjcmlwdGlvbjogc3RkZGV2cyB9XG4gICAgXSkpKTtcbiAgfVxuICByZW5kZXJEaW1lbnNpb25zKCkge1xuICAgIGNvbnN0IHsgbXVsdGlkaW1lbnNpb25hbEluZm86IHN0cmluZ3MgfSA9IHRoaXMuc3RyaW5ncztcbiAgICBjb25zdCB7IG5hbWUsIGRpbWVuc2lvbnMgfSA9IHRoaXMudmFyaWFibGVJbmZvO1xuICAgIHJldHVybiBkaW1lbnNpb25zLm1hcCgoZGltZW5zaW9uSW5mbywgaSkgPT4ge1xuICAgICAgY29uc3QgeyBuYW1lOiBkaW1OYW1lLCB2YWx1ZXMsIGludGVydmFsLCBpbnRlcnZhbFVuaXQsIGhhc1JlZ3VsYXJJbnRlcnZhbHMsIGV4dGVudCB9ID0gZGltZW5zaW9uSW5mbztcbiAgICAgIGxldCBkaW1lbnNpb25MYWJlbCA9IGRpbU5hbWUgPT09IFwiU3RkVGltZVwiXG4gICAgICAgID8gc3RyaW5ncy5zdGRUaW1lRGltZW5zaW9uXG4gICAgICAgIDogZGltTmFtZSA9PT0gXCJTdGRaXCJcbiAgICAgICAgICA/IHN0cmluZ3Muc3RkWkRpbWVuc2lvblxuICAgICAgICAgIDogc3RyaW5ncy5nZW5lcmFsRGltZW5zaW9uLnJlcGxhY2UoXCIke2RpbWVuc2lvbk5hbWV9XCIsIGRpbU5hbWUpO1xuICAgICAgZGltZW5zaW9uTGFiZWwgKz0gYCAoJHt2YWx1ZXMubGVuZ3RofSlgO1xuICAgICAgY29uc3QgaW50ZXJ2YWxVbml0TGFiZWwgPSB0aGlzLl9mb3JtYXRVbml0KGludGVydmFsVW5pdCk7XG4gICAgICBjb25zdCBpbnRlcnZhbExhYmVsID0gaW50ZXJ2YWxcbiAgICAgICAgPyBgJHtpbnRlcnZhbH0gKCR7aGFzUmVndWxhckludGVydmFscyA/IHN0cmluZ3MucmVndWxhciA6IHN0cmluZ3MuaXJyZWd1bGFyfSlgXG4gICAgICAgIDogXCJcIjtcbiAgICAgIGNvbnN0IGZyb20gPSBmb3JtYXREaW1lbnNpb25WYWx1ZShleHRlbnRbMF0sIGRpbWVuc2lvbkluZm8sIHsgaW50bDogdGhpcy5pbnRsIH0pO1xuICAgICAgY29uc3QgdG8gPSBmb3JtYXREaW1lbnNpb25WYWx1ZShleHRlbnRbMV0sIGRpbWVuc2lvbkluZm8sIHsgaW50bDogdGhpcy5pbnRsIH0pO1xuICAgICAgY29uc3QgZXh0ZW50TGFiZWwgPSBgJHtmcm9tfSAtICR7dG99YDtcbiAgICAgIHJldHVybiAoaChcImNhbGNpdGUtYWNjb3JkaW9uLWl0ZW1cIiwgeyBcImljb24tcG9zaXRpb25cIjogXCJzdGFydFwiLCBleHBhbmRlZDogZGltTmFtZSA9PT0gdGhpcy5hY3RpdmVEaW1lbnNpb25OYW1lLCBoZWFkaW5nOiBkaW1lbnNpb25MYWJlbCwgXCJkaW1lbnNpb24taW5kZXhcIjogaSwga2V5OiBgJHtuYW1lfS0ke2RpbU5hbWV9YCwgY2xhc3M6IFwiaW5mby1zZWN0aW9uXCIgfSwgdGhpcy5yZW5kZXJJbmZvU2VjdGlvbihbXG4gICAgICAgIHsgbmFtZTogc3RyaW5ncy5pbnRlcnZhbCwgZGVzY3JpcHRpb246IGludGVydmFsTGFiZWwgfSxcbiAgICAgICAgeyBuYW1lOiBzdHJpbmdzLmludGVydmFsVW5pdCwgZGVzY3JpcHRpb246IGludGVydmFsVW5pdExhYmVsIH0sXG4gICAgICAgIHsgbmFtZTogc3RyaW5ncy5leHRlbnQsIGRlc2NyaXB0aW9uOiBleHRlbnRMYWJlbCB9XG4gICAgICBdKSkpO1xuICAgIH0pO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQcml2YXRlIG1ldGhvZHNcbiAgLy9cbiAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cbiAgX2Zvcm1hdFN0YXRzKHZhbHVlcykge1xuICAgIHJldHVybiB2YWx1ZXMubWFwKCh2YWx1ZSkgPT4gdGhpcy5pbnRsLmZvcm1hdE51bWJlcih2YWx1ZSkpLmpvaW4oXCI7IFwiKTtcbiAgfVxuICBfZm9ybWF0VW5pdCh1bml0KSB7XG4gICAgdmFyIF9hLCBfYiwgX2M7XG4gICAgaWYgKHVuaXQpIHtcbiAgICAgIGNvbnN0IHNyY1VuaXQgPSB1bml0LnJlcGxhY2UoXCJlc3JpXCIsIFwiXCIpO1xuICAgICAgdW5pdCA9IHNyY1VuaXQudG9Mb3dlckNhc2UoKTtcbiAgICAgIHVuaXQgPSAoX2MgPSAoX2EgPSB0aGlzLnN0cmluZ3MudGltZVt1bml0XSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9iID0gdGhpcy5tZXNzYWdlcy51bml0c1t1bml0XSkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLnBsdXJhbCkgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogc3JjVW5pdDtcbiAgICB9XG4gICAgcmV0dXJuIHVuaXQgIT09IG51bGwgJiYgdW5pdCAhPT0gdm9pZCAwID8gdW5pdCA6IFwiXCI7XG4gIH1cbiAgZ2V0IGhvc3RFbGVtZW50KCkgeyByZXR1cm4gZ2V0RWxlbWVudCh0aGlzKTsgfVxuICBzdGF0aWMgZ2V0IHdhdGNoZXJzKCkgeyByZXR1cm4ge1xuICAgIFwidmFyaWFibGVJbmZvXCI6IFtcIndhdGNoVmFyaWFibGVJbmZvXCJdXG4gIH07IH1cbn07XG5BcmNnaXNSYXN0ZXJNdWx0aWRpbWVuc2lvbmFsVmFyaWFibGVJbmZvLnN0eWxlID0gYXJjZ2lzUmFzdGVyTXVsdGlkaW1lbnNpb25hbFZhcmlhYmxlSW5mb0NzcztcblxuZXhwb3J0IHsgQXJjZ2lzUmFzdGVyTXVsdGlkaW1lbnNpb25hbFZhcmlhYmxlSW5mbyBhcyBhcmNnaXNfcmFzdGVyX211bHRpZGltZW5zaW9uYWxfdmFyaWFibGVfaW5mbyB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBpIGFzIGlzRGVmaW5lZCB9IGZyb20gJy4vY29tbW9uRnVuY3Rpb25zLTUyNjJiMDk0LmpzJztcblxuY29uc3QgbWluVmVyc2lvblJGVE11bHRpZGltZW5zaW9uYWxJbmZvID0gMTAuOTtcbmZ1bmN0aW9uIGZvcm1hdFRpbWUodmFsdWUsIG9wdGlvbnMpIHtcbiAgY29uc3QgZGF0ZSA9IG5ldyBEYXRlKHZhbHVlKTtcbiAgY29uc3QgeyB1c2VGcmllbmRseUlTT0Zvcm1hdCwgaW50bCwgZm9ybWF0IH0gPSBvcHRpb25zO1xuICBpZiAodXNlRnJpZW5kbHlJU09Gb3JtYXQgJiYgaW50bCkge1xuICAgIHJldHVybiBpbnRsLmZvcm1hdERhdGUoZGF0ZSwgT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCBpbnRsLmNvbnZlcnREYXRlRm9ybWF0VG9JbnRsT3B0aW9ucyhmb3JtYXQgIT09IG51bGwgJiYgZm9ybWF0ICE9PSB2b2lkIDAgPyBmb3JtYXQgOiBcInNob3J0LWRhdGUtbG9uZy10aW1lXCIpKSwgeyB0aW1lWm9uZTogXCJVVENcIiB9KSk7XG4gIH1cbiAgbGV0IGlzb1RpbWVTdHJpbmcgPSBuZXcgRGF0ZSh2YWx1ZSkudG9JU09TdHJpbmcoKTtcbiAgaXNvVGltZVN0cmluZyA9IGlzb1RpbWVTdHJpbmcuc2xpY2UoMCwgaXNvVGltZVN0cmluZy5pbmRleE9mKFwiLlwiKSkgKyBcIlpcIjtcbiAgcmV0dXJuIGlzb1RpbWVTdHJpbmc7XG59XG5mdW5jdGlvbiBmb3JtYXRNb250aCh2YWx1ZV9iYXNlMSwgaW50bCwgZm9ybWF0ID0gXCJsb25nXCIpIHtcbiAgLy8gdXNpbmcgYW4gYXJiaXRyYXJ5IGRhdGUgKHRoZSBkYXkgdGhlIGNvZGUgd2FzIHdyaXR0ZW4pIHRvIGF2b2lkIHNpZGUgZWZmZWN0cyBvZiBzZXRNb250aCBuZWFyIHRoZSBlbmQgb2YgdGhlIG1vbnRoXG4gIC8vIHNldE1vbnRoIHdpbGwgbW92ZSB0aGUgZGF0ZSB0byB0aGUgbmV4dCBtb250aCB3aGVuIG5ldyBtb250aCBkb2Vzbid0IGhhdmUgY3VycmVudCBkYXRlIChlLmcuIDkvMzEsIDIvMzApXG4gIC8vIGRhdGUgPSBuZXcgRGF0ZSgyMDAyLCA5LCAzMSk7IGRhdGUuc2V0TW9udGgoOCk7IGNvbnNvbGUubG9nKGRhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCkpXG4gIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgyMDIyLCA5LCAxMCk7XG4gIGRhdGUuc2V0TW9udGgodmFsdWVfYmFzZTEgLSAxKTtcbiAgcmV0dXJuIGludGwuZm9ybWF0RGF0ZShkYXRlLCB7IG1vbnRoOiBmb3JtYXQgfSk7XG59XG5mdW5jdGlvbiBmb3JtYXRRdWFydGVyKHZhbHVlX2Jhc2UxLCBpbnRsKSB7XG4gIGNvbnN0IHN0YXJ0TW9udGggPSBmb3JtYXRNb250aCgodmFsdWVfYmFzZTEgLSAxKSAqIDMgKyAxLCBpbnRsLCBcInNob3J0XCIpO1xuICBjb25zdCBlbmRNb250aCA9IGZvcm1hdE1vbnRoKHZhbHVlX2Jhc2UxICogMywgaW50bCwgXCJzaG9ydFwiKTtcbiAgcmV0dXJuIGAke3N0YXJ0TW9udGh9IC0gJHtlbmRNb250aH1gO1xufVxuZnVuY3Rpb24gZm9ybWF0RGltZW5zaW9uVmFsdWUodmFsdWUsIGRpbWVuc2lvbkluZm8sIG9wdGlvbnMgPSB7fSkge1xuICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gIGlmICh2YWx1ZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIFwiXCI7XG4gIH1cbiAgY29uc3QgeyBpbnRsLCB1c2VSZWN1cnJpbmdUaW1lTGFiZWwgfSA9IG9wdGlvbnM7XG4gIGlmICh1c2VSZWN1cnJpbmdUaW1lTGFiZWwgJiYgaW50bCAmJiAhQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBjb25zdCBpbnRlcnZhbFVuaXQgPSAoX2EgPSBkaW1lbnNpb25JbmZvLmludGVydmFsVW5pdCkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRvTG93ZXJDYXNlKCkudHJpbSgpO1xuICAgIC8vIHdlZWtseSBhbmQgZGFpbHkgYXJlIG5vdCBzdXBwb3J0ZWQgeWV0XG4gICAgY29uc3QgY2FuVXNlUmVjdXJyaW5nVGltZUxhYmVsID0gaXNSZWN1cnJpbmdUaW1lRGltZW5zaW9uKGRpbWVuc2lvbkluZm8pICYmIChpbnRlcnZhbFVuaXQgPT09IFwibW9udGhzXCIgfHwgaW50ZXJ2YWxVbml0ID09PSBcInF1YXJ0ZXJzXCIpO1xuICAgIGlmIChjYW5Vc2VSZWN1cnJpbmdUaW1lTGFiZWwpIHtcbiAgICAgIHJldHVybiBpbnRlcnZhbFVuaXQgPT09IFwibW9udGhzXCIgPyBmb3JtYXRNb250aCh2YWx1ZSwgaW50bCkgOiBmb3JtYXRRdWFydGVyKHZhbHVlLCBpbnRsKTtcbiAgICB9XG4gIH1cbiAgLy8gdGhpcyBpcyBwcmVmZXJlZCB3aGVuIGxhYmVsaW5nIGEgc2xpZGVyIGFsaWtlIGNvbnRyb2xcbiAgY29uc3QgbGFzdEVsZW1lbnQgPSAoX2IgPSBkaW1lbnNpb25JbmZvLnZhbHVlcykgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iW2RpbWVuc2lvbkluZm8udmFsdWVzLmxlbmd0aCAtIDFdO1xuICBpZiAob3B0aW9ucy51c2VTdGFydE9yRW5kRm9yUmFuZ2VkVmFsdWUgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZSkgJiYgdmFsdWUubGVuZ3RoID09PSAyICYmIEFycmF5LmlzQXJyYXkobGFzdEVsZW1lbnQpKSB7XG4gICAgY29uc3QgaXNMYXN0RWxlbWVudCA9IHZhbHVlLmpvaW4oXCItXCIpID09PSBsYXN0RWxlbWVudC5qb2luKFwiLVwiKTtcbiAgICB2YWx1ZSA9IGlzTGFzdEVsZW1lbnQgPyB2YWx1ZVsxXSA6IHZhbHVlWzBdO1xuICB9XG4gIGNvbnN0IGlzVGltZSA9IGlzVGltZURpbWVuc2lvbihkaW1lbnNpb25JbmZvKTtcbiAgaWYgKCFpc1RpbWUpIHtcbiAgICByZXR1cm4gQXJyYXkuaXNBcnJheSh2YWx1ZSlcbiAgICAgID8gdmFsdWUubWFwKChlbGVtZW50KSA9PiB7IHZhciBfYTsgcmV0dXJuIChfYSA9IGludGwgPT09IG51bGwgfHwgaW50bCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaW50bC5mb3JtYXROdW1iZXIoZWxlbWVudCkpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IFN0cmluZyhlbGVtZW50KTsgfSkuam9pbihcIiAtIFwiKVxuICAgICAgOiAoX2MgPSBpbnRsID09PSBudWxsIHx8IGludGwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGludGwuZm9ybWF0TnVtYmVyKHZhbHVlKSkgIT09IG51bGwgJiYgX2MgIT09IHZvaWQgMCA/IF9jIDogU3RyaW5nKHZhbHVlKTtcbiAgfVxuICBpZiAob3B0aW9ucy51c2VGcmllbmRseUlTT0Zvcm1hdCAmJiAhb3B0aW9ucy5mb3JtYXQpIHtcbiAgICBsZXQgcmVzb2x1dGlvbiA9IChfZCA9IGRpbWVuc2lvbkluZm8uaW50ZXJ2YWxVbml0KSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QudG9Mb3dlckNhc2UoKS50cmltKCk7XG4gICAgbGV0IHsgaW50ZXJ2YWwsIGV4dGVudCB9ID0gZGltZW5zaW9uSW5mbztcbiAgICBpZiAocmVzb2x1dGlvbiA9PT0gXCJtb250aHNcIikge1xuICAgICAgaWYgKGludGVydmFsID4gMTEpIHtcbiAgICAgICAgcmVzb2x1dGlvbiA9IFwieWVhclwiO1xuICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmIChyZXNvbHV0aW9uID09PSBcImRheXNcIikge1xuICAgICAgaWYgKGludGVydmFsID4gMzY0KSB7XG4gICAgICAgIHJlc29sdXRpb24gPSBcInllYXJcIjtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGludGVydmFsID4gMjcpIHtcbiAgICAgICAgcmVzb2x1dGlvbiA9IFwibW9udGhzXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHJlc29sdXRpb24gPT09IFwiaG91cnNcIikge1xuICAgICAgcmVzb2x1dGlvbiA9IFwiZGF5c1wiO1xuICAgIH1cbiAgICBpZiAoIVtcInllYXJzXCIsIFwibW9udGhzXCIsIFwiZGF5c1wiXS5pbmNsdWRlcyhyZXNvbHV0aW9uKSAmJiAoZXh0ZW50ID09PSBudWxsIHx8IGV4dGVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXh0ZW50Lmxlbmd0aCkpIHtcbiAgICAgIGNvbnN0IGludGVydmFsID0gKGV4dGVudFsxXSAtIGV4dGVudFswXSkgLyBkaW1lbnNpb25JbmZvLnZhbHVlcy5sZW5ndGg7XG4gICAgICBjb25zdCBkYXkgPSA4NjQwMDAwMDtcbiAgICAgIGlmIChpbnRlcnZhbCA+PSAzNjUgKiBkYXkpIHtcbiAgICAgICAgcmVzb2x1dGlvbiA9IFwieWVhcnNcIjtcbiAgICAgIH1cbiAgICAgIGVsc2UgaWYgKGludGVydmFsID49IDI4ICogZGF5KSB7XG4gICAgICAgIHJlc29sdXRpb24gPSBcIm1vbnRoc1wiO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBmb3JtYXQgPSByZXNvbHV0aW9uID09PSBcInllYXJzXCIgPyBcInllYXJcIiA6IHJlc29sdXRpb24gPT09IFwibW9udGhzXCIgPyBcInNob3J0LW1vbnRoLXllYXJcIiA6IFwic2hvcnQtZGF0ZVwiO1xuICAgIG9wdGlvbnMgPSBPYmplY3QuYXNzaWduKHsgZm9ybWF0IH0sIG9wdGlvbnMpO1xuICB9XG4gIHJldHVybiBBcnJheS5pc0FycmF5KHZhbHVlKVxuICAgID8gdmFsdWUubWFwKChlbGVtZW50KSA9PiBmb3JtYXRUaW1lKGVsZW1lbnQsIG9wdGlvbnMpKS5qb2luKFwiIC0gXCIpXG4gICAgOiBmb3JtYXRUaW1lKHZhbHVlLCBvcHRpb25zKTtcbn1cbmZ1bmN0aW9uIGdldENsaXBwZWREaW1lbnNpb25JbmZvKGRpbWVuc2lvbkluZm8sIG11bHRpZGltZW5zaW9uYWxTdWJzZXQpIHtcbiAgdmFyIF9hO1xuICBjb25zdCBjb25zdHJhaW50ID0gKF9hID0gbXVsdGlkaW1lbnNpb25hbFN1YnNldCA9PT0gbnVsbCB8fCBtdWx0aWRpbWVuc2lvbmFsU3Vic2V0ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBtdWx0aWRpbWVuc2lvbmFsU3Vic2V0LmRpbWVuc2lvbnMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5maW5kKCh7IG5hbWUgfSkgPT4gbmFtZSA9PT0gZGltZW5zaW9uSW5mby5uYW1lKTtcbiAgaWYgKCEoY29uc3RyYWludCA9PT0gbnVsbCB8fCBjb25zdHJhaW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjb25zdHJhaW50LmV4dGVudCkpIHtcbiAgICByZXR1cm4gZGltZW5zaW9uSW5mbztcbiAgfVxuICBjb25zdCBleHRlbnQgPSBbLi4uY29uc3RyYWludC5leHRlbnRdO1xuICBjb25zdCB2YWx1ZXMgPSBkaW1lbnNpb25JbmZvLnZhbHVlcy5maWx0ZXIoKHZhbHVlKSA9PiB7XG4gICAgLy8gbXVzdCBiZSBjb250YWluZWQsIGludGVyc2VjdGlvbiBpcyBub3Qgc3VmZmljaWVudFxuICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgaWYgKCFpc0RlZmluZWQoZXh0ZW50WzFdKSB8fCBleHRlbnRbMF0gPT09IGV4dGVudFsxXSkge1xuICAgICAgICByZXR1cm4gdmFsdWVbMF0gPT09IGV4dGVudFswXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB2YWx1ZVswXSA+PSBleHRlbnRbMF0gJiYgdmFsdWVbMF0gPD0gZXh0ZW50WzFdICYmIHZhbHVlWzFdID49IGV4dGVudFswXSAmJiB2YWx1ZVsxXSA8PSBleHRlbnRbMV07XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZSA+PSBleHRlbnRbMF0gJiYgdmFsdWUgPD0gZXh0ZW50WzFdO1xuICB9KTtcbiAgLy8gdGhpcyBpcyBhIHNwZWNpYWwgY2FzZSwgd2hlbiBsYXN0IHNsaWNlIG9mIGEgcmFuZ2VkIGRpbWVuc2lvbiBzZXJpZXMgaXMgdXNlZFxuICBpZiAodmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgIGNvbnN0IGxhc3RWYWx1ZSA9IGRpbWVuc2lvbkluZm8udmFsdWVzW2RpbWVuc2lvbkluZm8udmFsdWVzLmxlbmd0aCAtIDFdO1xuICAgIGlmIChBcnJheS5pc0FycmF5KGxhc3RWYWx1ZSkgJiYgbGFzdFZhbHVlWzFdID09PSBleHRlbnRbMF0pIHtcbiAgICAgIHZhbHVlcy5wdXNoKGxhc3RWYWx1ZSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIGRpbWVuc2lvbkluZm8pLCB7IGV4dGVudCwgdmFsdWVzIH0pO1xufVxuZnVuY3Rpb24gZ2V0RGVmYXVsdERpbWVuc2lvblNsaWNlVmFsdWUoZGltZW5zaW9uSW5mbykge1xuICB2YXIgX2E7XG4gIGNvbnN0IHsgdmFsdWVzLCBleHRlbnQsIG5hbWUgfSA9IGRpbWVuc2lvbkluZm87XG4gIGxldCB2YWx1ZSA9IChfYSA9IHZhbHVlcyA9PT0gbnVsbCB8fCB2YWx1ZXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHZhbHVlc1swXSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogZXh0ZW50WzBdO1xuICBpZiAobmFtZS50b0xvd2VyQ2FzZSgpID09PSBcInN0ZHpcIiAmJlxuICAgICFkaW1lbnNpb25JbmZvLmhhc1JhbmdlcyAmJlxuICAgIE1hdGguYWJzKGV4dGVudFsxXSkgPD0gTWF0aC5hYnMoZXh0ZW50WzBdKSkge1xuICAgIGlmICh2YWx1ZXMgPT09IG51bGwgfHwgdmFsdWVzID09PSB2b2lkIDAgPyB2b2lkIDAgOiB2YWx1ZXMubGVuZ3RoKSB7XG4gICAgICB2YWx1ZSA9IHZhbHVlc1t2YWx1ZXMubGVuZ3RoIC0gMV07XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgdmFsdWUgPSBleHRlbnRbMV07XG4gICAgfVxuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cbmZ1bmN0aW9uIGdldE11bHRpZGltZW5zaW9uYWxEZWZpbml0aW9uKGxheWVyKSB7XG4gIHZhciBfYSwgX2I7XG4gIHJldHVybiBsYXllci50eXBlID09PSBcImltYWdlcnktdGlsZVwiXG4gICAgPyBsYXllci5tdWx0aWRpbWVuc2lvbmFsRGVmaW5pdGlvblxuICAgIDogKF9iID0gKChfYSA9IGxheWVyLm1vc2FpY1J1bGUpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IGxheWVyLl9kZWZhdWx0U2VydmljZU1vc2FpY1J1bGUpKSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2IubXVsdGlkaW1lbnNpb25hbERlZmluaXRpb247XG59XG5hc3luYyBmdW5jdGlvbiBnZXRNdWx0aWRpbWVuc2lvbmFsSW5mbyhsYXllciwgdXNlUmF3U291cmNlSW5mbykge1xuICB2YXIgX2EsIF9iO1xuICBpZiAobGF5ZXIudHlwZSA9PT0gXCJpbWFnZXJ5LXRpbGVcIikge1xuICAgIHJldHVybiBsYXllci5yYXN0ZXJJbmZvLm11bHRpZGltZW5zaW9uYWxJbmZvO1xuICB9XG4gIGNvbnN0IHsgcmFzdGVyRnVuY3Rpb24sIHZlcnNpb24gfSA9IGxheWVyO1xuICBpZiAodXNlUmF3U291cmNlSW5mbyB8fFxuICAgIHZlcnNpb24gPD0gbWluVmVyc2lvblJGVE11bHRpZGltZW5zaW9uYWxJbmZvIHx8XG4gICAgIXJhc3RlckZ1bmN0aW9uIHx8XG4gICAgKChfYSA9IHJhc3RlckZ1bmN0aW9uLmZ1bmN0aW9uTmFtZSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnRvTG93ZXJDYXNlKCkpID09PSBcIm5vbmVcIikge1xuICAgIHJldHVybiBsYXllci5zZXJ2aWNlUmFzdGVySW5mby5tdWx0aWRpbWVuc2lvbmFsSW5mbztcbiAgfVxuICBjb25zdCByYXN0ZXJJbmZvID0gKF9iID0gKGF3YWl0IGxheWVyLmdlbmVyYXRlUmFzdGVySW5mbyhsYXllci5yYXN0ZXJGdW5jdGlvbikpKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiBsYXllci5zZXJ2aWNlUmFzdGVySW5mbztcbiAgcmV0dXJuIHJhc3RlckluZm8ubXVsdGlkaW1lbnNpb25hbEluZm87XG59XG5mdW5jdGlvbiBpc1RpbWVEaW1lbnNpb24oZGltZW5zaW9uSW5mbywgaWdub3JlUmVjdXJpbmcgPSBmYWxzZSkge1xuICByZXR1cm4gZGltZW5zaW9uSW5mby5uYW1lID09PSBcIlN0ZFRpbWVcIiAmJiAoaWdub3JlUmVjdXJpbmcgfHwgIWRpbWVuc2lvbkluZm8ucmVjdXJyaW5nKTtcbn1cbmZ1bmN0aW9uIGlzUmVjdXJyaW5nVGltZURpbWVuc2lvbihkaW1lbnNpb25JbmZvKSB7XG4gIHJldHVybiBkaW1lbnNpb25JbmZvLm5hbWUgPT09IFwiU3RkVGltZVwiICYmICEhZGltZW5zaW9uSW5mby5yZWN1cnJpbmc7XG59XG5mdW5jdGlvbiB1cGRhdGVEaW1lbnNpb25hbERlZmluaXRpb24oZGVmLCBkaW1lbnNpb25JbmZvLCBhY3RpdmVNdWx0aWRpbWVuc2lvbmFsU3Vic2V0KSB7XG4gIGRpbWVuc2lvbkluZm8gPSBnZXRDbGlwcGVkRGltZW5zaW9uSW5mbyhkaW1lbnNpb25JbmZvLCBhY3RpdmVNdWx0aWRpbWVuc2lvbmFsU3Vic2V0KTtcbiAgY29uc3Qgb3JpZ2luYWxGb3JtYXR0ZWRWYWx1ZSA9IGZvcm1hdERpbWVuc2lvblZhbHVlKGRlZi52YWx1ZXNbMF0sIGRpbWVuc2lvbkluZm8pO1xuICBjb25zdCBoYXNPcmlnaW5hbEZvcm1hdHRlZFZhbHVlID0gZGltZW5zaW9uSW5mby52YWx1ZXMuc29tZSgodmFsKSA9PiBvcmlnaW5hbEZvcm1hdHRlZFZhbHVlID09PSBmb3JtYXREaW1lbnNpb25WYWx1ZSh2YWwsIGRpbWVuc2lvbkluZm8pKTtcbiAgaWYgKCFoYXNPcmlnaW5hbEZvcm1hdHRlZFZhbHVlKSB7XG4gICAgLy8gZ2V0IGRlZmF1bHQgc2xpY2UgdmFsdWUgd2hlbiBkZWYudmFsdWVzIGlzIGludmFsaWRcbiAgICBjb25zdCB2YWx1ZSA9IGdldERlZmF1bHREaW1lbnNpb25TbGljZVZhbHVlKGRpbWVuc2lvbkluZm8pO1xuICAgIGRlZi52YWx1ZXMgPSBbdmFsdWVdO1xuICB9XG59XG5cbmV4cG9ydCB7IGdldE11bHRpZGltZW5zaW9uYWxJbmZvIGFzIGEsIGdldERlZmF1bHREaW1lbnNpb25TbGljZVZhbHVlIGFzIGIsIGdldE11bHRpZGltZW5zaW9uYWxEZWZpbml0aW9uIGFzIGMsIGZvcm1hdERpbWVuc2lvblZhbHVlIGFzIGYsIGdldENsaXBwZWREaW1lbnNpb25JbmZvIGFzIGcsIGlzVGltZURpbWVuc2lvbiBhcyBpLCBtaW5WZXJzaW9uUkZUTXVsdGlkaW1lbnNpb25hbEluZm8gYXMgbSwgdXBkYXRlRGltZW5zaW9uYWxEZWZpbml0aW9uIGFzIHUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==