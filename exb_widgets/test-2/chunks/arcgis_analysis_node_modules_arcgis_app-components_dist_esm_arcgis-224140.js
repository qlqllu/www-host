"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-224140"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-drag-and-drop.entry.js":
/*!***********************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-drag-and-drop.entry.js ***!
  \***********************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_drag_and_drop: () => (/* binding */ ArcgisDragAndDrop)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _locale_13e00a75_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./locale-13e00a75.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-13e00a75.js");
/* harmony import */ var _file_f36193e9_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./file-f36193e9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-f36193e9.js");
/* harmony import */ var _privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./privileges-ccd5f37d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-ccd5f37d.js");
/* harmony import */ var _item_types_054054c6_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./item-types-054054c6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-054054c6.js");
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/* harmony import */ var _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./languageUtil-22258c90.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js");
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/* harmony import */ var _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./ui-ecf86bba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js");
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/* harmony import */ var _guid_4f4176ba_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./guid-4f4176ba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js");
/* harmony import */ var _functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./functional-c82f5ab9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-c82f5ab9.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */














const helpMapNumbers = {
  append: 120001300,
  default: 120000456
};
function validateAddedFile(files, isFolder, user, fileConstraints, uiInfo) {
  var _a, _b;
  // Check if unzipped shapefile, then
  // Check if multiple files uploaded, then
  // Check if file extension is supported
  // If it passes all those tests, update the page
  const { helpBase, helpMap, i18n, helpIdType } = uiInfo;
  const { extension } = (0,_file_f36193e9_js__WEBPACK_IMPORTED_MODULE_2__.s)(files[0]);
  const { maxFileSize, allowedExtensions } = fileConstraints;
  let valid = false;
  let errorMessage;
  const validExtension = (_a = allowedExtensions === null || allowedExtensions === void 0 ? void 0 : allowedExtensions.includes(extension)) !== null && _a !== void 0 ? _a : true;
  const foundShapefile = Object.keys(files).some((key) => {
    const { extension } = (0,_file_f36193e9_js__WEBPACK_IMPORTED_MODULE_2__.s)(files[key]);
    const shapefileExtensions = ["shp", "shx", "dbf", "prj"];
    return shapefileExtensions.includes(extension);
  });
  const validationTypes = (_b = fileConstraints.validationTypes) !== null && _b !== void 0 ? _b : null;
  const possibleType = (0,_item_types_054054c6_js__WEBPACK_IMPORTED_MODULE_4__.f)((0,_file_f36193e9_js__WEBPACK_IMPORTED_MODULE_2__.s)(files[0]).extension, validationTypes)[0];
  const validFileType = possibleType &&
    (possibleType.appendUploadFormat || possibleType.allowAddDirect || !possibleType.orgOnly || !(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_3__.n)(user));
  if (foundShapefile) {
    errorMessage = {
      title: i18n.error.shapefileErrorTitle,
      message: i18n.error.shapefileErrorMessage,
      link: {
        text: i18n.error.shapefileErrorLink,
        path: `${helpBase}${helpMap["120002804"]}`
      }
    };
  }
  else if (files.length > 1) {
    errorMessage = {
      title: i18n.error.multipleFilesErrorTitle,
      message: i18n.error.multipleFilesErrorMessage
    };
  }
  else if (maxFileSize != null && files[0].size > maxFileSize) {
    const sizeInMB = maxFileSize / 1000000;
    errorMessage = { message: i18n.error.maxSize.replace("${size}", sizeInMB.toString()) };
  }
  else if (!validFileType || !validExtension) {
    const helpMapNumber = helpMapNumbers[helpIdType];
    isFolder
      ? (errorMessage = {
        message: i18n.error.folderError
      })
      : (errorMessage = {
        title: i18n.error.unsupportedFileTypeTitle,
        link: {
          text: i18n.error.unsupportedFileTypeMessage,
          path: `${helpBase}${helpMap[helpMapNumber]}`
        }
      });
  }
  else {
    valid = true;
  }
  return { success: valid, errorMessage };
}

const arcgisDragAndDropCss = ".drag-and-drop-well{position:relative}.drag-and-drop-well ::slotted(*){position:relative;transition:all 200ms ease-in-out;position:relative;border:2px dashed transparent}.drag-and-drop-well ::slotted(*):before{content:\"\";position:absolute;top:0;right:0;bottom:0;left:0;background-color:rgba(0, 121, 193, 0) !important;pointer-events:none;transition:background-color 200ms ease-in-out !important;z-index:2}.dragging ::slotted(*){border-color:#007ac2 !important}.dragging ::slotted(*):before{border-color:#007ac2 !important;background-color:rgba(0, 121, 193, 0.05) !important}.notice-container{display:flex;justify-content:center;align-items:center;position:absolute;top:0;left:0;right:0;pointer-events:none;z-index:10}.alert__message{display:block;line-height:1.375}.alert__link{display:inline}.full-height{height:100%}";

const ArcgisDragAndDrop = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.arcgisDropSuccess = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisDropSuccess", 7);
    this.arcgisAlertActive = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisAlertActive", 7);
    this.arcgisDragOver = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisDragOver", 7);
    this.config = undefined;
    this.user = undefined;
    this.active = true;
    this.alertMessage = { title: "" };
    this.alertActive = false;
    this.error = false;
    this.files = undefined;
    this.allowedExtensions = null;
    this.validTypes = null;
    this.dragOverNoticeMessage = undefined;
    this.insideModal = undefined;
    this.fullHeight = undefined;
    this.showHelpLinkOnError = true;
    this.maxFileSize = undefined;
    this.helpIdType = "default";
    this.isFolder = false;
    this.dragOver = undefined;
  }
  handleAlertChange() {
    var _a, _b;
    const { alertActive } = this;
    if (alertActive) {
      window.dispatchEvent(new CustomEvent("calciteInternalAlertSync", { detail: { queue: [] } }));
      (_a = this.el.shadowRoot.querySelector("#new-item-alert")) === null || _a === void 0 ? void 0 : _a.setAttribute("active", "");
    }
    else {
      (_b = this.el.shadowRoot.querySelector("#new-item-alert")) === null || _b === void 0 ? void 0 : _b.removeAttribute("active");
    }
    this.arcgisAlertActive.emit(alertActive);
  }
  handleFileUpdate() {
    const { files, i18n, isFolder, user, config, validTypes, helpIdType } = this;
    const { success, errorMessage } = validateAddedFile(files, isFolder, user, {
      allowedExtensions: this.allowedExtensions,
      maxFileSize: this.maxFileSize,
      validationTypes: validTypes
    }, { helpIdType, i18n, helpBase: config.helpBase, helpMap: config.helpMap });
    if (success) {
      this.arcgisDropSuccess.emit(files[0]);
    }
    else {
      this.alertMessage = errorMessage;
      this.alertActive = true;
    }
  }
  handleDragOver(e) {
    if (e.dataTransfer.types.includes("Files")) {
      if (this.wellRef) {
        // * Make sure the notice is visible on screen
        const windowHeight = window.innerHeight;
        const { y: wellOffsetTop, bottom } = this.wellRef.getBoundingClientRect();
        const topBoundary = Math.max(wellOffsetTop, 0);
        const bottomBoundary = Math.min(windowHeight, bottom);
        this.noticeRef.style.height = `${bottomBoundary - topBoundary}px`;
        // -Math.min(0, wellOffsetTop) because:
        //  --- when the well's top is NOT visible, we'll have wellOffsetTop < 0
        //  => we'll offset `top` of the notice's container by that amount
        //  --- when the well's top is visible, we'll have wellOffsetTop > 0
        //  => we'll use 0 for the top of the notice's container
        const relativeTop = -Math.min(0, wellOffsetTop);
        this.noticeRef.style.top = `${relativeTop}px`;
      }
      e.preventDefault();
      this.dragOver = true;
      this.arcgisDragOver.emit(this.dragOver);
    }
    return false;
  }
  async componentWillLoad() {
    const locale = await (0,_locale_13e00a75_js__WEBPACK_IMPORTED_MODULE_1__.g)(this.el);
    this.i18n = locale[0];
  }
  render() {
    const { title, message, link } = this.alertMessage;
    const { text, path } = Object.assign({}, link);
    const { active, dragOverNoticeMessage, dragOver, insideModal, fullHeight, showHelpLinkOnError } = this;
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { ref: (ele) => (this.wellRef = ele), class: {
        hide: !active,
        "drag-and-drop-well": true,
        dragging: this.dragOver,
        "full-height": fullHeight
      }, onDragOver: active && this.handleDragOver.bind(this), onDragLeave: () => {
        this.dragOver = false;
      }, onDrop: (e) => {
        var _a, _b, _c, _d;
        if (!active) {
          return;
        }
        e.preventDefault();
        this.alertActive = false;
        this.dragOver = false;
        const { files, items } = e.dataTransfer;
        const item = items === null || items === void 0 ? void 0 : items[0];
        this.isFolder =
          ((_d = ((_b = (_a = item.webkitGetAsEntry) === null || _a === void 0 ? void 0 : _a.call(item)) !== null && _b !== void 0 ? _b : (_c = item === null || item === void 0 ? void 0 : item.getAsEntry) === null || _c === void 0 ? void 0 : _c.call(item))) === null || _d === void 0 ? void 0 : _d.isDirectory) || false;
        this.files = files;
      } }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("slot", null), insideModal ? (
    // TODO: consider having this component return an error code rather than a full alert
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { id: "new-item-alert", kind: "danger", onAlertDismiss: () => {
        this.alertActive = false;
      }, active: !!this.alertActive, heading: title, description: message, link: { href: link === null || link === void 0 ? void 0 : link.path, title: link === null || link === void 0 ? void 0 : link.text } })) : ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-alert", { label: "", id: "new-item-alert", icon: true, kind: "danger", onCalciteAlertClose: () => {
        this.alertActive = false;
      }, open: !!this.alertActive, tabIndex: !this.alertActive ? -1 : null, ref: (el) => {
        // here, we hide the queue as it takes up too much room on mobile and we're not using it
        const queue = el.shadowRoot.querySelector(".alert-queue-count");
        if (queue) {
          queue.style.display = "none";
        }
      } }, title && (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: "title" }, title), message && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: "message", class: "alert__message" }, message)), showHelpLinkOnError && link && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-link", { slot: "link", target: "_blank", href: path, class: "alert__link" }, text)))), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "notice-container", ref: (ele) => (this.noticeRef = ele) }, dragOverNoticeMessage && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-notice", { icon: "upload-to", open: dragOver, scale: "m", width: "auto" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { slot: "message" }, dragOverNoticeMessage))))));
  }
  get el() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
  static get watchers() { return {
    "alertActive": ["handleAlertChange"],
    "files": ["handleFileUpdate"]
  }; }
};
ArcgisDragAndDrop.style = arcgisDragAndDropCss;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-f36193e9.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/file-f36193e9.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ sanitizeFileName),
/* harmony export */   f: () => (/* binding */ formatFileSize),
/* harmony export */   g: () => (/* binding */ getItemInfoByType),
/* harmony export */   s: () => (/* binding */ sanitizeFileInput),
/* harmony export */   v: () => (/* binding */ validateOverwriteFileName)
/* harmony export */ });
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/* harmony import */ var _guid_4f4176ba_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./guid-4f4176ba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



function sanitizeFileName(name, addGUID) {
  //TODO: add new param to spec file.
  const expression = /(?:\.([^.]+))?$/;
  const invalidTitleCharacters = /\.|-/g;
  let fileName = name.replace(/^.*(\\|\/|:)/, "");
  let extension = (fileName && expression.exec(fileName)[1] ? expression.exec(fileName)[1].toLowerCase() : "");
  let title = "";
  if (fileName.indexOf(".rft.") > -1) {
    const [name, suffix] = fileName.split(".rft.");
    extension = `rft.${suffix}`;
    title = name;
  }
  if (fileName && !title) {
    title = fileName.lastIndexOf(".") === -1 ? fileName : fileName.substring(0, fileName.lastIndexOf("."));
  }
  // Replace any invalid characters with an underscore
  title = title.replace(invalidTitleCharacters, "_");
  // Allow file upload of existing item's file name // currently used in append
  if (addGUID) {
    title = makeUniqueFileName(title);
    fileName = `${title}.${extension}`;
  }
  return { title, fileName, extension };
}
// Helper method that takes in a file & returns the cleaned up file name as is and in title form, and the detected file extension
function sanitizeFileInput(file, addGUID) {
  return sanitizeFileName(file.name, !!addGUID);
}
function makeUniqueFileName(name) {
  return `${name}_${(0,_guid_4f4176ba_js__WEBPACK_IMPORTED_MODULE_1__.g)()}`;
}
function validateOverwriteFileName(uploadedFileName, sourceFileName) {
  let fileName = uploadedFileName;
  const position = uploadedFileName.lastIndexOf("\\");
  if (position > -1) {
    fileName = fileName.substring(position + 1, fileName.length);
  }
  return fileName.replace(/\ /g, "_") === sourceFileName.replace(/\ /g, "_");
}
function getItemInfoByType(type) {
  if (_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[type]) {
    return _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[type];
  }
  else {
    return _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[Object.keys(_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a).find((fileType) => _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_0__.a[fileType].type === type)];
  }
}
function formatFileSize(size) {
  if (!size) {
    return "0 B";
  }
  const i = Math.floor(Math.log(size) / Math.log(1024));
  const adjustedSize = Math.round(size / Math.pow(1024, i));
  const unit = ["B", "KB", "MB", "GB", "TB"][i];
  return `${adjustedSize} ${unit}`;
}




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js":
/*!**********************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/guid-4f4176ba.js ***!
  \**********************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   g: () => (/* binding */ guid)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */
function generateId(counts) {
  return counts
    .map((count) => {
    let out = "";
    for (let i = 0; i < count; i++) {
      out += (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);
    }
    return out;
  })
    .join("-");
}
const guid = () => generateId([2, 1, 1, 1, 3]);




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-054054c6.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-054054c6.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ isLargeCSV),
/* harmony export */   f: () => (/* binding */ findPossibleItemTypesByExtension),
/* harmony export */   i: () => (/* binding */ isLargeGeoJSON),
/* harmony export */   m: () => (/* binding */ mapItemTypesToFileExtensions)
/* harmony export */ });
/* harmony import */ var _functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./functional-c82f5ab9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-c82f5ab9.js");
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



function findPossibleItemTypesByExtension(extension, validationTypes) {
  // Search item types extensions for the one imported
  let itemTypes;
  if (validationTypes) {
    itemTypes = validationTypes.map((value) => {
      return value.type;
    });
  }
  else {
    itemTypes = Object.keys(_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a);
  }
  let possibleItemTypes = [];
  itemTypes.forEach((type) => {
    var _a;
    if (((_a = _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a[type].fileExt) === null || _a === void 0 ? void 0 : _a.indexOf(extension)) >= 0) {
      possibleItemTypes.push(_item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a[type]);
    }
  });
  return possibleItemTypes;
}
function mapItemTypesToFileExtensions(types) {
  if (!types) {
    return null;
  }
  return (0,_functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_0__.b)(types.flatMap((type) => { var _a; return (_a = _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_1__.a[type]) === null || _a === void 0 ? void 0 : _a.fileExt; }).filter((valid) => !!valid));
}
const isLargeGeoJSON = (sizeInBytes) => {
  const sizeInMB = sizeInBytes / 1024 / 1024;
  // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2553#issuecomment-3645404
  return sizeInMB > 50; // 50MB
};
const isLargeCSV = (sizeInBytes) => {
  const sizeInMB = sizeInBytes / 1024 / 1024;
  // https://devtopia.esri.com/WebGIS/arcgis-app-components/issues/2875#issuecomment-3748913
  return sizeInMB > 20; // 20MB
};




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js":
/*!******************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js ***!
  \******************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   C: () => (/* binding */ CSS_UTILITY),
/* harmony export */   a: () => (/* binding */ formatDate),
/* harmony export */   f: () => (/* binding */ formatNumber),
/* harmony export */   g: () => (/* binding */ getElementDir),
/* harmony export */   l: () => (/* binding */ languageMap)
/* harmony export */ });
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */



const languageMap = new Map([
  ["ar", "ar"],
  ["bg", "bg"],
  ["bs", "bs"],
  ["ca", "ca"],
  ["cs", "cs"],
  ["da", "da"],
  ["de", "de"],
  ["el", "el"],
  ["en", "en"],
  ["es", "es"],
  ["et", "et"],
  ["fi", "fi"],
  ["fr", "fr"],
  ["he", "he"],
  ["hr", "hr"],
  ["hu", "hu"],
  ["id", "id"],
  ["it", "it"],
  ["ja", "ja"],
  ["ko", "ko"],
  ["lt", "lt"],
  ["lv", "lv"],
  ["nb", "nb"],
  ["nl", "nl"],
  ["pl", "pl"],
  ["pt-br", "pt-BR"],
  ["pt-pt", "pt-PT"],
  ["ro", "ro"],
  ["ru", "ru"],
  ["sk", "sk"],
  ["sl", "sl"],
  ["sr", "sr"],
  ["sv", "sv"],
  ["th", "th"],
  ["tr", "tr"],
  ["uk", "uk"],
  ["vi", "vi"],
  ["zh-cn", "zh-CN"],
  ["zh-hk", "zh-HK"],
  ["zh-tw", "zh-TW"]
]);
// rtl
function getElementDir(el) {
  return getElementProp(el, "dir", "ltr");
}
function getElementProp(el, prop, value) {
  const closestWithProp = (0,_dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_1__.c)(el, `[${prop}]`);
  return closestWithProp ? closestWithProp.getAttribute(prop) : value;
}
// css
const CSS_UTILITY = {
  rtl: "arcgis--rtl"
};
async function formatNumber(number, options) {
  const { api, type, places } = options || {};
  if (api === 4) {
    const [intl] = await (0,_loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_0__.l)(["esri/intl"]);
    const numberFormatIntlOptions = intl.convertNumberFormatToIntlOptions({
      places,
      style: type,
      digitSeparator: true
    });
    return intl.formatNumber(number, Object.assign(Object.assign({}, numberFormatIntlOptions), { style: type }));
  }
  const [dojoNumber] = await (0,_loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_0__.l)(["dojo/number"]);
  return dojoNumber.format(number, {
    type,
    places,
    pattern: options === null || options === void 0 ? void 0 : options.pattern
  });
}
const cache = {};
function formatDate(date) {
  const lang = document.documentElement.lang;
  const dayShortMonthYear = {
    year: "numeric",
    month: "short",
    day: "numeric"
  };
  if (!cache[lang]) {
    cache[lang] = new Intl.DateTimeFormat(document.documentElement.lang, dayShortMonthYear);
  }
  return cache[lang].format(date);
}




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-13e00a75.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/locale-13e00a75.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ getComponentClosestLanguage),
/* harmony export */   g: () => (/* binding */ getLocaleComponentStrings)
/* harmony export */ });
/* harmony import */ var _dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./dom-13f5b00c.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/dom-13f5b00c.js");
/* harmony import */ var _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./languageUtil-22258c90.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/languageUtil-22258c90.js");
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */




// https://medium.com/stencil-tricks/implementing-internationalisation-i18n-with-stencil-5e6559554117
function getComponentClosestLanguage(element) {
  var _a, _b, _c;
  const closestElement = (_a = (0,_dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
  // language set by the calling application or browser. defaults to english.
  const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
  if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
    return _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
  }
  else {
    // "ru-RU" maps to "ru" use case
    if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
      return _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang.slice(0, 2));
    }
    else {
      return "en";
    }
  }
}
function getComponentClosestLanguageIntl(element) {
  var _a, _b, _c;
  // it's OK if we don't have the 4 letter language file for it
  // 4 letter language code needed for formatting numbers
  const closestElement = (_a = (0,_dom_13f5b00c_js__WEBPACK_IMPORTED_MODULE_0__.c)(element, "[lang]")) !== null && _a !== void 0 ? _a : (_c = (_b = element.shadowRoot) === null || _b === void 0 ? void 0 : _b.ownerDocument) === null || _c === void 0 ? void 0 : _c.documentElement;
  // language set by the calling application or browser. defaults to english.
  const lang = ((closestElement === null || closestElement === void 0 ? void 0 : closestElement.lang) || (navigator === null || navigator === void 0 ? void 0 : navigator.language) || "en").toLowerCase();
  if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang)) {
    return _languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.get(lang);
  }
  else {
    if (_languageUtil_22258c90_js__WEBPACK_IMPORTED_MODULE_1__.l.has(lang.slice(0, 2))) {
      // we support the 2 letter coded language
      // e.g. it-CH vs it
      return lang;
    }
    else {
      return "en";
    }
  }
}
function fetchLocaleStringsForComponent(componentName, locale) {
  return new Promise((resolve, reject) => {
    fetch((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_2__.a)(`../arcgis-app-assets/i18n/${componentName}.i18n.${locale}.json`)).then((result) => {
      if (result.ok)
        resolve(result.json());
      else
        reject();
    }, () => reject());
  });
}
const stringCache = {};
function fetchLocaleStringsFromCache(componentName, locale) {
  const id = `${componentName}${locale}`;
  if (!stringCache[id]) {
    stringCache[id] = fetchLocaleStringsForComponent(componentName, locale);
  }
  return stringCache[id];
}
/**
 * Get strings and language codes.
 * This method returns 2 language codes.
 * The first one returns a code that's also supported as a language file.
 * The second one returns a code where there is support for the first 2 letters of the code as part of a language file,
 * but will return the original 4 letter code from the page.
 * E.g. For "it-ch" it will return "it" as the first language code and "it-ch" as the second.
 * The second one is required for esri.intl.setLocale() to get the correct formatting.
 *
 * If a tagName is provided it will overwite the element's tagName
 *
 *  @return [ strings, first language code, second language code]
 */
async function getLocaleComponentStrings(element, tagName) {
  const componentName = tagName || element.tagName.toLowerCase();
  const componentLanguage = getComponentClosestLanguage(element);
  const componentLanguageIntl = getComponentClosestLanguageIntl(element);
  let strings;
  try {
    strings = await fetchLocaleStringsFromCache(componentName, componentLanguage);
  }
  catch (e) {
    console.warn(`no locale for ${componentName} (${componentLanguage}) loading default locale en.`);
    strings = await fetchLocaleStringsFromCache(componentName, "en");
  }
  return [strings, componentLanguage, componentLanguageIntl];
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTIyNDE0MC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ2tHO0FBQzVCO0FBQ1Y7QUFDQztBQUNvQjtBQUN0RDtBQUNTO0FBQ0Q7QUFDRDtBQUNSO0FBQ0c7QUFDRDtBQUNNOztBQUVsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsc0NBQXNDO0FBQ2hELFVBQVUsWUFBWSxFQUFFLG9EQUFpQjtBQUN6QyxVQUFVLGlDQUFpQztBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksWUFBWSxFQUFFLG9EQUFpQjtBQUMzQztBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0EsdUJBQXVCLDBEQUFnQyxDQUFDLG9EQUFpQjtBQUN6RTtBQUNBLGlHQUFpRywwREFBWTtBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsU0FBUyxFQUFFLHFCQUFxQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLHVDQUF1QyxLQUFLO0FBQ2pFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQixTQUFTLEVBQUUsdUJBQXVCO0FBQ3JEO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVztBQUNYOztBQUVBLGtEQUFrRCxrQkFBa0IsaUNBQWlDLGtCQUFrQixpQ0FBaUMsa0JBQWtCLDhCQUE4Qix3Q0FBd0MsYUFBYSxrQkFBa0IsTUFBTSxRQUFRLFNBQVMsT0FBTyxpREFBaUQsb0JBQW9CLHlEQUF5RCxVQUFVLHVCQUF1QixnQ0FBZ0Ms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QUFDOUc7QUFDQSw2QkFBNkIsMkRBQVc7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFc0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUM3RnRHO0FBQ0E7QUFDQTtBQUNBO0FBQzJFO0FBQ2I7QUFDTjs7QUFFeEQ7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLG1EQUFpQztBQUNoRTtBQUNBO0FBQ0EsTUFBTSx3REFBVztBQUNqQixXQUFXLHdEQUFXO0FBQ3RCO0FBQ0E7QUFDQTtBQUNBLFFBQVEsd0RBQVc7QUFDbkIsYUFBYSx3REFBVztBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixtREFBaUM7QUFDaEU7QUFDQTtBQUNBLE1BQU0sd0RBQVc7QUFDakIsV0FBVyx3REFBVztBQUN0QjtBQUNBO0FBQ0EsUUFBUSx3REFBVztBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxxREFBWSw4QkFBOEIsY0FBYyxRQUFRLE9BQU87QUFDakY7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixjQUFjLEVBQUUsT0FBTztBQUN2QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsZUFBZSxHQUFHLGtCQUFrQjtBQUN0RTtBQUNBO0FBQ0E7QUFDQTs7QUFFNEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcmNnaXMtZHJhZy1hbmQtZHJvcC5lbnRyeS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9maWxlLWYzNjE5M2U5LmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2d1aWQtNGY0MTc2YmEuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vaXRlbS10eXBlcy0wNTQwNTRjNi5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9sYW5ndWFnZVV0aWwtMjIyNThjOTAuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vbG9jYWxlLTEzZTAwYTc1LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgciBhcyByZWdpc3Rlckluc3RhbmNlLCBjIGFzIGNyZWF0ZUV2ZW50LCBoLCBkIGFzIGdldEVsZW1lbnQgfSBmcm9tICcuL2luZGV4LTkyZWJiMzk2LmpzJztcbmltcG9ydCB7IGcgYXMgZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyB9IGZyb20gJy4vbG9jYWxlLTEzZTAwYTc1LmpzJztcbmltcG9ydCB7IHMgYXMgc2FuaXRpemVGaWxlSW5wdXQgfSBmcm9tICcuL2ZpbGUtZjM2MTkzZTkuanMnO1xuaW1wb3J0IHsgbiBhcyBpc1B1YmxpY1VzZXIgfSBmcm9tICcuL3ByaXZpbGVnZXMtY2NkNWYzN2QuanMnO1xuaW1wb3J0IHsgZiBhcyBmaW5kUG9zc2libGVJdGVtVHlwZXNCeUV4dGVuc2lvbiB9IGZyb20gJy4vaXRlbS10eXBlcy0wNTQwNTRjNi5qcyc7XG5pbXBvcnQgJy4vZG9tLTEzZjViMDBjLmpzJztcbmltcG9ydCAnLi9sYW5ndWFnZVV0aWwtMjIyNThjOTAuanMnO1xuaW1wb3J0ICcuL2xvYWRNb2R1bGVzLWFhZjMwYmQ2LmpzJztcbmltcG9ydCAnLi9pdGVtLXR5cGVzLWI0ZmU4NmFkLmpzJztcbmltcG9ydCAnLi91aS1lY2Y4NmJiYS5qcyc7XG5pbXBvcnQgJy4vaW5kZXgtODFkNTQ4YjcuanMnO1xuaW1wb3J0ICcuL2d1aWQtNGY0MTc2YmEuanMnO1xuaW1wb3J0ICcuL2Z1bmN0aW9uYWwtYzgyZjVhYjkuanMnO1xuXG5jb25zdCBoZWxwTWFwTnVtYmVycyA9IHtcbiAgYXBwZW5kOiAxMjAwMDEzMDAsXG4gIGRlZmF1bHQ6IDEyMDAwMDQ1NlxufTtcbmZ1bmN0aW9uIHZhbGlkYXRlQWRkZWRGaWxlKGZpbGVzLCBpc0ZvbGRlciwgdXNlciwgZmlsZUNvbnN0cmFpbnRzLCB1aUluZm8pIHtcbiAgdmFyIF9hLCBfYjtcbiAgLy8gQ2hlY2sgaWYgdW56aXBwZWQgc2hhcGVmaWxlLCB0aGVuXG4gIC8vIENoZWNrIGlmIG11bHRpcGxlIGZpbGVzIHVwbG9hZGVkLCB0aGVuXG4gIC8vIENoZWNrIGlmIGZpbGUgZXh0ZW5zaW9uIGlzIHN1cHBvcnRlZFxuICAvLyBJZiBpdCBwYXNzZXMgYWxsIHRob3NlIHRlc3RzLCB1cGRhdGUgdGhlIHBhZ2VcbiAgY29uc3QgeyBoZWxwQmFzZSwgaGVscE1hcCwgaTE4biwgaGVscElkVHlwZSB9ID0gdWlJbmZvO1xuICBjb25zdCB7IGV4dGVuc2lvbiB9ID0gc2FuaXRpemVGaWxlSW5wdXQoZmlsZXNbMF0pO1xuICBjb25zdCB7IG1heEZpbGVTaXplLCBhbGxvd2VkRXh0ZW5zaW9ucyB9ID0gZmlsZUNvbnN0cmFpbnRzO1xuICBsZXQgdmFsaWQgPSBmYWxzZTtcbiAgbGV0IGVycm9yTWVzc2FnZTtcbiAgY29uc3QgdmFsaWRFeHRlbnNpb24gPSAoX2EgPSBhbGxvd2VkRXh0ZW5zaW9ucyA9PT0gbnVsbCB8fCBhbGxvd2VkRXh0ZW5zaW9ucyA9PT0gdm9pZCAwID8gdm9pZCAwIDogYWxsb3dlZEV4dGVuc2lvbnMuaW5jbHVkZXMoZXh0ZW5zaW9uKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdHJ1ZTtcbiAgY29uc3QgZm91bmRTaGFwZWZpbGUgPSBPYmplY3Qua2V5cyhmaWxlcykuc29tZSgoa2V5KSA9PiB7XG4gICAgY29uc3QgeyBleHRlbnNpb24gfSA9IHNhbml0aXplRmlsZUlucHV0KGZpbGVzW2tleV0pO1xuICAgIGNvbnN0IHNoYXBlZmlsZUV4dGVuc2lvbnMgPSBbXCJzaHBcIiwgXCJzaHhcIiwgXCJkYmZcIiwgXCJwcmpcIl07XG4gICAgcmV0dXJuIHNoYXBlZmlsZUV4dGVuc2lvbnMuaW5jbHVkZXMoZXh0ZW5zaW9uKTtcbiAgfSk7XG4gIGNvbnN0IHZhbGlkYXRpb25UeXBlcyA9IChfYiA9IGZpbGVDb25zdHJhaW50cy52YWxpZGF0aW9uVHlwZXMpICE9PSBudWxsICYmIF9iICE9PSB2b2lkIDAgPyBfYiA6IG51bGw7XG4gIGNvbnN0IHBvc3NpYmxlVHlwZSA9IGZpbmRQb3NzaWJsZUl0ZW1UeXBlc0J5RXh0ZW5zaW9uKHNhbml0aXplRmlsZUlucHV0KGZpbGVzWzBdKS5leHRlbnNpb24sIHZhbGlkYXRpb25UeXBlcylbMF07XG4gIGNvbnN0IHZhbGlkRmlsZVR5cGUgPSBwb3NzaWJsZVR5cGUgJiZcbiAgICAocG9zc2libGVUeXBlLmFwcGVuZFVwbG9hZEZvcm1hdCB8fCBwb3NzaWJsZVR5cGUuYWxsb3dBZGREaXJlY3QgfHwgIXBvc3NpYmxlVHlwZS5vcmdPbmx5IHx8ICFpc1B1YmxpY1VzZXIodXNlcikpO1xuICBpZiAoZm91bmRTaGFwZWZpbGUpIHtcbiAgICBlcnJvck1lc3NhZ2UgPSB7XG4gICAgICB0aXRsZTogaTE4bi5lcnJvci5zaGFwZWZpbGVFcnJvclRpdGxlLFxuICAgICAgbWVzc2FnZTogaTE4bi5lcnJvci5zaGFwZWZpbGVFcnJvck1lc3NhZ2UsXG4gICAgICBsaW5rOiB7XG4gICAgICAgIHRleHQ6IGkxOG4uZXJyb3Iuc2hhcGVmaWxlRXJyb3JMaW5rLFxuICAgICAgICBwYXRoOiBgJHtoZWxwQmFzZX0ke2hlbHBNYXBbXCIxMjAwMDI4MDRcIl19YFxuICAgICAgfVxuICAgIH07XG4gIH1cbiAgZWxzZSBpZiAoZmlsZXMubGVuZ3RoID4gMSkge1xuICAgIGVycm9yTWVzc2FnZSA9IHtcbiAgICAgIHRpdGxlOiBpMThuLmVycm9yLm11bHRpcGxlRmlsZXNFcnJvclRpdGxlLFxuICAgICAgbWVzc2FnZTogaTE4bi5lcnJvci5tdWx0aXBsZUZpbGVzRXJyb3JNZXNzYWdlXG4gICAgfTtcbiAgfVxuICBlbHNlIGlmIChtYXhGaWxlU2l6ZSAhPSBudWxsICYmIGZpbGVzWzBdLnNpemUgPiBtYXhGaWxlU2l6ZSkge1xuICAgIGNvbnN0IHNpemVJbk1CID0gbWF4RmlsZVNpemUgLyAxMDAwMDAwO1xuICAgIGVycm9yTWVzc2FnZSA9IHsgbWVzc2FnZTogaTE4bi5lcnJvci5tYXhTaXplLnJlcGxhY2UoXCIke3NpemV9XCIsIHNpemVJbk1CLnRvU3RyaW5nKCkpIH07XG4gIH1cbiAgZWxzZSBpZiAoIXZhbGlkRmlsZVR5cGUgfHwgIXZhbGlkRXh0ZW5zaW9uKSB7XG4gICAgY29uc3QgaGVscE1hcE51bWJlciA9IGhlbHBNYXBOdW1iZXJzW2hlbHBJZFR5cGVdO1xuICAgIGlzRm9sZGVyXG4gICAgICA/IChlcnJvck1lc3NhZ2UgPSB7XG4gICAgICAgIG1lc3NhZ2U6IGkxOG4uZXJyb3IuZm9sZGVyRXJyb3JcbiAgICAgIH0pXG4gICAgICA6IChlcnJvck1lc3NhZ2UgPSB7XG4gICAgICAgIHRpdGxlOiBpMThuLmVycm9yLnVuc3VwcG9ydGVkRmlsZVR5cGVUaXRsZSxcbiAgICAgICAgbGluazoge1xuICAgICAgICAgIHRleHQ6IGkxOG4uZXJyb3IudW5zdXBwb3J0ZWRGaWxlVHlwZU1lc3NhZ2UsXG4gICAgICAgICAgcGF0aDogYCR7aGVscEJhc2V9JHtoZWxwTWFwW2hlbHBNYXBOdW1iZXJdfWBcbiAgICAgICAgfVxuICAgICAgfSk7XG4gIH1cbiAgZWxzZSB7XG4gICAgdmFsaWQgPSB0cnVlO1xuICB9XG4gIHJldHVybiB7IHN1Y2Nlc3M6IHZhbGlkLCBlcnJvck1lc3NhZ2UgfTtcbn1cblxuY29uc3QgYXJjZ2lzRHJhZ0FuZERyb3BDc3MgPSBcIi5kcmFnLWFuZC1kcm9wLXdlbGx7cG9zaXRpb246cmVsYXRpdmV9LmRyYWctYW5kLWRyb3Atd2VsbCA6OnNsb3R0ZWQoKil7cG9zaXRpb246cmVsYXRpdmU7dHJhbnNpdGlvbjphbGwgMjAwbXMgZWFzZS1pbi1vdXQ7cG9zaXRpb246cmVsYXRpdmU7Ym9yZGVyOjJweCBkYXNoZWQgdHJhbnNwYXJlbnR9LmRyYWctYW5kLWRyb3Atd2VsbCA6OnNsb3R0ZWQoKik6YmVmb3Jle2NvbnRlbnQ6XFxcIlxcXCI7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7cmlnaHQ6MDtib3R0b206MDtsZWZ0OjA7YmFja2dyb3VuZC1jb2xvcjpyZ2JhKDAsIDEyMSwgMTkzLCAwKSAhaW1wb3J0YW50O3BvaW50ZXItZXZlbnRzOm5vbmU7dHJhbnNpdGlvbjpiYWNrZ3JvdW5kLWNvbG9yIDIwMG1zIGVhc2UtaW4tb3V0ICFpbXBvcnRhbnQ7ei1pbmRleDoyfS5kcmFnZ2luZyA6OnNsb3R0ZWQoKil7Ym9yZGVyLWNvbG9yOiMwMDdhYzIgIWltcG9ydGFudH0uZHJhZ2dpbmcgOjpzbG90dGVkKCopOmJlZm9yZXtib3JkZXItY29sb3I6IzAwN2FjMiAhaW1wb3J0YW50O2JhY2tncm91bmQtY29sb3I6cmdiYSgwLCAxMjEsIDE5MywgMC4wNSkgIWltcG9ydGFudH0ubm90aWNlLWNvbnRhaW5lcntkaXNwbGF5OmZsZXg7anVzdGlmeS1jb250ZW50OmNlbnRlcjthbGlnbi1pdGVtczpjZW50ZXI7cG9zaXRpb246YWJzb2x1dGU7dG9wOjA7bGVmdDowO3JpZ2h0OjA7cG9pbnRlci1ldmVudHM6bm9uZTt6LWluZGV4OjEwfS5hbGVydF9fbWVzc2FnZXtkaXNwbGF5OmJsb2NrO2xpbmUtaGVpZ2h0OjEuMzc1fS5hbGVydF9fbGlua3tkaXNwbGF5OmlubGluZX0uZnVsbC1oZWlnaHR7aGVpZ2h0OjEwMCV9XCI7XG5cbmNvbnN0IEFyY2dpc0RyYWdBbmREcm9wID0gY2xhc3Mge1xuICBjb25zdHJ1Y3Rvcihob3N0UmVmKSB7XG4gICAgcmVnaXN0ZXJJbnN0YW5jZSh0aGlzLCBob3N0UmVmKTtcbiAgICB0aGlzLmFyY2dpc0Ryb3BTdWNjZXNzID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNEcm9wU3VjY2Vzc1wiLCA3KTtcbiAgICB0aGlzLmFyY2dpc0FsZXJ0QWN0aXZlID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNBbGVydEFjdGl2ZVwiLCA3KTtcbiAgICB0aGlzLmFyY2dpc0RyYWdPdmVyID0gY3JlYXRlRXZlbnQodGhpcywgXCJhcmNnaXNEcmFnT3ZlclwiLCA3KTtcbiAgICB0aGlzLmNvbmZpZyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnVzZXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hY3RpdmUgPSB0cnVlO1xuICAgIHRoaXMuYWxlcnRNZXNzYWdlID0geyB0aXRsZTogXCJcIiB9O1xuICAgIHRoaXMuYWxlcnRBY3RpdmUgPSBmYWxzZTtcbiAgICB0aGlzLmVycm9yID0gZmFsc2U7XG4gICAgdGhpcy5maWxlcyA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmFsbG93ZWRFeHRlbnNpb25zID0gbnVsbDtcbiAgICB0aGlzLnZhbGlkVHlwZXMgPSBudWxsO1xuICAgIHRoaXMuZHJhZ092ZXJOb3RpY2VNZXNzYWdlID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuaW5zaWRlTW9kYWwgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5mdWxsSGVpZ2h0ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2hvd0hlbHBMaW5rT25FcnJvciA9IHRydWU7XG4gICAgdGhpcy5tYXhGaWxlU2l6ZSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLmhlbHBJZFR5cGUgPSBcImRlZmF1bHRcIjtcbiAgICB0aGlzLmlzRm9sZGVyID0gZmFsc2U7XG4gICAgdGhpcy5kcmFnT3ZlciA9IHVuZGVmaW5lZDtcbiAgfVxuICBoYW5kbGVBbGVydENoYW5nZSgpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIGNvbnN0IHsgYWxlcnRBY3RpdmUgfSA9IHRoaXM7XG4gICAgaWYgKGFsZXJ0QWN0aXZlKSB7XG4gICAgICB3aW5kb3cuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJjYWxjaXRlSW50ZXJuYWxBbGVydFN5bmNcIiwgeyBkZXRhaWw6IHsgcXVldWU6IFtdIH0gfSkpO1xuICAgICAgKF9hID0gdGhpcy5lbC5zaGFkb3dSb290LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LWl0ZW0tYWxlcnRcIikpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zZXRBdHRyaWJ1dGUoXCJhY3RpdmVcIiwgXCJcIik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgKF9iID0gdGhpcy5lbC5zaGFkb3dSb290LnF1ZXJ5U2VsZWN0b3IoXCIjbmV3LWl0ZW0tYWxlcnRcIikpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi5yZW1vdmVBdHRyaWJ1dGUoXCJhY3RpdmVcIik7XG4gICAgfVxuICAgIHRoaXMuYXJjZ2lzQWxlcnRBY3RpdmUuZW1pdChhbGVydEFjdGl2ZSk7XG4gIH1cbiAgaGFuZGxlRmlsZVVwZGF0ZSgpIHtcbiAgICBjb25zdCB7IGZpbGVzLCBpMThuLCBpc0ZvbGRlciwgdXNlciwgY29uZmlnLCB2YWxpZFR5cGVzLCBoZWxwSWRUeXBlIH0gPSB0aGlzO1xuICAgIGNvbnN0IHsgc3VjY2VzcywgZXJyb3JNZXNzYWdlIH0gPSB2YWxpZGF0ZUFkZGVkRmlsZShmaWxlcywgaXNGb2xkZXIsIHVzZXIsIHtcbiAgICAgIGFsbG93ZWRFeHRlbnNpb25zOiB0aGlzLmFsbG93ZWRFeHRlbnNpb25zLFxuICAgICAgbWF4RmlsZVNpemU6IHRoaXMubWF4RmlsZVNpemUsXG4gICAgICB2YWxpZGF0aW9uVHlwZXM6IHZhbGlkVHlwZXNcbiAgICB9LCB7IGhlbHBJZFR5cGUsIGkxOG4sIGhlbHBCYXNlOiBjb25maWcuaGVscEJhc2UsIGhlbHBNYXA6IGNvbmZpZy5oZWxwTWFwIH0pO1xuICAgIGlmIChzdWNjZXNzKSB7XG4gICAgICB0aGlzLmFyY2dpc0Ryb3BTdWNjZXNzLmVtaXQoZmlsZXNbMF0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMuYWxlcnRNZXNzYWdlID0gZXJyb3JNZXNzYWdlO1xuICAgICAgdGhpcy5hbGVydEFjdGl2ZSA9IHRydWU7XG4gICAgfVxuICB9XG4gIGhhbmRsZURyYWdPdmVyKGUpIHtcbiAgICBpZiAoZS5kYXRhVHJhbnNmZXIudHlwZXMuaW5jbHVkZXMoXCJGaWxlc1wiKSkge1xuICAgICAgaWYgKHRoaXMud2VsbFJlZikge1xuICAgICAgICAvLyAqIE1ha2Ugc3VyZSB0aGUgbm90aWNlIGlzIHZpc2libGUgb24gc2NyZWVuXG4gICAgICAgIGNvbnN0IHdpbmRvd0hlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodDtcbiAgICAgICAgY29uc3QgeyB5OiB3ZWxsT2Zmc2V0VG9wLCBib3R0b20gfSA9IHRoaXMud2VsbFJlZi5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgY29uc3QgdG9wQm91bmRhcnkgPSBNYXRoLm1heCh3ZWxsT2Zmc2V0VG9wLCAwKTtcbiAgICAgICAgY29uc3QgYm90dG9tQm91bmRhcnkgPSBNYXRoLm1pbih3aW5kb3dIZWlnaHQsIGJvdHRvbSk7XG4gICAgICAgIHRoaXMubm90aWNlUmVmLnN0eWxlLmhlaWdodCA9IGAke2JvdHRvbUJvdW5kYXJ5IC0gdG9wQm91bmRhcnl9cHhgO1xuICAgICAgICAvLyAtTWF0aC5taW4oMCwgd2VsbE9mZnNldFRvcCkgYmVjYXVzZTpcbiAgICAgICAgLy8gIC0tLSB3aGVuIHRoZSB3ZWxsJ3MgdG9wIGlzIE5PVCB2aXNpYmxlLCB3ZSdsbCBoYXZlIHdlbGxPZmZzZXRUb3AgPCAwXG4gICAgICAgIC8vICA9PiB3ZSdsbCBvZmZzZXQgYHRvcGAgb2YgdGhlIG5vdGljZSdzIGNvbnRhaW5lciBieSB0aGF0IGFtb3VudFxuICAgICAgICAvLyAgLS0tIHdoZW4gdGhlIHdlbGwncyB0b3AgaXMgdmlzaWJsZSwgd2UnbGwgaGF2ZSB3ZWxsT2Zmc2V0VG9wID4gMFxuICAgICAgICAvLyAgPT4gd2UnbGwgdXNlIDAgZm9yIHRoZSB0b3Agb2YgdGhlIG5vdGljZSdzIGNvbnRhaW5lclxuICAgICAgICBjb25zdCByZWxhdGl2ZVRvcCA9IC1NYXRoLm1pbigwLCB3ZWxsT2Zmc2V0VG9wKTtcbiAgICAgICAgdGhpcy5ub3RpY2VSZWYuc3R5bGUudG9wID0gYCR7cmVsYXRpdmVUb3B9cHhgO1xuICAgICAgfVxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5kcmFnT3ZlciA9IHRydWU7XG4gICAgICB0aGlzLmFyY2dpc0RyYWdPdmVyLmVtaXQodGhpcy5kcmFnT3Zlcik7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBhc3luYyBjb21wb25lbnRXaWxsTG9hZCgpIHtcbiAgICBjb25zdCBsb2NhbGUgPSBhd2FpdCBnZXRMb2NhbGVDb21wb25lbnRTdHJpbmdzKHRoaXMuZWwpO1xuICAgIHRoaXMuaTE4biA9IGxvY2FsZVswXTtcbiAgfVxuICByZW5kZXIoKSB7XG4gICAgY29uc3QgeyB0aXRsZSwgbWVzc2FnZSwgbGluayB9ID0gdGhpcy5hbGVydE1lc3NhZ2U7XG4gICAgY29uc3QgeyB0ZXh0LCBwYXRoIH0gPSBPYmplY3QuYXNzaWduKHt9LCBsaW5rKTtcbiAgICBjb25zdCB7IGFjdGl2ZSwgZHJhZ092ZXJOb3RpY2VNZXNzYWdlLCBkcmFnT3ZlciwgaW5zaWRlTW9kYWwsIGZ1bGxIZWlnaHQsIHNob3dIZWxwTGlua09uRXJyb3IgfSA9IHRoaXM7XG4gICAgcmV0dXJuIChoKFwiZGl2XCIsIHsgcmVmOiAoZWxlKSA9PiAodGhpcy53ZWxsUmVmID0gZWxlKSwgY2xhc3M6IHtcbiAgICAgICAgaGlkZTogIWFjdGl2ZSxcbiAgICAgICAgXCJkcmFnLWFuZC1kcm9wLXdlbGxcIjogdHJ1ZSxcbiAgICAgICAgZHJhZ2dpbmc6IHRoaXMuZHJhZ092ZXIsXG4gICAgICAgIFwiZnVsbC1oZWlnaHRcIjogZnVsbEhlaWdodFxuICAgICAgfSwgb25EcmFnT3ZlcjogYWN0aXZlICYmIHRoaXMuaGFuZGxlRHJhZ092ZXIuYmluZCh0aGlzKSwgb25EcmFnTGVhdmU6ICgpID0+IHtcbiAgICAgICAgdGhpcy5kcmFnT3ZlciA9IGZhbHNlO1xuICAgICAgfSwgb25Ecm9wOiAoZSkgPT4ge1xuICAgICAgICB2YXIgX2EsIF9iLCBfYywgX2Q7XG4gICAgICAgIGlmICghYWN0aXZlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdGhpcy5hbGVydEFjdGl2ZSA9IGZhbHNlO1xuICAgICAgICB0aGlzLmRyYWdPdmVyID0gZmFsc2U7XG4gICAgICAgIGNvbnN0IHsgZmlsZXMsIGl0ZW1zIH0gPSBlLmRhdGFUcmFuc2ZlcjtcbiAgICAgICAgY29uc3QgaXRlbSA9IGl0ZW1zID09PSBudWxsIHx8IGl0ZW1zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBpdGVtc1swXTtcbiAgICAgICAgdGhpcy5pc0ZvbGRlciA9XG4gICAgICAgICAgKChfZCA9ICgoX2IgPSAoX2EgPSBpdGVtLndlYmtpdEdldEFzRW50cnkpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5jYWxsKGl0ZW0pKSAhPT0gbnVsbCAmJiBfYiAhPT0gdm9pZCAwID8gX2IgOiAoX2MgPSBpdGVtID09PSBudWxsIHx8IGl0ZW0gPT09IHZvaWQgMCA/IHZvaWQgMCA6IGl0ZW0uZ2V0QXNFbnRyeSkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmNhbGwoaXRlbSkpKSA9PT0gbnVsbCB8fCBfZCA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2QuaXNEaXJlY3RvcnkpIHx8IGZhbHNlO1xuICAgICAgICB0aGlzLmZpbGVzID0gZmlsZXM7XG4gICAgICB9IH0sIGgoXCJzbG90XCIsIG51bGwpLCBpbnNpZGVNb2RhbCA/IChcbiAgICAvLyBUT0RPOiBjb25zaWRlciBoYXZpbmcgdGhpcyBjb21wb25lbnQgcmV0dXJuIGFuIGVycm9yIGNvZGUgcmF0aGVyIHRoYW4gYSBmdWxsIGFsZXJ0XG4gICAgaChcImFyY2dpcy1uZXctaXRlbS1hbGVydFwiLCB7IGlkOiBcIm5ldy1pdGVtLWFsZXJ0XCIsIGtpbmQ6IFwiZGFuZ2VyXCIsIG9uQWxlcnREaXNtaXNzOiAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWxlcnRBY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0sIGFjdGl2ZTogISF0aGlzLmFsZXJ0QWN0aXZlLCBoZWFkaW5nOiB0aXRsZSwgZGVzY3JpcHRpb246IG1lc3NhZ2UsIGxpbms6IHsgaHJlZjogbGluayA9PT0gbnVsbCB8fCBsaW5rID09PSB2b2lkIDAgPyB2b2lkIDAgOiBsaW5rLnBhdGgsIHRpdGxlOiBsaW5rID09PSBudWxsIHx8IGxpbmsgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGxpbmsudGV4dCB9IH0pKSA6IChoKFwiY2FsY2l0ZS1hbGVydFwiLCB7IGxhYmVsOiBcIlwiLCBpZDogXCJuZXctaXRlbS1hbGVydFwiLCBpY29uOiB0cnVlLCBraW5kOiBcImRhbmdlclwiLCBvbkNhbGNpdGVBbGVydENsb3NlOiAoKSA9PiB7XG4gICAgICAgIHRoaXMuYWxlcnRBY3RpdmUgPSBmYWxzZTtcbiAgICAgIH0sIG9wZW46ICEhdGhpcy5hbGVydEFjdGl2ZSwgdGFiSW5kZXg6ICF0aGlzLmFsZXJ0QWN0aXZlID8gLTEgOiBudWxsLCByZWY6IChlbCkgPT4ge1xuICAgICAgICAvLyBoZXJlLCB3ZSBoaWRlIHRoZSBxdWV1ZSBhcyBpdCB0YWtlcyB1cCB0b28gbXVjaCByb29tIG9uIG1vYmlsZSBhbmQgd2UncmUgbm90IHVzaW5nIGl0XG4gICAgICAgIGNvbnN0IHF1ZXVlID0gZWwuc2hhZG93Um9vdC5xdWVyeVNlbGVjdG9yKFwiLmFsZXJ0LXF1ZXVlLWNvdW50XCIpO1xuICAgICAgICBpZiAocXVldWUpIHtcbiAgICAgICAgICBxdWV1ZS5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG4gICAgICAgIH1cbiAgICAgIH0gfSwgdGl0bGUgJiYgaChcImRpdlwiLCB7IHNsb3Q6IFwidGl0bGVcIiB9LCB0aXRsZSksIG1lc3NhZ2UgJiYgKGgoXCJkaXZcIiwgeyBzbG90OiBcIm1lc3NhZ2VcIiwgY2xhc3M6IFwiYWxlcnRfX21lc3NhZ2VcIiB9LCBtZXNzYWdlKSksIHNob3dIZWxwTGlua09uRXJyb3IgJiYgbGluayAmJiAoaChcImNhbGNpdGUtbGlua1wiLCB7IHNsb3Q6IFwibGlua1wiLCB0YXJnZXQ6IFwiX2JsYW5rXCIsIGhyZWY6IHBhdGgsIGNsYXNzOiBcImFsZXJ0X19saW5rXCIgfSwgdGV4dCkpKSksIGgoXCJkaXZcIiwgeyBjbGFzczogXCJub3RpY2UtY29udGFpbmVyXCIsIHJlZjogKGVsZSkgPT4gKHRoaXMubm90aWNlUmVmID0gZWxlKSB9LCBkcmFnT3Zlck5vdGljZU1lc3NhZ2UgJiYgKGgoXCJjYWxjaXRlLW5vdGljZVwiLCB7IGljb246IFwidXBsb2FkLXRvXCIsIG9wZW46IGRyYWdPdmVyLCBzY2FsZTogXCJtXCIsIHdpZHRoOiBcImF1dG9cIiB9LCBoKFwiZGl2XCIsIHsgc2xvdDogXCJtZXNzYWdlXCIgfSwgZHJhZ092ZXJOb3RpY2VNZXNzYWdlKSkpKSkpO1xuICB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbiAgc3RhdGljIGdldCB3YXRjaGVycygpIHsgcmV0dXJuIHtcbiAgICBcImFsZXJ0QWN0aXZlXCI6IFtcImhhbmRsZUFsZXJ0Q2hhbmdlXCJdLFxuICAgIFwiZmlsZXNcIjogW1wiaGFuZGxlRmlsZVVwZGF0ZVwiXVxuICB9OyB9XG59O1xuQXJjZ2lzRHJhZ0FuZERyb3Auc3R5bGUgPSBhcmNnaXNEcmFnQW5kRHJvcENzcztcblxuZXhwb3J0IHsgQXJjZ2lzRHJhZ0FuZERyb3AgYXMgYXJjZ2lzX2RyYWdfYW5kX2Ryb3AgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgYSBhcyBhZGRDcmVhdGVJdGVtVHlwZXMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtYjRmZTg2YWQuanMnO1xuaW1wb3J0IHsgZyBhcyBndWlkIH0gZnJvbSAnLi9ndWlkLTRmNDE3NmJhLmpzJztcblxuZnVuY3Rpb24gc2FuaXRpemVGaWxlTmFtZShuYW1lLCBhZGRHVUlEKSB7XG4gIC8vVE9ETzogYWRkIG5ldyBwYXJhbSB0byBzcGVjIGZpbGUuXG4gIGNvbnN0IGV4cHJlc3Npb24gPSAvKD86XFwuKFteLl0rKSk/JC87XG4gIGNvbnN0IGludmFsaWRUaXRsZUNoYXJhY3RlcnMgPSAvXFwufC0vZztcbiAgbGV0IGZpbGVOYW1lID0gbmFtZS5yZXBsYWNlKC9eLiooXFxcXHxcXC98OikvLCBcIlwiKTtcbiAgbGV0IGV4dGVuc2lvbiA9IChmaWxlTmFtZSAmJiBleHByZXNzaW9uLmV4ZWMoZmlsZU5hbWUpWzFdID8gZXhwcmVzc2lvbi5leGVjKGZpbGVOYW1lKVsxXS50b0xvd2VyQ2FzZSgpIDogXCJcIik7XG4gIGxldCB0aXRsZSA9IFwiXCI7XG4gIGlmIChmaWxlTmFtZS5pbmRleE9mKFwiLnJmdC5cIikgPiAtMSkge1xuICAgIGNvbnN0IFtuYW1lLCBzdWZmaXhdID0gZmlsZU5hbWUuc3BsaXQoXCIucmZ0LlwiKTtcbiAgICBleHRlbnNpb24gPSBgcmZ0LiR7c3VmZml4fWA7XG4gICAgdGl0bGUgPSBuYW1lO1xuICB9XG4gIGlmIChmaWxlTmFtZSAmJiAhdGl0bGUpIHtcbiAgICB0aXRsZSA9IGZpbGVOYW1lLmxhc3RJbmRleE9mKFwiLlwiKSA9PT0gLTEgPyBmaWxlTmFtZSA6IGZpbGVOYW1lLnN1YnN0cmluZygwLCBmaWxlTmFtZS5sYXN0SW5kZXhPZihcIi5cIikpO1xuICB9XG4gIC8vIFJlcGxhY2UgYW55IGludmFsaWQgY2hhcmFjdGVycyB3aXRoIGFuIHVuZGVyc2NvcmVcbiAgdGl0bGUgPSB0aXRsZS5yZXBsYWNlKGludmFsaWRUaXRsZUNoYXJhY3RlcnMsIFwiX1wiKTtcbiAgLy8gQWxsb3cgZmlsZSB1cGxvYWQgb2YgZXhpc3RpbmcgaXRlbSdzIGZpbGUgbmFtZSAvLyBjdXJyZW50bHkgdXNlZCBpbiBhcHBlbmRcbiAgaWYgKGFkZEdVSUQpIHtcbiAgICB0aXRsZSA9IG1ha2VVbmlxdWVGaWxlTmFtZSh0aXRsZSk7XG4gICAgZmlsZU5hbWUgPSBgJHt0aXRsZX0uJHtleHRlbnNpb259YDtcbiAgfVxuICByZXR1cm4geyB0aXRsZSwgZmlsZU5hbWUsIGV4dGVuc2lvbiB9O1xufVxuLy8gSGVscGVyIG1ldGhvZCB0aGF0IHRha2VzIGluIGEgZmlsZSAmIHJldHVybnMgdGhlIGNsZWFuZWQgdXAgZmlsZSBuYW1lIGFzIGlzIGFuZCBpbiB0aXRsZSBmb3JtLCBhbmQgdGhlIGRldGVjdGVkIGZpbGUgZXh0ZW5zaW9uXG5mdW5jdGlvbiBzYW5pdGl6ZUZpbGVJbnB1dChmaWxlLCBhZGRHVUlEKSB7XG4gIHJldHVybiBzYW5pdGl6ZUZpbGVOYW1lKGZpbGUubmFtZSwgISFhZGRHVUlEKTtcbn1cbmZ1bmN0aW9uIG1ha2VVbmlxdWVGaWxlTmFtZShuYW1lKSB7XG4gIHJldHVybiBgJHtuYW1lfV8ke2d1aWQoKX1gO1xufVxuZnVuY3Rpb24gdmFsaWRhdGVPdmVyd3JpdGVGaWxlTmFtZSh1cGxvYWRlZEZpbGVOYW1lLCBzb3VyY2VGaWxlTmFtZSkge1xuICBsZXQgZmlsZU5hbWUgPSB1cGxvYWRlZEZpbGVOYW1lO1xuICBjb25zdCBwb3NpdGlvbiA9IHVwbG9hZGVkRmlsZU5hbWUubGFzdEluZGV4T2YoXCJcXFxcXCIpO1xuICBpZiAocG9zaXRpb24gPiAtMSkge1xuICAgIGZpbGVOYW1lID0gZmlsZU5hbWUuc3Vic3RyaW5nKHBvc2l0aW9uICsgMSwgZmlsZU5hbWUubGVuZ3RoKTtcbiAgfVxuICByZXR1cm4gZmlsZU5hbWUucmVwbGFjZSgvXFwgL2csIFwiX1wiKSA9PT0gc291cmNlRmlsZU5hbWUucmVwbGFjZSgvXFwgL2csIFwiX1wiKTtcbn1cbmZ1bmN0aW9uIGdldEl0ZW1JbmZvQnlUeXBlKHR5cGUpIHtcbiAgaWYgKGFkZENyZWF0ZUl0ZW1UeXBlc1t0eXBlXSkge1xuICAgIHJldHVybiBhZGRDcmVhdGVJdGVtVHlwZXNbdHlwZV07XG4gIH1cbiAgZWxzZSB7XG4gICAgcmV0dXJuIGFkZENyZWF0ZUl0ZW1UeXBlc1tPYmplY3Qua2V5cyhhZGRDcmVhdGVJdGVtVHlwZXMpLmZpbmQoKGZpbGVUeXBlKSA9PiBhZGRDcmVhdGVJdGVtVHlwZXNbZmlsZVR5cGVdLnR5cGUgPT09IHR5cGUpXTtcbiAgfVxufVxuZnVuY3Rpb24gZm9ybWF0RmlsZVNpemUoc2l6ZSkge1xuICBpZiAoIXNpemUpIHtcbiAgICByZXR1cm4gXCIwIEJcIjtcbiAgfVxuICBjb25zdCBpID0gTWF0aC5mbG9vcihNYXRoLmxvZyhzaXplKSAvIE1hdGgubG9nKDEwMjQpKTtcbiAgY29uc3QgYWRqdXN0ZWRTaXplID0gTWF0aC5yb3VuZChzaXplIC8gTWF0aC5wb3coMTAyNCwgaSkpO1xuICBjb25zdCB1bml0ID0gW1wiQlwiLCBcIktCXCIsIFwiTUJcIiwgXCJHQlwiLCBcIlRCXCJdW2ldO1xuICByZXR1cm4gYCR7YWRqdXN0ZWRTaXplfSAke3VuaXR9YDtcbn1cblxuZXhwb3J0IHsgc2FuaXRpemVGaWxlTmFtZSBhcyBhLCBmb3JtYXRGaWxlU2l6ZSBhcyBmLCBnZXRJdGVtSW5mb0J5VHlwZSBhcyBnLCBzYW5pdGl6ZUZpbGVJbnB1dCBhcyBzLCB2YWxpZGF0ZU92ZXJ3cml0ZUZpbGVOYW1lIGFzIHYgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuZnVuY3Rpb24gZ2VuZXJhdGVJZChjb3VudHMpIHtcbiAgcmV0dXJuIGNvdW50c1xuICAgIC5tYXAoKGNvdW50KSA9PiB7XG4gICAgbGV0IG91dCA9IFwiXCI7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG4gICAgICBvdXQgKz0gKCgoMSArIE1hdGgucmFuZG9tKCkpICogMHgxMDAwMCkgfCAwKS50b1N0cmluZygxNikuc3Vic3RyaW5nKDEpO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9KVxuICAgIC5qb2luKFwiLVwiKTtcbn1cbmNvbnN0IGd1aWQgPSAoKSA9PiBnZW5lcmF0ZUlkKFsyLCAxLCAxLCAxLCAzXSk7XG5cbmV4cG9ydCB7IGd1aWQgYXMgZyB9O1xuIiwiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyBiIGFzIHVuaXF1ZSB9IGZyb20gJy4vZnVuY3Rpb25hbC1jODJmNWFiOS5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZENyZWF0ZUl0ZW1UeXBlcyB9IGZyb20gJy4vaXRlbS10eXBlcy1iNGZlODZhZC5qcyc7XG5cbmZ1bmN0aW9uIGZpbmRQb3NzaWJsZUl0ZW1UeXBlc0J5RXh0ZW5zaW9uKGV4dGVuc2lvbiwgdmFsaWRhdGlvblR5cGVzKSB7XG4gIC8vIFNlYXJjaCBpdGVtIHR5cGVzIGV4dGVuc2lvbnMgZm9yIHRoZSBvbmUgaW1wb3J0ZWRcbiAgbGV0IGl0ZW1UeXBlcztcbiAgaWYgKHZhbGlkYXRpb25UeXBlcykge1xuICAgIGl0ZW1UeXBlcyA9IHZhbGlkYXRpb25UeXBlcy5tYXAoKHZhbHVlKSA9PiB7XG4gICAgICByZXR1cm4gdmFsdWUudHlwZTtcbiAgICB9KTtcbiAgfVxuICBlbHNlIHtcbiAgICBpdGVtVHlwZXMgPSBPYmplY3Qua2V5cyhhZGRDcmVhdGVJdGVtVHlwZXMpO1xuICB9XG4gIGxldCBwb3NzaWJsZUl0ZW1UeXBlcyA9IFtdO1xuICBpdGVtVHlwZXMuZm9yRWFjaCgodHlwZSkgPT4ge1xuICAgIHZhciBfYTtcbiAgICBpZiAoKChfYSA9IGFkZENyZWF0ZUl0ZW1UeXBlc1t0eXBlXS5maWxlRXh0KSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5kZXhPZihleHRlbnNpb24pKSA+PSAwKSB7XG4gICAgICBwb3NzaWJsZUl0ZW1UeXBlcy5wdXNoKGFkZENyZWF0ZUl0ZW1UeXBlc1t0eXBlXSk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHBvc3NpYmxlSXRlbVR5cGVzO1xufVxuZnVuY3Rpb24gbWFwSXRlbVR5cGVzVG9GaWxlRXh0ZW5zaW9ucyh0eXBlcykge1xuICBpZiAoIXR5cGVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIHVuaXF1ZSh0eXBlcy5mbGF0TWFwKCh0eXBlKSA9PiB7IHZhciBfYTsgcmV0dXJuIChfYSA9IGFkZENyZWF0ZUl0ZW1UeXBlc1t0eXBlXSkgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmZpbGVFeHQ7IH0pLmZpbHRlcigodmFsaWQpID0+ICEhdmFsaWQpKTtcbn1cbmNvbnN0IGlzTGFyZ2VHZW9KU09OID0gKHNpemVJbkJ5dGVzKSA9PiB7XG4gIGNvbnN0IHNpemVJbk1CID0gc2l6ZUluQnl0ZXMgLyAxMDI0IC8gMTAyNDtcbiAgLy8gaHR0cHM6Ly9kZXZ0b3BpYS5lc3JpLmNvbS9XZWJHSVMvYXJjZ2lzLWFwcC1jb21wb25lbnRzL2lzc3Vlcy8yNTUzI2lzc3VlY29tbWVudC0zNjQ1NDA0XG4gIHJldHVybiBzaXplSW5NQiA+IDUwOyAvLyA1ME1CXG59O1xuY29uc3QgaXNMYXJnZUNTViA9IChzaXplSW5CeXRlcykgPT4ge1xuICBjb25zdCBzaXplSW5NQiA9IHNpemVJbkJ5dGVzIC8gMTAyNCAvIDEwMjQ7XG4gIC8vIGh0dHBzOi8vZGV2dG9waWEuZXNyaS5jb20vV2ViR0lTL2FyY2dpcy1hcHAtY29tcG9uZW50cy9pc3N1ZXMvMjg3NSNpc3N1ZWNvbW1lbnQtMzc0ODkxM1xuICByZXR1cm4gc2l6ZUluTUIgPiAyMDsgLy8gMjBNQlxufTtcblxuZXhwb3J0IHsgaXNMYXJnZUNTViBhcyBhLCBmaW5kUG9zc2libGVJdGVtVHlwZXNCeUV4dGVuc2lvbiBhcyBmLCBpc0xhcmdlR2VvSlNPTiBhcyBpLCBtYXBJdGVtVHlwZXNUb0ZpbGVFeHRlbnNpb25zIGFzIG0gfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgbCBhcyBsb2FkTW9kdWxlcyB9IGZyb20gJy4vbG9hZE1vZHVsZXMtYWFmMzBiZDYuanMnO1xuaW1wb3J0IHsgYyBhcyBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkgfSBmcm9tICcuL2RvbS0xM2Y1YjAwYy5qcyc7XG5cbmNvbnN0IGxhbmd1YWdlTWFwID0gbmV3IE1hcChbXG4gIFtcImFyXCIsIFwiYXJcIl0sXG4gIFtcImJnXCIsIFwiYmdcIl0sXG4gIFtcImJzXCIsIFwiYnNcIl0sXG4gIFtcImNhXCIsIFwiY2FcIl0sXG4gIFtcImNzXCIsIFwiY3NcIl0sXG4gIFtcImRhXCIsIFwiZGFcIl0sXG4gIFtcImRlXCIsIFwiZGVcIl0sXG4gIFtcImVsXCIsIFwiZWxcIl0sXG4gIFtcImVuXCIsIFwiZW5cIl0sXG4gIFtcImVzXCIsIFwiZXNcIl0sXG4gIFtcImV0XCIsIFwiZXRcIl0sXG4gIFtcImZpXCIsIFwiZmlcIl0sXG4gIFtcImZyXCIsIFwiZnJcIl0sXG4gIFtcImhlXCIsIFwiaGVcIl0sXG4gIFtcImhyXCIsIFwiaHJcIl0sXG4gIFtcImh1XCIsIFwiaHVcIl0sXG4gIFtcImlkXCIsIFwiaWRcIl0sXG4gIFtcIml0XCIsIFwiaXRcIl0sXG4gIFtcImphXCIsIFwiamFcIl0sXG4gIFtcImtvXCIsIFwia29cIl0sXG4gIFtcImx0XCIsIFwibHRcIl0sXG4gIFtcImx2XCIsIFwibHZcIl0sXG4gIFtcIm5iXCIsIFwibmJcIl0sXG4gIFtcIm5sXCIsIFwibmxcIl0sXG4gIFtcInBsXCIsIFwicGxcIl0sXG4gIFtcInB0LWJyXCIsIFwicHQtQlJcIl0sXG4gIFtcInB0LXB0XCIsIFwicHQtUFRcIl0sXG4gIFtcInJvXCIsIFwicm9cIl0sXG4gIFtcInJ1XCIsIFwicnVcIl0sXG4gIFtcInNrXCIsIFwic2tcIl0sXG4gIFtcInNsXCIsIFwic2xcIl0sXG4gIFtcInNyXCIsIFwic3JcIl0sXG4gIFtcInN2XCIsIFwic3ZcIl0sXG4gIFtcInRoXCIsIFwidGhcIl0sXG4gIFtcInRyXCIsIFwidHJcIl0sXG4gIFtcInVrXCIsIFwidWtcIl0sXG4gIFtcInZpXCIsIFwidmlcIl0sXG4gIFtcInpoLWNuXCIsIFwiemgtQ05cIl0sXG4gIFtcInpoLWhrXCIsIFwiemgtSEtcIl0sXG4gIFtcInpoLXR3XCIsIFwiemgtVFdcIl1cbl0pO1xuLy8gcnRsXG5mdW5jdGlvbiBnZXRFbGVtZW50RGlyKGVsKSB7XG4gIHJldHVybiBnZXRFbGVtZW50UHJvcChlbCwgXCJkaXJcIiwgXCJsdHJcIik7XG59XG5mdW5jdGlvbiBnZXRFbGVtZW50UHJvcChlbCwgcHJvcCwgdmFsdWUpIHtcbiAgY29uc3QgY2xvc2VzdFdpdGhQcm9wID0gY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5KGVsLCBgWyR7cHJvcH1dYCk7XG4gIHJldHVybiBjbG9zZXN0V2l0aFByb3AgPyBjbG9zZXN0V2l0aFByb3AuZ2V0QXR0cmlidXRlKHByb3ApIDogdmFsdWU7XG59XG4vLyBjc3NcbmNvbnN0IENTU19VVElMSVRZID0ge1xuICBydGw6IFwiYXJjZ2lzLS1ydGxcIlxufTtcbmFzeW5jIGZ1bmN0aW9uIGZvcm1hdE51bWJlcihudW1iZXIsIG9wdGlvbnMpIHtcbiAgY29uc3QgeyBhcGksIHR5cGUsIHBsYWNlcyB9ID0gb3B0aW9ucyB8fCB7fTtcbiAgaWYgKGFwaSA9PT0gNCkge1xuICAgIGNvbnN0IFtpbnRsXSA9IGF3YWl0IGxvYWRNb2R1bGVzKFtcImVzcmkvaW50bFwiXSk7XG4gICAgY29uc3QgbnVtYmVyRm9ybWF0SW50bE9wdGlvbnMgPSBpbnRsLmNvbnZlcnROdW1iZXJGb3JtYXRUb0ludGxPcHRpb25zKHtcbiAgICAgIHBsYWNlcyxcbiAgICAgIHN0eWxlOiB0eXBlLFxuICAgICAgZGlnaXRTZXBhcmF0b3I6IHRydWVcbiAgICB9KTtcbiAgICByZXR1cm4gaW50bC5mb3JtYXROdW1iZXIobnVtYmVyLCBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oe30sIG51bWJlckZvcm1hdEludGxPcHRpb25zKSwgeyBzdHlsZTogdHlwZSB9KSk7XG4gIH1cbiAgY29uc3QgW2Rvam9OdW1iZXJdID0gYXdhaXQgbG9hZE1vZHVsZXMoW1wiZG9qby9udW1iZXJcIl0pO1xuICByZXR1cm4gZG9qb051bWJlci5mb3JtYXQobnVtYmVyLCB7XG4gICAgdHlwZSxcbiAgICBwbGFjZXMsXG4gICAgcGF0dGVybjogb3B0aW9ucyA9PT0gbnVsbCB8fCBvcHRpb25zID09PSB2b2lkIDAgPyB2b2lkIDAgOiBvcHRpb25zLnBhdHRlcm5cbiAgfSk7XG59XG5jb25zdCBjYWNoZSA9IHt9O1xuZnVuY3Rpb24gZm9ybWF0RGF0ZShkYXRlKSB7XG4gIGNvbnN0IGxhbmcgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQubGFuZztcbiAgY29uc3QgZGF5U2hvcnRNb250aFllYXIgPSB7XG4gICAgeWVhcjogXCJudW1lcmljXCIsXG4gICAgbW9udGg6IFwic2hvcnRcIixcbiAgICBkYXk6IFwibnVtZXJpY1wiXG4gIH07XG4gIGlmICghY2FjaGVbbGFuZ10pIHtcbiAgICBjYWNoZVtsYW5nXSA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5sYW5nLCBkYXlTaG9ydE1vbnRoWWVhcik7XG4gIH1cbiAgcmV0dXJuIGNhY2hlW2xhbmddLmZvcm1hdChkYXRlKTtcbn1cblxuZXhwb3J0IHsgQ1NTX1VUSUxJVFkgYXMgQywgZm9ybWF0RGF0ZSBhcyBhLCBmb3JtYXROdW1iZXIgYXMgZiwgZ2V0RWxlbWVudERpciBhcyBnLCBsYW5ndWFnZU1hcCBhcyBsIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IGMgYXMgY2xvc2VzdEVsZW1lbnRDcm9zc1NoYWRvd0JvdW5kYXJ5IH0gZnJvbSAnLi9kb20tMTNmNWIwMGMuanMnO1xuaW1wb3J0IHsgbCBhcyBsYW5ndWFnZU1hcCB9IGZyb20gJy4vbGFuZ3VhZ2VVdGlsLTIyMjU4YzkwLmpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QXNzZXRQYXRoIH0gZnJvbSAnLi9pbmRleC05MmViYjM5Ni5qcyc7XG5cbi8vIGh0dHBzOi8vbWVkaXVtLmNvbS9zdGVuY2lsLXRyaWNrcy9pbXBsZW1lbnRpbmctaW50ZXJuYXRpb25hbGlzYXRpb24taTE4bi13aXRoLXN0ZW5jaWwtNWU2NTU5NTU0MTE3XG5mdW5jdGlvbiBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UoZWxlbWVudCkge1xuICB2YXIgX2EsIF9iLCBfYztcbiAgY29uc3QgY2xvc2VzdEVsZW1lbnQgPSAoX2EgPSBjbG9zZXN0RWxlbWVudENyb3NzU2hhZG93Qm91bmRhcnkoZWxlbWVudCwgXCJbbGFuZ11cIikpICE9PSBudWxsICYmIF9hICE9PSB2b2lkIDAgPyBfYSA6IChfYyA9IChfYiA9IGVsZW1lbnQuc2hhZG93Um9vdCkgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLm93bmVyRG9jdW1lbnQpID09PSBudWxsIHx8IF9jID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYy5kb2N1bWVudEVsZW1lbnQ7XG4gIC8vIGxhbmd1YWdlIHNldCBieSB0aGUgY2FsbGluZyBhcHBsaWNhdGlvbiBvciBicm93c2VyLiBkZWZhdWx0cyB0byBlbmdsaXNoLlxuICBjb25zdCBsYW5nID0gKChjbG9zZXN0RWxlbWVudCA9PT0gbnVsbCB8fCBjbG9zZXN0RWxlbWVudCA9PT0gdm9pZCAwID8gdm9pZCAwIDogY2xvc2VzdEVsZW1lbnQubGFuZykgfHwgKG5hdmlnYXRvciA9PT0gbnVsbCB8fCBuYXZpZ2F0b3IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG5hdmlnYXRvci5sYW5ndWFnZSkgfHwgXCJlblwiKS50b0xvd2VyQ2FzZSgpO1xuICBpZiAobGFuZ3VhZ2VNYXAuaGFzKGxhbmcpKSB7XG4gICAgcmV0dXJuIGxhbmd1YWdlTWFwLmdldChsYW5nKTtcbiAgfVxuICBlbHNlIHtcbiAgICAvLyBcInJ1LVJVXCIgbWFwcyB0byBcInJ1XCIgdXNlIGNhc2VcbiAgICBpZiAobGFuZ3VhZ2VNYXAuaGFzKGxhbmcuc2xpY2UoMCwgMikpKSB7XG4gICAgICByZXR1cm4gbGFuZ3VhZ2VNYXAuZ2V0KGxhbmcuc2xpY2UoMCwgMikpO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHJldHVybiBcImVuXCI7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2VJbnRsKGVsZW1lbnQpIHtcbiAgdmFyIF9hLCBfYiwgX2M7XG4gIC8vIGl0J3MgT0sgaWYgd2UgZG9uJ3QgaGF2ZSB0aGUgNCBsZXR0ZXIgbGFuZ3VhZ2UgZmlsZSBmb3IgaXRcbiAgLy8gNCBsZXR0ZXIgbGFuZ3VhZ2UgY29kZSBuZWVkZWQgZm9yIGZvcm1hdHRpbmcgbnVtYmVyc1xuICBjb25zdCBjbG9zZXN0RWxlbWVudCA9IChfYSA9IGNsb3Nlc3RFbGVtZW50Q3Jvc3NTaGFkb3dCb3VuZGFyeShlbGVtZW50LCBcIltsYW5nXVwiKSkgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogKF9jID0gKF9iID0gZWxlbWVudC5zaGFkb3dSb290KSA9PT0gbnVsbCB8fCBfYiA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Iub3duZXJEb2N1bWVudCkgPT09IG51bGwgfHwgX2MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9jLmRvY3VtZW50RWxlbWVudDtcbiAgLy8gbGFuZ3VhZ2Ugc2V0IGJ5IHRoZSBjYWxsaW5nIGFwcGxpY2F0aW9uIG9yIGJyb3dzZXIuIGRlZmF1bHRzIHRvIGVuZ2xpc2guXG4gIGNvbnN0IGxhbmcgPSAoKGNsb3Nlc3RFbGVtZW50ID09PSBudWxsIHx8IGNsb3Nlc3RFbGVtZW50ID09PSB2b2lkIDAgPyB2b2lkIDAgOiBjbG9zZXN0RWxlbWVudC5sYW5nKSB8fCAobmF2aWdhdG9yID09PSBudWxsIHx8IG5hdmlnYXRvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogbmF2aWdhdG9yLmxhbmd1YWdlKSB8fCBcImVuXCIpLnRvTG93ZXJDYXNlKCk7XG4gIGlmIChsYW5ndWFnZU1hcC5oYXMobGFuZykpIHtcbiAgICByZXR1cm4gbGFuZ3VhZ2VNYXAuZ2V0KGxhbmcpO1xuICB9XG4gIGVsc2Uge1xuICAgIGlmIChsYW5ndWFnZU1hcC5oYXMobGFuZy5zbGljZSgwLCAyKSkpIHtcbiAgICAgIC8vIHdlIHN1cHBvcnQgdGhlIDIgbGV0dGVyIGNvZGVkIGxhbmd1YWdlXG4gICAgICAvLyBlLmcuIGl0LUNIIHZzIGl0XG4gICAgICByZXR1cm4gbGFuZztcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICByZXR1cm4gXCJlblwiO1xuICAgIH1cbiAgfVxufVxuZnVuY3Rpb24gZmV0Y2hMb2NhbGVTdHJpbmdzRm9yQ29tcG9uZW50KGNvbXBvbmVudE5hbWUsIGxvY2FsZSkge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGZldGNoKGdldEFzc2V0UGF0aChgLi4vYXJjZ2lzLWFwcC1hc3NldHMvaTE4bi8ke2NvbXBvbmVudE5hbWV9LmkxOG4uJHtsb2NhbGV9Lmpzb25gKSkudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICBpZiAocmVzdWx0Lm9rKVxuICAgICAgICByZXNvbHZlKHJlc3VsdC5qc29uKCkpO1xuICAgICAgZWxzZVxuICAgICAgICByZWplY3QoKTtcbiAgICB9LCAoKSA9PiByZWplY3QoKSk7XG4gIH0pO1xufVxuY29uc3Qgc3RyaW5nQ2FjaGUgPSB7fTtcbmZ1bmN0aW9uIGZldGNoTG9jYWxlU3RyaW5nc0Zyb21DYWNoZShjb21wb25lbnROYW1lLCBsb2NhbGUpIHtcbiAgY29uc3QgaWQgPSBgJHtjb21wb25lbnROYW1lfSR7bG9jYWxlfWA7XG4gIGlmICghc3RyaW5nQ2FjaGVbaWRdKSB7XG4gICAgc3RyaW5nQ2FjaGVbaWRdID0gZmV0Y2hMb2NhbGVTdHJpbmdzRm9yQ29tcG9uZW50KGNvbXBvbmVudE5hbWUsIGxvY2FsZSk7XG4gIH1cbiAgcmV0dXJuIHN0cmluZ0NhY2hlW2lkXTtcbn1cbi8qKlxuICogR2V0IHN0cmluZ3MgYW5kIGxhbmd1YWdlIGNvZGVzLlxuICogVGhpcyBtZXRob2QgcmV0dXJucyAyIGxhbmd1YWdlIGNvZGVzLlxuICogVGhlIGZpcnN0IG9uZSByZXR1cm5zIGEgY29kZSB0aGF0J3MgYWxzbyBzdXBwb3J0ZWQgYXMgYSBsYW5ndWFnZSBmaWxlLlxuICogVGhlIHNlY29uZCBvbmUgcmV0dXJucyBhIGNvZGUgd2hlcmUgdGhlcmUgaXMgc3VwcG9ydCBmb3IgdGhlIGZpcnN0IDIgbGV0dGVycyBvZiB0aGUgY29kZSBhcyBwYXJ0IG9mIGEgbGFuZ3VhZ2UgZmlsZSxcbiAqIGJ1dCB3aWxsIHJldHVybiB0aGUgb3JpZ2luYWwgNCBsZXR0ZXIgY29kZSBmcm9tIHRoZSBwYWdlLlxuICogRS5nLiBGb3IgXCJpdC1jaFwiIGl0IHdpbGwgcmV0dXJuIFwiaXRcIiBhcyB0aGUgZmlyc3QgbGFuZ3VhZ2UgY29kZSBhbmQgXCJpdC1jaFwiIGFzIHRoZSBzZWNvbmQuXG4gKiBUaGUgc2Vjb25kIG9uZSBpcyByZXF1aXJlZCBmb3IgZXNyaS5pbnRsLnNldExvY2FsZSgpIHRvIGdldCB0aGUgY29ycmVjdCBmb3JtYXR0aW5nLlxuICpcbiAqIElmIGEgdGFnTmFtZSBpcyBwcm92aWRlZCBpdCB3aWxsIG92ZXJ3aXRlIHRoZSBlbGVtZW50J3MgdGFnTmFtZVxuICpcbiAqICBAcmV0dXJuIFsgc3RyaW5ncywgZmlyc3QgbGFuZ3VhZ2UgY29kZSwgc2Vjb25kIGxhbmd1YWdlIGNvZGVdXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldExvY2FsZUNvbXBvbmVudFN0cmluZ3MoZWxlbWVudCwgdGFnTmFtZSkge1xuICBjb25zdCBjb21wb25lbnROYW1lID0gdGFnTmFtZSB8fCBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgY29uc3QgY29tcG9uZW50TGFuZ3VhZ2UgPSBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UoZWxlbWVudCk7XG4gIGNvbnN0IGNvbXBvbmVudExhbmd1YWdlSW50bCA9IGdldENvbXBvbmVudENsb3Nlc3RMYW5ndWFnZUludGwoZWxlbWVudCk7XG4gIGxldCBzdHJpbmdzO1xuICB0cnkge1xuICAgIHN0cmluZ3MgPSBhd2FpdCBmZXRjaExvY2FsZVN0cmluZ3NGcm9tQ2FjaGUoY29tcG9uZW50TmFtZSwgY29tcG9uZW50TGFuZ3VhZ2UpO1xuICB9XG4gIGNhdGNoIChlKSB7XG4gICAgY29uc29sZS53YXJuKGBubyBsb2NhbGUgZm9yICR7Y29tcG9uZW50TmFtZX0gKCR7Y29tcG9uZW50TGFuZ3VhZ2V9KSBsb2FkaW5nIGRlZmF1bHQgbG9jYWxlIGVuLmApO1xuICAgIHN0cmluZ3MgPSBhd2FpdCBmZXRjaExvY2FsZVN0cmluZ3NGcm9tQ2FjaGUoY29tcG9uZW50TmFtZSwgXCJlblwiKTtcbiAgfVxuICByZXR1cm4gW3N0cmluZ3MsIGNvbXBvbmVudExhbmd1YWdlLCBjb21wb25lbnRMYW5ndWFnZUludGxdO1xufVxuXG5leHBvcnQgeyBnZXRDb21wb25lbnRDbG9zZXN0TGFuZ3VhZ2UgYXMgYSwgZ2V0TG9jYWxlQ29tcG9uZW50U3RyaW5ncyBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=