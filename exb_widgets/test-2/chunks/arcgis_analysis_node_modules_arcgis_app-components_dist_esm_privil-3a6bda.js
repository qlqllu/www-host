"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_privil-3a6bda"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-35590eb4.js":
/*!****************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-35590eb4.js ***!
  \****************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ canPublishType),
/* harmony export */   b: () => (/* binding */ canPublishFeatures),
/* harmony export */   c: () => (/* binding */ canPublishFromCloud),
/* harmony export */   d: () => (/* binding */ canCreateDeveloperCredentials),
/* harmony export */   e: () => (/* binding */ canPublishImageCollection),
/* harmony export */   f: () => (/* binding */ fetchUserLicensedItems),
/* harmony export */   g: () => (/* binding */ canPublishTiles),
/* harmony export */   h: () => (/* binding */ canPublishScenes),
/* harmony export */   i: () => (/* binding */ canCreateLocatorView),
/* harmony export */   j: () => (/* binding */ canCreateLocator),
/* harmony export */   k: () => (/* binding */ canCreateDataStore),
/* harmony export */   l: () => (/* binding */ canCreateItems),
/* harmony export */   m: () => (/* binding */ canGeocode),
/* harmony export */   n: () => (/* binding */ canReceiveItems),
/* harmony export */   o: () => (/* binding */ canShowTotalCredits),
/* harmony export */   p: () => (/* binding */ canAddAPIKey),
/* harmony export */   q: () => (/* binding */ getWorldGeocoderUrl),
/* harmony export */   r: () => (/* binding */ canCreateNotebooks),
/* harmony export */   s: () => (/* binding */ canCreateAdvancedNotebooks),
/* harmony export */   t: () => (/* binding */ canViewOrgGroups),
/* harmony export */   u: () => (/* binding */ canManageItems)
/* harmony export */ });
/* harmony import */ var _privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./privileges-ccd5f37d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-ccd5f37d.js");
/* harmony import */ var _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./config-eb5f7dc2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js");
/* harmony import */ var _portal_79caaeff_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./portal-79caaeff.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-79caaeff.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */




async function getWorldGeocoderUrl() {
  return new Promise(async (resolve) => {
    const { portal } = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c;
    if (!(portal === null || portal === void 0 ? void 0 : portal.isPortal)) {
      const env = getEnvironment(portal);
      resolve(`https://geocode${env}.arcgis.com/arcgis/rest/services/World/GeocodeServer`);
    }
    else {
      const geocoders = portal.helperServices.geocode;
      const url = await getWorldGeocoderUrlFromProxies(geocoders);
      resolve(url);
    }
  });
}
function getEnvironment(portal) {
  const hostname = portal === null || portal === void 0 ? void 0 : portal.portalHostname;
  if (hostname.indexOf("dev") !== -1) {
    return "dev";
  }
  else if (hostname.indexOf("qa") !== -1) {
    return "qa";
  }
  return "";
}
function getWorldGeocoderUrlFromProxies(geocoders) {
  const { config, portal } = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_1__.c;
  return new Promise(async (resolve, reject) => {
    const esriBatchGeocoder = geocoders
      .filter((geocoder) => isServiceProxyGeocoder(geocoder.url, portal))
      .filter((proxy) => proxy.isEsriBatchGeocoder)[0];
    if (esriBatchGeocoder) {
      // Make sure world geocoder is configured
      const id = parseGeocoderItemId(esriBatchGeocoder);
      const url = `${config.restBaseUrl}/content/items/${id}`;
      try {
        const geocoderItem = await (0,_portal_79caaeff_js__WEBPACK_IMPORTED_MODULE_2__.r)(url);
        resolve(geocoderItem.url);
      }
      catch (err) {
        reject(err);
      }
    }
    else {
      reject("No world geocoder configured");
    }
  });
}
function isServiceProxyGeocoder(url = "", portal) {
  var _a;
  const isPortal = portal.isPortal;
  const lowerUrl = url.toLowerCase(), hasProxiedGeocodePaths = lowerUrl.indexOf("/geocodeserver") > -1 && lowerUrl.indexOf("/rest/services/") > -1;
  const isPortalProxy = isPortal && lowerUrl.indexOf((_a = portal.portalHostname) === null || _a === void 0 ? void 0 : _a.toLowerCase()) > -1;
  const isAGOLProxy = !isPortal && lowerUrl.indexOf("utility") && lowerUrl.indexOf(".arcgis.com") > -1;
  return hasProxiedGeocodePaths && (isPortalProxy || isAGOLProxy);
}
function parseGeocoderItemId(geocoder) {
  return geocoder.url.split("/servers/")[1].split("/rest/services/")[0];
}

function canPublish(user, portal, userLicensedItems) {
  return (!(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) &&
    !!portal.supportsHostedServices &&
    canCreateItems(user) &&
    (canPublishTiles(user, portal) ||
      canPublishFeatures(user, portal) ||
      canPublishScenes(user) ||
      canPublishVectorTiles(user) ||
      canPublishImageCollection(user, portal, userLicensedItems)));
}
function canCreateItems(user) {
  return (0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) || (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:user:createItem"));
}
function canReceiveItems(user) {
  return (0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) || (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:user:receiveItems"));
}
function canPublishFeatures(user, portal) {
  return (!(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) &&
    (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:publisher:publishFeatures")) &&
    (!portal.isPortal || portal.isBackedBySDS));
}
function canPublishTiles(user, portal) {
  return (!(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) &&
    (user === null || user === void 0 ? void 0 : user.privileges.includes("portal:publisher:publishTiles")) &&
    (!portal.isPortal || portal.isBackedBySDS));
}
function canPublishVectorTiles(user) {
  return !(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) && true; // this privilege doesn't exist yet
}
function canPublishScenes(user) {
  var _a;
  return !(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) && ((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:publishScenes"));
}
const canCreateDeveloperCredentials = (user) => !(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user);
function canPublishImageCollection(user, portal, userLicensedItems) {
  var _a, _b;
  const serverSupportsRasterAnalytics = !!((_b = (_a = portal.helperServices) === null || _a === void 0 ? void 0 : _a.rasterAnalytics) === null || _b === void 0 ? void 0 : _b.url);
  const canPublishDynamic = canPublishDynamicImagery(user, portal, userLicensedItems);
  const canPublish = portal.isPortal
    ? canPublishDynamic
    : canPublishDynamic || canPublishTiledImagery(user, portal, userLicensedItems);
  return serverSupportsRasterAnalytics && canPublish;
}
function canPublishDynamicImagery(user, portal, userLicensedItems) {
  var _a;
  return (((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:publishDynamicImagery")) &&
    (portal.isPortal || hasImageEntitlement(userLicensedItems)));
}
function canPublishTiledImagery(user, portal, userLicensedItems) {
  var _a;
  return (((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:publishTiledImagery")) &&
    !portal.isPortal &&
    hasImageEntitlement(userLicensedItems));
}
function hasImageEntitlement(userLicensedItems) {
  return userLicensedItems === null || userLicensedItems === void 0 ? void 0 : userLicensedItems.some((licensedItem) => { var _a; return (_a = licensedItem.entitlements) === null || _a === void 0 ? void 0 : _a.some((entitlement) => entitlement.toLowerCase() === "image"); });
}
async function fetchUserLicensedItems(portal) {
  var _a;
  const { userLicensedItems } = await (0,_portal_79caaeff_js__WEBPACK_IMPORTED_MODULE_2__.r)(`${(_a = portal.restUrl) !== null && _a !== void 0 ? _a : portal.portalUrl}/community/self?returnUserLicensedItems=true`);
  return userLicensedItems;
}
function canCreateLocatorView(user, portal) {
  var _a, _b;
  const hasWorldGeocoder = (_a = portal.helperServices) === null || _a === void 0 ? void 0 : _a.geocode.some(({ url }) => isServiceProxyGeocoder(url, portal));
  const privileges = (_b = user === null || user === void 0 ? void 0 : user.privileges) !== null && _b !== void 0 ? _b : [];
  return (!(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) &&
    hasWorldGeocoder &&
    (!portal.isPortal ||
      (!portal.isWebTierAuth &&
        // https://devtopia.esri.com/WebGIS/arcgis-portal-app/issues/40338
        privileges.includes("portal:user:viewOrgItems") &&
        privileges.includes("portal:user:createItem"))));
}
const canCreateLocator = (user) => !(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user);
function canCreateAdvancedNotebooks(user) {
  return user === null || user === void 0 ? void 0 : user.privileges.includes("premium:publisher:createAdvancedNotebooks");
}
function canCreateNotebooks(user) {
  return user === null || user === void 0 ? void 0 : user.privileges.includes("premium:publisher:createNotebooks");
}
function canCreateDataStore(user, portal) {
  var _a;
  return !!portal.isPortal && !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:publisher:registerDataStores"));
}
function canGeocode(user) {
  return !(0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.n)(user) && (user === null || user === void 0 ? void 0 : user.privileges.includes("premium:user:geocode"));
}
function canPublishFromCloud(user, portal, userLicensedItems) {
  return !portal.isPortal && canPublishFeatures(user, portal) && canPublish(user, portal, userLicensedItems);
}
function canPublishServiceDefinition(user, portal) {
  return canPublishFeatures(user, portal) && canPublishTiles(user, portal);
}
function canPublishType(user, type, portal) {
  switch (type) {
    case "CSV":
    case "GeoJson":
    case "Microsoft Excel":
    case "Shapefile":
    case "File Geodatabase":
    case "Photos with Locations":
      return canPublishFeatures(user, portal);
    case "Tile Package":
      return canPublishTiles(user, portal);
    case "Vector Tile Package":
      return canPublishVectorTiles(user);
    case "Scene Package":
      return canPublishScenes(user);
    case "Service Definition":
      return canPublishServiceDefinition(user, portal);
    default:
      return true;
  }
}
function canManageCredits(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:manageCredits"));
}
function canShowTotalCredits(user, portal) {
  var _a;
  return ((0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.e)(user) ||
    canManageCredits(user) ||
    !!((user === null || user === void 0 ? void 0 : user.assignedCredits) > -1 && ((_a = portal === null || portal === void 0 ? void 0 : portal.portalProperties) === null || _a === void 0 ? void 0 : _a.showCreditsOnProfile)));
}
const canAddAPIKey = (_) => false;
// temporarily disable for now https://devtopia.esri.com/WebGIS/arcgis-portal-app/issues/42863
// ["Trial Developer", "Developer", "Developer Subscription"].includes(subscriptionType);
function canViewOrgGroups(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:viewGroups"));
}
function canViewOrgItems(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:viewItems"));
}
function canViewUsers(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:viewUsers"));
}
function canUpdateOrgItems(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:updateItems"));
}
function canDeleteOrgItems(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:deleteItems"));
}
function canReassignOrgItems(user) {
  var _a;
  return !!((_a = user === null || user === void 0 ? void 0 : user.privileges) === null || _a === void 0 ? void 0 : _a.includes("portal:admin:reassignItems"));
}
function canManageItems(user) {
  return ((0,_privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_0__.e)(user) ||
    (canViewUsers(user) &&
      canViewOrgItems(user) &&
      (canUpdateOrgItems(user) || canDeleteOrgItems(user) || canReassignOrgItems(user))));
}




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fcHJpdmlsLTNhNmJkYS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUM4RTtBQUN0QjtBQUNKOztBQUVwRDtBQUNBO0FBQ0EsWUFBWSxTQUFTLEVBQUUsa0RBQVc7QUFDbEM7QUFDQTtBQUNBLGdDQUFnQyxJQUFJO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLGlCQUFpQixFQUFFLGtEQUFXO0FBQ3hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCLG1CQUFtQixpQkFBaUIsR0FBRztBQUM1RDtBQUNBLG1DQUFtQyxzREFBTztBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsV0FBVywwREFBWTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDBEQUFZO0FBQ3JCO0FBQ0E7QUFDQSxTQUFTLDBEQUFZO0FBQ3JCO0FBQ0E7QUFDQSxXQUFXLDBEQUFZO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVywwREFBWTtBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMERBQVksZ0JBQWdCO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMERBQVk7QUFDdEI7QUFDQSxpREFBaUQsMERBQVk7QUFDN0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEhBQTBILFFBQVEsK0lBQStJO0FBQ2pSO0FBQ0E7QUFDQTtBQUNBLFVBQVUsb0JBQW9CLFFBQVEsc0RBQU8sSUFBSSx3RUFBd0U7QUFDekg7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnSEFBZ0gsS0FBSztBQUNySDtBQUNBLFdBQVcsMERBQVk7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsMERBQVk7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMERBQVk7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLDBEQUFVO0FBQ3BCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSwwREFBVTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTs7QUFFb2hCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vcHJpdmlsZWdlcy0zNTU5MGViNC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IG4gYXMgaXNQdWJsaWNVc2VyLCBlIGFzIGlzT3JnQWRtaW4gfSBmcm9tICcuL3ByaXZpbGVnZXMtY2NkNWYzN2QuanMnO1xuaW1wb3J0IHsgYyBhcyBjb25maWdTdGF0ZSB9IGZyb20gJy4vY29uZmlnLWViNWY3ZGMyLmpzJztcbmltcG9ydCB7IHIgYXMgcmVxdWVzdCB9IGZyb20gJy4vcG9ydGFsLTc5Y2FhZWZmLmpzJztcblxuYXN5bmMgZnVuY3Rpb24gZ2V0V29ybGRHZW9jb2RlclVybCgpIHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKGFzeW5jIChyZXNvbHZlKSA9PiB7XG4gICAgY29uc3QgeyBwb3J0YWwgfSA9IGNvbmZpZ1N0YXRlO1xuICAgIGlmICghKHBvcnRhbCA9PT0gbnVsbCB8fCBwb3J0YWwgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHBvcnRhbC5pc1BvcnRhbCkpIHtcbiAgICAgIGNvbnN0IGVudiA9IGdldEVudmlyb25tZW50KHBvcnRhbCk7XG4gICAgICByZXNvbHZlKGBodHRwczovL2dlb2NvZGUke2Vudn0uYXJjZ2lzLmNvbS9hcmNnaXMvcmVzdC9zZXJ2aWNlcy9Xb3JsZC9HZW9jb2RlU2VydmVyYCk7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgY29uc3QgZ2VvY29kZXJzID0gcG9ydGFsLmhlbHBlclNlcnZpY2VzLmdlb2NvZGU7XG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBnZXRXb3JsZEdlb2NvZGVyVXJsRnJvbVByb3hpZXMoZ2VvY29kZXJzKTtcbiAgICAgIHJlc29sdmUodXJsKTtcbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gZ2V0RW52aXJvbm1lbnQocG9ydGFsKSB7XG4gIGNvbnN0IGhvc3RuYW1lID0gcG9ydGFsID09PSBudWxsIHx8IHBvcnRhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcG9ydGFsLnBvcnRhbEhvc3RuYW1lO1xuICBpZiAoaG9zdG5hbWUuaW5kZXhPZihcImRldlwiKSAhPT0gLTEpIHtcbiAgICByZXR1cm4gXCJkZXZcIjtcbiAgfVxuICBlbHNlIGlmIChob3N0bmFtZS5pbmRleE9mKFwicWFcIikgIT09IC0xKSB7XG4gICAgcmV0dXJuIFwicWFcIjtcbiAgfVxuICByZXR1cm4gXCJcIjtcbn1cbmZ1bmN0aW9uIGdldFdvcmxkR2VvY29kZXJVcmxGcm9tUHJveGllcyhnZW9jb2RlcnMpIHtcbiAgY29uc3QgeyBjb25maWcsIHBvcnRhbCB9ID0gY29uZmlnU3RhdGU7XG4gIHJldHVybiBuZXcgUHJvbWlzZShhc3luYyAocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgZXNyaUJhdGNoR2VvY29kZXIgPSBnZW9jb2RlcnNcbiAgICAgIC5maWx0ZXIoKGdlb2NvZGVyKSA9PiBpc1NlcnZpY2VQcm94eUdlb2NvZGVyKGdlb2NvZGVyLnVybCwgcG9ydGFsKSlcbiAgICAgIC5maWx0ZXIoKHByb3h5KSA9PiBwcm94eS5pc0VzcmlCYXRjaEdlb2NvZGVyKVswXTtcbiAgICBpZiAoZXNyaUJhdGNoR2VvY29kZXIpIHtcbiAgICAgIC8vIE1ha2Ugc3VyZSB3b3JsZCBnZW9jb2RlciBpcyBjb25maWd1cmVkXG4gICAgICBjb25zdCBpZCA9IHBhcnNlR2VvY29kZXJJdGVtSWQoZXNyaUJhdGNoR2VvY29kZXIpO1xuICAgICAgY29uc3QgdXJsID0gYCR7Y29uZmlnLnJlc3RCYXNlVXJsfS9jb250ZW50L2l0ZW1zLyR7aWR9YDtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGdlb2NvZGVySXRlbSA9IGF3YWl0IHJlcXVlc3QodXJsKTtcbiAgICAgICAgcmVzb2x2ZShnZW9jb2Rlckl0ZW0udXJsKTtcbiAgICAgIH1cbiAgICAgIGNhdGNoIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgcmVqZWN0KFwiTm8gd29ybGQgZ2VvY29kZXIgY29uZmlndXJlZFwiKTtcbiAgICB9XG4gIH0pO1xufVxuZnVuY3Rpb24gaXNTZXJ2aWNlUHJveHlHZW9jb2Rlcih1cmwgPSBcIlwiLCBwb3J0YWwpIHtcbiAgdmFyIF9hO1xuICBjb25zdCBpc1BvcnRhbCA9IHBvcnRhbC5pc1BvcnRhbDtcbiAgY29uc3QgbG93ZXJVcmwgPSB1cmwudG9Mb3dlckNhc2UoKSwgaGFzUHJveGllZEdlb2NvZGVQYXRocyA9IGxvd2VyVXJsLmluZGV4T2YoXCIvZ2VvY29kZXNlcnZlclwiKSA+IC0xICYmIGxvd2VyVXJsLmluZGV4T2YoXCIvcmVzdC9zZXJ2aWNlcy9cIikgPiAtMTtcbiAgY29uc3QgaXNQb3J0YWxQcm94eSA9IGlzUG9ydGFsICYmIGxvd2VyVXJsLmluZGV4T2YoKF9hID0gcG9ydGFsLnBvcnRhbEhvc3RuYW1lKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EudG9Mb3dlckNhc2UoKSkgPiAtMTtcbiAgY29uc3QgaXNBR09MUHJveHkgPSAhaXNQb3J0YWwgJiYgbG93ZXJVcmwuaW5kZXhPZihcInV0aWxpdHlcIikgJiYgbG93ZXJVcmwuaW5kZXhPZihcIi5hcmNnaXMuY29tXCIpID4gLTE7XG4gIHJldHVybiBoYXNQcm94aWVkR2VvY29kZVBhdGhzICYmIChpc1BvcnRhbFByb3h5IHx8IGlzQUdPTFByb3h5KTtcbn1cbmZ1bmN0aW9uIHBhcnNlR2VvY29kZXJJdGVtSWQoZ2VvY29kZXIpIHtcbiAgcmV0dXJuIGdlb2NvZGVyLnVybC5zcGxpdChcIi9zZXJ2ZXJzL1wiKVsxXS5zcGxpdChcIi9yZXN0L3NlcnZpY2VzL1wiKVswXTtcbn1cblxuZnVuY3Rpb24gY2FuUHVibGlzaCh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKSB7XG4gIHJldHVybiAoIWlzUHVibGljVXNlcih1c2VyKSAmJlxuICAgICEhcG9ydGFsLnN1cHBvcnRzSG9zdGVkU2VydmljZXMgJiZcbiAgICBjYW5DcmVhdGVJdGVtcyh1c2VyKSAmJlxuICAgIChjYW5QdWJsaXNoVGlsZXModXNlciwgcG9ydGFsKSB8fFxuICAgICAgY2FuUHVibGlzaEZlYXR1cmVzKHVzZXIsIHBvcnRhbCkgfHxcbiAgICAgIGNhblB1Ymxpc2hTY2VuZXModXNlcikgfHxcbiAgICAgIGNhblB1Ymxpc2hWZWN0b3JUaWxlcyh1c2VyKSB8fFxuICAgICAgY2FuUHVibGlzaEltYWdlQ29sbGVjdGlvbih1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKSkpO1xufVxuZnVuY3Rpb24gY2FuQ3JlYXRlSXRlbXModXNlcikge1xuICByZXR1cm4gaXNQdWJsaWNVc2VyKHVzZXIpIHx8ICh1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcy5pbmNsdWRlcyhcInBvcnRhbDp1c2VyOmNyZWF0ZUl0ZW1cIikpO1xufVxuZnVuY3Rpb24gY2FuUmVjZWl2ZUl0ZW1zKHVzZXIpIHtcbiAgcmV0dXJuIGlzUHVibGljVXNlcih1c2VyKSB8fCAodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6dXNlcjpyZWNlaXZlSXRlbXNcIikpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaEZlYXR1cmVzKHVzZXIsIHBvcnRhbCkge1xuICByZXR1cm4gKCFpc1B1YmxpY1VzZXIodXNlcikgJiZcbiAgICAodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6cHVibGlzaGVyOnB1Ymxpc2hGZWF0dXJlc1wiKSkgJiZcbiAgICAoIXBvcnRhbC5pc1BvcnRhbCB8fCBwb3J0YWwuaXNCYWNrZWRCeVNEUykpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaFRpbGVzKHVzZXIsIHBvcnRhbCkge1xuICByZXR1cm4gKCFpc1B1YmxpY1VzZXIodXNlcikgJiZcbiAgICAodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwb3J0YWw6cHVibGlzaGVyOnB1Ymxpc2hUaWxlc1wiKSkgJiZcbiAgICAoIXBvcnRhbC5pc1BvcnRhbCB8fCBwb3J0YWwuaXNCYWNrZWRCeVNEUykpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaFZlY3RvclRpbGVzKHVzZXIpIHtcbiAgcmV0dXJuICFpc1B1YmxpY1VzZXIodXNlcikgJiYgdHJ1ZTsgLy8gdGhpcyBwcml2aWxlZ2UgZG9lc24ndCBleGlzdCB5ZXRcbn1cbmZ1bmN0aW9uIGNhblB1Ymxpc2hTY2VuZXModXNlcikge1xuICB2YXIgX2E7XG4gIHJldHVybiAhaXNQdWJsaWNVc2VyKHVzZXIpICYmICgoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwicG9ydGFsOnB1Ymxpc2hlcjpwdWJsaXNoU2NlbmVzXCIpKTtcbn1cbmNvbnN0IGNhbkNyZWF0ZURldmVsb3BlckNyZWRlbnRpYWxzID0gKHVzZXIpID0+ICFpc1B1YmxpY1VzZXIodXNlcik7XG5mdW5jdGlvbiBjYW5QdWJsaXNoSW1hZ2VDb2xsZWN0aW9uKHVzZXIsIHBvcnRhbCwgdXNlckxpY2Vuc2VkSXRlbXMpIHtcbiAgdmFyIF9hLCBfYjtcbiAgY29uc3Qgc2VydmVyU3VwcG9ydHNSYXN0ZXJBbmFseXRpY3MgPSAhISgoX2IgPSAoX2EgPSBwb3J0YWwuaGVscGVyU2VydmljZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5yYXN0ZXJBbmFseXRpY3MpID09PSBudWxsIHx8IF9iID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYi51cmwpO1xuICBjb25zdCBjYW5QdWJsaXNoRHluYW1pYyA9IGNhblB1Ymxpc2hEeW5hbWljSW1hZ2VyeSh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKTtcbiAgY29uc3QgY2FuUHVibGlzaCA9IHBvcnRhbC5pc1BvcnRhbFxuICAgID8gY2FuUHVibGlzaER5bmFtaWNcbiAgICA6IGNhblB1Ymxpc2hEeW5hbWljIHx8IGNhblB1Ymxpc2hUaWxlZEltYWdlcnkodXNlciwgcG9ydGFsLCB1c2VyTGljZW5zZWRJdGVtcyk7XG4gIHJldHVybiBzZXJ2ZXJTdXBwb3J0c1Jhc3RlckFuYWx5dGljcyAmJiBjYW5QdWJsaXNoO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaER5bmFtaWNJbWFnZXJ5KHVzZXIsIHBvcnRhbCwgdXNlckxpY2Vuc2VkSXRlbXMpIHtcbiAgdmFyIF9hO1xuICByZXR1cm4gKCgoX2EgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLmluY2x1ZGVzKFwicG9ydGFsOnB1Ymxpc2hlcjpwdWJsaXNoRHluYW1pY0ltYWdlcnlcIikpICYmXG4gICAgKHBvcnRhbC5pc1BvcnRhbCB8fCBoYXNJbWFnZUVudGl0bGVtZW50KHVzZXJMaWNlbnNlZEl0ZW1zKSkpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaFRpbGVkSW1hZ2VyeSh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICgoKF9hID0gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmNsdWRlcyhcInBvcnRhbDpwdWJsaXNoZXI6cHVibGlzaFRpbGVkSW1hZ2VyeVwiKSkgJiZcbiAgICAhcG9ydGFsLmlzUG9ydGFsICYmXG4gICAgaGFzSW1hZ2VFbnRpdGxlbWVudCh1c2VyTGljZW5zZWRJdGVtcykpO1xufVxuZnVuY3Rpb24gaGFzSW1hZ2VFbnRpdGxlbWVudCh1c2VyTGljZW5zZWRJdGVtcykge1xuICByZXR1cm4gdXNlckxpY2Vuc2VkSXRlbXMgPT09IG51bGwgfHwgdXNlckxpY2Vuc2VkSXRlbXMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXJMaWNlbnNlZEl0ZW1zLnNvbWUoKGxpY2Vuc2VkSXRlbSkgPT4geyB2YXIgX2E7IHJldHVybiAoX2EgPSBsaWNlbnNlZEl0ZW0uZW50aXRsZW1lbnRzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2Euc29tZSgoZW50aXRsZW1lbnQpID0+IGVudGl0bGVtZW50LnRvTG93ZXJDYXNlKCkgPT09IFwiaW1hZ2VcIik7IH0pO1xufVxuYXN5bmMgZnVuY3Rpb24gZmV0Y2hVc2VyTGljZW5zZWRJdGVtcyhwb3J0YWwpIHtcbiAgdmFyIF9hO1xuICBjb25zdCB7IHVzZXJMaWNlbnNlZEl0ZW1zIH0gPSBhd2FpdCByZXF1ZXN0KGAkeyhfYSA9IHBvcnRhbC5yZXN0VXJsKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBwb3J0YWwucG9ydGFsVXJsfS9jb21tdW5pdHkvc2VsZj9yZXR1cm5Vc2VyTGljZW5zZWRJdGVtcz10cnVlYCk7XG4gIHJldHVybiB1c2VyTGljZW5zZWRJdGVtcztcbn1cbmZ1bmN0aW9uIGNhbkNyZWF0ZUxvY2F0b3JWaWV3KHVzZXIsIHBvcnRhbCkge1xuICB2YXIgX2EsIF9iO1xuICBjb25zdCBoYXNXb3JsZEdlb2NvZGVyID0gKF9hID0gcG9ydGFsLmhlbHBlclNlcnZpY2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuZ2VvY29kZS5zb21lKCh7IHVybCB9KSA9PiBpc1NlcnZpY2VQcm94eUdlb2NvZGVyKHVybCwgcG9ydGFsKSk7XG4gIGNvbnN0IHByaXZpbGVnZXMgPSAoX2IgPSB1c2VyID09PSBudWxsIHx8IHVzZXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVzZXIucHJpdmlsZWdlcykgIT09IG51bGwgJiYgX2IgIT09IHZvaWQgMCA/IF9iIDogW107XG4gIHJldHVybiAoIWlzUHVibGljVXNlcih1c2VyKSAmJlxuICAgIGhhc1dvcmxkR2VvY29kZXIgJiZcbiAgICAoIXBvcnRhbC5pc1BvcnRhbCB8fFxuICAgICAgKCFwb3J0YWwuaXNXZWJUaWVyQXV0aCAmJlxuICAgICAgICAvLyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtcG9ydGFsLWFwcC9pc3N1ZXMvNDAzMzhcbiAgICAgICAgcHJpdmlsZWdlcy5pbmNsdWRlcyhcInBvcnRhbDp1c2VyOnZpZXdPcmdJdGVtc1wiKSAmJlxuICAgICAgICBwcml2aWxlZ2VzLmluY2x1ZGVzKFwicG9ydGFsOnVzZXI6Y3JlYXRlSXRlbVwiKSkpKTtcbn1cbmNvbnN0IGNhbkNyZWF0ZUxvY2F0b3IgPSAodXNlcikgPT4gIWlzUHVibGljVXNlcih1c2VyKTtcbmZ1bmN0aW9uIGNhbkNyZWF0ZUFkdmFuY2VkTm90ZWJvb2tzKHVzZXIpIHtcbiAgcmV0dXJuIHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzLmluY2x1ZGVzKFwicHJlbWl1bTpwdWJsaXNoZXI6Y3JlYXRlQWR2YW5jZWROb3RlYm9va3NcIik7XG59XG5mdW5jdGlvbiBjYW5DcmVhdGVOb3RlYm9va3ModXNlcikge1xuICByZXR1cm4gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMuaW5jbHVkZXMoXCJwcmVtaXVtOnB1Ymxpc2hlcjpjcmVhdGVOb3RlYm9va3NcIik7XG59XG5mdW5jdGlvbiBjYW5DcmVhdGVEYXRhU3RvcmUodXNlciwgcG9ydGFsKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICEhcG9ydGFsLmlzUG9ydGFsICYmICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6cHVibGlzaGVyOnJlZ2lzdGVyRGF0YVN0b3Jlc1wiKSk7XG59XG5mdW5jdGlvbiBjYW5HZW9jb2RlKHVzZXIpIHtcbiAgcmV0dXJuICFpc1B1YmxpY1VzZXIodXNlcikgJiYgKHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzLmluY2x1ZGVzKFwicHJlbWl1bTp1c2VyOmdlb2NvZGVcIikpO1xufVxuZnVuY3Rpb24gY2FuUHVibGlzaEZyb21DbG91ZCh1c2VyLCBwb3J0YWwsIHVzZXJMaWNlbnNlZEl0ZW1zKSB7XG4gIHJldHVybiAhcG9ydGFsLmlzUG9ydGFsICYmIGNhblB1Ymxpc2hGZWF0dXJlcyh1c2VyLCBwb3J0YWwpICYmIGNhblB1Ymxpc2godXNlciwgcG9ydGFsLCB1c2VyTGljZW5zZWRJdGVtcyk7XG59XG5mdW5jdGlvbiBjYW5QdWJsaXNoU2VydmljZURlZmluaXRpb24odXNlciwgcG9ydGFsKSB7XG4gIHJldHVybiBjYW5QdWJsaXNoRmVhdHVyZXModXNlciwgcG9ydGFsKSAmJiBjYW5QdWJsaXNoVGlsZXModXNlciwgcG9ydGFsKTtcbn1cbmZ1bmN0aW9uIGNhblB1Ymxpc2hUeXBlKHVzZXIsIHR5cGUsIHBvcnRhbCkge1xuICBzd2l0Y2ggKHR5cGUpIHtcbiAgICBjYXNlIFwiQ1NWXCI6XG4gICAgY2FzZSBcIkdlb0pzb25cIjpcbiAgICBjYXNlIFwiTWljcm9zb2Z0IEV4Y2VsXCI6XG4gICAgY2FzZSBcIlNoYXBlZmlsZVwiOlxuICAgIGNhc2UgXCJGaWxlIEdlb2RhdGFiYXNlXCI6XG4gICAgY2FzZSBcIlBob3RvcyB3aXRoIExvY2F0aW9uc1wiOlxuICAgICAgcmV0dXJuIGNhblB1Ymxpc2hGZWF0dXJlcyh1c2VyLCBwb3J0YWwpO1xuICAgIGNhc2UgXCJUaWxlIFBhY2thZ2VcIjpcbiAgICAgIHJldHVybiBjYW5QdWJsaXNoVGlsZXModXNlciwgcG9ydGFsKTtcbiAgICBjYXNlIFwiVmVjdG9yIFRpbGUgUGFja2FnZVwiOlxuICAgICAgcmV0dXJuIGNhblB1Ymxpc2hWZWN0b3JUaWxlcyh1c2VyKTtcbiAgICBjYXNlIFwiU2NlbmUgUGFja2FnZVwiOlxuICAgICAgcmV0dXJuIGNhblB1Ymxpc2hTY2VuZXModXNlcik7XG4gICAgY2FzZSBcIlNlcnZpY2UgRGVmaW5pdGlvblwiOlxuICAgICAgcmV0dXJuIGNhblB1Ymxpc2hTZXJ2aWNlRGVmaW5pdGlvbih1c2VyLCBwb3J0YWwpO1xuICAgIGRlZmF1bHQ6XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuZnVuY3Rpb24gY2FuTWFuYWdlQ3JlZGl0cyh1c2VyKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46bWFuYWdlQ3JlZGl0c1wiKSk7XG59XG5mdW5jdGlvbiBjYW5TaG93VG90YWxDcmVkaXRzKHVzZXIsIHBvcnRhbCkge1xuICB2YXIgX2E7XG4gIHJldHVybiAoaXNPcmdBZG1pbih1c2VyKSB8fFxuICAgIGNhbk1hbmFnZUNyZWRpdHModXNlcikgfHxcbiAgICAhISgodXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLmFzc2lnbmVkQ3JlZGl0cykgPiAtMSAmJiAoKF9hID0gcG9ydGFsID09PSBudWxsIHx8IHBvcnRhbCA9PT0gdm9pZCAwID8gdm9pZCAwIDogcG9ydGFsLnBvcnRhbFByb3BlcnRpZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5zaG93Q3JlZGl0c09uUHJvZmlsZSkpKTtcbn1cbmNvbnN0IGNhbkFkZEFQSUtleSA9IChfKSA9PiBmYWxzZTtcbi8vIHRlbXBvcmFyaWx5IGRpc2FibGUgZm9yIG5vdyBodHRwczovL2RldnRvcGlhLmVzcmkuY29tL1dlYkdJUy9hcmNnaXMtcG9ydGFsLWFwcC9pc3N1ZXMvNDI4NjNcbi8vIFtcIlRyaWFsIERldmVsb3BlclwiLCBcIkRldmVsb3BlclwiLCBcIkRldmVsb3BlciBTdWJzY3JpcHRpb25cIl0uaW5jbHVkZXMoc3Vic2NyaXB0aW9uVHlwZSk7XG5mdW5jdGlvbiBjYW5WaWV3T3JnR3JvdXBzKHVzZXIpIHtcbiAgdmFyIF9hO1xuICByZXR1cm4gISEoKF9hID0gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjp2aWV3R3JvdXBzXCIpKTtcbn1cbmZ1bmN0aW9uIGNhblZpZXdPcmdJdGVtcyh1c2VyKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dmlld0l0ZW1zXCIpKTtcbn1cbmZ1bmN0aW9uIGNhblZpZXdVc2Vycyh1c2VyKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46dmlld1VzZXJzXCIpKTtcbn1cbmZ1bmN0aW9uIGNhblVwZGF0ZU9yZ0l0ZW1zKHVzZXIpIHtcbiAgdmFyIF9hO1xuICByZXR1cm4gISEoKF9hID0gdXNlciA9PT0gbnVsbCB8fCB1c2VyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1c2VyLnByaXZpbGVnZXMpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5pbmNsdWRlcyhcInBvcnRhbDphZG1pbjp1cGRhdGVJdGVtc1wiKSk7XG59XG5mdW5jdGlvbiBjYW5EZWxldGVPcmdJdGVtcyh1c2VyKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46ZGVsZXRlSXRlbXNcIikpO1xufVxuZnVuY3Rpb24gY2FuUmVhc3NpZ25PcmdJdGVtcyh1c2VyKSB7XG4gIHZhciBfYTtcbiAgcmV0dXJuICEhKChfYSA9IHVzZXIgPT09IG51bGwgfHwgdXNlciA9PT0gdm9pZCAwID8gdm9pZCAwIDogdXNlci5wcml2aWxlZ2VzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5jbHVkZXMoXCJwb3J0YWw6YWRtaW46cmVhc3NpZ25JdGVtc1wiKSk7XG59XG5mdW5jdGlvbiBjYW5NYW5hZ2VJdGVtcyh1c2VyKSB7XG4gIHJldHVybiAoaXNPcmdBZG1pbih1c2VyKSB8fFxuICAgIChjYW5WaWV3VXNlcnModXNlcikgJiZcbiAgICAgIGNhblZpZXdPcmdJdGVtcyh1c2VyKSAmJlxuICAgICAgKGNhblVwZGF0ZU9yZ0l0ZW1zKHVzZXIpIHx8IGNhbkRlbGV0ZU9yZ0l0ZW1zKHVzZXIpIHx8IGNhblJlYXNzaWduT3JnSXRlbXModXNlcikpKSk7XG59XG5cbmV4cG9ydCB7IGNhblB1Ymxpc2hUeXBlIGFzIGEsIGNhblB1Ymxpc2hGZWF0dXJlcyBhcyBiLCBjYW5QdWJsaXNoRnJvbUNsb3VkIGFzIGMsIGNhbkNyZWF0ZURldmVsb3BlckNyZWRlbnRpYWxzIGFzIGQsIGNhblB1Ymxpc2hJbWFnZUNvbGxlY3Rpb24gYXMgZSwgZmV0Y2hVc2VyTGljZW5zZWRJdGVtcyBhcyBmLCBjYW5QdWJsaXNoVGlsZXMgYXMgZywgY2FuUHVibGlzaFNjZW5lcyBhcyBoLCBjYW5DcmVhdGVMb2NhdG9yVmlldyBhcyBpLCBjYW5DcmVhdGVMb2NhdG9yIGFzIGosIGNhbkNyZWF0ZURhdGFTdG9yZSBhcyBrLCBjYW5DcmVhdGVJdGVtcyBhcyBsLCBjYW5HZW9jb2RlIGFzIG0sIGNhblJlY2VpdmVJdGVtcyBhcyBuLCBjYW5TaG93VG90YWxDcmVkaXRzIGFzIG8sIGNhbkFkZEFQSUtleSBhcyBwLCBnZXRXb3JsZEdlb2NvZGVyVXJsIGFzIHEsIGNhbkNyZWF0ZU5vdGVib29rcyBhcyByLCBjYW5DcmVhdGVBZHZhbmNlZE5vdGVib29rcyBhcyBzLCBjYW5WaWV3T3JnR3JvdXBzIGFzIHQsIGNhbk1hbmFnZUl0ZW1zIGFzIHUgfTtcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==