"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["vendors-extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-20bfff"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js":
/*!**************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js ***!
  \**************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   a: () => (/* binding */ addItemState),
/* harmony export */   b: () => (/* binding */ addItemUrlState),
/* harmony export */   c: () => (/* binding */ addItemRequestState),
/* harmony export */   d: () => (/* binding */ addItemStore)
/* harmony export */ });
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const addItemStore = (0,_index_81d548b7_js__WEBPACK_IMPORTED_MODULE_0__.c)({
  typeKeywords: [],
  customParameters: [],
  analyzedLocationTypes: [],
  allowStoredAuth: true,
  isSecured: null,
  checkAuth: false
});
// Entire add item state object
const addItemState = addItemStore.state;
// Subsets of add item state
const addItemRequestState = addItemStore.state;
const addItemUrlState = addItemStore.state;




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   A: () => (/* binding */ AppendOverwriteCloudPublishTypes),
/* harmony export */   N: () => (/* binding */ NONE_VALUE),
/* harmony export */   a: () => (/* binding */ appendFileTypes),
/* harmony export */   b: () => (/* binding */ AppendOverwritePublishTypes),
/* harmony export */   c: () => (/* binding */ appendExtensionsForEnterprise),
/* harmony export */   d: () => (/* binding */ appendExtensions),
/* harmony export */   u: () => (/* binding */ uidFields)
/* harmony export */ });
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */
const uidFields = ["esriFieldTypeOID", "esriFieldTypeGlobalID"];
const NONE_VALUE = "<None>";
const AppendOverwritePublishTypes = {
  "file geodatabase": "filegeodatabase",
  shapefile: "shapefile",
  geojson: "geojson",
  csv: "CSV",
  "microsoft excel": "excel",
  geopackage: "geoPackage"
};
const appendFileTypes = {
  Shapefile: "shapefile",
  "File Geodatabase": "fileGeodatabase",
  CSV: "csv",
  "Microsoft Excel": "excel",
  GeoJson: "geojson",
  GeoPackage: "geoPackage"
};
const AppendOverwriteCloudPublishTypes = {
  csv: "CSV",
  excel: "Microsoft Excel",
  shapefile: "Shapefile",
  fgdb: "File Geodatabase",
  geojson: "GeoJson",
  googlesheets: "Microsoft Excel"
};
const appendExtensions = ["zip", "csv", "xls", "xlsx", "geojson", "gpkg", "json"];
const appendExtensionsForEnterprise = ["zip", "csv", "xls", "xlsx"];




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-63c5ce83.js":
/*!************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-63c5ce83.js ***!
  \************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   c: () => (/* binding */ canMatchField),
/* harmony export */   g: () => (/* binding */ getAppendParameters)
/* harmony export */ });
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/* harmony import */ var _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./append-58a7e7ab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js");
/* harmony import */ var _geocode_7eb7c0df_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./geocode-7eb7c0df.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/geocode-7eb7c0df.js");
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */





var __rest = ( false) || function (s, e) {
  var t = {};
  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
    t[p] = s[p];
  if (s != null && typeof Object.getOwnPropertySymbols === "function")
    for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
        t[p[i]] = s[p[i]];
    }
  return t;
};
function canMatchField(field, matchField) {
  var _a;
  const fieldType = (field === null || field === void 0 ? void 0 : field.type) || null;
  const matchFieldType = (matchField === null || matchField === void 0 ? void 0 : matchField.type) || null;
  const matchFields = {
    esriFieldTypeSmallInteger: ["esriFieldTypeSmallInteger"],
    esriFieldTypeInteger: ["esriFieldTypeInteger", "esriFieldTypeSmallInteger"],
    esriFieldTypeSingle: ["esriFieldTypeSingle", "esriFieldTypeDouble"],
    esriFieldTypeDouble: [
      "esriFieldTypeDouble",
      "esriFieldTypeSingle",
      "esriFieldTypeInteger",
      "esriFieldTypeSmallInteger"
    ],
    esriFieldTypeDate: ["esriFieldTypeDate"],
    esriFieldTypeString: [
      "esriFieldTypeString",
      "esriFieldTypeSmallInteger",
      "esriFieldTypeInteger",
      "esriFieldTypeSingle",
      "esriFieldTypeDouble",
      "esriFieldTypeDate",
      "esriFieldTypeGUID"
    ],
    esriFieldTypeGUID: ["esriFieldTypeGUID", "esriFieldTypeString"],
    esriFieldTypeOID: ["esriFieldTypeOID", "esriFieldTypeSmallInteger", "esriFieldTypeInteger"],
    esriFieldTypeGlobalID: ["esriFieldTypeGlobalID", "esriFieldTypeGUID", "esriFieldTypeString"],
    esriFieldTypeDateOnly: ["esriFieldTypeDateOnly"],
    esriFieldTypeTimeOnly: ["esriFieldTypeTimeOnly"],
    esriFieldTypeTimestampOffset: ["esriFieldTypeTimestampOffset"],
    esriFieldTypeBigInteger: ["esriFieldTypeBigInteger"]
  };
  return matchFieldType && (matchFieldType === fieldType || ((_a = matchFields[fieldType]) === null || _a === void 0 ? void 0 : _a.indexOf(matchFieldType)) > -1);
}
function getAppendParameters(addItemProps) {
  var _a;
  const { timezone, analyzeResults, type, fieldMappings, dataLayer, id, uidPair, addAppendSelectOption, sourceDataLayer } = addItemProps;
  let finalAppendParameters, appendSourceInfo;
  const { publishParameters } = analyzeResults, rest = __rest(analyzeResults, ["publishParameters"]);
  const upsert = addAppendSelectOption === "upsert" || addAppendSelectOption === "update";
  const finalFieldMappings = formatFieldMappings(fieldMappings);
  const appendFields = createAppendFields(finalFieldMappings);
  const timezoneInfo = {
    dateFieldsTimeReference: {
      timeZone: timezone || "UTC",
      respectsDaylightSaving: true
    }
  };
  const defaultAppendParams = {
    sourceTableName: dataLayer.name,
    fieldMappings: (finalFieldMappings === null || finalFieldMappings === void 0 ? void 0 : finalFieldMappings.length) ? JSON.stringify(finalFieldMappings) : null,
    upsert,
    skipInserts: addAppendSelectOption === "update",
    skipUpdates: false,
    useGlobalIds: upsert && (uidPair === null || uidPair === void 0 ? void 0 : uidPair.type) === "esriFieldTypeGlobalID",
    updateGeometry: upsert ? _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_0__.a.addAppendSelectUpdateTypeOption === "attributeAndGeometry" : true,
    appendFields: appendFields.length ? JSON.stringify(appendFields) : null,
    appendItemId: id,
    appendUploadFormat: _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_3__.a[_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_0__.a.type].appendUploadFormat,
    rollbackOnFailure: true
  };
  const publishInfo = __rest(publishParameters, ["layers"]);
  if (type === "CSV") {
    publishParameters.layerInfo.dateFieldsTimeReference = timezoneInfo.dateFieldsTimeReference;
    appendSourceInfo = Object.assign(Object.assign(Object.assign({}, timezoneInfo), publishParameters), rest);
  }
  else if (type === "Microsoft Excel") {
    const layerInfo = (0,_geocode_7eb7c0df_js__WEBPACK_IMPORTED_MODULE_2__.a)({}, true);
    const formattedLayerInfo = getLayerToAppend(layerInfo, publishInfo); //Updated info needs to be added to the layers [] rather than the root for excel
    formattedLayerInfo.dateFieldsTimeReference = timezoneInfo.dateFieldsTimeReference;
    publishInfo.name = dataLayer.name;
    appendSourceInfo = Object.assign(Object.assign(Object.assign(Object.assign({}, timezoneInfo), { layers: [formattedLayerInfo] }), publishInfo), rest);
  }
  else {
    appendSourceInfo = Object.assign(Object.assign(Object.assign({}, timezoneInfo), publishParameters), rest);
  }
  finalAppendParameters = Object.assign(Object.assign({}, defaultAppendParams), { appendSourceInfo: JSON.stringify(appendSourceInfo) });
  if (addAppendSelectOption === "add") {
    finalAppendParameters.upsertMatchingField = sourceDataLayer.objectIdField || ((_a = sourceDataLayer.uniqueField) === null || _a === void 0 ? void 0 : _a.name);
  }
  else {
    if (upsert && (uidPair === null || uidPair === void 0 ? void 0 : uidPair.isUniqueIndex)) {
      finalAppendParameters.upsertMatchingField = uidPair === null || uidPair === void 0 ? void 0 : uidPair.name;
    }
  }
  return finalAppendParameters;
}
function getLayerToAppend(layerInfo, updatedInfo) {
  const formattedLayer = Object.assign({}, layerInfo);
  formattedLayer.locationType = updatedInfo.locationType;
  if (formattedLayer.locationType === "address") {
    formattedLayer.addressFields = updatedInfo.addressFields;
    formattedLayer.sourceCountry = updatedInfo.sourceCountry;
  }
  else if (formattedLayer.locationType === "coordinates") {
    formattedLayer.coordinateFieldType = updatedInfo.coordinateFieldType;
    if (formattedLayer.coordinateFieldType === "LatitudeAndLongitude") {
      formattedLayer.latitudeFieldName = updatedInfo.latitudeFieldName;
      formattedLayer.longitudeFieldName = updatedInfo.longitudeFieldName;
    }
    else {
      formattedLayer.coordinateFieldName = updatedInfo.coordinateFieldName;
    }
  }
  return formattedLayer;
}
function formatFieldMappings(fieldMappings) {
  const fields = fieldMappings.filter((fieldMapping) => {
    return fieldMapping.source !== _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_1__.N;
  });
  const finalFieldMappings = fields.map(({ source, name }) => {
    return { source, name };
  });
  return finalFieldMappings;
}
function createAppendFields(fieldMappings) {
  const appendFields = fieldMappings.map((mapping) => {
    return mapping.name;
  });
  return appendFields;
}




/***/ }),

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-append-key-pair-select.entry.js":
/*!***********************************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-new-item-pages-append-key-pair-select.entry.js ***!
  \***********************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_new_item_pages_append_key_pair_select: () => (/* binding */ ArcgisNewItemPagesAppendKeyPairSelect)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/* harmony import */ var _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./add-item-97d577a9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/add-item-97d577a9.js");
/* harmony import */ var _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./append-58a7e7ab.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-58a7e7ab.js");
/* harmony import */ var _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./ui-ecf86bba.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/ui-ecf86bba.js");
/* harmony import */ var _append_63c5ce83_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./append-63c5ce83.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/append-63c5ce83.js");
/* harmony import */ var _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./config-eb5f7dc2.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/config-eb5f7dc2.js");
/* harmony import */ var _index_81d548b7_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./index-81d548b7.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-81d548b7.js");
/* harmony import */ var _geocode_7eb7c0df_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./geocode-7eb7c0df.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/geocode-7eb7c0df.js");
/* harmony import */ var _functional_c82f5ab9_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./functional-c82f5ab9.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/functional-c82f5ab9.js");
/* harmony import */ var _privileges_ccd5f37d_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./privileges-ccd5f37d.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-ccd5f37d.js");
/* harmony import */ var _privileges_35590eb4_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./privileges-35590eb4.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/privileges-35590eb4.js");
/* harmony import */ var _portal_79caaeff_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./portal-79caaeff.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/portal-79caaeff.js");
/* harmony import */ var _loadModules_aaf30bd6_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./loadModules-aaf30bd6.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/loadModules-aaf30bd6.js");
/* harmony import */ var _item_types_b4fe86ad_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./item-types-b4fe86ad.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/item-types-b4fe86ad.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */















const arcgisNewItemPagesAppendKeyPairSelectCss = ".timezone-wrapper{background-color:var(--calcite-ui-background);padding-left:1rem}.timezone{display:block;margin-bottom:0.75rem;-webkit-margin-end:2.5rem;margin-inline-end:2.5rem}.timezone-header{color:var(--calcite-ui-text-1);font-size:1rem;font-weight:500}";

const ArcgisNewItemPagesAppendKeyPairSelect = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.newItemUpdatePage = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemUpdatePage", 7);
    this.newItemPrevPage = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "newItemPrevPage", 7);
    this.workflowComplete = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "workflowComplete", 7);
    this.handleTimezoneChange = (event) => {
      this.selectedTimezone = event.detail;
    };
    this.handleKeyPairChange = (event) => {
      this.selectedKeyPair = event.detail;
    };
    this.i18n = undefined;
    this.selectedKeyPair = undefined;
    this.selectedTimezone = undefined;
    this.error = undefined;
  }
  handleNext() {
    if (_add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.addAppendSelectOption !== "add") {
      if (Object.values(this.selectedKeyPair).includes(_append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__.N)) {
        this.error = { title: _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_3__.u.i18n.error, message: this.i18n.noKeyPair }; //Key pair must be selected to update data.
        return;
      }
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.uidPair = this.selectedKeyPair;
    }
    _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.timezone = this.selectedTimezone;
    this.newItemUpdatePage.emit("appendMatchFields");
  }
  async handlePrev(event) {
    var _a;
    if (!(((_a = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.analyzeResults.publishParameters.layers) === null || _a === void 0 ? void 0 : _a.length) > 1)) {
      //item is deleted on appendSelectLayer
      event.preventDefault();
      _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.uidPair = null;
      this.newItemPrevPage.emit();
    }
  }
  componentWillLoad() {
    var _a;
    const { existingItem, dateFieldsTimeReference, originalFileName } = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a;
    this.i18n = _ui_ecf86bba_js__WEBPACK_IMPORTED_MODULE_3__.u.i18n.appendKeyValuePair;
    this.serviceLayer = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.sourceDataLayer;
    this.selectedTimezone = (_a = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.timezone) !== null && _a !== void 0 ? _a : "UTC";
    this.timezoneDescription = this.i18n.timezoneDescription
      .replace("${uploadedFileName}", originalFileName)
      .replace("${featureLayerName}", existingItem.title)
      .replace("${featureLayerTimezone}", dateFieldsTimeReference.timeZone);
    this.isEnterprise = _config_eb5f7dc2_js__WEBPACK_IMPORTED_MODULE_5__.c.portal.isPortal;
    this.findKeyPairs();
  }
  findKeyPairs() {
    var _a;
    const keyPairs = {};
    const serviceLayerFields = this.serviceLayer.fields || [];
    const indexes = this.serviceLayer.indexes || [];
    const dataLayerFields = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.backupLayerFields;
    indexes
      .filter((idx) => idx === null || idx === void 0 ? void 0 : idx.isUnique)
      .forEach((index) => {
      var _a;
      (((_a = index.fields) === null || _a === void 0 ? void 0 : _a.split(",")) || []).forEach((fieldName) => {
        serviceLayerFields.some((field) => {
          if (field.name.toLowerCase() === fieldName.toLowerCase()) {
            field.isUniqueIndex = true;
            return true;
          }
          else {
            return false;
          }
        });
      });
    });
    this.serviceUIDFields = serviceLayerFields
      .filter((field) => (field.type && _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__.u.includes(field.type)) || field.isUniqueIndex)
      .sort((a, b) => a.name.localeCompare(b.name));
    //Generate matched fields with serviceMatchFields
    this.serviceUIDFields.forEach((serviceFieldInfo) => {
      const matches = [];
      dataLayerFields.forEach((dataFieldInfo) => {
        if ((0,_append_63c5ce83_js__WEBPACK_IMPORTED_MODULE_4__.c)(serviceFieldInfo, dataFieldInfo)) {
          matches.push(dataFieldInfo.name);
        }
      });
      keyPairs[serviceFieldInfo.name] = {
        name: serviceFieldInfo.name,
        type: serviceFieldInfo.type,
        idx: 0,
        isUniqueIndex: serviceFieldInfo === null || serviceFieldInfo === void 0 ? void 0 : serviceFieldInfo.isUniqueIndex,
        possibleMatches: [_append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__.N, ...matches],
        disabled: true
      };
    });
    this.finalKeyPairs = Object.assign({ "<None>": { name: _append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__.N, type: "None", possibleMatches: [_append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__.N] } }, keyPairs);
    this.selectedKeyPair = (_a = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.uidPair) !== null && _a !== void 0 ? _a : this.finalKeyPairs[_append_58a7e7ab_js__WEBPACK_IMPORTED_MODULE_2__.N];
    _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a.serviceUIDFields = this.serviceUIDFields; //Do not include these fields in following match-fields table.
  }
  render() {
    const { error, i18n, isEnterprise, timezoneDescription } = this;
    const { addAppendSelectOption, backupLayerFields } = _add_item_97d577a9_js__WEBPACK_IMPORTED_MODULE_1__.a;
    const isAddWorkflow = addAppendSelectOption === "add";
    const hasDate = backupLayerFields === null || backupLayerFields === void 0 ? void 0 : backupLayerFields.some((field) => field.type === "esriFieldTypeDate");
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", null, !isAddWorkflow && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-append-key-value-pair", { class: "key-value-pair", keyPairs: this.finalKeyPairs, onKeyPairChange: this.handleKeyPairChange })), hasDate && !isEnterprise && ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-label", null, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "timezone-header" }, i18n.timezoneHeader), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("div", { class: "timezone-wrapper" }, (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-timezone-dropdown", { class: "timezone", onTimezoneChange: this.handleTimezoneChange, defaultTimezone: this.selectedTimezone, subTitle: timezoneDescription })))), (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("arcgis-new-item-alert", { heading: error === null || error === void 0 ? void 0 : error.title, description: error === null || error === void 0 ? void 0 : error.message, active: !!error, kind: "danger", onAlertDismiss: () => (this.error = null) })));
  }
  get el() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
};
ArcgisNewItemPagesAppendKeyPairSelect.style = arcgisNewItemPagesAppendKeyPairSelectCss;




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLTIwYmZmZi5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ3VEOztBQUV2RCxxQkFBcUIscURBQVc7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWdHOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUNwQmhHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFNOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQ2pDck07QUFDQTtBQUNBO0FBQ0E7QUFDMkQ7QUFDSjtBQUNXO0FBQ0M7O0FBRW5FLGNBQWMsTUFBNkI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5REFBeUQsY0FBYztBQUN2RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVSxnSEFBZ0g7QUFDMUg7QUFDQSxVQUFVLG9CQUFvQjtBQUM5QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNB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QkFBd0IscURBQUMsVUFBVSwyQkFBMkIsRUFBRSxxREFBQyx3Q0FBd0MsdUlBQXVJLE1BQU0scURBQUMsNEJBQTRCLDBOQUEwTjtBQUN6d0I7QUFDQSxhQUFhLE9BQU8scURBQVU7QUFDOUI7QUFDQTs7QUFFaUciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hZGQtaXRlbS05N2Q1NzdhOS5qcyIsIndlYnBhY2s6Ly9leGItY2xpZW50Ly4vZXh0ZW5zaW9ucy93aWRnZXRzL2FyY2dpcy9hbmFseXNpcy9ub2RlX21vZHVsZXMvQGFyY2dpcy9hcHAtY29tcG9uZW50cy9kaXN0L2VzbS9hcHBlbmQtNThhN2U3YWIuanMiLCJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vYXBwZW5kLTYzYzVjZTgzLmpzIiwid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FuYWx5c2lzL25vZGVfbW9kdWxlcy9AYXJjZ2lzL2FwcC1jb21wb25lbnRzL2Rpc3QvZXNtL2FyY2dpcy1uZXctaXRlbS1wYWdlcy1hcHBlbmQta2V5LXBhaXItc2VsZWN0LmVudHJ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVTdG9yZSB9IGZyb20gJy4vaW5kZXgtODFkNTQ4YjcuanMnO1xuXG5jb25zdCBhZGRJdGVtU3RvcmUgPSBjcmVhdGVTdG9yZSh7XG4gIHR5cGVLZXl3b3JkczogW10sXG4gIGN1c3RvbVBhcmFtZXRlcnM6IFtdLFxuICBhbmFseXplZExvY2F0aW9uVHlwZXM6IFtdLFxuICBhbGxvd1N0b3JlZEF1dGg6IHRydWUsXG4gIGlzU2VjdXJlZDogbnVsbCxcbiAgY2hlY2tBdXRoOiBmYWxzZVxufSk7XG4vLyBFbnRpcmUgYWRkIGl0ZW0gc3RhdGUgb2JqZWN0XG5jb25zdCBhZGRJdGVtU3RhdGUgPSBhZGRJdGVtU3RvcmUuc3RhdGU7XG4vLyBTdWJzZXRzIG9mIGFkZCBpdGVtIHN0YXRlXG5jb25zdCBhZGRJdGVtUmVxdWVzdFN0YXRlID0gYWRkSXRlbVN0b3JlLnN0YXRlO1xuY29uc3QgYWRkSXRlbVVybFN0YXRlID0gYWRkSXRlbVN0b3JlLnN0YXRlO1xuXG5leHBvcnQgeyBhZGRJdGVtU3RhdGUgYXMgYSwgYWRkSXRlbVVybFN0YXRlIGFzIGIsIGFkZEl0ZW1SZXF1ZXN0U3RhdGUgYXMgYywgYWRkSXRlbVN0b3JlIGFzIGQgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuY29uc3QgdWlkRmllbGRzID0gW1wiZXNyaUZpZWxkVHlwZU9JRFwiLCBcImVzcmlGaWVsZFR5cGVHbG9iYWxJRFwiXTtcbmNvbnN0IE5PTkVfVkFMVUUgPSBcIjxOb25lPlwiO1xuY29uc3QgQXBwZW5kT3ZlcndyaXRlUHVibGlzaFR5cGVzID0ge1xuICBcImZpbGUgZ2VvZGF0YWJhc2VcIjogXCJmaWxlZ2VvZGF0YWJhc2VcIixcbiAgc2hhcGVmaWxlOiBcInNoYXBlZmlsZVwiLFxuICBnZW9qc29uOiBcImdlb2pzb25cIixcbiAgY3N2OiBcIkNTVlwiLFxuICBcIm1pY3Jvc29mdCBleGNlbFwiOiBcImV4Y2VsXCIsXG4gIGdlb3BhY2thZ2U6IFwiZ2VvUGFja2FnZVwiXG59O1xuY29uc3QgYXBwZW5kRmlsZVR5cGVzID0ge1xuICBTaGFwZWZpbGU6IFwic2hhcGVmaWxlXCIsXG4gIFwiRmlsZSBHZW9kYXRhYmFzZVwiOiBcImZpbGVHZW9kYXRhYmFzZVwiLFxuICBDU1Y6IFwiY3N2XCIsXG4gIFwiTWljcm9zb2Z0IEV4Y2VsXCI6IFwiZXhjZWxcIixcbiAgR2VvSnNvbjogXCJnZW9qc29uXCIsXG4gIEdlb1BhY2thZ2U6IFwiZ2VvUGFja2FnZVwiXG59O1xuY29uc3QgQXBwZW5kT3ZlcndyaXRlQ2xvdWRQdWJsaXNoVHlwZXMgPSB7XG4gIGNzdjogXCJDU1ZcIixcbiAgZXhjZWw6IFwiTWljcm9zb2Z0IEV4Y2VsXCIsXG4gIHNoYXBlZmlsZTogXCJTaGFwZWZpbGVcIixcbiAgZmdkYjogXCJGaWxlIEdlb2RhdGFiYXNlXCIsXG4gIGdlb2pzb246IFwiR2VvSnNvblwiLFxuICBnb29nbGVzaGVldHM6IFwiTWljcm9zb2Z0IEV4Y2VsXCJcbn07XG5jb25zdCBhcHBlbmRFeHRlbnNpb25zID0gW1wiemlwXCIsIFwiY3N2XCIsIFwieGxzXCIsIFwieGxzeFwiLCBcImdlb2pzb25cIiwgXCJncGtnXCIsIFwianNvblwiXTtcbmNvbnN0IGFwcGVuZEV4dGVuc2lvbnNGb3JFbnRlcnByaXNlID0gW1wiemlwXCIsIFwiY3N2XCIsIFwieGxzXCIsIFwieGxzeFwiXTtcblxuZXhwb3J0IHsgQXBwZW5kT3ZlcndyaXRlQ2xvdWRQdWJsaXNoVHlwZXMgYXMgQSwgTk9ORV9WQUxVRSBhcyBOLCBhcHBlbmRGaWxlVHlwZXMgYXMgYSwgQXBwZW5kT3ZlcndyaXRlUHVibGlzaFR5cGVzIGFzIGIsIGFwcGVuZEV4dGVuc2lvbnNGb3JFbnRlcnByaXNlIGFzIGMsIGFwcGVuZEV4dGVuc2lvbnMgYXMgZCwgdWlkRmllbGRzIGFzIHUgfTtcbiIsIi8qIVxuICogQWxsIG1hdGVyaWFsIGNvcHlyaWdodCBFU1JJLCBBbGwgUmlnaHRzIFJlc2VydmVkLCB1bmxlc3Mgb3RoZXJ3aXNlIHNwZWNpZmllZC5cbiAqIHYzLjAuOTlcbiAqL1xuaW1wb3J0IHsgYSBhcyBhZGRJdGVtU3RhdGUgfSBmcm9tICcuL2FkZC1pdGVtLTk3ZDU3N2E5LmpzJztcbmltcG9ydCB7IE4gYXMgTk9ORV9WQUxVRSB9IGZyb20gJy4vYXBwZW5kLTU4YTdlN2FiLmpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QW5hbHl6ZWRMYXllckluZm8gfSBmcm9tICcuL2dlb2NvZGUtN2ViN2MwZGYuanMnO1xuaW1wb3J0IHsgYSBhcyBhZGRDcmVhdGVJdGVtVHlwZXMgfSBmcm9tICcuL2l0ZW0tdHlwZXMtYjRmZTg2YWQuanMnO1xuXG52YXIgX19yZXN0ID0gKHVuZGVmaW5lZCAmJiB1bmRlZmluZWQuX19yZXN0KSB8fCBmdW5jdGlvbiAocywgZSkge1xuICB2YXIgdCA9IHt9O1xuICBmb3IgKHZhciBwIGluIHMpIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwocywgcCkgJiYgZS5pbmRleE9mKHApIDwgMClcbiAgICB0W3BdID0gc1twXTtcbiAgaWYgKHMgIT0gbnVsbCAmJiB0eXBlb2YgT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyA9PT0gXCJmdW5jdGlvblwiKVxuICAgIGZvciAodmFyIGkgPSAwLCBwID0gT2JqZWN0LmdldE93blByb3BlcnR5U3ltYm9scyhzKTsgaSA8IHAubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChlLmluZGV4T2YocFtpXSkgPCAwICYmIE9iamVjdC5wcm90b3R5cGUucHJvcGVydHlJc0VudW1lcmFibGUuY2FsbChzLCBwW2ldKSlcbiAgICAgICAgdFtwW2ldXSA9IHNbcFtpXV07XG4gICAgfVxuICByZXR1cm4gdDtcbn07XG5mdW5jdGlvbiBjYW5NYXRjaEZpZWxkKGZpZWxkLCBtYXRjaEZpZWxkKSB7XG4gIHZhciBfYTtcbiAgY29uc3QgZmllbGRUeXBlID0gKGZpZWxkID09PSBudWxsIHx8IGZpZWxkID09PSB2b2lkIDAgPyB2b2lkIDAgOiBmaWVsZC50eXBlKSB8fCBudWxsO1xuICBjb25zdCBtYXRjaEZpZWxkVHlwZSA9IChtYXRjaEZpZWxkID09PSBudWxsIHx8IG1hdGNoRmllbGQgPT09IHZvaWQgMCA/IHZvaWQgMCA6IG1hdGNoRmllbGQudHlwZSkgfHwgbnVsbDtcbiAgY29uc3QgbWF0Y2hGaWVsZHMgPSB7XG4gICAgZXNyaUZpZWxkVHlwZVNtYWxsSW50ZWdlcjogW1wiZXNyaUZpZWxkVHlwZVNtYWxsSW50ZWdlclwiXSxcbiAgICBlc3JpRmllbGRUeXBlSW50ZWdlcjogW1wiZXNyaUZpZWxkVHlwZUludGVnZXJcIiwgXCJlc3JpRmllbGRUeXBlU21hbGxJbnRlZ2VyXCJdLFxuICAgIGVzcmlGaWVsZFR5cGVTaW5nbGU6IFtcImVzcmlGaWVsZFR5cGVTaW5nbGVcIiwgXCJlc3JpRmllbGRUeXBlRG91YmxlXCJdLFxuICAgIGVzcmlGaWVsZFR5cGVEb3VibGU6IFtcbiAgICAgIFwiZXNyaUZpZWxkVHlwZURvdWJsZVwiLFxuICAgICAgXCJlc3JpRmllbGRUeXBlU2luZ2xlXCIsXG4gICAgICBcImVzcmlGaWVsZFR5cGVJbnRlZ2VyXCIsXG4gICAgICBcImVzcmlGaWVsZFR5cGVTbWFsbEludGVnZXJcIlxuICAgIF0sXG4gICAgZXNyaUZpZWxkVHlwZURhdGU6IFtcImVzcmlGaWVsZFR5cGVEYXRlXCJdLFxuICAgIGVzcmlGaWVsZFR5cGVTdHJpbmc6IFtcbiAgICAgIFwiZXNyaUZpZWxkVHlwZVN0cmluZ1wiLFxuICAgICAgXCJlc3JpRmllbGRUeXBlU21hbGxJbnRlZ2VyXCIsXG4gICAgICBcImVzcmlGaWVsZFR5cGVJbnRlZ2VyXCIsXG4gICAgICBcImVzcmlGaWVsZFR5cGVTaW5nbGVcIixcbiAgICAgIFwiZXNyaUZpZWxkVHlwZURvdWJsZVwiLFxuICAgICAgXCJlc3JpRmllbGRUeXBlRGF0ZVwiLFxuICAgICAgXCJlc3JpRmllbGRUeXBlR1VJRFwiXG4gICAgXSxcbiAgICBlc3JpRmllbGRUeXBlR1VJRDogW1wiZXNyaUZpZWxkVHlwZUdVSURcIiwgXCJlc3JpRmllbGRUeXBlU3RyaW5nXCJdLFxuICAgIGVzcmlGaWVsZFR5cGVPSUQ6IFtcImVzcmlGaWVsZFR5cGVPSURcIiwgXCJlc3JpRmllbGRUeXBlU21hbGxJbnRlZ2VyXCIsIFwiZXNyaUZpZWxkVHlwZUludGVnZXJcIl0sXG4gICAgZXNyaUZpZWxkVHlwZUdsb2JhbElEOiBbXCJlc3JpRmllbGRUeXBlR2xvYmFsSURcIiwgXCJlc3JpRmllbGRUeXBlR1VJRFwiLCBcImVzcmlGaWVsZFR5cGVTdHJpbmdcIl0sXG4gICAgZXNyaUZpZWxkVHlwZURhdGVPbmx5OiBbXCJlc3JpRmllbGRUeXBlRGF0ZU9ubHlcIl0sXG4gICAgZXNyaUZpZWxkVHlwZVRpbWVPbmx5OiBbXCJlc3JpRmllbGRUeXBlVGltZU9ubHlcIl0sXG4gICAgZXNyaUZpZWxkVHlwZVRpbWVzdGFtcE9mZnNldDogW1wiZXNyaUZpZWxkVHlwZVRpbWVzdGFtcE9mZnNldFwiXSxcbiAgICBlc3JpRmllbGRUeXBlQmlnSW50ZWdlcjogW1wiZXNyaUZpZWxkVHlwZUJpZ0ludGVnZXJcIl1cbiAgfTtcbiAgcmV0dXJuIG1hdGNoRmllbGRUeXBlICYmIChtYXRjaEZpZWxkVHlwZSA9PT0gZmllbGRUeXBlIHx8ICgoX2EgPSBtYXRjaEZpZWxkc1tmaWVsZFR5cGVdKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EuaW5kZXhPZihtYXRjaEZpZWxkVHlwZSkpID4gLTEpO1xufVxuZnVuY3Rpb24gZ2V0QXBwZW5kUGFyYW1ldGVycyhhZGRJdGVtUHJvcHMpIHtcbiAgdmFyIF9hO1xuICBjb25zdCB7IHRpbWV6b25lLCBhbmFseXplUmVzdWx0cywgdHlwZSwgZmllbGRNYXBwaW5ncywgZGF0YUxheWVyLCBpZCwgdWlkUGFpciwgYWRkQXBwZW5kU2VsZWN0T3B0aW9uLCBzb3VyY2VEYXRhTGF5ZXIgfSA9IGFkZEl0ZW1Qcm9wcztcbiAgbGV0IGZpbmFsQXBwZW5kUGFyYW1ldGVycywgYXBwZW5kU291cmNlSW5mbztcbiAgY29uc3QgeyBwdWJsaXNoUGFyYW1ldGVycyB9ID0gYW5hbHl6ZVJlc3VsdHMsIHJlc3QgPSBfX3Jlc3QoYW5hbHl6ZVJlc3VsdHMsIFtcInB1Ymxpc2hQYXJhbWV0ZXJzXCJdKTtcbiAgY29uc3QgdXBzZXJ0ID0gYWRkQXBwZW5kU2VsZWN0T3B0aW9uID09PSBcInVwc2VydFwiIHx8IGFkZEFwcGVuZFNlbGVjdE9wdGlvbiA9PT0gXCJ1cGRhdGVcIjtcbiAgY29uc3QgZmluYWxGaWVsZE1hcHBpbmdzID0gZm9ybWF0RmllbGRNYXBwaW5ncyhmaWVsZE1hcHBpbmdzKTtcbiAgY29uc3QgYXBwZW5kRmllbGRzID0gY3JlYXRlQXBwZW5kRmllbGRzKGZpbmFsRmllbGRNYXBwaW5ncyk7XG4gIGNvbnN0IHRpbWV6b25lSW5mbyA9IHtcbiAgICBkYXRlRmllbGRzVGltZVJlZmVyZW5jZToge1xuICAgICAgdGltZVpvbmU6IHRpbWV6b25lIHx8IFwiVVRDXCIsXG4gICAgICByZXNwZWN0c0RheWxpZ2h0U2F2aW5nOiB0cnVlXG4gICAgfVxuICB9O1xuICBjb25zdCBkZWZhdWx0QXBwZW5kUGFyYW1zID0ge1xuICAgIHNvdXJjZVRhYmxlTmFtZTogZGF0YUxheWVyLm5hbWUsXG4gICAgZmllbGRNYXBwaW5nczogKGZpbmFsRmllbGRNYXBwaW5ncyA9PT0gbnVsbCB8fCBmaW5hbEZpZWxkTWFwcGluZ3MgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGZpbmFsRmllbGRNYXBwaW5ncy5sZW5ndGgpID8gSlNPTi5zdHJpbmdpZnkoZmluYWxGaWVsZE1hcHBpbmdzKSA6IG51bGwsXG4gICAgdXBzZXJ0LFxuICAgIHNraXBJbnNlcnRzOiBhZGRBcHBlbmRTZWxlY3RPcHRpb24gPT09IFwidXBkYXRlXCIsXG4gICAgc2tpcFVwZGF0ZXM6IGZhbHNlLFxuICAgIHVzZUdsb2JhbElkczogdXBzZXJ0ICYmICh1aWRQYWlyID09PSBudWxsIHx8IHVpZFBhaXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVpZFBhaXIudHlwZSkgPT09IFwiZXNyaUZpZWxkVHlwZUdsb2JhbElEXCIsXG4gICAgdXBkYXRlR2VvbWV0cnk6IHVwc2VydCA/IGFkZEl0ZW1TdGF0ZS5hZGRBcHBlbmRTZWxlY3RVcGRhdGVUeXBlT3B0aW9uID09PSBcImF0dHJpYnV0ZUFuZEdlb21ldHJ5XCIgOiB0cnVlLFxuICAgIGFwcGVuZEZpZWxkczogYXBwZW5kRmllbGRzLmxlbmd0aCA/IEpTT04uc3RyaW5naWZ5KGFwcGVuZEZpZWxkcykgOiBudWxsLFxuICAgIGFwcGVuZEl0ZW1JZDogaWQsXG4gICAgYXBwZW5kVXBsb2FkRm9ybWF0OiBhZGRDcmVhdGVJdGVtVHlwZXNbYWRkSXRlbVN0YXRlLnR5cGVdLmFwcGVuZFVwbG9hZEZvcm1hdCxcbiAgICByb2xsYmFja09uRmFpbHVyZTogdHJ1ZVxuICB9O1xuICBjb25zdCBwdWJsaXNoSW5mbyA9IF9fcmVzdChwdWJsaXNoUGFyYW1ldGVycywgW1wibGF5ZXJzXCJdKTtcbiAgaWYgKHR5cGUgPT09IFwiQ1NWXCIpIHtcbiAgICBwdWJsaXNoUGFyYW1ldGVycy5sYXllckluZm8uZGF0ZUZpZWxkc1RpbWVSZWZlcmVuY2UgPSB0aW1lem9uZUluZm8uZGF0ZUZpZWxkc1RpbWVSZWZlcmVuY2U7XG4gICAgYXBwZW5kU291cmNlSW5mbyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aW1lem9uZUluZm8pLCBwdWJsaXNoUGFyYW1ldGVycyksIHJlc3QpO1xuICB9XG4gIGVsc2UgaWYgKHR5cGUgPT09IFwiTWljcm9zb2Z0IEV4Y2VsXCIpIHtcbiAgICBjb25zdCBsYXllckluZm8gPSBnZXRBbmFseXplZExheWVySW5mbyh7fSwgdHJ1ZSk7XG4gICAgY29uc3QgZm9ybWF0dGVkTGF5ZXJJbmZvID0gZ2V0TGF5ZXJUb0FwcGVuZChsYXllckluZm8sIHB1Ymxpc2hJbmZvKTsgLy9VcGRhdGVkIGluZm8gbmVlZHMgdG8gYmUgYWRkZWQgdG8gdGhlIGxheWVycyBbXSByYXRoZXIgdGhhbiB0aGUgcm9vdCBmb3IgZXhjZWxcbiAgICBmb3JtYXR0ZWRMYXllckluZm8uZGF0ZUZpZWxkc1RpbWVSZWZlcmVuY2UgPSB0aW1lem9uZUluZm8uZGF0ZUZpZWxkc1RpbWVSZWZlcmVuY2U7XG4gICAgcHVibGlzaEluZm8ubmFtZSA9IGRhdGFMYXllci5uYW1lO1xuICAgIGFwcGVuZFNvdXJjZUluZm8gPSBPYmplY3QuYXNzaWduKE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aW1lem9uZUluZm8pLCB7IGxheWVyczogW2Zvcm1hdHRlZExheWVySW5mb10gfSksIHB1Ymxpc2hJbmZvKSwgcmVzdCk7XG4gIH1cbiAgZWxzZSB7XG4gICAgYXBwZW5kU291cmNlSW5mbyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbihPYmplY3QuYXNzaWduKHt9LCB0aW1lem9uZUluZm8pLCBwdWJsaXNoUGFyYW1ldGVycyksIHJlc3QpO1xuICB9XG4gIGZpbmFsQXBwZW5kUGFyYW1ldGVycyA9IE9iamVjdC5hc3NpZ24oT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdEFwcGVuZFBhcmFtcyksIHsgYXBwZW5kU291cmNlSW5mbzogSlNPTi5zdHJpbmdpZnkoYXBwZW5kU291cmNlSW5mbykgfSk7XG4gIGlmIChhZGRBcHBlbmRTZWxlY3RPcHRpb24gPT09IFwiYWRkXCIpIHtcbiAgICBmaW5hbEFwcGVuZFBhcmFtZXRlcnMudXBzZXJ0TWF0Y2hpbmdGaWVsZCA9IHNvdXJjZURhdGFMYXllci5vYmplY3RJZEZpZWxkIHx8ICgoX2EgPSBzb3VyY2VEYXRhTGF5ZXIudW5pcXVlRmllbGQpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5uYW1lKTtcbiAgfVxuICBlbHNlIHtcbiAgICBpZiAodXBzZXJ0ICYmICh1aWRQYWlyID09PSBudWxsIHx8IHVpZFBhaXIgPT09IHZvaWQgMCA/IHZvaWQgMCA6IHVpZFBhaXIuaXNVbmlxdWVJbmRleCkpIHtcbiAgICAgIGZpbmFsQXBwZW5kUGFyYW1ldGVycy51cHNlcnRNYXRjaGluZ0ZpZWxkID0gdWlkUGFpciA9PT0gbnVsbCB8fCB1aWRQYWlyID09PSB2b2lkIDAgPyB2b2lkIDAgOiB1aWRQYWlyLm5hbWU7XG4gICAgfVxuICB9XG4gIHJldHVybiBmaW5hbEFwcGVuZFBhcmFtZXRlcnM7XG59XG5mdW5jdGlvbiBnZXRMYXllclRvQXBwZW5kKGxheWVySW5mbywgdXBkYXRlZEluZm8pIHtcbiAgY29uc3QgZm9ybWF0dGVkTGF5ZXIgPSBPYmplY3QuYXNzaWduKHt9LCBsYXllckluZm8pO1xuICBmb3JtYXR0ZWRMYXllci5sb2NhdGlvblR5cGUgPSB1cGRhdGVkSW5mby5sb2NhdGlvblR5cGU7XG4gIGlmIChmb3JtYXR0ZWRMYXllci5sb2NhdGlvblR5cGUgPT09IFwiYWRkcmVzc1wiKSB7XG4gICAgZm9ybWF0dGVkTGF5ZXIuYWRkcmVzc0ZpZWxkcyA9IHVwZGF0ZWRJbmZvLmFkZHJlc3NGaWVsZHM7XG4gICAgZm9ybWF0dGVkTGF5ZXIuc291cmNlQ291bnRyeSA9IHVwZGF0ZWRJbmZvLnNvdXJjZUNvdW50cnk7XG4gIH1cbiAgZWxzZSBpZiAoZm9ybWF0dGVkTGF5ZXIubG9jYXRpb25UeXBlID09PSBcImNvb3JkaW5hdGVzXCIpIHtcbiAgICBmb3JtYXR0ZWRMYXllci5jb29yZGluYXRlRmllbGRUeXBlID0gdXBkYXRlZEluZm8uY29vcmRpbmF0ZUZpZWxkVHlwZTtcbiAgICBpZiAoZm9ybWF0dGVkTGF5ZXIuY29vcmRpbmF0ZUZpZWxkVHlwZSA9PT0gXCJMYXRpdHVkZUFuZExvbmdpdHVkZVwiKSB7XG4gICAgICBmb3JtYXR0ZWRMYXllci5sYXRpdHVkZUZpZWxkTmFtZSA9IHVwZGF0ZWRJbmZvLmxhdGl0dWRlRmllbGROYW1lO1xuICAgICAgZm9ybWF0dGVkTGF5ZXIubG9uZ2l0dWRlRmllbGROYW1lID0gdXBkYXRlZEluZm8ubG9uZ2l0dWRlRmllbGROYW1lO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIGZvcm1hdHRlZExheWVyLmNvb3JkaW5hdGVGaWVsZE5hbWUgPSB1cGRhdGVkSW5mby5jb29yZGluYXRlRmllbGROYW1lO1xuICAgIH1cbiAgfVxuICByZXR1cm4gZm9ybWF0dGVkTGF5ZXI7XG59XG5mdW5jdGlvbiBmb3JtYXRGaWVsZE1hcHBpbmdzKGZpZWxkTWFwcGluZ3MpIHtcbiAgY29uc3QgZmllbGRzID0gZmllbGRNYXBwaW5ncy5maWx0ZXIoKGZpZWxkTWFwcGluZykgPT4ge1xuICAgIHJldHVybiBmaWVsZE1hcHBpbmcuc291cmNlICE9PSBOT05FX1ZBTFVFO1xuICB9KTtcbiAgY29uc3QgZmluYWxGaWVsZE1hcHBpbmdzID0gZmllbGRzLm1hcCgoeyBzb3VyY2UsIG5hbWUgfSkgPT4ge1xuICAgIHJldHVybiB7IHNvdXJjZSwgbmFtZSB9O1xuICB9KTtcbiAgcmV0dXJuIGZpbmFsRmllbGRNYXBwaW5ncztcbn1cbmZ1bmN0aW9uIGNyZWF0ZUFwcGVuZEZpZWxkcyhmaWVsZE1hcHBpbmdzKSB7XG4gIGNvbnN0IGFwcGVuZEZpZWxkcyA9IGZpZWxkTWFwcGluZ3MubWFwKChtYXBwaW5nKSA9PiB7XG4gICAgcmV0dXJuIG1hcHBpbmcubmFtZTtcbiAgfSk7XG4gIHJldHVybiBhcHBlbmRGaWVsZHM7XG59XG5cbmV4cG9ydCB7IGNhbk1hdGNoRmllbGQgYXMgYywgZ2V0QXBwZW5kUGFyYW1ldGVycyBhcyBnIH07XG4iLCIvKiFcbiAqIEFsbCBtYXRlcmlhbCBjb3B5cmlnaHQgRVNSSSwgQWxsIFJpZ2h0cyBSZXNlcnZlZCwgdW5sZXNzIG90aGVyd2lzZSBzcGVjaWZpZWQuXG4gKiB2My4wLjk5XG4gKi9cbmltcG9ydCB7IHIgYXMgcmVnaXN0ZXJJbnN0YW5jZSwgYyBhcyBjcmVhdGVFdmVudCwgaCwgZCBhcyBnZXRFbGVtZW50IH0gZnJvbSAnLi9pbmRleC05MmViYjM5Ni5qcyc7XG5pbXBvcnQgeyBhIGFzIGFkZEl0ZW1TdGF0ZSB9IGZyb20gJy4vYWRkLWl0ZW0tOTdkNTc3YTkuanMnO1xuaW1wb3J0IHsgTiBhcyBOT05FX1ZBTFVFLCB1IGFzIHVpZEZpZWxkcyB9IGZyb20gJy4vYXBwZW5kLTU4YTdlN2FiLmpzJztcbmltcG9ydCB7IHUgYXMgdWlTdG9yZVN0YXRlIH0gZnJvbSAnLi91aS1lY2Y4NmJiYS5qcyc7XG5pbXBvcnQgeyBjIGFzIGNhbk1hdGNoRmllbGQgfSBmcm9tICcuL2FwcGVuZC02M2M1Y2U4My5qcyc7XG5pbXBvcnQgeyBjIGFzIGNvbmZpZ1N0YXRlIH0gZnJvbSAnLi9jb25maWctZWI1ZjdkYzIuanMnO1xuaW1wb3J0ICcuL2luZGV4LTgxZDU0OGI3LmpzJztcbmltcG9ydCAnLi9nZW9jb2RlLTdlYjdjMGRmLmpzJztcbmltcG9ydCAnLi9mdW5jdGlvbmFsLWM4MmY1YWI5LmpzJztcbmltcG9ydCAnLi9wcml2aWxlZ2VzLWNjZDVmMzdkLmpzJztcbmltcG9ydCAnLi9wcml2aWxlZ2VzLTM1NTkwZWI0LmpzJztcbmltcG9ydCAnLi9wb3J0YWwtNzljYWFlZmYuanMnO1xuaW1wb3J0ICcuL2xvYWRNb2R1bGVzLWFhZjMwYmQ2LmpzJztcbmltcG9ydCAnLi9pdGVtLXR5cGVzLWI0ZmU4NmFkLmpzJztcblxuY29uc3QgYXJjZ2lzTmV3SXRlbVBhZ2VzQXBwZW5kS2V5UGFpclNlbGVjdENzcyA9IFwiLnRpbWV6b25lLXdyYXBwZXJ7YmFja2dyb3VuZC1jb2xvcjp2YXIoLS1jYWxjaXRlLXVpLWJhY2tncm91bmQpO3BhZGRpbmctbGVmdDoxcmVtfS50aW1lem9uZXtkaXNwbGF5OmJsb2NrO21hcmdpbi1ib3R0b206MC43NXJlbTstd2Via2l0LW1hcmdpbi1lbmQ6Mi41cmVtO21hcmdpbi1pbmxpbmUtZW5kOjIuNXJlbX0udGltZXpvbmUtaGVhZGVye2NvbG9yOnZhcigtLWNhbGNpdGUtdWktdGV4dC0xKTtmb250LXNpemU6MXJlbTtmb250LXdlaWdodDo1MDB9XCI7XG5cbmNvbnN0IEFyY2dpc05ld0l0ZW1QYWdlc0FwcGVuZEtleVBhaXJTZWxlY3QgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgIHRoaXMubmV3SXRlbVVwZGF0ZVBhZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcIm5ld0l0ZW1VcGRhdGVQYWdlXCIsIDcpO1xuICAgIHRoaXMubmV3SXRlbVByZXZQYWdlID0gY3JlYXRlRXZlbnQodGhpcywgXCJuZXdJdGVtUHJldlBhZ2VcIiwgNyk7XG4gICAgdGhpcy53b3JrZmxvd0NvbXBsZXRlID0gY3JlYXRlRXZlbnQodGhpcywgXCJ3b3JrZmxvd0NvbXBsZXRlXCIsIDcpO1xuICAgIHRoaXMuaGFuZGxlVGltZXpvbmVDaGFuZ2UgPSAoZXZlbnQpID0+IHtcbiAgICAgIHRoaXMuc2VsZWN0ZWRUaW1lem9uZSA9IGV2ZW50LmRldGFpbDtcbiAgICB9O1xuICAgIHRoaXMuaGFuZGxlS2V5UGFpckNoYW5nZSA9IChldmVudCkgPT4ge1xuICAgICAgdGhpcy5zZWxlY3RlZEtleVBhaXIgPSBldmVudC5kZXRhaWw7XG4gICAgfTtcbiAgICB0aGlzLmkxOG4gPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zZWxlY3RlZEtleVBhaXIgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5zZWxlY3RlZFRpbWV6b25lID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuZXJyb3IgPSB1bmRlZmluZWQ7XG4gIH1cbiAgaGFuZGxlTmV4dCgpIHtcbiAgICBpZiAoYWRkSXRlbVN0YXRlLmFkZEFwcGVuZFNlbGVjdE9wdGlvbiAhPT0gXCJhZGRcIikge1xuICAgICAgaWYgKE9iamVjdC52YWx1ZXModGhpcy5zZWxlY3RlZEtleVBhaXIpLmluY2x1ZGVzKE5PTkVfVkFMVUUpKSB7XG4gICAgICAgIHRoaXMuZXJyb3IgPSB7IHRpdGxlOiB1aVN0b3JlU3RhdGUuaTE4bi5lcnJvciwgbWVzc2FnZTogdGhpcy5pMThuLm5vS2V5UGFpciB9OyAvL0tleSBwYWlyIG11c3QgYmUgc2VsZWN0ZWQgdG8gdXBkYXRlIGRhdGEuXG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGFkZEl0ZW1TdGF0ZS51aWRQYWlyID0gdGhpcy5zZWxlY3RlZEtleVBhaXI7XG4gICAgfVxuICAgIGFkZEl0ZW1TdGF0ZS50aW1lem9uZSA9IHRoaXMuc2VsZWN0ZWRUaW1lem9uZTtcbiAgICB0aGlzLm5ld0l0ZW1VcGRhdGVQYWdlLmVtaXQoXCJhcHBlbmRNYXRjaEZpZWxkc1wiKTtcbiAgfVxuICBhc3luYyBoYW5kbGVQcmV2KGV2ZW50KSB7XG4gICAgdmFyIF9hO1xuICAgIGlmICghKCgoX2EgPSBhZGRJdGVtU3RhdGUuYW5hbHl6ZVJlc3VsdHMucHVibGlzaFBhcmFtZXRlcnMubGF5ZXJzKSA9PT0gbnVsbCB8fCBfYSA9PT0gdm9pZCAwID8gdm9pZCAwIDogX2EubGVuZ3RoKSA+IDEpKSB7XG4gICAgICAvL2l0ZW0gaXMgZGVsZXRlZCBvbiBhcHBlbmRTZWxlY3RMYXllclxuICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIGFkZEl0ZW1TdGF0ZS51aWRQYWlyID0gbnVsbDtcbiAgICAgIHRoaXMubmV3SXRlbVByZXZQYWdlLmVtaXQoKTtcbiAgICB9XG4gIH1cbiAgY29tcG9uZW50V2lsbExvYWQoKSB7XG4gICAgdmFyIF9hO1xuICAgIGNvbnN0IHsgZXhpc3RpbmdJdGVtLCBkYXRlRmllbGRzVGltZVJlZmVyZW5jZSwgb3JpZ2luYWxGaWxlTmFtZSB9ID0gYWRkSXRlbVN0YXRlO1xuICAgIHRoaXMuaTE4biA9IHVpU3RvcmVTdGF0ZS5pMThuLmFwcGVuZEtleVZhbHVlUGFpcjtcbiAgICB0aGlzLnNlcnZpY2VMYXllciA9IGFkZEl0ZW1TdGF0ZS5zb3VyY2VEYXRhTGF5ZXI7XG4gICAgdGhpcy5zZWxlY3RlZFRpbWV6b25lID0gKF9hID0gYWRkSXRlbVN0YXRlLnRpbWV6b25lKSAhPT0gbnVsbCAmJiBfYSAhPT0gdm9pZCAwID8gX2EgOiBcIlVUQ1wiO1xuICAgIHRoaXMudGltZXpvbmVEZXNjcmlwdGlvbiA9IHRoaXMuaTE4bi50aW1lem9uZURlc2NyaXB0aW9uXG4gICAgICAucmVwbGFjZShcIiR7dXBsb2FkZWRGaWxlTmFtZX1cIiwgb3JpZ2luYWxGaWxlTmFtZSlcbiAgICAgIC5yZXBsYWNlKFwiJHtmZWF0dXJlTGF5ZXJOYW1lfVwiLCBleGlzdGluZ0l0ZW0udGl0bGUpXG4gICAgICAucmVwbGFjZShcIiR7ZmVhdHVyZUxheWVyVGltZXpvbmV9XCIsIGRhdGVGaWVsZHNUaW1lUmVmZXJlbmNlLnRpbWVab25lKTtcbiAgICB0aGlzLmlzRW50ZXJwcmlzZSA9IGNvbmZpZ1N0YXRlLnBvcnRhbC5pc1BvcnRhbDtcbiAgICB0aGlzLmZpbmRLZXlQYWlycygpO1xuICB9XG4gIGZpbmRLZXlQYWlycygpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3Qga2V5UGFpcnMgPSB7fTtcbiAgICBjb25zdCBzZXJ2aWNlTGF5ZXJGaWVsZHMgPSB0aGlzLnNlcnZpY2VMYXllci5maWVsZHMgfHwgW107XG4gICAgY29uc3QgaW5kZXhlcyA9IHRoaXMuc2VydmljZUxheWVyLmluZGV4ZXMgfHwgW107XG4gICAgY29uc3QgZGF0YUxheWVyRmllbGRzID0gYWRkSXRlbVN0YXRlLmJhY2t1cExheWVyRmllbGRzO1xuICAgIGluZGV4ZXNcbiAgICAgIC5maWx0ZXIoKGlkeCkgPT4gaWR4ID09PSBudWxsIHx8IGlkeCA9PT0gdm9pZCAwID8gdm9pZCAwIDogaWR4LmlzVW5pcXVlKVxuICAgICAgLmZvckVhY2goKGluZGV4KSA9PiB7XG4gICAgICB2YXIgX2E7XG4gICAgICAoKChfYSA9IGluZGV4LmZpZWxkcykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNwbGl0KFwiLFwiKSkgfHwgW10pLmZvckVhY2goKGZpZWxkTmFtZSkgPT4ge1xuICAgICAgICBzZXJ2aWNlTGF5ZXJGaWVsZHMuc29tZSgoZmllbGQpID0+IHtcbiAgICAgICAgICBpZiAoZmllbGQubmFtZS50b0xvd2VyQ2FzZSgpID09PSBmaWVsZE5hbWUudG9Mb3dlckNhc2UoKSkge1xuICAgICAgICAgICAgZmllbGQuaXNVbmlxdWVJbmRleCA9IHRydWU7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICB9XG4gICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIHRoaXMuc2VydmljZVVJREZpZWxkcyA9IHNlcnZpY2VMYXllckZpZWxkc1xuICAgICAgLmZpbHRlcigoZmllbGQpID0+IChmaWVsZC50eXBlICYmIHVpZEZpZWxkcy5pbmNsdWRlcyhmaWVsZC50eXBlKSkgfHwgZmllbGQuaXNVbmlxdWVJbmRleClcbiAgICAgIC5zb3J0KChhLCBiKSA9PiBhLm5hbWUubG9jYWxlQ29tcGFyZShiLm5hbWUpKTtcbiAgICAvL0dlbmVyYXRlIG1hdGNoZWQgZmllbGRzIHdpdGggc2VydmljZU1hdGNoRmllbGRzXG4gICAgdGhpcy5zZXJ2aWNlVUlERmllbGRzLmZvckVhY2goKHNlcnZpY2VGaWVsZEluZm8pID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBbXTtcbiAgICAgIGRhdGFMYXllckZpZWxkcy5mb3JFYWNoKChkYXRhRmllbGRJbmZvKSA9PiB7XG4gICAgICAgIGlmIChjYW5NYXRjaEZpZWxkKHNlcnZpY2VGaWVsZEluZm8sIGRhdGFGaWVsZEluZm8pKSB7XG4gICAgICAgICAgbWF0Y2hlcy5wdXNoKGRhdGFGaWVsZEluZm8ubmFtZSk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAga2V5UGFpcnNbc2VydmljZUZpZWxkSW5mby5uYW1lXSA9IHtcbiAgICAgICAgbmFtZTogc2VydmljZUZpZWxkSW5mby5uYW1lLFxuICAgICAgICB0eXBlOiBzZXJ2aWNlRmllbGRJbmZvLnR5cGUsXG4gICAgICAgIGlkeDogMCxcbiAgICAgICAgaXNVbmlxdWVJbmRleDogc2VydmljZUZpZWxkSW5mbyA9PT0gbnVsbCB8fCBzZXJ2aWNlRmllbGRJbmZvID09PSB2b2lkIDAgPyB2b2lkIDAgOiBzZXJ2aWNlRmllbGRJbmZvLmlzVW5pcXVlSW5kZXgsXG4gICAgICAgIHBvc3NpYmxlTWF0Y2hlczogW05PTkVfVkFMVUUsIC4uLm1hdGNoZXNdLFxuICAgICAgICBkaXNhYmxlZDogdHJ1ZVxuICAgICAgfTtcbiAgICB9KTtcbiAgICB0aGlzLmZpbmFsS2V5UGFpcnMgPSBPYmplY3QuYXNzaWduKHsgXCI8Tm9uZT5cIjogeyBuYW1lOiBOT05FX1ZBTFVFLCB0eXBlOiBcIk5vbmVcIiwgcG9zc2libGVNYXRjaGVzOiBbTk9ORV9WQUxVRV0gfSB9LCBrZXlQYWlycyk7XG4gICAgdGhpcy5zZWxlY3RlZEtleVBhaXIgPSAoX2EgPSBhZGRJdGVtU3RhdGUudWlkUGFpcikgIT09IG51bGwgJiYgX2EgIT09IHZvaWQgMCA/IF9hIDogdGhpcy5maW5hbEtleVBhaXJzW05PTkVfVkFMVUVdO1xuICAgIGFkZEl0ZW1TdGF0ZS5zZXJ2aWNlVUlERmllbGRzID0gdGhpcy5zZXJ2aWNlVUlERmllbGRzOyAvL0RvIG5vdCBpbmNsdWRlIHRoZXNlIGZpZWxkcyBpbiBmb2xsb3dpbmcgbWF0Y2gtZmllbGRzIHRhYmxlLlxuICB9XG4gIHJlbmRlcigpIHtcbiAgICBjb25zdCB7IGVycm9yLCBpMThuLCBpc0VudGVycHJpc2UsIHRpbWV6b25lRGVzY3JpcHRpb24gfSA9IHRoaXM7XG4gICAgY29uc3QgeyBhZGRBcHBlbmRTZWxlY3RPcHRpb24sIGJhY2t1cExheWVyRmllbGRzIH0gPSBhZGRJdGVtU3RhdGU7XG4gICAgY29uc3QgaXNBZGRXb3JrZmxvdyA9IGFkZEFwcGVuZFNlbGVjdE9wdGlvbiA9PT0gXCJhZGRcIjtcbiAgICBjb25zdCBoYXNEYXRlID0gYmFja3VwTGF5ZXJGaWVsZHMgPT09IG51bGwgfHwgYmFja3VwTGF5ZXJGaWVsZHMgPT09IHZvaWQgMCA/IHZvaWQgMCA6IGJhY2t1cExheWVyRmllbGRzLnNvbWUoKGZpZWxkKSA9PiBmaWVsZC50eXBlID09PSBcImVzcmlGaWVsZFR5cGVEYXRlXCIpO1xuICAgIHJldHVybiAoaChcImRpdlwiLCBudWxsLCAhaXNBZGRXb3JrZmxvdyAmJiAoaChcImFyY2dpcy1uZXctaXRlbS1hcHBlbmQta2V5LXZhbHVlLXBhaXJcIiwgeyBjbGFzczogXCJrZXktdmFsdWUtcGFpclwiLCBrZXlQYWlyczogdGhpcy5maW5hbEtleVBhaXJzLCBvbktleVBhaXJDaGFuZ2U6IHRoaXMuaGFuZGxlS2V5UGFpckNoYW5nZSB9KSksIGhhc0RhdGUgJiYgIWlzRW50ZXJwcmlzZSAmJiAoaChcImNhbGNpdGUtbGFiZWxcIiwgbnVsbCwgaChcImRpdlwiLCB7IGNsYXNzOiBcInRpbWV6b25lLWhlYWRlclwiIH0sIGkxOG4udGltZXpvbmVIZWFkZXIpLCBoKFwiZGl2XCIsIHsgY2xhc3M6IFwidGltZXpvbmUtd3JhcHBlclwiIH0sIGgoXCJhcmNnaXMtbmV3LWl0ZW0tdGltZXpvbmUtZHJvcGRvd25cIiwgeyBjbGFzczogXCJ0aW1lem9uZVwiLCBvblRpbWV6b25lQ2hhbmdlOiB0aGlzLmhhbmRsZVRpbWV6b25lQ2hhbmdlLCBkZWZhdWx0VGltZXpvbmU6IHRoaXMuc2VsZWN0ZWRUaW1lem9uZSwgc3ViVGl0bGU6IHRpbWV6b25lRGVzY3JpcHRpb24gfSkpKSksIGgoXCJhcmNnaXMtbmV3LWl0ZW0tYWxlcnRcIiwgeyBoZWFkaW5nOiBlcnJvciA9PT0gbnVsbCB8fCBlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXJyb3IudGl0bGUsIGRlc2NyaXB0aW9uOiBlcnJvciA9PT0gbnVsbCB8fCBlcnJvciA9PT0gdm9pZCAwID8gdm9pZCAwIDogZXJyb3IubWVzc2FnZSwgYWN0aXZlOiAhIWVycm9yLCBraW5kOiBcImRhbmdlclwiLCBvbkFsZXJ0RGlzbWlzczogKCkgPT4gKHRoaXMuZXJyb3IgPSBudWxsKSB9KSkpO1xuICB9XG4gIGdldCBlbCgpIHsgcmV0dXJuIGdldEVsZW1lbnQodGhpcyk7IH1cbn07XG5BcmNnaXNOZXdJdGVtUGFnZXNBcHBlbmRLZXlQYWlyU2VsZWN0LnN0eWxlID0gYXJjZ2lzTmV3SXRlbVBhZ2VzQXBwZW5kS2V5UGFpclNlbGVjdENzcztcblxuZXhwb3J0IHsgQXJjZ2lzTmV3SXRlbVBhZ2VzQXBwZW5kS2V5UGFpclNlbGVjdCBhcyBhcmNnaXNfbmV3X2l0ZW1fcGFnZXNfYXBwZW5kX2tleV9wYWlyX3NlbGVjdCB9O1xuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9