"use strict";
(self["webpackChunkexb_client"] = self["webpackChunkexb_client"] || []).push([["extensions_widgets_arcgis_analysis_node_modules_arcgis_app-components_dist_esm_arcgis-lazy-lo-5b7d4e"],{

/***/ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-lazy-loading-select.entry.js":
/*!*****************************************************************************************************************************!*\
  !*** ./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/arcgis-lazy-loading-select.entry.js ***!
  \*****************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   arcgis_lazy_loading_select: () => (/* binding */ ArcgisLazyLoadingSelect)
/* harmony export */ });
/* harmony import */ var _index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./index-92ebb396.js */ "./extensions/widgets/arcgis/analysis/node_modules/@arcgis/app-components/dist/esm/index-92ebb396.js");
/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * v3.0.99
 */


const arcgisLazyLoadingSelectCss = ":host{width:100%;overflow:hidden}.lazy-select-button{--calcite-ui-foreground-3:var(--calcite-ui-border-input)}";

const ArcgisLazyLoadingSelect = class {
  constructor(hostRef) {
    (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.r)(this, hostRef);
    this.arcgisLazyLoadingSelectChange = (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.c)(this, "arcgisLazyLoadingSelectChange", 7);
    this.handleOutsideClick = (event) => {
      if (!this.open) {
        return;
      }
      // when list has single item, simply close
      if (this.list.length > 1) {
        const paths = event.composedPath();
        if (paths.includes(this.hostElement) || paths.includes(this.menuPopOver)) {
          return;
        }
      }
      this.closeMenuPopOverAndDisconnectHandles();
    };
    this.handleResize = () => this.open && this.closeMenuPopOverAndDisconnectHandles();
    this.list = undefined;
    this.selectedIndex = 0;
    this.containerTop = 0;
    this.containerBottom = undefined;
    this.pageSize = 500;
    this.accumulatePages = true;
    this.strings = undefined;
    this.ariaLabeledBy = undefined;
    this.showFilterLength = 20;
    this.pageId = 0;
    this.open = false;
  }
  watchSelectedIndex(newValue) {
    if (this.menuPopOver) {
      this.menuPopOver.selectedIndex = newValue;
    }
  }
  watchPageSize(newValue) {
    if (this.menuPopOver) {
      this.menuPopOver.pageSize = newValue;
    }
  }
  //--------------------------------------------------------------------------
  //
  //  Lifecycle
  //
  //--------------------------------------------------------------------------
  disconnectedCallback() {
    this.closeMenuPopOverAndDisconnectHandles();
  }
  // --------------------------------------------------------------------------
  //
  //  Render Methods
  //
  //--------------------------------------------------------------------------
  render() {
    var _a;
    const { selectedIndex, list } = this;
    const selected = selectedIndex >= list.length ? list[0] : list[selectedIndex];
    return ((0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.h)("calcite-button", { scale: "s", width: "full", appearance: "outline-fill", kind: this.open ? "brand" : "neutral", class: this.open ? undefined : "lazy-select-button", alignment: "icon-end-space-between", iconEnd: this.open ? "chevron-up" : "chevron-down", "aria-haspopup": "true", "aria-expanded": this.open ? "true" : "false", "aria-label": this.ariaLabeledBy ? undefined : (_a = this.strings) === null || _a === void 0 ? void 0 : _a.selectLabel, "aria-labelledby": this.ariaLabeledBy || undefined, onClick: () => this.renderSelectMenu(), ref: (node) => (this.refNode = node) }, selected.label));
  }
  renderSelectMenu() {
    if (this.menuPopOver) {
      this.closeMenuPopOverAndDisconnectHandles();
      return;
    }
    this.open = true;
    document.addEventListener("pointerdown", this.handleOutsideClick);
    window.addEventListener("resize", this.handleOutsideClick);
    const menuPopOver = document.createElement("arcgis-lazy-loading-list");
    const { height: hostHeight, top: hostTop } = this.hostElement.getBoundingClientRect();
    const { width, left, bottom, top, height: triggerHeight } = this.refNode.getBoundingClientRect();
    const height = hostHeight - triggerHeight - (bottom - hostTop);
    menuPopOver.popoverProps = {
      width,
      left,
      top,
      bottom,
      height,
      containerTop: this.containerTop,
      containerBottom: this.containerBottom
    };
    // fly out to the root container is good when the list requires container wider element that goes beyond select's controller,
    // it's visible without horizontal scrolling, similar to browser's native select control.
    menuPopOver.flyOut = true;
    menuPopOver.strings = this.strings;
    menuPopOver.showFilter = this.list.length >= this.showFilterLength;
    menuPopOver.pageSize = this.pageSize;
    menuPopOver.accumulatePages = this.accumulatePages;
    this.menuPopOver = menuPopOver;
    menuPopOver.addEventListener("arcgisLazyLoadingListChange", (evt) => {
      this.selectedIndex = evt.detail.selectedIndex;
      this.arcgisLazyLoadingSelectChange.emit(evt.detail);
      this.closeMenuPopOverAndDisconnectHandles();
    });
    document.body.appendChild(menuPopOver);
    this.menuPopOver.list = this.list;
    this.menuPopOver.selectedIndex = this.selectedIndex;
    this.setupMarginObservers();
  }
  // --------------------------------------------------------------------------
  //
  //  Private Methods
  //
  //--------------------------------------------------------------------------
  closeMenuPopOverAndDisconnectHandles() {
    this.disconnectObservers();
    document.removeEventListener("pointerdown", this.handleOutsideClick);
    window.removeEventListener("resize", this.handleOutsideClick);
    if (this.menuPopOver) {
      setTimeout(() => {
        document.body.removeChild(this.menuPopOver);
        this.menuPopOver = null;
      }, 100);
    }
    this.open = false;
  }
  setupMarginObservers() {
    const { top: selectTop, bottom: selectBottom } = this.refNode.getBoundingClientRect();
    const { clientHeight } = document.body;
    this.disconnectObservers();
    const rootMarginForTop = `0px 0px ${selectBottom - clientHeight}px 0px`;
    this.topObserver = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) {
          this.closeMenuPopOverAndDisconnectHandles();
        }
      });
    }, { rootMargin: rootMarginForTop });
    const rootMarginForBottom = `${-selectTop}px 0px 0px 0px`;
    this.bottomObserver = new IntersectionObserver((entries) => {
      entries.forEach((entry) => {
        if (!entry.isIntersecting) {
          this.closeMenuPopOverAndDisconnectHandles();
        }
      });
    }, { rootMargin: rootMarginForBottom });
    this.topObserver.observe(this.refNode);
    this.bottomObserver.observe(this.refNode);
  }
  disconnectObservers() {
    var _a, _b;
    (_a = this.topObserver) === null || _a === void 0 ? void 0 : _a.disconnect();
    (_b = this.bottomObserver) === null || _b === void 0 ? void 0 : _b.disconnect();
    this.topObserver = null;
    this.bottomObserver = null;
  }
  get hostElement() { return (0,_index_92ebb396_js__WEBPACK_IMPORTED_MODULE_0__.d)(this); }
  static get watchers() { return {
    "selectedIndex": ["watchSelectedIndex"],
    "pageSize": ["watchPageSize"]
  }; }
};
ArcgisLazyLoadingSelect.style = arcgisLazyLoadingSelectCss;




/***/ })

}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoid2lkZ2V0cy9jaHVua3MvYXJjZ2lzX2FuYWx5c2lzX25vZGVfbW9kdWxlc19hcmNnaXNfYXBwLWNvbXBvbmVudHNfZGlzdF9lc21fYXJjZ2lzLWxhenktbG8tNWI3ZDRlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDa0c7O0FBRWxHLDBDQUEwQyxXQUFXLGdCQUFnQixvQkFBb0IseURBQXlEOztBQUVsSjtBQUNBO0FBQ0EsSUFBSSxxREFBZ0I7QUFDcEIseUNBQXlDLHFEQUFXO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksc0JBQXNCO0FBQ2xDO0FBQ0EsWUFBWSxxREFBQyxxQkFBcUIsOGlCQUE4aUI7QUFDaGxCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxtQ0FBbUM7QUFDL0MsWUFBWSxrREFBa0Q7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSx1Q0FBdUM7QUFDbkQsWUFBWSxlQUFlO0FBQzNCO0FBQ0Esd0NBQXdDLDRCQUE0QjtBQUNwRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLEtBQUssSUFBSSw4QkFBOEI7QUFDdkMsbUNBQW1DLFdBQVc7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLLElBQUksaUNBQWlDO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLE9BQU8scURBQVU7QUFDdkMsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRWlFIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYW5hbHlzaXMvbm9kZV9tb2R1bGVzL0BhcmNnaXMvYXBwLWNvbXBvbmVudHMvZGlzdC9lc20vYXJjZ2lzLWxhenktbG9hZGluZy1zZWxlY3QuZW50cnkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBBbGwgbWF0ZXJpYWwgY29weXJpZ2h0IEVTUkksIEFsbCBSaWdodHMgUmVzZXJ2ZWQsIHVubGVzcyBvdGhlcndpc2Ugc3BlY2lmaWVkLlxuICogdjMuMC45OVxuICovXG5pbXBvcnQgeyByIGFzIHJlZ2lzdGVySW5zdGFuY2UsIGMgYXMgY3JlYXRlRXZlbnQsIGgsIGQgYXMgZ2V0RWxlbWVudCB9IGZyb20gJy4vaW5kZXgtOTJlYmIzOTYuanMnO1xuXG5jb25zdCBhcmNnaXNMYXp5TG9hZGluZ1NlbGVjdENzcyA9IFwiOmhvc3R7d2lkdGg6MTAwJTtvdmVyZmxvdzpoaWRkZW59Lmxhenktc2VsZWN0LWJ1dHRvbnstLWNhbGNpdGUtdWktZm9yZWdyb3VuZC0zOnZhcigtLWNhbGNpdGUtdWktYm9yZGVyLWlucHV0KX1cIjtcblxuY29uc3QgQXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3QgPSBjbGFzcyB7XG4gIGNvbnN0cnVjdG9yKGhvc3RSZWYpIHtcbiAgICByZWdpc3Rlckluc3RhbmNlKHRoaXMsIGhvc3RSZWYpO1xuICAgIHRoaXMuYXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3RDaGFuZ2UgPSBjcmVhdGVFdmVudCh0aGlzLCBcImFyY2dpc0xhenlMb2FkaW5nU2VsZWN0Q2hhbmdlXCIsIDcpO1xuICAgIHRoaXMuaGFuZGxlT3V0c2lkZUNsaWNrID0gKGV2ZW50KSA9PiB7XG4gICAgICBpZiAoIXRoaXMub3Blbikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICAvLyB3aGVuIGxpc3QgaGFzIHNpbmdsZSBpdGVtLCBzaW1wbHkgY2xvc2VcbiAgICAgIGlmICh0aGlzLmxpc3QubGVuZ3RoID4gMSkge1xuICAgICAgICBjb25zdCBwYXRocyA9IGV2ZW50LmNvbXBvc2VkUGF0aCgpO1xuICAgICAgICBpZiAocGF0aHMuaW5jbHVkZXModGhpcy5ob3N0RWxlbWVudCkgfHwgcGF0aHMuaW5jbHVkZXModGhpcy5tZW51UG9wT3ZlcikpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHRoaXMuY2xvc2VNZW51UG9wT3ZlckFuZERpc2Nvbm5lY3RIYW5kbGVzKCk7XG4gICAgfTtcbiAgICB0aGlzLmhhbmRsZVJlc2l6ZSA9ICgpID0+IHRoaXMub3BlbiAmJiB0aGlzLmNsb3NlTWVudVBvcE92ZXJBbmREaXNjb25uZWN0SGFuZGxlcygpO1xuICAgIHRoaXMubGlzdCA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSAwO1xuICAgIHRoaXMuY29udGFpbmVyVG9wID0gMDtcbiAgICB0aGlzLmNvbnRhaW5lckJvdHRvbSA9IHVuZGVmaW5lZDtcbiAgICB0aGlzLnBhZ2VTaXplID0gNTAwO1xuICAgIHRoaXMuYWNjdW11bGF0ZVBhZ2VzID0gdHJ1ZTtcbiAgICB0aGlzLnN0cmluZ3MgPSB1bmRlZmluZWQ7XG4gICAgdGhpcy5hcmlhTGFiZWxlZEJ5ID0gdW5kZWZpbmVkO1xuICAgIHRoaXMuc2hvd0ZpbHRlckxlbmd0aCA9IDIwO1xuICAgIHRoaXMucGFnZUlkID0gMDtcbiAgICB0aGlzLm9wZW4gPSBmYWxzZTtcbiAgfVxuICB3YXRjaFNlbGVjdGVkSW5kZXgobmV3VmFsdWUpIHtcbiAgICBpZiAodGhpcy5tZW51UG9wT3Zlcikge1xuICAgICAgdGhpcy5tZW51UG9wT3Zlci5zZWxlY3RlZEluZGV4ID0gbmV3VmFsdWU7XG4gICAgfVxuICB9XG4gIHdhdGNoUGFnZVNpemUobmV3VmFsdWUpIHtcbiAgICBpZiAodGhpcy5tZW51UG9wT3Zlcikge1xuICAgICAgdGhpcy5tZW51UG9wT3Zlci5wYWdlU2l6ZSA9IG5ld1ZhbHVlO1xuICAgIH1cbiAgfVxuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBMaWZlY3ljbGVcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBkaXNjb25uZWN0ZWRDYWxsYmFjaygpIHtcbiAgICB0aGlzLmNsb3NlTWVudVBvcE92ZXJBbmREaXNjb25uZWN0SGFuZGxlcygpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBSZW5kZXIgTWV0aG9kc1xuICAvL1xuICAvLy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIHJlbmRlcigpIHtcbiAgICB2YXIgX2E7XG4gICAgY29uc3QgeyBzZWxlY3RlZEluZGV4LCBsaXN0IH0gPSB0aGlzO1xuICAgIGNvbnN0IHNlbGVjdGVkID0gc2VsZWN0ZWRJbmRleCA+PSBsaXN0Lmxlbmd0aCA/IGxpc3RbMF0gOiBsaXN0W3NlbGVjdGVkSW5kZXhdO1xuICAgIHJldHVybiAoaChcImNhbGNpdGUtYnV0dG9uXCIsIHsgc2NhbGU6IFwic1wiLCB3aWR0aDogXCJmdWxsXCIsIGFwcGVhcmFuY2U6IFwib3V0bGluZS1maWxsXCIsIGtpbmQ6IHRoaXMub3BlbiA/IFwiYnJhbmRcIiA6IFwibmV1dHJhbFwiLCBjbGFzczogdGhpcy5vcGVuID8gdW5kZWZpbmVkIDogXCJsYXp5LXNlbGVjdC1idXR0b25cIiwgYWxpZ25tZW50OiBcImljb24tZW5kLXNwYWNlLWJldHdlZW5cIiwgaWNvbkVuZDogdGhpcy5vcGVuID8gXCJjaGV2cm9uLXVwXCIgOiBcImNoZXZyb24tZG93blwiLCBcImFyaWEtaGFzcG9wdXBcIjogXCJ0cnVlXCIsIFwiYXJpYS1leHBhbmRlZFwiOiB0aGlzLm9wZW4gPyBcInRydWVcIiA6IFwiZmFsc2VcIiwgXCJhcmlhLWxhYmVsXCI6IHRoaXMuYXJpYUxhYmVsZWRCeSA/IHVuZGVmaW5lZCA6IChfYSA9IHRoaXMuc3RyaW5ncykgPT09IG51bGwgfHwgX2EgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9hLnNlbGVjdExhYmVsLCBcImFyaWEtbGFiZWxsZWRieVwiOiB0aGlzLmFyaWFMYWJlbGVkQnkgfHwgdW5kZWZpbmVkLCBvbkNsaWNrOiAoKSA9PiB0aGlzLnJlbmRlclNlbGVjdE1lbnUoKSwgcmVmOiAobm9kZSkgPT4gKHRoaXMucmVmTm9kZSA9IG5vZGUpIH0sIHNlbGVjdGVkLmxhYmVsKSk7XG4gIH1cbiAgcmVuZGVyU2VsZWN0TWVudSgpIHtcbiAgICBpZiAodGhpcy5tZW51UG9wT3Zlcikge1xuICAgICAgdGhpcy5jbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5vcGVuID0gdHJ1ZTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwicG9pbnRlcmRvd25cIiwgdGhpcy5oYW5kbGVPdXRzaWRlQ2xpY2spO1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicmVzaXplXCIsIHRoaXMuaGFuZGxlT3V0c2lkZUNsaWNrKTtcbiAgICBjb25zdCBtZW51UG9wT3ZlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhcmNnaXMtbGF6eS1sb2FkaW5nLWxpc3RcIik7XG4gICAgY29uc3QgeyBoZWlnaHQ6IGhvc3RIZWlnaHQsIHRvcDogaG9zdFRvcCB9ID0gdGhpcy5ob3N0RWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICBjb25zdCB7IHdpZHRoLCBsZWZ0LCBib3R0b20sIHRvcCwgaGVpZ2h0OiB0cmlnZ2VySGVpZ2h0IH0gPSB0aGlzLnJlZk5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgaGVpZ2h0ID0gaG9zdEhlaWdodCAtIHRyaWdnZXJIZWlnaHQgLSAoYm90dG9tIC0gaG9zdFRvcCk7XG4gICAgbWVudVBvcE92ZXIucG9wb3ZlclByb3BzID0ge1xuICAgICAgd2lkdGgsXG4gICAgICBsZWZ0LFxuICAgICAgdG9wLFxuICAgICAgYm90dG9tLFxuICAgICAgaGVpZ2h0LFxuICAgICAgY29udGFpbmVyVG9wOiB0aGlzLmNvbnRhaW5lclRvcCxcbiAgICAgIGNvbnRhaW5lckJvdHRvbTogdGhpcy5jb250YWluZXJCb3R0b21cbiAgICB9O1xuICAgIC8vIGZseSBvdXQgdG8gdGhlIHJvb3QgY29udGFpbmVyIGlzIGdvb2Qgd2hlbiB0aGUgbGlzdCByZXF1aXJlcyBjb250YWluZXIgd2lkZXIgZWxlbWVudCB0aGF0IGdvZXMgYmV5b25kIHNlbGVjdCdzIGNvbnRyb2xsZXIsXG4gICAgLy8gaXQncyB2aXNpYmxlIHdpdGhvdXQgaG9yaXpvbnRhbCBzY3JvbGxpbmcsIHNpbWlsYXIgdG8gYnJvd3NlcidzIG5hdGl2ZSBzZWxlY3QgY29udHJvbC5cbiAgICBtZW51UG9wT3Zlci5mbHlPdXQgPSB0cnVlO1xuICAgIG1lbnVQb3BPdmVyLnN0cmluZ3MgPSB0aGlzLnN0cmluZ3M7XG4gICAgbWVudVBvcE92ZXIuc2hvd0ZpbHRlciA9IHRoaXMubGlzdC5sZW5ndGggPj0gdGhpcy5zaG93RmlsdGVyTGVuZ3RoO1xuICAgIG1lbnVQb3BPdmVyLnBhZ2VTaXplID0gdGhpcy5wYWdlU2l6ZTtcbiAgICBtZW51UG9wT3Zlci5hY2N1bXVsYXRlUGFnZXMgPSB0aGlzLmFjY3VtdWxhdGVQYWdlcztcbiAgICB0aGlzLm1lbnVQb3BPdmVyID0gbWVudVBvcE92ZXI7XG4gICAgbWVudVBvcE92ZXIuYWRkRXZlbnRMaXN0ZW5lcihcImFyY2dpc0xhenlMb2FkaW5nTGlzdENoYW5nZVwiLCAoZXZ0KSA9PiB7XG4gICAgICB0aGlzLnNlbGVjdGVkSW5kZXggPSBldnQuZGV0YWlsLnNlbGVjdGVkSW5kZXg7XG4gICAgICB0aGlzLmFyY2dpc0xhenlMb2FkaW5nU2VsZWN0Q2hhbmdlLmVtaXQoZXZ0LmRldGFpbCk7XG4gICAgICB0aGlzLmNsb3NlTWVudVBvcE92ZXJBbmREaXNjb25uZWN0SGFuZGxlcygpO1xuICAgIH0pO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQobWVudVBvcE92ZXIpO1xuICAgIHRoaXMubWVudVBvcE92ZXIubGlzdCA9IHRoaXMubGlzdDtcbiAgICB0aGlzLm1lbnVQb3BPdmVyLnNlbGVjdGVkSW5kZXggPSB0aGlzLnNlbGVjdGVkSW5kZXg7XG4gICAgdGhpcy5zZXR1cE1hcmdpbk9ic2VydmVycygpO1xuICB9XG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8vXG4gIC8vICBQcml2YXRlIE1ldGhvZHNcbiAgLy9cbiAgLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICBjbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKSB7XG4gICAgdGhpcy5kaXNjb25uZWN0T2JzZXJ2ZXJzKCk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInBvaW50ZXJkb3duXCIsIHRoaXMuaGFuZGxlT3V0c2lkZUNsaWNrKTtcbiAgICB3aW5kb3cucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB0aGlzLmhhbmRsZU91dHNpZGVDbGljayk7XG4gICAgaWYgKHRoaXMubWVudVBvcE92ZXIpIHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBkb2N1bWVudC5ib2R5LnJlbW92ZUNoaWxkKHRoaXMubWVudVBvcE92ZXIpO1xuICAgICAgICB0aGlzLm1lbnVQb3BPdmVyID0gbnVsbDtcbiAgICAgIH0sIDEwMCk7XG4gICAgfVxuICAgIHRoaXMub3BlbiA9IGZhbHNlO1xuICB9XG4gIHNldHVwTWFyZ2luT2JzZXJ2ZXJzKCkge1xuICAgIGNvbnN0IHsgdG9wOiBzZWxlY3RUb3AsIGJvdHRvbTogc2VsZWN0Qm90dG9tIH0gPSB0aGlzLnJlZk5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgY29uc3QgeyBjbGllbnRIZWlnaHQgfSA9IGRvY3VtZW50LmJvZHk7XG4gICAgdGhpcy5kaXNjb25uZWN0T2JzZXJ2ZXJzKCk7XG4gICAgY29uc3Qgcm9vdE1hcmdpbkZvclRvcCA9IGAwcHggMHB4ICR7c2VsZWN0Qm90dG9tIC0gY2xpZW50SGVpZ2h0fXB4IDBweGA7XG4gICAgdGhpcy50b3BPYnNlcnZlciA9IG5ldyBJbnRlcnNlY3Rpb25PYnNlcnZlcigoZW50cmllcykgPT4ge1xuICAgICAgZW50cmllcy5mb3JFYWNoKChlbnRyeSkgPT4ge1xuICAgICAgICBpZiAoIWVudHJ5LmlzSW50ZXJzZWN0aW5nKSB7XG4gICAgICAgICAgdGhpcy5jbG9zZU1lbnVQb3BPdmVyQW5kRGlzY29ubmVjdEhhbmRsZXMoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSwgeyByb290TWFyZ2luOiByb290TWFyZ2luRm9yVG9wIH0pO1xuICAgIGNvbnN0IHJvb3RNYXJnaW5Gb3JCb3R0b20gPSBgJHstc2VsZWN0VG9wfXB4IDBweCAwcHggMHB4YDtcbiAgICB0aGlzLmJvdHRvbU9ic2VydmVyID0gbmV3IEludGVyc2VjdGlvbk9ic2VydmVyKChlbnRyaWVzKSA9PiB7XG4gICAgICBlbnRyaWVzLmZvckVhY2goKGVudHJ5KSA9PiB7XG4gICAgICAgIGlmICghZW50cnkuaXNJbnRlcnNlY3RpbmcpIHtcbiAgICAgICAgICB0aGlzLmNsb3NlTWVudVBvcE92ZXJBbmREaXNjb25uZWN0SGFuZGxlcygpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9LCB7IHJvb3RNYXJnaW46IHJvb3RNYXJnaW5Gb3JCb3R0b20gfSk7XG4gICAgdGhpcy50b3BPYnNlcnZlci5vYnNlcnZlKHRoaXMucmVmTm9kZSk7XG4gICAgdGhpcy5ib3R0b21PYnNlcnZlci5vYnNlcnZlKHRoaXMucmVmTm9kZSk7XG4gIH1cbiAgZGlzY29ubmVjdE9ic2VydmVycygpIHtcbiAgICB2YXIgX2EsIF9iO1xuICAgIChfYSA9IHRoaXMudG9wT2JzZXJ2ZXIpID09PSBudWxsIHx8IF9hID09PSB2b2lkIDAgPyB2b2lkIDAgOiBfYS5kaXNjb25uZWN0KCk7XG4gICAgKF9iID0gdGhpcy5ib3R0b21PYnNlcnZlcikgPT09IG51bGwgfHwgX2IgPT09IHZvaWQgMCA/IHZvaWQgMCA6IF9iLmRpc2Nvbm5lY3QoKTtcbiAgICB0aGlzLnRvcE9ic2VydmVyID0gbnVsbDtcbiAgICB0aGlzLmJvdHRvbU9ic2VydmVyID0gbnVsbDtcbiAgfVxuICBnZXQgaG9zdEVsZW1lbnQoKSB7IHJldHVybiBnZXRFbGVtZW50KHRoaXMpOyB9XG4gIHN0YXRpYyBnZXQgd2F0Y2hlcnMoKSB7IHJldHVybiB7XG4gICAgXCJzZWxlY3RlZEluZGV4XCI6IFtcIndhdGNoU2VsZWN0ZWRJbmRleFwiXSxcbiAgICBcInBhZ2VTaXplXCI6IFtcIndhdGNoUGFnZVNpemVcIl1cbiAgfTsgfVxufTtcbkFyY2dpc0xhenlMb2FkaW5nU2VsZWN0LnN0eWxlID0gYXJjZ2lzTGF6eUxvYWRpbmdTZWxlY3RDc3M7XG5cbmV4cG9ydCB7IEFyY2dpc0xhenlMb2FkaW5nU2VsZWN0IGFzIGFyY2dpc19sYXp5X2xvYWRpbmdfc2VsZWN0IH07XG4iXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=