/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
System.register(["jimu-core","jimu-arcgis"], function(__WEBPACK_DYNAMIC_EXPORT__, __system_context__) {
	var __WEBPACK_EXTERNAL_MODULE_jimu_core__ = {};
	var __WEBPACK_EXTERNAL_MODULE_jimu_arcgis__ = {};
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_core__, "__esModule", { value: true });
	Object.defineProperty(__WEBPACK_EXTERNAL_MODULE_jimu_arcgis__, "__esModule", { value: true });
	return {
		setters: [
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_core__[key] = module[key];
				});
			},
			function(module) {
				Object.keys(module).forEach(function(key) {
					__WEBPACK_EXTERNAL_MODULE_jimu_arcgis__[key] = module[key];
				});
			}
		],
		execute: function() {
			__WEBPACK_DYNAMIC_EXPORT__(
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./extensions/widgets/arcgis/arcgis-map/src/message-actions/pan-to-action.ts":
/*!***********************************************************************************!*\
  !*** ./extensions/widgets/arcgis/arcgis-map/src/message-actions/pan-to-action.ts ***!
  \***********************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ PanToAction)\n/* harmony export */ });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-arcgis */ \"jimu-arcgis\");\n/* harmony import */ var _runtime_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../runtime/utils */ \"./extensions/widgets/arcgis/arcgis-map/src/runtime/utils.ts\");\n\n\n\nclass PanToAction extends jimu_core__WEBPACK_IMPORTED_MODULE_0__.AbstractMessageAction {\n    constructor() {\n        super(...arguments);\n        this.NoLockTriggerLayerWidgets = ['Map'];\n    }\n    filterMessageType(messageType, messageWidgetId) {\n        return messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataRecordSetChange ||\n            messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataRecordsSelectionChange ||\n            messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.ExtentChange ||\n            messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataSourceFilterChange;\n    }\n    filterMessage(message) {\n        return true;\n    }\n    getSettingComponentUri(messageType, messageWidgetId) {\n        //const config = getAppStore().getState().appStateInBuilder ? getAppStore().getState().appStateInBuilder.appConfig : getAppStore().getState().appConfig\n        //const messageWidgetJson = config.widgets[messageWidgetId]\n        if (messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataRecordsSelectionChange ||\n            messageType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataSourceFilterChange) {\n            return 'message-actions/pan-to-action-setting';\n        }\n        else {\n            return null;\n        }\n    }\n    onExecute(message, actionConfig) {\n        return (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)(['esri/Graphic']).then(modules => {\n            var _a;\n            let Graphic = null;\n            [Graphic] = modules;\n            switch (message.type) {\n                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataRecordSetChange:\n                    const dataRecordSetChangeMessage = message;\n                    if (dataRecordSetChangeMessage.changeType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.RecordSetChangeType.Create ||\n                        dataRecordSetChangeMessage.changeType === jimu_core__WEBPACK_IMPORTED_MODULE_0__.RecordSetChangeType.Update) {\n                        let newFeatureSet = {};\n                        if (dataRecordSetChangeMessage.dataRecordSet && dataRecordSetChangeMessage.dataRecordSet.records) {\n                            const features = [];\n                            for (let i = 0; i < dataRecordSetChangeMessage.dataRecordSet.records.length; i++) {\n                                const dataRecordFeature = dataRecordSetChangeMessage.dataRecordSet.records[i].feature;\n                                if (dataRecordFeature) {\n                                    features.push((0,_runtime_utils__WEBPACK_IMPORTED_MODULE_2__.handleFeature)(dataRecordFeature, Graphic).geometry);\n                                }\n                            }\n                            newFeatureSet = {\n                                features: features\n                            };\n                        }\n                        jimu_core__WEBPACK_IMPORTED_MODULE_0__.MutableStoreManager.getInstance().updateStateValue(this.widgetId, 'panToActionValue.value', newFeatureSet);\n                    }\n                    break;\n                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataRecordsSelectionChange:\n                    const config = (0,jimu_core__WEBPACK_IMPORTED_MODULE_0__.getAppStore)().getState().appConfig;\n                    const messageWidgetJson = config.widgets[message.widgetId];\n                    const messageWidgetLabel = messageWidgetJson.manifest.label;\n                    const dataRecordsSelectionChangeMessage = message;\n                    let selectionFeatureSet = {};\n                    const selectFeatures = [];\n                    if (dataRecordsSelectionChangeMessage.records) {\n                        if (dataRecordsSelectionChangeMessage.records[0]) {\n                            //if (!actionConfig.useDataSource || (dataRecordsSelectionChangeMessage.records[0].dataSource.getMainDataSource().id !== actionConfig.useDataSource.mainDataSourceId)) {\n                            //  break\n                            //}\n                            if (this.NoLockTriggerLayerWidgets.includes(messageWidgetLabel)) {\n                                const mainDataSourceOfSelection = dataRecordsSelectionChangeMessage.records[0].dataSource.getMainDataSource();\n                                if (!((_a = actionConfig === null || actionConfig === void 0 ? void 0 : actionConfig.useDataSources) === null || _a === void 0 ? void 0 : _a.some(useDataSource => (useDataSource === null || useDataSource === void 0 ? void 0 : useDataSource.mainDataSourceId) === mainDataSourceOfSelection.id))) {\n                                    break;\n                                }\n                            }\n                            else {\n                                const selectionChangeDS = dataRecordsSelectionChangeMessage.records[0].dataSource;\n                                const selectionChangeMainDS = selectionChangeDS === null || selectionChangeDS === void 0 ? void 0 : selectionChangeDS.getMainDataSource();\n                                // check dsId of mainDS currently, will support view in the future.\n                                if (!actionConfig.useDataSources.some(useDataSource => (useDataSource === null || useDataSource === void 0 ? void 0 : useDataSource.mainDataSourceId) === selectionChangeMainDS.id)) {\n                                    break;\n                                }\n                            }\n                        }\n                        for (let i = 0; i < dataRecordsSelectionChangeMessage.records.length; i++) {\n                            const dataRecordFeature = dataRecordsSelectionChangeMessage.records[i].feature;\n                            if (dataRecordFeature) {\n                                selectFeatures.push((0,_runtime_utils__WEBPACK_IMPORTED_MODULE_2__.handleFeature)(dataRecordFeature, Graphic).geometry);\n                            }\n                        }\n                    }\n                    selectionFeatureSet = {\n                        features: selectFeatures\n                    };\n                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.MutableStoreManager.getInstance().updateStateValue(this.widgetId, 'panToActionValue.value', selectionFeatureSet);\n                    break;\n                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.ExtentChange:\n                    const extentChangeMessage = message;\n                    if (extentChangeMessage.getRelatedWidgetIds().includes(this.widgetId)) {\n                        break;\n                    }\n                    const extentValue = {\n                        features: [extentChangeMessage.extent]\n                    };\n                    const panToFeatureActionValue = {\n                        value: extentValue,\n                        relatedWidgets: extentChangeMessage.getRelatedWidgetIds()\n                    };\n                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.MutableStoreManager.getInstance().updateStateValue(this.widgetId, 'panToActionValue', panToFeatureActionValue);\n                    break;\n                case jimu_core__WEBPACK_IMPORTED_MODULE_0__.MessageType.DataSourceFilterChange:\n                    const filterChangeMessage = message;\n                    const filterChangeDS = jimu_core__WEBPACK_IMPORTED_MODULE_0__.DataSourceManager.getInstance().getDataSource(filterChangeMessage.dataSourceId);\n                    //const filterChangeMainDS = filterChangeDS?.getMainDataSource()\n                    // support view.\n                    if (!actionConfig.useDataSources.some(useDataSource => (useDataSource === null || useDataSource === void 0 ? void 0 : useDataSource.dataSourceId) === filterChangeDS.id)) {\n                        break;\n                    }\n                    const filterChangeActionValue = {\n                        dataSourceId: filterChangeMessage.dataSourceId,\n                        useDataSources: actionConfig.useDataSources || [],\n                        type: 'pan-to-query-params'\n                    };\n                    jimu_core__WEBPACK_IMPORTED_MODULE_0__.MutableStoreManager.getInstance().updateStateValue(this.widgetId, 'panToActionValue.value', filterChangeActionValue);\n                    break;\n            }\n            return true;\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FyY2dpcy1tYXAvc3JjL21lc3NhZ2UtYWN0aW9ucy9wYW4tdG8tYWN0aW9uLnRzLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUlBO0FBQ0E7QUFHQTtBQUFBOztBQUNBO0FBbUlBO0FBbElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsid2VicGFjazovL2V4Yi1jbGllbnQvLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FyY2dpcy1tYXAvc3JjL21lc3NhZ2UtYWN0aW9ucy9wYW4tdG8tYWN0aW9uLnRzPzllZTciXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtcbiAgQWJzdHJhY3RNZXNzYWdlQWN0aW9uLCBNZXNzYWdlVHlwZSwgTWVzc2FnZSwgZ2V0QXBwU3RvcmUsIERhdGFSZWNvcmRTZXRDaGFuZ2VNZXNzYWdlLCBSZWNvcmRTZXRDaGFuZ2VUeXBlLCBEYXRhU291cmNlRmlsdGVyQ2hhbmdlTWVzc2FnZSxcbiAgRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlLCBFeHRlbnRDaGFuZ2VNZXNzYWdlLCBGZWF0dXJlRGF0YVJlY29yZCBhcyBGZWF0dXJlUXVlcnlEYXRhUmVjb3JkLCBNdXRhYmxlU3RvcmVNYW5hZ2VyLCBEYXRhU291cmNlTWFuYWdlclxufSBmcm9tICdqaW11LWNvcmUnXG5pbXBvcnQgeyBGZWF0dXJlRGF0YVJlY29yZCBhcyBGZWF0dXJlTGF5ZXJEYXRhUmVjb3JkLCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzIH0gZnJvbSAnamltdS1hcmNnaXMnXG5pbXBvcnQgeyBoYW5kbGVGZWF0dXJlIH0gZnJvbSAnLi4vcnVudGltZS91dGlscydcbmltcG9ydCB7IElNQ29uZmlnIH0gZnJvbSAnLi9wYW4tdG8tYWN0aW9uLXNldHRpbmcnXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBhblRvQWN0aW9uIGV4dGVuZHMgQWJzdHJhY3RNZXNzYWdlQWN0aW9uIHtcbiAgTm9Mb2NrVHJpZ2dlckxheWVyV2lkZ2V0cyA9IFsnTWFwJ11cbiAgZmlsdGVyTWVzc2FnZVR5cGUgKG1lc3NhZ2VUeXBlOiBNZXNzYWdlVHlwZSwgbWVzc2FnZVdpZGdldElkPzogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIG1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5EYXRhUmVjb3JkU2V0Q2hhbmdlIHx8XG4gICAgICBtZXNzYWdlVHlwZSA9PT0gTWVzc2FnZVR5cGUuRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2UgfHxcbiAgICAgIG1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5FeHRlbnRDaGFuZ2UgfHxcbiAgICAgIG1lc3NhZ2VUeXBlID09PSBNZXNzYWdlVHlwZS5EYXRhU291cmNlRmlsdGVyQ2hhbmdlXG4gIH1cblxuICBmaWx0ZXJNZXNzYWdlIChtZXNzYWdlOiBNZXNzYWdlKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuXG4gIGdldFNldHRpbmdDb21wb25lbnRVcmkgKG1lc3NhZ2VUeXBlOiBNZXNzYWdlVHlwZSwgbWVzc2FnZVdpZGdldElkPzogc3RyaW5nKTogc3RyaW5nIHtcbiAgICAvL2NvbnN0IGNvbmZpZyA9IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlciA/IGdldEFwcFN0b3JlKCkuZ2V0U3RhdGUoKS5hcHBTdGF0ZUluQnVpbGRlci5hcHBDb25maWcgOiBnZXRBcHBTdG9yZSgpLmdldFN0YXRlKCkuYXBwQ29uZmlnXG4gICAgLy9jb25zdCBtZXNzYWdlV2lkZ2V0SnNvbiA9IGNvbmZpZy53aWRnZXRzW21lc3NhZ2VXaWRnZXRJZF1cbiAgICBpZiAobWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkRhdGFSZWNvcmRzU2VsZWN0aW9uQ2hhbmdlIHx8XG4gICAgICAgICAgbWVzc2FnZVR5cGUgPT09IE1lc3NhZ2VUeXBlLkRhdGFTb3VyY2VGaWx0ZXJDaGFuZ2UpIHtcbiAgICAgIHJldHVybiAnbWVzc2FnZS1hY3Rpb25zL3Bhbi10by1hY3Rpb24tc2V0dGluZydcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH1cblxuICBvbkV4ZWN1dGUgKG1lc3NhZ2U6IE1lc3NhZ2UsIGFjdGlvbkNvbmZpZz86IElNQ29uZmlnKTogUHJvbWlzZTxib29sZWFuPiB8IGJvb2xlYW4ge1xuICAgIHJldHVybiBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFsnZXNyaS9HcmFwaGljJ10pLnRoZW4obW9kdWxlcyA9PiB7XG4gICAgICBsZXQgR3JhcGhpYzogX19lc3JpLkdyYXBoaWNDb25zdHJ1Y3RvciA9IG51bGw7XG4gICAgICBbR3JhcGhpY10gPSBtb2R1bGVzXG4gICAgICBzd2l0Y2ggKG1lc3NhZ2UudHlwZSkge1xuICAgICAgICBjYXNlIE1lc3NhZ2VUeXBlLkRhdGFSZWNvcmRTZXRDaGFuZ2U6XG4gICAgICAgICAgY29uc3QgZGF0YVJlY29yZFNldENoYW5nZU1lc3NhZ2UgPSBtZXNzYWdlIGFzIERhdGFSZWNvcmRTZXRDaGFuZ2VNZXNzYWdlXG4gICAgICAgICAgaWYgKGRhdGFSZWNvcmRTZXRDaGFuZ2VNZXNzYWdlLmNoYW5nZVR5cGUgPT09IFJlY29yZFNldENoYW5nZVR5cGUuQ3JlYXRlIHx8XG4gICAgICAgICAgICBkYXRhUmVjb3JkU2V0Q2hhbmdlTWVzc2FnZS5jaGFuZ2VUeXBlID09PSBSZWNvcmRTZXRDaGFuZ2VUeXBlLlVwZGF0ZSkge1xuICAgICAgICAgICAgbGV0IG5ld0ZlYXR1cmVTZXQgPSB7fVxuICAgICAgICAgICAgaWYgKGRhdGFSZWNvcmRTZXRDaGFuZ2VNZXNzYWdlLmRhdGFSZWNvcmRTZXQgJiYgZGF0YVJlY29yZFNldENoYW5nZU1lc3NhZ2UuZGF0YVJlY29yZFNldC5yZWNvcmRzKSB7XG4gICAgICAgICAgICAgIGNvbnN0IGZlYXR1cmVzID0gW11cbiAgICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhUmVjb3JkU2V0Q2hhbmdlTWVzc2FnZS5kYXRhUmVjb3JkU2V0LnJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBkYXRhUmVjb3JkRmVhdHVyZSA9IChkYXRhUmVjb3JkU2V0Q2hhbmdlTWVzc2FnZS5kYXRhUmVjb3JkU2V0LnJlY29yZHNbaV0gYXNcbiAgICAgICAgICAgICAgICAgIChGZWF0dXJlUXVlcnlEYXRhUmVjb3JkIHwgRmVhdHVyZUxheWVyRGF0YVJlY29yZCkpLmZlYXR1cmVcbiAgICAgICAgICAgICAgICBpZiAoZGF0YVJlY29yZEZlYXR1cmUpIHtcbiAgICAgICAgICAgICAgICAgIGZlYXR1cmVzLnB1c2goaGFuZGxlRmVhdHVyZShkYXRhUmVjb3JkRmVhdHVyZSwgR3JhcGhpYykuZ2VvbWV0cnkpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgbmV3RmVhdHVyZVNldCA9IHtcbiAgICAgICAgICAgICAgICBmZWF0dXJlczogZmVhdHVyZXNcbiAgICAgICAgICAgICAgfSBhcyBfX2VzcmkuRmVhdHVyZVNldFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBNdXRhYmxlU3RvcmVNYW5hZ2VyLmdldEluc3RhbmNlKCkudXBkYXRlU3RhdGVWYWx1ZSh0aGlzLndpZGdldElkLCAncGFuVG9BY3Rpb25WYWx1ZS52YWx1ZScsIG5ld0ZlYXR1cmVTZXQpXG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTWVzc2FnZVR5cGUuRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2U6XG4gICAgICAgICAgY29uc3QgY29uZmlnID0gZ2V0QXBwU3RvcmUoKS5nZXRTdGF0ZSgpLmFwcENvbmZpZ1xuICAgICAgICAgIGNvbnN0IG1lc3NhZ2VXaWRnZXRKc29uID0gY29uZmlnLndpZGdldHNbbWVzc2FnZS53aWRnZXRJZF1cbiAgICAgICAgICBjb25zdCBtZXNzYWdlV2lkZ2V0TGFiZWwgPSBtZXNzYWdlV2lkZ2V0SnNvbi5tYW5pZmVzdC5sYWJlbFxuICAgICAgICAgIGNvbnN0IGRhdGFSZWNvcmRzU2VsZWN0aW9uQ2hhbmdlTWVzc2FnZSA9IG1lc3NhZ2UgYXMgRGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlXG5cbiAgICAgICAgICBsZXQgc2VsZWN0aW9uRmVhdHVyZVNldCA9IHt9XG4gICAgICAgICAgY29uc3Qgc2VsZWN0RmVhdHVyZXMgPSBbXVxuICAgICAgICAgIGlmIChkYXRhUmVjb3Jkc1NlbGVjdGlvbkNoYW5nZU1lc3NhZ2UucmVjb3Jkcykge1xuICAgICAgICAgICAgaWYgKGRhdGFSZWNvcmRzU2VsZWN0aW9uQ2hhbmdlTWVzc2FnZS5yZWNvcmRzWzBdKSB7XG4gICAgICAgICAgICAgIC8vaWYgKCFhY3Rpb25Db25maWcudXNlRGF0YVNvdXJjZSB8fCAoZGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlLnJlY29yZHNbMF0uZGF0YVNvdXJjZS5nZXRNYWluRGF0YVNvdXJjZSgpLmlkICE9PSBhY3Rpb25Db25maWcudXNlRGF0YVNvdXJjZS5tYWluRGF0YVNvdXJjZUlkKSkge1xuICAgICAgICAgICAgICAvLyAgYnJlYWtcbiAgICAgICAgICAgICAgLy99XG4gICAgICAgICAgICAgIGlmICh0aGlzLk5vTG9ja1RyaWdnZXJMYXllcldpZGdldHMuaW5jbHVkZXMobWVzc2FnZVdpZGdldExhYmVsKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1haW5EYXRhU291cmNlT2ZTZWxlY3Rpb24gPSBkYXRhUmVjb3Jkc1NlbGVjdGlvbkNoYW5nZU1lc3NhZ2UucmVjb3Jkc1swXS5kYXRhU291cmNlLmdldE1haW5EYXRhU291cmNlKClcbiAgICAgICAgICAgICAgICBpZiAoIWFjdGlvbkNvbmZpZz8udXNlRGF0YVNvdXJjZXM/LnNvbWUodXNlRGF0YVNvdXJjZSA9PiB1c2VEYXRhU291cmNlPy5tYWluRGF0YVNvdXJjZUlkID09PSBtYWluRGF0YVNvdXJjZU9mU2VsZWN0aW9uLmlkKSkge1xuICAgICAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uQ2hhbmdlRFMgPSBkYXRhUmVjb3Jkc1NlbGVjdGlvbkNoYW5nZU1lc3NhZ2UucmVjb3Jkc1swXS5kYXRhU291cmNlXG4gICAgICAgICAgICAgICAgY29uc3Qgc2VsZWN0aW9uQ2hhbmdlTWFpbkRTID0gc2VsZWN0aW9uQ2hhbmdlRFM/LmdldE1haW5EYXRhU291cmNlKClcbiAgICAgICAgICAgICAgICAvLyBjaGVjayBkc0lkIG9mIG1haW5EUyBjdXJyZW50bHksIHdpbGwgc3VwcG9ydCB2aWV3IGluIHRoZSBmdXR1cmUuXG4gICAgICAgICAgICAgICAgaWYgKCFhY3Rpb25Db25maWcudXNlRGF0YVNvdXJjZXMuc29tZSh1c2VEYXRhU291cmNlID0+IHVzZURhdGFTb3VyY2U/Lm1haW5EYXRhU291cmNlSWQgPT09IHNlbGVjdGlvbkNoYW5nZU1haW5EUy5pZCkpIHtcbiAgICAgICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlLnJlY29yZHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgY29uc3QgZGF0YVJlY29yZEZlYXR1cmUgPSAoZGF0YVJlY29yZHNTZWxlY3Rpb25DaGFuZ2VNZXNzYWdlLnJlY29yZHNbaV0gYXNcbiAgICAgICAgICAgICAgICAoRmVhdHVyZVF1ZXJ5RGF0YVJlY29yZCB8IEZlYXR1cmVMYXllckRhdGFSZWNvcmQpKS5mZWF0dXJlXG4gICAgICAgICAgICAgIGlmIChkYXRhUmVjb3JkRmVhdHVyZSkge1xuICAgICAgICAgICAgICAgIHNlbGVjdEZlYXR1cmVzLnB1c2goaGFuZGxlRmVhdHVyZShkYXRhUmVjb3JkRmVhdHVyZSwgR3JhcGhpYykuZ2VvbWV0cnkpXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICBzZWxlY3Rpb25GZWF0dXJlU2V0ID0ge1xuICAgICAgICAgICAgZmVhdHVyZXM6IHNlbGVjdEZlYXR1cmVzXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgTXV0YWJsZVN0b3JlTWFuYWdlci5nZXRJbnN0YW5jZSgpLnVwZGF0ZVN0YXRlVmFsdWUodGhpcy53aWRnZXRJZCwgJ3BhblRvQWN0aW9uVmFsdWUudmFsdWUnLCBzZWxlY3Rpb25GZWF0dXJlU2V0KVxuICAgICAgICAgIGJyZWFrXG4gICAgICAgIGNhc2UgTWVzc2FnZVR5cGUuRXh0ZW50Q2hhbmdlOlxuICAgICAgICAgIGNvbnN0IGV4dGVudENoYW5nZU1lc3NhZ2UgPSBtZXNzYWdlIGFzIEV4dGVudENoYW5nZU1lc3NhZ2VcblxuICAgICAgICAgIGlmIChleHRlbnRDaGFuZ2VNZXNzYWdlLmdldFJlbGF0ZWRXaWRnZXRJZHMoKS5pbmNsdWRlcyh0aGlzLndpZGdldElkKSkge1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBjb25zdCBleHRlbnRWYWx1ZSA9IHtcbiAgICAgICAgICAgIGZlYXR1cmVzOiBbZXh0ZW50Q2hhbmdlTWVzc2FnZS5leHRlbnRdXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgY29uc3QgcGFuVG9GZWF0dXJlQWN0aW9uVmFsdWUgPSB7XG4gICAgICAgICAgICB2YWx1ZTogZXh0ZW50VmFsdWUsXG4gICAgICAgICAgICByZWxhdGVkV2lkZ2V0czogZXh0ZW50Q2hhbmdlTWVzc2FnZS5nZXRSZWxhdGVkV2lkZ2V0SWRzKClcbiAgICAgICAgICB9XG4gICAgICAgICAgTXV0YWJsZVN0b3JlTWFuYWdlci5nZXRJbnN0YW5jZSgpLnVwZGF0ZVN0YXRlVmFsdWUodGhpcy53aWRnZXRJZCwgJ3BhblRvQWN0aW9uVmFsdWUnLCBwYW5Ub0ZlYXR1cmVBY3Rpb25WYWx1ZSlcbiAgICAgICAgICBicmVha1xuICAgICAgICBjYXNlIE1lc3NhZ2VUeXBlLkRhdGFTb3VyY2VGaWx0ZXJDaGFuZ2U6XG4gICAgICAgICAgY29uc3QgZmlsdGVyQ2hhbmdlTWVzc2FnZSA9IG1lc3NhZ2UgYXMgRGF0YVNvdXJjZUZpbHRlckNoYW5nZU1lc3NhZ2VcbiAgICAgICAgICBjb25zdCBmaWx0ZXJDaGFuZ2VEUyA9IERhdGFTb3VyY2VNYW5hZ2VyLmdldEluc3RhbmNlKCkuZ2V0RGF0YVNvdXJjZShmaWx0ZXJDaGFuZ2VNZXNzYWdlLmRhdGFTb3VyY2VJZClcbiAgICAgICAgICAvL2NvbnN0IGZpbHRlckNoYW5nZU1haW5EUyA9IGZpbHRlckNoYW5nZURTPy5nZXRNYWluRGF0YVNvdXJjZSgpXG4gICAgICAgICAgLy8gc3VwcG9ydCB2aWV3LlxuICAgICAgICAgIGlmICghYWN0aW9uQ29uZmlnLnVzZURhdGFTb3VyY2VzLnNvbWUodXNlRGF0YVNvdXJjZSA9PiB1c2VEYXRhU291cmNlPy5kYXRhU291cmNlSWQgPT09IGZpbHRlckNoYW5nZURTLmlkKSkge1xuICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICB9XG4gICAgICAgICAgY29uc3QgZmlsdGVyQ2hhbmdlQWN0aW9uVmFsdWUgPSB7XG4gICAgICAgICAgICBkYXRhU291cmNlSWQ6IGZpbHRlckNoYW5nZU1lc3NhZ2UuZGF0YVNvdXJjZUlkLFxuICAgICAgICAgICAgdXNlRGF0YVNvdXJjZXM6IGFjdGlvbkNvbmZpZy51c2VEYXRhU291cmNlcyB8fCBbXSxcbiAgICAgICAgICAgIHR5cGU6ICdwYW4tdG8tcXVlcnktcGFyYW1zJ1xuICAgICAgICAgIH1cblxuICAgICAgICAgIE11dGFibGVTdG9yZU1hbmFnZXIuZ2V0SW5zdGFuY2UoKS51cGRhdGVTdGF0ZVZhbHVlKHRoaXMud2lkZ2V0SWQsICdwYW5Ub0FjdGlvblZhbHVlLnZhbHVlJywgZmlsdGVyQ2hhbmdlQWN0aW9uVmFsdWUpXG4gICAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSlcbiAgfVxufVxuIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///./extensions/widgets/arcgis/arcgis-map/src/message-actions/pan-to-action.ts\n");

/***/ }),

/***/ "./extensions/widgets/arcgis/arcgis-map/src/runtime/utils.ts":
/*!*******************************************************************!*\
  !*** ./extensions/widgets/arcgis/arcgis-map/src/runtime/utils.ts ***!
  \*******************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"controlUIWidget\": () => (/* binding */ controlUIWidget),\n/* harmony export */   \"createNewFeaturelayer\": () => (/* binding */ createNewFeaturelayer),\n/* harmony export */   \"updateFeaturelayer\": () => (/* binding */ updateFeaturelayer),\n/* harmony export */   \"selectFeature\": () => (/* binding */ selectFeature),\n/* harmony export */   \"mapPanto\": () => (/* binding */ mapPanto),\n/* harmony export */   \"filterFeaturesByQuery\": () => (/* binding */ filterFeaturesByQuery),\n/* harmony export */   \"flashFeaturesByQuery\": () => (/* binding */ flashFeaturesByQuery),\n/* harmony export */   \"handleFeature\": () => (/* binding */ handleFeature),\n/* harmony export */   \"projectGeometries\": () => (/* binding */ projectGeometries),\n/* harmony export */   \"processZoomToFeatures\": () => (/* binding */ processZoomToFeatures),\n/* harmony export */   \"checkIsLive\": () => (/* binding */ checkIsLive),\n/* harmony export */   \"getMapBaseRestoreData\": () => (/* binding */ getMapBaseRestoreData),\n/* harmony export */   \"restoreMapBase\": () => (/* binding */ restoreMapBase)\n/* harmony export */ });\n/* harmony import */ var jimu_core__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! jimu-core */ \"jimu-core\");\n/* harmony import */ var jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! jimu-arcgis */ \"jimu-arcgis\");\nvar __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\n/* eslint-disable prefer-const */\n\n\nfunction controlUIWidget(mapBaseView, isOpen, uiWidget, position, widgetName) {\n    const ui = mapBaseView.ui;\n    if (!uiWidget) {\n        return;\n    }\n    if (isOpen) {\n        ui.add(uiWidget, position);\n        if (widgetName && ui.exbMapTools.indexOf(widgetName) === -1) {\n            ui.exbMapTools.push(widgetName);\n        }\n    }\n    else {\n        ui.remove(uiWidget);\n    }\n}\nfunction createNewFeaturelayer(mapBaseView, newFeatureSetValue) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const newLayerPromises = [];\n        newFeatureSetValue && Object.keys(newFeatureSetValue).forEach(layerId => {\n            const layer = mapBaseView.map.layers.find(layer => layer.id === layerId);\n            if (layer) {\n                console.warn('the feature layer is already created');\n                return;\n            }\n            newLayerPromises.push(addFeatureSetToMap(mapBaseView, newFeatureSetValue[layerId], layerId));\n        });\n        if (newLayerPromises.length === 0) {\n            return null;\n        }\n        else {\n            return Promise.all(newLayerPromises);\n        }\n    });\n}\nfunction updateFeaturelayer(mapBaseView, changedFeatureSetValue) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const updatePromises = [];\n        changedFeatureSetValue && Object.keys(changedFeatureSetValue).forEach(layerId => {\n            const layer = mapBaseView.map.layers.find(layer => layer.id === layerId);\n            if (layer) {\n                mapBaseView.map.remove(layer);\n                updatePromises.push(addFeatureSetToMap(mapBaseView, changedFeatureSetValue[layerId], layerId));\n            }\n        });\n        if (updatePromises.length === 0) {\n            return null;\n        }\n        else {\n            return Promise.all(updatePromises);\n        }\n    });\n}\nfunction addFeatureSetToMap(mapBaseView, featureSet, layerId) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return yield new Promise((resolve, reject) => {\n            return (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)([\n                'esri/layers/FeatureLayer'\n            ]).then(modules => {\n                if (featureSet.features.length < 1) {\n                    return resolve(null);\n                }\n                else {\n                    // let FeatureSet: typeof  __esri.FeatureSet;\n                    let FeatureLayer;\n                    // eslint-disable-next-line\n                    [FeatureLayer] = modules;\n                    const layerFromFeatureSet = featureSet.features[0].layer;\n                    const fieldsInFeaturelayer = [];\n                    const fieldMap = {};\n                    for (let i = 0; i < layerFromFeatureSet.fields.length; i++) {\n                        const fieldsItem = getReasonableField(layerFromFeatureSet.fields[i]);\n                        fieldMap[layerFromFeatureSet.fields[i].name] = fieldsItem.name;\n                        fieldsInFeaturelayer.push(fieldsItem);\n                    }\n                    const fieldsInPopupTemplate = [];\n                    for (const key in featureSet.features[0].attributes) {\n                        if (fieldMap[key]) {\n                            const fieldsItem = {\n                                fieldName: fieldMap[key],\n                                label: key\n                            };\n                            fieldsInPopupTemplate.push(fieldsItem);\n                        }\n                    }\n                    const sourceFeatures = [];\n                    featureSet.features.forEach((feature, index) => {\n                        const tempFeature = feature;\n                        if (tempFeature.attributes) {\n                            for (const key in tempFeature.attributes) {\n                                tempFeature.attributes[fieldMap[key]] = tempFeature.attributes[key];\n                            }\n                            tempFeature.attributes.exbfid = index;\n                        }\n                        else {\n                            tempFeature.attributes = {\n                                exbfid: index\n                            };\n                        }\n                        sourceFeatures.push(tempFeature);\n                    });\n                    const layer = new FeatureLayer({\n                        id: layerId,\n                        title: layerFromFeatureSet.title,\n                        source: sourceFeatures,\n                        fields: fieldsInFeaturelayer,\n                        outFields: ['*'],\n                        objectIdField: 'exbfid',\n                        renderer: layerFromFeatureSet.renderer,\n                        popupEnabled: true,\n                        popupTemplate: {\n                            title: 'information',\n                            content: [{\n                                    type: 'fields',\n                                    fieldInfos: fieldsInPopupTemplate\n                                }]\n                        }\n                    });\n                    mapBaseView.map.add(layer);\n                    layer.on('layerview-create', event => {\n                        return resolve(null);\n                    });\n                }\n            });\n        });\n    });\n}\nfunction getReasonableField(field) {\n    // the function is supported to normalize the field.name\n    const fieldName = field.name;\n    return {\n        name: fieldName.replace(/\\./g, '_').replace(/\\(/g, '_').replace(/\\)/g, '_'),\n        alias: field.alias,\n        type: field.type\n    };\n}\nfunction selectFeature(mapBaseView, target, layerId) {\n    // In this function, we assume that features come from the same layer\n    let featureLayerId = layerId;\n    let featureLayerView = null;\n    let tempFeature = null;\n    // if layerId doesn't exist, we get layerId by feature\n    if (!featureLayerId) {\n        if (target instanceof Array) {\n            tempFeature = target[0];\n        }\n        else {\n            tempFeature = target;\n        }\n        if (tempFeature) {\n            featureLayerId = tempFeature.layer && tempFeature.layer.id;\n        }\n    }\n    if (featureLayerId) {\n        const layerViews = mapBaseView.allLayerViews;\n        for (let i = 0; i < layerViews.length; i++) {\n            if (layerViews.getItemAt(i).layer.id === featureLayerId) {\n                featureLayerView = layerViews.getItemAt(i);\n            }\n        }\n        if (featureLayerView) {\n            return {\n                layerId: featureLayerId,\n                handle: featureLayerView.highlight(target)\n            };\n        }\n        else {\n            return null;\n        }\n    }\n}\nfunction mapPanto(mapBaseView, target) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const panToTarget = target;\n        const tempBaseMapView = mapBaseView;\n        if (panToTarget instanceof Array) {\n            if (panToTarget.length === 0)\n                return yield Promise.resolve();\n            if (panToTarget[0].geometry) {\n                const geometryArr = [];\n                for (let i = 0; i < panToTarget.length; i++) {\n                    geometryArr.push(panToTarget[i].geometry);\n                }\n                return yield getGeometriesExtent(geometryArr).then((extent) => {\n                    return tempBaseMapView.goTo(extent.center);\n                });\n            }\n            else {\n                return getGeometriesExtent(panToTarget).then((extent) => {\n                    return tempBaseMapView.goTo(extent.center);\n                });\n            }\n        }\n        else {\n            if (panToTarget.geometry) {\n                const getmetry = panToTarget.geometry;\n                return tempBaseMapView.goTo(getCenterPoint(getmetry));\n            }\n            else {\n                return tempBaseMapView.goTo(getCenterPoint(panToTarget));\n            }\n        }\n    });\n}\nfunction getGeometriesExtent(geometries) {\n    return __awaiter(this, void 0, void 0, function* () {\n        return yield (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)([\n            'esri/geometry/Extent'\n        ]).then((modules) => __awaiter(this, void 0, void 0, function* () {\n            // eslint-disable-next-line\n            let Extent;\n            [Extent] = modules;\n            if (!geometries || !geometries.length) {\n                return yield Promise.resolve(null);\n            }\n            let fullExtent = null;\n            let index;\n            const numGeometries = geometries.length;\n            for (index = 0; index < numGeometries; index++) {\n                const geometry = geometries[index];\n                if (!geometry) {\n                    continue;\n                }\n                let extent = geometry.extent;\n                if (!extent && geometry.type === 'point') {\n                    const pointGeometry = geometry;\n                    if (pointGeometry.x && pointGeometry.y) {\n                        extent = new Extent({\n                            xmax: pointGeometry.x,\n                            xmin: pointGeometry.x,\n                            ymax: pointGeometry.y,\n                            ymin: pointGeometry.y,\n                            zmax: pointGeometry.z,\n                            zmin: pointGeometry.z,\n                            spatialReference: pointGeometry.spatialReference\n                        });\n                    }\n                }\n                if (!extent) {\n                    continue;\n                }\n                if (fullExtent) {\n                    fullExtent = fullExtent.union(extent);\n                }\n                else {\n                    fullExtent = extent;\n                }\n            }\n            if (fullExtent.width < 0 && fullExtent.height < 0) {\n                return yield Promise.resolve(null);\n            }\n            return yield Promise.resolve(fullExtent);\n        }));\n    });\n}\nfunction filterFeaturesByQuery(jimuMapView, layerDataSourceId, querySQL) {\n    if (layerDataSourceId) {\n        const jimuLayerViews = jimuMapView.jimuLayerViews;\n        const jimuLayerViewIds = Object.keys(jimuLayerViews);\n        for (let i = 0; i < jimuLayerViewIds.length; i++) {\n            let tempJimuLayerView = jimuLayerViews[jimuLayerViewIds[i]];\n            if (tempJimuLayerView && tempJimuLayerView.layer && tempJimuLayerView.layerDataSourceId === layerDataSourceId &&\n                (tempJimuLayerView.type === jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.LayerTypes.FeatureLayer || tempJimuLayerView.type === jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.LayerTypes.SceneLayer)) {\n                tempJimuLayerView.setLocalDefinitionExpression(querySQL);\n            }\n        }\n    }\n}\nfunction queryFeatures(layerObject, querySQL) {\n    return (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)([\n        'esri/rest/support/Query'\n    ]).then(modules => {\n        let Query;\n        [Query] = modules;\n        const query = new Query();\n        query.where = querySQL;\n        query.outFields = ['*'];\n        query.returnGeometry = true;\n        return layerObject.queryFeatures(query).then(featureSet => {\n            return featureSet;\n        });\n    });\n}\nfunction flashOnFeatureLayer(jimuMapView, querySQL, tempJimuLayerView) {\n    if ((tempJimuLayerView).view) {\n        let featureLayerView = (tempJimuLayerView).view;\n        if (featureLayerView) {\n            queryFeatures(featureLayerView.layer, querySQL).then(featureSet => {\n                if (featureSet && featureSet.features && featureSet.features.length > 0) {\n                    const symbol = getFlashSymbol(featureLayerView.layer.geometryType);\n                    startFlash(jimuMapView.view, featureSet.features, symbol);\n                }\n            });\n        }\n        else {\n            return null;\n        }\n    }\n    else {\n        (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)([\n            'esri/layers/FeatureLayer'\n        ]).then(modules => {\n            let FeatureLayer;\n            [FeatureLayer] = modules;\n            let tempFeatureLayer = new FeatureLayer({\n                url: jimu_core__WEBPACK_IMPORTED_MODULE_0__.dataSourceUtils.getUrlByLayer(tempJimuLayerView.layer)\n            });\n            tempFeatureLayer.load().then(() => {\n                queryFeatures(tempFeatureLayer, querySQL).then(featureSet => {\n                    if (featureSet && featureSet.features && featureSet.features.length > 0) {\n                        const symbol = getFlashSymbol(featureSet.features[0].geometry.type);\n                        startFlash(jimuMapView.view, featureSet.features, symbol);\n                    }\n                });\n            });\n        });\n    }\n}\nlet sceneHightlightHandle = null;\nfunction flashOnSceneLayer(jimuMapView, querySQL, tempJimuLayerView) {\n    var _a;\n    if ((tempJimuLayerView).view) {\n        let sceneLayerView = (tempJimuLayerView).view;\n        // @ts-expect-error\n        queryFeatures((_a = sceneLayerView === null || sceneLayerView === void 0 ? void 0 : sceneLayerView.layer) === null || _a === void 0 ? void 0 : _a.associatedLayer, querySQL).then(featureSet => {\n            if (featureSet && featureSet.features && featureSet.features.length > 0) {\n                const objectIdField = sceneLayerView.layer.objectIdField;\n                const objectIds = featureSet.features.map(feature => feature.attributes[objectIdField]);\n                let i = 0;\n                const maxFlashCount = 6;\n                let highlightColor = [255, 255, 0, 0.8];\n                const originalHighlightOptions = jimuMapView.view.highlightOptions;\n                const flash = function () {\n                    if (i < maxFlashCount) {\n                        i++;\n                        if (highlightColor) {\n                            highlightColor = null;\n                            // @ts-expect-error\n                            jimuMapView.view.highlightOptions = { color: [0, 0, 0, 0] };\n                            sceneHightlightHandle && sceneHightlightHandle.remove();\n                            sceneHightlightHandle = sceneLayerView.highlight(objectIds);\n                        }\n                        else {\n                            highlightColor = [255, 255, 0, 0.8];\n                            // @ts-expect-error\n                            jimuMapView.view.highlightOptions = { color: highlightColor };\n                            sceneHightlightHandle && sceneHightlightHandle.remove();\n                            sceneHightlightHandle = sceneLayerView.highlight(objectIds);\n                        }\n                        setTimeout(flash, 500);\n                    }\n                    else {\n                        jimuMapView.view.highlightOptions = originalHighlightOptions;\n                        sceneHightlightHandle && sceneHightlightHandle.remove();\n                    }\n                };\n                setTimeout(flash, 500);\n            }\n        });\n    }\n}\nfunction flashFeaturesByQuery(jimuMapView, layerDataSourceId, querySQL) {\n    if (layerDataSourceId) {\n        const jimuLayerViews = jimuMapView.jimuLayerViews;\n        const jimuLayerViewIds = Object.keys(jimuLayerViews);\n        for (let i = 0; i < jimuLayerViewIds.length; i++) {\n            let tempJimuLayerView = jimuLayerViews[jimuLayerViewIds[i]];\n            if (tempJimuLayerView && tempJimuLayerView.layer && tempJimuLayerView.layerDataSourceId === layerDataSourceId) {\n                if (tempJimuLayerView.type === jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.LayerTypes.FeatureLayer) {\n                    flashOnFeatureLayer(jimuMapView, querySQL, tempJimuLayerView);\n                }\n                else if (tempJimuLayerView.type === jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.LayerTypes.SceneLayer) {\n                    flashOnSceneLayer(jimuMapView, querySQL, tempJimuLayerView);\n                }\n            }\n        }\n    }\n}\nfunction startFlash(mapBaseView, features, symbol) {\n    (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)([\n        'esri/Graphic'\n    ]).then(modules => {\n        // eslint-disable-next-line\n        let Graphic;\n        [Graphic] = modules;\n        const flashFeatures = function (features, maxFlashCount) {\n            const graphics = [];\n            let flashCount = 0;\n            for (let i = 0; i < features.length; i++) {\n                const tempGraphic = new Graphic({\n                    geometry: features[i].geometry,\n                    symbol: symbol,\n                    attributes: features[i].attributes\n                });\n                graphics.push(tempGraphic);\n            }\n            const singleFlash = function () {\n                mapBaseView.graphics.addMany(graphics);\n                setTimeout(() => {\n                    mapBaseView.graphics.removeMany(graphics);\n                    flashCount = flashCount + 1;\n                    if (flashCount < maxFlashCount) {\n                        setTimeout(() => {\n                            singleFlash();\n                        }, 500);\n                    }\n                }, 500);\n            };\n            singleFlash();\n        };\n        flashFeatures(features, 3);\n    });\n}\nfunction getFlashSymbol(geometryType) {\n    if (['point', 'multipoint'].includes(geometryType)) {\n        return {\n            type: 'simple-marker',\n            style: 'circle',\n            color: [255, 255, 0, 0.8],\n            size: '16px',\n            outline: {\n                color: [255, 255, 0, 0.8],\n                width: 3\n            }\n        };\n    }\n    else if (['polyline'].includes(geometryType)) {\n        return {\n            type: 'simple-line',\n            color: [255, 255, 0, 0.8],\n            width: 3,\n            style: 'solid'\n        };\n    }\n    else if (['polygon', 'extent'].includes(geometryType)) {\n        return {\n            type: 'simple-fill',\n            color: [255, 255, 0, 0.5],\n            style: 'solid',\n            outline: {\n                color: [255, 255, 0, 0.8],\n                width: 3\n            }\n        };\n    }\n    else if (['mesh'].includes(geometryType)) {\n        return {\n            type: 'mesh-3d',\n            symbolLayers: [{\n                    type: 'fill',\n                    material: { color: [255, 255, 0, 0.8] }\n                }]\n        };\n    }\n    else {\n        return null;\n    }\n}\nfunction getCenterPoint(geometry) {\n    // point | multipoint | polyline | polygon | extent | mesh\n    switch (geometry.type) {\n        case 'point':\n            return geometry;\n        case 'extent':\n            return geometry.center;\n        case 'polygon':\n            return geometry.centroid;\n        case 'polyline':\n            return geometry.extent.center;\n        default:\n            return geometry && geometry.extent ? geometry.extent.center : undefined;\n        // todo\n    }\n}\nfunction handleFeature(feature, Graphic) {\n    let tempFeature = null;\n    if (feature.clone) {\n        tempFeature = feature.clone();\n    }\n    else {\n        tempFeature = Graphic.fromJSON(Object.assign({}, feature));\n        tempFeature.attributes = Object.assign({}, feature.attributes);\n    }\n    return tempFeature;\n}\nfunction projectGeometries(geometries, spatialReference) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (!geometries || geometries.length === 0 || !geometries[0] ||\n            spatialReference.wkid === geometries[0].spatialReference.wkid || (spatialReference.equals(geometries[0].spatialReference))) {\n            return yield Promise.resolve(geometries);\n        }\n        else if (spatialReference.isWebMercator && geometries[0].spatialReference.isWGS84) {\n            // In js api 4.x, the view can handle WebMercator and WGS84 spatialReference auto\n            return yield Promise.resolve(geometries);\n        }\n        else if (spatialReference.isWGS84 && geometries[0].spatialReference.isWebMercator) {\n            // In js api 4.x, the view can handle WebMercator and WGS84 spatialReference auto\n            return yield Promise.resolve(geometries);\n        }\n        else {\n            return yield jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.geometryUtils.projectToSpatialReference(geometries, spatialReference);\n        }\n    });\n}\nfunction processZoomToFeatures(mapBaseView, layer, features) {\n    return __awaiter(this, void 0, void 0, function* () {\n        if (mapBaseView && mapBaseView.type === '3d' && layer && layer.queryFeatures && features) {\n            return yield (0,jimu_arcgis__WEBPACK_IMPORTED_MODULE_1__.loadArcGISJSAPIModules)([\n                'esri/rest/support/Query'\n            ]).then((modules) => {\n                const [Query] = modules;\n                const query = new Query();\n                query.returnGeometry = true;\n                query.outFields = ['*'];\n                query.objectIds = features.map(feature => feature.attributes[layer.objectIdField]);\n                return layer.queryFeatures(query).then((result) => __awaiter(this, void 0, void 0, function* () {\n                    if (result && result.features && result.features.length === features.length) {\n                        return yield Promise.resolve(result.features);\n                    }\n                    else {\n                        return yield Promise.resolve(features);\n                    }\n                }), () => __awaiter(this, void 0, void 0, function* () {\n                    return yield Promise.resolve(features);\n                }));\n            });\n        }\n        else {\n            return yield Promise.resolve(features);\n        }\n    });\n}\nfunction checkIsLive(appMode) {\n    if (window.jimuConfig.isInBuilder) {\n        if (appMode === jimu_core__WEBPACK_IMPORTED_MODULE_0__.AppMode.Design) {\n            return false;\n        }\n        else {\n            return true;\n        }\n    }\n    else {\n        return true;\n    }\n}\nfunction getMapBaseRestoreData(mapInstance) {\n    return {\n        mapContainer: mapInstance.mapContainer,\n        state: mapInstance.state,\n        MapView: mapInstance.MapView,\n        SceneView: mapInstance.SceneView,\n        Extent: mapInstance.Extent,\n        Viewpoint: mapInstance.Viewpoint,\n        mapView: mapInstance.mapView,\n        sceneView: mapInstance.sceneView,\n        extentWatch: mapInstance.extentWatch,\n        fatalErrorWatch: mapInstance.fatalErrorWatch,\n        dsManager: mapInstance.dsManager,\n        highLightHandles: mapInstance.highLightHandles,\n        mapBaseViewEventHandles: mapInstance.mapBaseViewEventHandles,\n        Color: mapInstance.Color,\n        isRequestingMap: mapInstance.isRequestingMap\n    };\n}\nfunction restoreMapBase(mapInstance, restoreData) {\n    mapInstance.mapContainer = restoreData.mapContainer;\n    mapInstance.state = restoreData.state;\n    mapInstance.MapView = restoreData.MapView;\n    mapInstance.SceneView = restoreData.SceneView;\n    mapInstance.Extent = restoreData.Extent;\n    mapInstance.Viewpoint = restoreData.Viewpoint;\n    mapInstance.mapView = restoreData.mapView;\n    mapInstance.sceneView = restoreData.sceneView;\n    mapInstance.extentWatch = restoreData.extentWatch;\n    mapInstance.fatalErrorWatch = restoreData.fatalErrorWatch;\n    mapInstance.dsManager = restoreData.dsManager;\n    mapInstance.highLightHandles = restoreData.highLightHandles;\n    mapInstance.mapBaseViewEventHandles = restoreData.mapBaseViewEventHandles;\n    mapInstance.Color = restoreData.Color;\n    mapInstance.isRequestingMap = restoreData.isRequestingMap;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiLi9leHRlbnNpb25zL3dpZGdldHMvYXJjZ2lzL2FyY2dpcy1tYXAvc3JjL3J1bnRpbWUvdXRpbHMudHMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUdBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBRUE7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQUE7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBOztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBRUE7O0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXhiLWNsaWVudC8uL2V4dGVuc2lvbnMvd2lkZ2V0cy9hcmNnaXMvYXJjZ2lzLW1hcC9zcmMvcnVudGltZS91dGlscy50cz9mZTQ0Il0sInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIHByZWZlci1jb25zdCAqL1xuaW1wb3J0IHsgQXBwTW9kZSwgZGF0YVNvdXJjZVV0aWxzIH0gZnJvbSAnamltdS1jb3JlJ1xuaW1wb3J0IE1hcEJhc2UsIHsgSGlnaExpZ2h0SGFuZGxlIH0gZnJvbSAnLi9jb21wb25lbnRzL21hcGJhc2UnXG5pbXBvcnQgeyBJRmVhdHVyZSB9IGZyb20gJ0Blc3JpL2FyY2dpcy1yZXN0LXR5cGVzJ1xuaW1wb3J0IHsgZ2VvbWV0cnlVdGlscywgbG9hZEFyY0dJU0pTQVBJTW9kdWxlcywgSmltdU1hcFZpZXcsIExheWVyVHlwZXMsIEppbXVGZWF0dXJlTGF5ZXJWaWV3LCBKaW11U2NlbmVMYXllclZpZXcgfSBmcm9tICdqaW11LWFyY2dpcydcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRyb2xVSVdpZGdldCAobWFwQmFzZVZpZXc6IF9fZXNyaS5NYXBWaWV3IHwgX19lc3JpLlNjZW5lVmlldywgaXNPcGVuOiBib29sZWFuLCB1aVdpZGdldDogX19lc3JpLldpZGdldCwgcG9zaXRpb24/OiBzdHJpbmcsIHdpZGdldE5hbWU/OiBzdHJpbmcpIHtcbiAgY29uc3QgdWkgPSBtYXBCYXNlVmlldy51aSBhcyBhbnlcbiAgaWYgKCF1aVdpZGdldCkge1xuICAgIHJldHVyblxuICB9XG4gIGlmIChpc09wZW4pIHtcbiAgICB1aS5hZGQodWlXaWRnZXQsIHBvc2l0aW9uKVxuICAgIGlmICh3aWRnZXROYW1lICYmIHVpLmV4Yk1hcFRvb2xzLmluZGV4T2Yod2lkZ2V0TmFtZSkgPT09IC0xKSB7XG4gICAgICB1aS5leGJNYXBUb29scy5wdXNoKHdpZGdldE5hbWUpXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHVpLnJlbW92ZSh1aVdpZGdldClcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY3JlYXRlTmV3RmVhdHVyZWxheWVyIChtYXBCYXNlVmlldzogX19lc3JpLk1hcFZpZXcgfCBfX2VzcmkuU2NlbmVWaWV3LCBuZXdGZWF0dXJlU2V0VmFsdWU/OiB7W2xheWVySUQ6IHN0cmluZ106IF9fZXNyaS5GZWF0dXJlU2V0fSk6IFByb21pc2U8YW55PiB7XG4gIGNvbnN0IG5ld0xheWVyUHJvbWlzZXMgPSBbXVxuICBuZXdGZWF0dXJlU2V0VmFsdWUgJiYgT2JqZWN0LmtleXMobmV3RmVhdHVyZVNldFZhbHVlKS5mb3JFYWNoKGxheWVySWQgPT4ge1xuICAgIGNvbnN0IGxheWVyID0gbWFwQmFzZVZpZXcubWFwLmxheWVycy5maW5kKGxheWVyID0+IGxheWVyLmlkID09PSBsYXllcklkKVxuICAgIGlmIChsYXllcikge1xuICAgICAgY29uc29sZS53YXJuKCd0aGUgZmVhdHVyZSBsYXllciBpcyBhbHJlYWR5IGNyZWF0ZWQnKVxuICAgICAgcmV0dXJuXG4gICAgfVxuICAgIG5ld0xheWVyUHJvbWlzZXMucHVzaChhZGRGZWF0dXJlU2V0VG9NYXAobWFwQmFzZVZpZXcsIG5ld0ZlYXR1cmVTZXRWYWx1ZVtsYXllcklkXSwgbGF5ZXJJZCkpXG4gIH0pXG5cbiAgaWYgKG5ld0xheWVyUHJvbWlzZXMubGVuZ3RoID09PSAwKSB7XG4gICAgcmV0dXJuIG51bGxcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwobmV3TGF5ZXJQcm9taXNlcylcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gdXBkYXRlRmVhdHVyZWxheWVyIChtYXBCYXNlVmlldzogX19lc3JpLk1hcFZpZXcgfCBfX2VzcmkuU2NlbmVWaWV3LCBjaGFuZ2VkRmVhdHVyZVNldFZhbHVlPzoge1tsYXllcklEOiBzdHJpbmddOiBfX2VzcmkuRmVhdHVyZVNldH0pOiBQcm9taXNlPGFueT4ge1xuICBjb25zdCB1cGRhdGVQcm9taXNlcyA9IFtdXG4gIGNoYW5nZWRGZWF0dXJlU2V0VmFsdWUgJiYgT2JqZWN0LmtleXMoY2hhbmdlZEZlYXR1cmVTZXRWYWx1ZSkuZm9yRWFjaChsYXllcklkID0+IHtcbiAgICBjb25zdCBsYXllciA9IG1hcEJhc2VWaWV3Lm1hcC5sYXllcnMuZmluZChsYXllciA9PiBsYXllci5pZCA9PT0gbGF5ZXJJZClcbiAgICBpZiAobGF5ZXIpIHtcbiAgICAgIG1hcEJhc2VWaWV3Lm1hcC5yZW1vdmUobGF5ZXIpXG4gICAgICB1cGRhdGVQcm9taXNlcy5wdXNoKGFkZEZlYXR1cmVTZXRUb01hcChtYXBCYXNlVmlldywgY2hhbmdlZEZlYXR1cmVTZXRWYWx1ZVtsYXllcklkXSwgbGF5ZXJJZCkpXG4gICAgfVxuICB9KVxuXG4gIGlmICh1cGRhdGVQcm9taXNlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbFxuICB9IGVsc2Uge1xuICAgIHJldHVybiBQcm9taXNlLmFsbCh1cGRhdGVQcm9taXNlcylcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBhZGRGZWF0dXJlU2V0VG9NYXAgKG1hcEJhc2VWaWV3OiBfX2VzcmkuTWFwVmlldyB8IF9fZXNyaS5TY2VuZVZpZXcsIGZlYXR1cmVTZXQ6IF9fZXNyaS5GZWF0dXJlU2V0LCBsYXllcklkOiBzdHJpbmcpOiBQcm9taXNlPGFueT4ge1xuICByZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIHJldHVybiBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAgICdlc3JpL2xheWVycy9GZWF0dXJlTGF5ZXInXG4gICAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICAgIGlmIChmZWF0dXJlU2V0LmZlYXR1cmVzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUobnVsbClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIGxldCBGZWF0dXJlU2V0OiB0eXBlb2YgIF9fZXNyaS5GZWF0dXJlU2V0O1xuICAgICAgICBsZXQgRmVhdHVyZUxheWVyOiB0eXBlb2YgX19lc3JpLkZlYXR1cmVMYXllcjtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgIFtGZWF0dXJlTGF5ZXJdID0gbW9kdWxlcztcblxuICAgICAgICBjb25zdCBsYXllckZyb21GZWF0dXJlU2V0ID0gZmVhdHVyZVNldC5mZWF0dXJlc1swXS5sYXllciBhcyBhbnlcbiAgICAgICAgY29uc3QgZmllbGRzSW5GZWF0dXJlbGF5ZXIgPSBbXVxuICAgICAgICBjb25zdCBmaWVsZE1hcCA9IHt9XG5cbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXllckZyb21GZWF0dXJlU2V0LmZpZWxkcy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIGNvbnN0IGZpZWxkc0l0ZW0gPSBnZXRSZWFzb25hYmxlRmllbGQobGF5ZXJGcm9tRmVhdHVyZVNldC5maWVsZHNbaV0pXG4gICAgICAgICAgZmllbGRNYXBbbGF5ZXJGcm9tRmVhdHVyZVNldC5maWVsZHNbaV0ubmFtZV0gPSBmaWVsZHNJdGVtLm5hbWVcbiAgICAgICAgICBmaWVsZHNJbkZlYXR1cmVsYXllci5wdXNoKGZpZWxkc0l0ZW0pXG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBmaWVsZHNJblBvcHVwVGVtcGxhdGUgPSBbXVxuICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiBmZWF0dXJlU2V0LmZlYXR1cmVzWzBdLmF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICBpZiAoZmllbGRNYXBba2V5XSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGRzSXRlbSA9IHtcbiAgICAgICAgICAgICAgZmllbGROYW1lOiBmaWVsZE1hcFtrZXldLFxuICAgICAgICAgICAgICBsYWJlbDoga2V5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBmaWVsZHNJblBvcHVwVGVtcGxhdGUucHVzaChmaWVsZHNJdGVtKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHNvdXJjZUZlYXR1cmVzID0gW11cbiAgICAgICAgZmVhdHVyZVNldC5mZWF0dXJlcy5mb3JFYWNoKChmZWF0dXJlLCBpbmRleCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHRlbXBGZWF0dXJlID0gZmVhdHVyZVxuICAgICAgICAgIGlmICh0ZW1wRmVhdHVyZS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGtleSBpbiB0ZW1wRmVhdHVyZS5hdHRyaWJ1dGVzKSB7XG4gICAgICAgICAgICAgIHRlbXBGZWF0dXJlLmF0dHJpYnV0ZXNbZmllbGRNYXBba2V5XV0gPSB0ZW1wRmVhdHVyZS5hdHRyaWJ1dGVzW2tleV1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGVtcEZlYXR1cmUuYXR0cmlidXRlcy5leGJmaWQgPSBpbmRleFxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0ZW1wRmVhdHVyZS5hdHRyaWJ1dGVzID0ge1xuICAgICAgICAgICAgICBleGJmaWQ6IGluZGV4XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHNvdXJjZUZlYXR1cmVzLnB1c2godGVtcEZlYXR1cmUpXG4gICAgICAgIH0pXG5cbiAgICAgICAgY29uc3QgbGF5ZXIgPSBuZXcgRmVhdHVyZUxheWVyKHtcbiAgICAgICAgICBpZDogbGF5ZXJJZCxcbiAgICAgICAgICB0aXRsZTogbGF5ZXJGcm9tRmVhdHVyZVNldC50aXRsZSxcbiAgICAgICAgICBzb3VyY2U6IHNvdXJjZUZlYXR1cmVzLFxuICAgICAgICAgIGZpZWxkczogZmllbGRzSW5GZWF0dXJlbGF5ZXIsXG4gICAgICAgICAgb3V0RmllbGRzOiBbJyonXSxcbiAgICAgICAgICBvYmplY3RJZEZpZWxkOiAnZXhiZmlkJyxcbiAgICAgICAgICByZW5kZXJlcjogbGF5ZXJGcm9tRmVhdHVyZVNldC5yZW5kZXJlcixcbiAgICAgICAgICBwb3B1cEVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgcG9wdXBUZW1wbGF0ZToge1xuICAgICAgICAgICAgdGl0bGU6ICdpbmZvcm1hdGlvbicsXG4gICAgICAgICAgICBjb250ZW50OiBbe1xuICAgICAgICAgICAgICB0eXBlOiAnZmllbGRzJyxcbiAgICAgICAgICAgICAgZmllbGRJbmZvczogZmllbGRzSW5Qb3B1cFRlbXBsYXRlXG4gICAgICAgICAgICB9XVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICBtYXBCYXNlVmlldy5tYXAuYWRkKGxheWVyKVxuXG4gICAgICAgIGxheWVyLm9uKCdsYXllcnZpZXctY3JlYXRlJywgZXZlbnQgPT4ge1xuICAgICAgICAgIHJldHVybiByZXNvbHZlKG51bGwpXG4gICAgICAgIH0pXG4gICAgICB9XG4gICAgfSlcbiAgfSlcbn1cblxuZnVuY3Rpb24gZ2V0UmVhc29uYWJsZUZpZWxkIChmaWVsZDogX19lc3JpLkZpZWxkKTogX19lc3JpLkZpZWxkIHtcbiAgLy8gdGhlIGZ1bmN0aW9uIGlzIHN1cHBvcnRlZCB0byBub3JtYWxpemUgdGhlIGZpZWxkLm5hbWVcbiAgY29uc3QgZmllbGROYW1lID0gZmllbGQubmFtZVxuICByZXR1cm4ge1xuICAgIG5hbWU6IGZpZWxkTmFtZS5yZXBsYWNlKC9cXC4vZywgJ18nKS5yZXBsYWNlKC9cXCgvZywgJ18nKS5yZXBsYWNlKC9cXCkvZywgJ18nKSxcbiAgICBhbGlhczogZmllbGQuYWxpYXMsXG4gICAgdHlwZTogZmllbGQudHlwZVxuICB9IGFzIGFueVxufVxuXG5leHBvcnQgZnVuY3Rpb24gc2VsZWN0RmVhdHVyZSAobWFwQmFzZVZpZXc6IF9fZXNyaS5NYXBWaWV3IHwgX19lc3JpLlNjZW5lVmlldywgdGFyZ2V0OiBfX2VzcmkuR3JhcGhpYyB8IF9fZXNyaS5HcmFwaGljW10gfCBJRmVhdHVyZSB8IElGZWF0dXJlW10sIGxheWVySWQ/OiBzdHJpbmcpOiBIaWdoTGlnaHRIYW5kbGUge1xuICAvLyBJbiB0aGlzIGZ1bmN0aW9uLCB3ZSBhc3N1bWUgdGhhdCBmZWF0dXJlcyBjb21lIGZyb20gdGhlIHNhbWUgbGF5ZXJcbiAgbGV0IGZlYXR1cmVMYXllcklkID0gbGF5ZXJJZFxuICBsZXQgZmVhdHVyZUxheWVyVmlldyA9IG51bGxcbiAgbGV0IHRlbXBGZWF0dXJlID0gbnVsbFxuXG4gIC8vIGlmIGxheWVySWQgZG9lc24ndCBleGlzdCwgd2UgZ2V0IGxheWVySWQgYnkgZmVhdHVyZVxuICBpZiAoIWZlYXR1cmVMYXllcklkKSB7XG4gICAgaWYgKHRhcmdldCBpbnN0YW5jZW9mIEFycmF5KSB7XG4gICAgICB0ZW1wRmVhdHVyZSA9IHRhcmdldFswXSBhcyBfX2VzcmkuR3JhcGhpY1xuICAgIH0gZWxzZSB7XG4gICAgICB0ZW1wRmVhdHVyZSA9IHRhcmdldCBhcyBfX2VzcmkuR3JhcGhpY1xuICAgIH1cblxuICAgIGlmICh0ZW1wRmVhdHVyZSkge1xuICAgICAgZmVhdHVyZUxheWVySWQgPSB0ZW1wRmVhdHVyZS5sYXllciAmJiB0ZW1wRmVhdHVyZS5sYXllci5pZFxuICAgIH1cbiAgfVxuXG4gIGlmIChmZWF0dXJlTGF5ZXJJZCkge1xuICAgIGNvbnN0IGxheWVyVmlld3MgPSBtYXBCYXNlVmlldy5hbGxMYXllclZpZXdzXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsYXllclZpZXdzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAobGF5ZXJWaWV3cy5nZXRJdGVtQXQoaSkubGF5ZXIuaWQgPT09IGZlYXR1cmVMYXllcklkKSB7XG4gICAgICAgIGZlYXR1cmVMYXllclZpZXcgPSBsYXllclZpZXdzLmdldEl0ZW1BdChpKVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmZWF0dXJlTGF5ZXJWaWV3KSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBsYXllcklkOiBmZWF0dXJlTGF5ZXJJZCxcbiAgICAgICAgaGFuZGxlOiBmZWF0dXJlTGF5ZXJWaWV3LmhpZ2hsaWdodCh0YXJnZXQpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtYXBQYW50byAobWFwQmFzZVZpZXc6IF9fZXNyaS5NYXBWaWV3IHwgX19lc3JpLlNjZW5lVmlldywgdGFyZ2V0OiBfX2VzcmkuR2VvbWV0cnkgfCBfX2VzcmkuR2VvbWV0cnlbXSB8XG5fX2VzcmkuR3JhcGhpYyB8IF9fZXNyaS5HcmFwaGljW10gfCBfX2VzcmkuRXh0ZW50KTogUHJvbWlzZTxhbnk+IHtcbiAgY29uc3QgcGFuVG9UYXJnZXQgPSB0YXJnZXQgYXMgYW55XG4gIGNvbnN0IHRlbXBCYXNlTWFwVmlldyA9IG1hcEJhc2VWaWV3IGFzIGFueVxuICBpZiAocGFuVG9UYXJnZXQgaW5zdGFuY2VvZiBBcnJheSkge1xuICAgIGlmIChwYW5Ub1RhcmdldC5sZW5ndGggPT09IDApIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoKVxuXG4gICAgaWYgKHBhblRvVGFyZ2V0WzBdLmdlb21ldHJ5KSB7XG4gICAgICBjb25zdCBnZW9tZXRyeUFycjogX19lc3JpLkdlb21ldHJ5W10gPSBbXVxuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBwYW5Ub1RhcmdldC5sZW5ndGg7IGkrKykge1xuICAgICAgICBnZW9tZXRyeUFyci5wdXNoKHBhblRvVGFyZ2V0W2ldLmdlb21ldHJ5KVxuICAgICAgfVxuXG4gICAgICByZXR1cm4gYXdhaXQgZ2V0R2VvbWV0cmllc0V4dGVudChnZW9tZXRyeUFycikudGhlbigoZXh0ZW50KSA9PiB7XG4gICAgICAgIHJldHVybiB0ZW1wQmFzZU1hcFZpZXcuZ29UbyhleHRlbnQuY2VudGVyKVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGdldEdlb21ldHJpZXNFeHRlbnQocGFuVG9UYXJnZXQpLnRoZW4oKGV4dGVudCkgPT4ge1xuICAgICAgICByZXR1cm4gdGVtcEJhc2VNYXBWaWV3LmdvVG8oZXh0ZW50LmNlbnRlcilcbiAgICAgIH0pXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGlmIChwYW5Ub1RhcmdldC5nZW9tZXRyeSkge1xuICAgICAgY29uc3QgZ2V0bWV0cnkgPSBwYW5Ub1RhcmdldC5nZW9tZXRyeSBhcyBfX2VzcmkuR2VvbWV0cnlcbiAgICAgIHJldHVybiB0ZW1wQmFzZU1hcFZpZXcuZ29UbyhnZXRDZW50ZXJQb2ludChnZXRtZXRyeSkpXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0ZW1wQmFzZU1hcFZpZXcuZ29UbyhnZXRDZW50ZXJQb2ludChwYW5Ub1RhcmdldCkpXG4gICAgfVxuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEdlb21ldHJpZXNFeHRlbnQgKGdlb21ldHJpZXM6IF9fZXNyaS5HZW9tZXRyeVtdKTogUHJvbWlzZTxfX2VzcmkuRXh0ZW50PiB7XG4gIHJldHVybiBhd2FpdCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAnZXNyaS9nZW9tZXRyeS9FeHRlbnQnXG4gIF0pLnRoZW4oYXN5bmMgbW9kdWxlcyA9PiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgbGV0IEV4dGVudDogdHlwZW9mIF9fZXNyaS5FeHRlbnQ7XG4gICAgW0V4dGVudF0gPSBtb2R1bGVzXG5cbiAgICBpZiAoIWdlb21ldHJpZXMgfHwgIWdlb21ldHJpZXMubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKG51bGwpXG4gICAgfVxuXG4gICAgbGV0IGZ1bGxFeHRlbnQ6IF9fZXNyaS5FeHRlbnQgPSBudWxsXG4gICAgbGV0IGluZGV4XG4gICAgY29uc3QgbnVtR2VvbWV0cmllcyA9IGdlb21ldHJpZXMubGVuZ3RoXG5cbiAgICBmb3IgKGluZGV4ID0gMDsgaW5kZXggPCBudW1HZW9tZXRyaWVzOyBpbmRleCsrKSB7XG4gICAgICBjb25zdCBnZW9tZXRyeSA9IGdlb21ldHJpZXNbaW5kZXhdXG4gICAgICBpZiAoIWdlb21ldHJ5KSB7XG4gICAgICAgIGNvbnRpbnVlXG4gICAgICB9XG5cbiAgICAgIGxldCBleHRlbnQgPSBnZW9tZXRyeS5leHRlbnRcblxuICAgICAgaWYgKCFleHRlbnQgJiYgZ2VvbWV0cnkudHlwZSA9PT0gJ3BvaW50Jykge1xuICAgICAgICBjb25zdCBwb2ludEdlb21ldHJ5ID0gZ2VvbWV0cnkgYXMgYW55XG5cbiAgICAgICAgaWYgKHBvaW50R2VvbWV0cnkueCAmJiBwb2ludEdlb21ldHJ5LnkpIHtcbiAgICAgICAgICBleHRlbnQgPSBuZXcgRXh0ZW50KHtcbiAgICAgICAgICAgIHhtYXg6IHBvaW50R2VvbWV0cnkueCxcbiAgICAgICAgICAgIHhtaW46IHBvaW50R2VvbWV0cnkueCxcbiAgICAgICAgICAgIHltYXg6IHBvaW50R2VvbWV0cnkueSxcbiAgICAgICAgICAgIHltaW46IHBvaW50R2VvbWV0cnkueSxcbiAgICAgICAgICAgIHptYXg6IHBvaW50R2VvbWV0cnkueixcbiAgICAgICAgICAgIHptaW46IHBvaW50R2VvbWV0cnkueixcbiAgICAgICAgICAgIHNwYXRpYWxSZWZlcmVuY2U6IHBvaW50R2VvbWV0cnkuc3BhdGlhbFJlZmVyZW5jZVxuICAgICAgICAgIH0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKCFleHRlbnQpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgaWYgKGZ1bGxFeHRlbnQpIHtcbiAgICAgICAgZnVsbEV4dGVudCA9IGZ1bGxFeHRlbnQudW5pb24oZXh0ZW50KVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZnVsbEV4dGVudCA9IGV4dGVudFxuICAgICAgfVxuICAgIH1cblxuICAgIGlmIChmdWxsRXh0ZW50LndpZHRoIDwgMCAmJiBmdWxsRXh0ZW50LmhlaWdodCA8IDApIHtcbiAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUobnVsbClcbiAgICB9XG5cbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGZ1bGxFeHRlbnQpXG4gIH0pXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJGZWF0dXJlc0J5UXVlcnkgKGppbXVNYXBWaWV3OiBKaW11TWFwVmlldywgbGF5ZXJEYXRhU291cmNlSWQ6IHN0cmluZywgcXVlcnlTUUw6IHN0cmluZyk6IHZvaWQge1xuICBpZiAobGF5ZXJEYXRhU291cmNlSWQpIHtcbiAgICBjb25zdCBqaW11TGF5ZXJWaWV3cyA9IGppbXVNYXBWaWV3LmppbXVMYXllclZpZXdzXG4gICAgY29uc3QgamltdUxheWVyVmlld0lkcyA9IE9iamVjdC5rZXlzKGppbXVMYXllclZpZXdzKVxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgamltdUxheWVyVmlld0lkcy5sZW5ndGg7IGkrKykge1xuICAgICAgbGV0IHRlbXBKaW11TGF5ZXJWaWV3ID0gamltdUxheWVyVmlld3NbamltdUxheWVyVmlld0lkc1tpXV1cbiAgICAgIGlmICh0ZW1wSmltdUxheWVyVmlldyAmJiB0ZW1wSmltdUxheWVyVmlldy5sYXllciAmJiB0ZW1wSmltdUxheWVyVmlldy5sYXllckRhdGFTb3VyY2VJZCA9PT0gbGF5ZXJEYXRhU291cmNlSWQgJiZcbiAgICAgICAgKHRlbXBKaW11TGF5ZXJWaWV3LnR5cGUgPT09IExheWVyVHlwZXMuRmVhdHVyZUxheWVyIHx8IHRlbXBKaW11TGF5ZXJWaWV3LnR5cGUgPT09IExheWVyVHlwZXMuU2NlbmVMYXllcikpIHtcbiAgICAgICAgKHRlbXBKaW11TGF5ZXJWaWV3IGFzIEppbXVGZWF0dXJlTGF5ZXJWaWV3IHwgSmltdVNjZW5lTGF5ZXJWaWV3KS5zZXRMb2NhbERlZmluaXRpb25FeHByZXNzaW9uKHF1ZXJ5U1FMKVxuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBxdWVyeUZlYXR1cmVzIChsYXllck9iamVjdCwgcXVlcnlTUUwpIHtcbiAgcmV0dXJuIGxvYWRBcmNHSVNKU0FQSU1vZHVsZXMoW1xuICAgICdlc3JpL3Jlc3Qvc3VwcG9ydC9RdWVyeSdcbiAgXSkudGhlbihtb2R1bGVzID0+IHtcbiAgICBsZXQgUXVlcnk6IHR5cGVvZiBfX2VzcmkuUXVlcnk7XG4gICAgW1F1ZXJ5XSA9IG1vZHVsZXNcbiAgICBjb25zdCBxdWVyeSA9IG5ldyBRdWVyeSgpXG4gICAgcXVlcnkud2hlcmUgPSBxdWVyeVNRTFxuICAgIHF1ZXJ5Lm91dEZpZWxkcyA9IFsnKiddXG4gICAgcXVlcnkucmV0dXJuR2VvbWV0cnkgPSB0cnVlXG4gICAgcmV0dXJuIGxheWVyT2JqZWN0LnF1ZXJ5RmVhdHVyZXMocXVlcnkpLnRoZW4oZmVhdHVyZVNldCA9PiB7XG4gICAgICByZXR1cm4gZmVhdHVyZVNldFxuICAgIH0pXG4gIH0pXG59XG5cbmZ1bmN0aW9uIGZsYXNoT25GZWF0dXJlTGF5ZXIgKGppbXVNYXBWaWV3OiBKaW11TWFwVmlldywgcXVlcnlTUUw6IHN0cmluZywgdGVtcEppbXVMYXllclZpZXc6IEppbXVGZWF0dXJlTGF5ZXJWaWV3KSB7XG4gIGlmICgodGVtcEppbXVMYXllclZpZXcpLnZpZXcpIHtcbiAgICBsZXQgZmVhdHVyZUxheWVyVmlldzogX19lc3JpLkZlYXR1cmVMYXllclZpZXcgPSAodGVtcEppbXVMYXllclZpZXcpLnZpZXdcbiAgICBpZiAoZmVhdHVyZUxheWVyVmlldykge1xuICAgICAgcXVlcnlGZWF0dXJlcyhmZWF0dXJlTGF5ZXJWaWV3LmxheWVyLCBxdWVyeVNRTCkudGhlbihmZWF0dXJlU2V0ID0+IHtcbiAgICAgICAgaWYgKGZlYXR1cmVTZXQgJiYgZmVhdHVyZVNldC5mZWF0dXJlcyAmJiBmZWF0dXJlU2V0LmZlYXR1cmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICBjb25zdCBzeW1ib2wgPSBnZXRGbGFzaFN5bWJvbChmZWF0dXJlTGF5ZXJWaWV3LmxheWVyLmdlb21ldHJ5VHlwZSlcbiAgICAgICAgICBzdGFydEZsYXNoKGppbXVNYXBWaWV3LnZpZXcsIGZlYXR1cmVTZXQuZmVhdHVyZXMsIHN5bWJvbClcbiAgICAgICAgfVxuICAgICAgfSlcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG51bGxcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgbG9hZEFyY0dJU0pTQVBJTW9kdWxlcyhbXG4gICAgICAnZXNyaS9sYXllcnMvRmVhdHVyZUxheWVyJ1xuICAgIF0pLnRoZW4obW9kdWxlcyA9PiB7XG4gICAgICBsZXQgRmVhdHVyZUxheWVyOiB0eXBlb2YgX19lc3JpLkZlYXR1cmVMYXllcjtcbiAgICAgIFtGZWF0dXJlTGF5ZXJdID0gbW9kdWxlc1xuXG4gICAgICBsZXQgdGVtcEZlYXR1cmVMYXllciA9IG5ldyBGZWF0dXJlTGF5ZXIoe1xuICAgICAgICB1cmw6IGRhdGFTb3VyY2VVdGlscy5nZXRVcmxCeUxheWVyKCh0ZW1wSmltdUxheWVyVmlldyBhcyBKaW11RmVhdHVyZUxheWVyVmlldyB8IEppbXVTY2VuZUxheWVyVmlldykubGF5ZXIpXG4gICAgICB9KVxuICAgICAgdGVtcEZlYXR1cmVMYXllci5sb2FkKCkudGhlbigoKSA9PiB7XG4gICAgICAgIHF1ZXJ5RmVhdHVyZXModGVtcEZlYXR1cmVMYXllciwgcXVlcnlTUUwpLnRoZW4oZmVhdHVyZVNldCA9PiB7XG4gICAgICAgICAgaWYgKGZlYXR1cmVTZXQgJiYgZmVhdHVyZVNldC5mZWF0dXJlcyAmJiBmZWF0dXJlU2V0LmZlYXR1cmVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHN5bWJvbCA9IGdldEZsYXNoU3ltYm9sKGZlYXR1cmVTZXQuZmVhdHVyZXNbMF0uZ2VvbWV0cnkudHlwZSlcbiAgICAgICAgICAgIHN0YXJ0Rmxhc2goamltdU1hcFZpZXcudmlldywgZmVhdHVyZVNldC5mZWF0dXJlcywgc3ltYm9sKVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgIH0pXG4gICAgfSlcbiAgfVxufVxuXG5sZXQgc2NlbmVIaWdodGxpZ2h0SGFuZGxlID0gbnVsbFxuZnVuY3Rpb24gZmxhc2hPblNjZW5lTGF5ZXIgKGppbXVNYXBWaWV3OiBKaW11TWFwVmlldywgcXVlcnlTUUw6IHN0cmluZywgdGVtcEppbXVMYXllclZpZXc6IEppbXVTY2VuZUxheWVyVmlldykge1xuICBpZiAoKHRlbXBKaW11TGF5ZXJWaWV3KS52aWV3KSB7XG4gICAgbGV0IHNjZW5lTGF5ZXJWaWV3OiBfX2VzcmkuU2NlbmVMYXllclZpZXcgPSAodGVtcEppbXVMYXllclZpZXcpLnZpZXdcbiAgICAvLyBAdHMtZXhwZWN0LWVycm9yXG4gICAgcXVlcnlGZWF0dXJlcyhzY2VuZUxheWVyVmlldz8ubGF5ZXI/LmFzc29jaWF0ZWRMYXllciwgcXVlcnlTUUwpLnRoZW4oZmVhdHVyZVNldCA9PiB7XG4gICAgICBpZiAoZmVhdHVyZVNldCAmJiBmZWF0dXJlU2V0LmZlYXR1cmVzICYmIGZlYXR1cmVTZXQuZmVhdHVyZXMubGVuZ3RoID4gMCkge1xuICAgICAgICBjb25zdCBvYmplY3RJZEZpZWxkID0gc2NlbmVMYXllclZpZXcubGF5ZXIub2JqZWN0SWRGaWVsZFxuICAgICAgICBjb25zdCBvYmplY3RJZHMgPSBmZWF0dXJlU2V0LmZlYXR1cmVzLm1hcChmZWF0dXJlID0+IGZlYXR1cmUuYXR0cmlidXRlc1tvYmplY3RJZEZpZWxkXSlcblxuICAgICAgICBsZXQgaSA9IDBcbiAgICAgICAgY29uc3QgbWF4Rmxhc2hDb3VudCA9IDZcbiAgICAgICAgbGV0IGhpZ2hsaWdodENvbG9yID0gWzI1NSwgMjU1LCAwLCAwLjhdXG4gICAgICAgIGNvbnN0IG9yaWdpbmFsSGlnaGxpZ2h0T3B0aW9ucyA9IGppbXVNYXBWaWV3LnZpZXcuaGlnaGxpZ2h0T3B0aW9uc1xuXG4gICAgICAgIGNvbnN0IGZsYXNoID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIGlmIChpIDwgbWF4Rmxhc2hDb3VudCkge1xuICAgICAgICAgICAgaSsrXG4gICAgICAgICAgICBpZiAoaGlnaGxpZ2h0Q29sb3IpIHtcbiAgICAgICAgICAgICAgaGlnaGxpZ2h0Q29sb3IgPSBudWxsXG4gICAgICAgICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3JcbiAgICAgICAgICAgICAgamltdU1hcFZpZXcudmlldy5oaWdobGlnaHRPcHRpb25zID0geyBjb2xvcjogWzAsIDAsIDAsIDBdIH1cbiAgICAgICAgICAgICAgc2NlbmVIaWdodGxpZ2h0SGFuZGxlICYmIHNjZW5lSGlnaHRsaWdodEhhbmRsZS5yZW1vdmUoKVxuICAgICAgICAgICAgICBzY2VuZUhpZ2h0bGlnaHRIYW5kbGUgPSBzY2VuZUxheWVyVmlldy5oaWdobGlnaHQob2JqZWN0SWRzKVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgaGlnaGxpZ2h0Q29sb3IgPSBbMjU1LCAyNTUsIDAsIDAuOF1cbiAgICAgICAgICAgICAgLy8gQHRzLWV4cGVjdC1lcnJvclxuICAgICAgICAgICAgICBqaW11TWFwVmlldy52aWV3LmhpZ2hsaWdodE9wdGlvbnMgPSB7IGNvbG9yOiBoaWdobGlnaHRDb2xvciB9XG4gICAgICAgICAgICAgIHNjZW5lSGlnaHRsaWdodEhhbmRsZSAmJiBzY2VuZUhpZ2h0bGlnaHRIYW5kbGUucmVtb3ZlKClcbiAgICAgICAgICAgICAgc2NlbmVIaWdodGxpZ2h0SGFuZGxlID0gc2NlbmVMYXllclZpZXcuaGlnaGxpZ2h0KG9iamVjdElkcylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHNldFRpbWVvdXQoZmxhc2gsIDUwMClcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgamltdU1hcFZpZXcudmlldy5oaWdobGlnaHRPcHRpb25zID0gb3JpZ2luYWxIaWdobGlnaHRPcHRpb25zXG4gICAgICAgICAgICBzY2VuZUhpZ2h0bGlnaHRIYW5kbGUgJiYgc2NlbmVIaWdodGxpZ2h0SGFuZGxlLnJlbW92ZSgpXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHNldFRpbWVvdXQoZmxhc2gsIDUwMClcbiAgICAgIH1cbiAgICB9KVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmbGFzaEZlYXR1cmVzQnlRdWVyeSAoamltdU1hcFZpZXc6IEppbXVNYXBWaWV3LCBsYXllckRhdGFTb3VyY2VJZDogc3RyaW5nLCBxdWVyeVNRTDogc3RyaW5nKTogdm9pZCB7XG4gIGlmIChsYXllckRhdGFTb3VyY2VJZCkge1xuICAgIGNvbnN0IGppbXVMYXllclZpZXdzID0gamltdU1hcFZpZXcuamltdUxheWVyVmlld3NcbiAgICBjb25zdCBqaW11TGF5ZXJWaWV3SWRzID0gT2JqZWN0LmtleXMoamltdUxheWVyVmlld3MpXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBqaW11TGF5ZXJWaWV3SWRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICBsZXQgdGVtcEppbXVMYXllclZpZXcgPSBqaW11TGF5ZXJWaWV3c1tqaW11TGF5ZXJWaWV3SWRzW2ldXVxuICAgICAgaWYgKHRlbXBKaW11TGF5ZXJWaWV3ICYmIHRlbXBKaW11TGF5ZXJWaWV3LmxheWVyICYmIHRlbXBKaW11TGF5ZXJWaWV3LmxheWVyRGF0YVNvdXJjZUlkID09PSBsYXllckRhdGFTb3VyY2VJZCkge1xuICAgICAgICBpZiAodGVtcEppbXVMYXllclZpZXcudHlwZSA9PT0gTGF5ZXJUeXBlcy5GZWF0dXJlTGF5ZXIpIHtcbiAgICAgICAgICBmbGFzaE9uRmVhdHVyZUxheWVyKGppbXVNYXBWaWV3LCBxdWVyeVNRTCwgdGVtcEppbXVMYXllclZpZXcgYXMgSmltdUZlYXR1cmVMYXllclZpZXcpXG4gICAgICAgIH0gZWxzZSBpZiAodGVtcEppbXVMYXllclZpZXcudHlwZSA9PT0gTGF5ZXJUeXBlcy5TY2VuZUxheWVyKSB7XG4gICAgICAgICAgZmxhc2hPblNjZW5lTGF5ZXIoamltdU1hcFZpZXcsIHF1ZXJ5U1FMLCB0ZW1wSmltdUxheWVyVmlldyBhcyBKaW11U2NlbmVMYXllclZpZXcpXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuZnVuY3Rpb24gc3RhcnRGbGFzaCAobWFwQmFzZVZpZXc6IF9fZXNyaS5NYXBWaWV3IHwgX19lc3JpLlNjZW5lVmlldywgZmVhdHVyZXM6IF9fZXNyaS5HcmFwaGljW10sIHN5bWJvbCkge1xuICBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAnZXNyaS9HcmFwaGljJ1xuICBdKS50aGVuKG1vZHVsZXMgPT4ge1xuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZVxuICAgIGxldCBHcmFwaGljOiB0eXBlb2YgX19lc3JpLkdyYXBoaWM7XG4gICAgW0dyYXBoaWNdID0gbW9kdWxlc1xuXG4gICAgY29uc3QgZmxhc2hGZWF0dXJlcyA9IGZ1bmN0aW9uIChmZWF0dXJlczogX19lc3JpLkdyYXBoaWNbXSwgbWF4Rmxhc2hDb3VudDogbnVtYmVyKSB7XG4gICAgICBjb25zdCBncmFwaGljcyA9IFtdXG4gICAgICBsZXQgZmxhc2hDb3VudCA9IDBcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZmVhdHVyZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgdGVtcEdyYXBoaWMgPSBuZXcgR3JhcGhpYyh7XG4gICAgICAgICAgZ2VvbWV0cnk6IGZlYXR1cmVzW2ldLmdlb21ldHJ5LFxuICAgICAgICAgIHN5bWJvbDogc3ltYm9sLFxuICAgICAgICAgIGF0dHJpYnV0ZXM6IGZlYXR1cmVzW2ldLmF0dHJpYnV0ZXNcbiAgICAgICAgfSlcbiAgICAgICAgZ3JhcGhpY3MucHVzaCh0ZW1wR3JhcGhpYylcbiAgICAgIH1cblxuICAgICAgY29uc3Qgc2luZ2xlRmxhc2ggPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIG1hcEJhc2VWaWV3LmdyYXBoaWNzLmFkZE1hbnkoZ3JhcGhpY3MpXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgIG1hcEJhc2VWaWV3LmdyYXBoaWNzLnJlbW92ZU1hbnkoZ3JhcGhpY3MpXG4gICAgICAgICAgZmxhc2hDb3VudCA9IGZsYXNoQ291bnQgKyAxXG4gICAgICAgICAgaWYgKGZsYXNoQ291bnQgPCBtYXhGbGFzaENvdW50KSB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgc2luZ2xlRmxhc2goKVxuICAgICAgICAgICAgfSwgNTAwKVxuICAgICAgICAgIH1cbiAgICAgICAgfSwgNTAwKVxuICAgICAgfVxuXG4gICAgICBzaW5nbGVGbGFzaCgpXG4gICAgfVxuXG4gICAgZmxhc2hGZWF0dXJlcyhmZWF0dXJlcywgMylcbiAgfSlcbn1cblxuZnVuY3Rpb24gZ2V0Rmxhc2hTeW1ib2wgKGdlb21ldHJ5VHlwZTogc3RyaW5nKSB7XG4gIGlmIChbJ3BvaW50JywgJ211bHRpcG9pbnQnXS5pbmNsdWRlcyhnZW9tZXRyeVR5cGUpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdzaW1wbGUtbWFya2VyJyxcbiAgICAgIHN0eWxlOiAnY2lyY2xlJyxcbiAgICAgIGNvbG9yOiBbMjU1LCAyNTUsIDAsIDAuOF0sXG4gICAgICBzaXplOiAnMTZweCcsXG4gICAgICBvdXRsaW5lOiB7XG4gICAgICAgIGNvbG9yOiBbMjU1LCAyNTUsIDAsIDAuOF0sXG4gICAgICAgIHdpZHRoOiAzXG4gICAgICB9XG4gICAgfVxuICB9IGVsc2UgaWYgKFsncG9seWxpbmUnXS5pbmNsdWRlcyhnZW9tZXRyeVR5cGUpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdzaW1wbGUtbGluZScsXG4gICAgICBjb2xvcjogWzI1NSwgMjU1LCAwLCAwLjhdLFxuICAgICAgd2lkdGg6IDMsXG4gICAgICBzdHlsZTogJ3NvbGlkJ1xuICAgIH1cbiAgfSBlbHNlIGlmIChbJ3BvbHlnb24nLCAnZXh0ZW50J10uaW5jbHVkZXMoZ2VvbWV0cnlUeXBlKSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiAnc2ltcGxlLWZpbGwnLCAvLyBhdXRvY2FzdHMgYXMgbmV3IFNpbXBsZUZpbGxTeW1ib2woKVxuICAgICAgY29sb3I6IFsyNTUsIDI1NSwgMCwgMC41XSxcbiAgICAgIHN0eWxlOiAnc29saWQnLFxuICAgICAgb3V0bGluZTogeyAvLyBhdXRvY2FzdHMgYXMgbmV3IFNpbXBsZUxpbmVTeW1ib2woKVxuICAgICAgICBjb2xvcjogWzI1NSwgMjU1LCAwLCAwLjhdLFxuICAgICAgICB3aWR0aDogM1xuICAgICAgfVxuICAgIH1cbiAgfSBlbHNlIGlmIChbJ21lc2gnXS5pbmNsdWRlcyhnZW9tZXRyeVR5cGUpKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHR5cGU6ICdtZXNoLTNkJywgLy8gYXV0b2Nhc3RzIGFzIG5ldyBNZXNoU3ltYm9sM0QoKVxuICAgICAgc3ltYm9sTGF5ZXJzOiBbe1xuICAgICAgICB0eXBlOiAnZmlsbCcsIC8vIGF1dG9jYXN0cyBhcyBuZXcgRmlsbFN5bWJvbDNETGF5ZXIoKVxuICAgICAgICBtYXRlcmlhbDogeyBjb2xvcjogWzI1NSwgMjU1LCAwLCAwLjhdIH1cbiAgICAgIH1dXG4gICAgfVxuICB9IGVsc2Uge1xuICAgIHJldHVybiBudWxsXG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0Q2VudGVyUG9pbnQgKGdlb21ldHJ5OiBfX2VzcmkuR2VvbWV0cnkpOiBfX2VzcmkuUG9pbnQge1xuICAvLyBwb2ludCB8IG11bHRpcG9pbnQgfCBwb2x5bGluZSB8IHBvbHlnb24gfCBleHRlbnQgfCBtZXNoXG4gIHN3aXRjaCAoZ2VvbWV0cnkudHlwZSkge1xuICAgIGNhc2UgJ3BvaW50JzpcbiAgICAgIHJldHVybiBnZW9tZXRyeSBhcyBfX2VzcmkuUG9pbnRcbiAgICBjYXNlICdleHRlbnQnOlxuICAgICAgcmV0dXJuIChnZW9tZXRyeSBhcyBfX2VzcmkuRXh0ZW50KS5jZW50ZXJcbiAgICBjYXNlICdwb2x5Z29uJzpcbiAgICAgIHJldHVybiAoZ2VvbWV0cnkgYXMgX19lc3JpLlBvbHlnb24pLmNlbnRyb2lkXG4gICAgY2FzZSAncG9seWxpbmUnOlxuICAgICAgcmV0dXJuIChnZW9tZXRyeSBhcyBfX2VzcmkuUG9seWxpbmUpLmV4dGVudC5jZW50ZXJcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGdlb21ldHJ5ICYmIGdlb21ldHJ5LmV4dGVudCA/IGdlb21ldHJ5LmV4dGVudC5jZW50ZXIgOiB1bmRlZmluZWRcbiAgICAvLyB0b2RvXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZUZlYXR1cmUgKGZlYXR1cmU6IElGZWF0dXJlIHwgX19lc3JpLkdyYXBoaWMsIEdyYXBoaWM6IF9fZXNyaS5HcmFwaGljQ29uc3RydWN0b3IpOiBfX2VzcmkuR3JhcGhpYyB7XG4gIGxldCB0ZW1wRmVhdHVyZSA9IG51bGxcbiAgaWYgKChmZWF0dXJlIGFzIGFueSkuY2xvbmUpIHtcbiAgICB0ZW1wRmVhdHVyZSA9IChmZWF0dXJlIGFzIGFueSkuY2xvbmUoKVxuICB9IGVsc2Uge1xuICAgIHRlbXBGZWF0dXJlID0gR3JhcGhpYy5mcm9tSlNPTihPYmplY3QuYXNzaWduKHt9LCBmZWF0dXJlKSlcbiAgICB0ZW1wRmVhdHVyZS5hdHRyaWJ1dGVzID0gT2JqZWN0LmFzc2lnbih7fSwgZmVhdHVyZS5hdHRyaWJ1dGVzKVxuICB9XG4gIHJldHVybiB0ZW1wRmVhdHVyZVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvamVjdEdlb21ldHJpZXMgKGdlb21ldHJpZXM6IF9fZXNyaS5HZW9tZXRyeVtdLCBzcGF0aWFsUmVmZXJlbmNlOiBfX2VzcmkuU3BhdGlhbFJlZmVyZW5jZSk6IFByb21pc2U8X19lc3JpLkdlb21ldHJ5W10+IHtcbiAgaWYgKCFnZW9tZXRyaWVzIHx8IGdlb21ldHJpZXMubGVuZ3RoID09PSAwIHx8ICFnZW9tZXRyaWVzWzBdIHx8XG4gICAgc3BhdGlhbFJlZmVyZW5jZS53a2lkID09PSBnZW9tZXRyaWVzWzBdLnNwYXRpYWxSZWZlcmVuY2Uud2tpZCB8fCAoc3BhdGlhbFJlZmVyZW5jZS5lcXVhbHMoZ2VvbWV0cmllc1swXS5zcGF0aWFsUmVmZXJlbmNlKSkpIHtcbiAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGdlb21ldHJpZXMpXG4gIH0gZWxzZSBpZiAoc3BhdGlhbFJlZmVyZW5jZS5pc1dlYk1lcmNhdG9yICYmIGdlb21ldHJpZXNbMF0uc3BhdGlhbFJlZmVyZW5jZS5pc1dHUzg0KSB7XG4gICAgLy8gSW4ganMgYXBpIDQueCwgdGhlIHZpZXcgY2FuIGhhbmRsZSBXZWJNZXJjYXRvciBhbmQgV0dTODQgc3BhdGlhbFJlZmVyZW5jZSBhdXRvXG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShnZW9tZXRyaWVzKVxuICB9IGVsc2UgaWYgKHNwYXRpYWxSZWZlcmVuY2UuaXNXR1M4NCAmJiBnZW9tZXRyaWVzWzBdLnNwYXRpYWxSZWZlcmVuY2UuaXNXZWJNZXJjYXRvcikge1xuICAgIC8vIEluIGpzIGFwaSA0LngsIHRoZSB2aWV3IGNhbiBoYW5kbGUgV2ViTWVyY2F0b3IgYW5kIFdHUzg0IHNwYXRpYWxSZWZlcmVuY2UgYXV0b1xuICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZ2VvbWV0cmllcylcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gYXdhaXQgZ2VvbWV0cnlVdGlscy5wcm9qZWN0VG9TcGF0aWFsUmVmZXJlbmNlKGdlb21ldHJpZXMsIHNwYXRpYWxSZWZlcmVuY2UpXG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3Nab29tVG9GZWF0dXJlcyAobWFwQmFzZVZpZXc6IF9fZXNyaS5NYXBWaWV3IHwgX19lc3JpLlNjZW5lVmlldywgbGF5ZXI6IGFueSwgZmVhdHVyZXM6IF9fZXNyaS5HcmFwaGljW10pOiBQcm9taXNlPF9fZXNyaS5HcmFwaGljW10+IHtcbiAgaWYgKG1hcEJhc2VWaWV3ICYmIG1hcEJhc2VWaWV3LnR5cGUgPT09ICczZCcgJiYgbGF5ZXIgJiYgbGF5ZXIucXVlcnlGZWF0dXJlcyAmJiBmZWF0dXJlcykge1xuICAgIHJldHVybiBhd2FpdCBsb2FkQXJjR0lTSlNBUElNb2R1bGVzKFtcbiAgICAgICdlc3JpL3Jlc3Qvc3VwcG9ydC9RdWVyeSdcbiAgICBdKS50aGVuKChtb2R1bGVzKSA9PiB7XG4gICAgICBjb25zdCBbUXVlcnldID0gbW9kdWxlc1xuICAgICAgY29uc3QgcXVlcnkgPSBuZXcgUXVlcnkoKVxuICAgICAgcXVlcnkucmV0dXJuR2VvbWV0cnkgPSB0cnVlXG4gICAgICBxdWVyeS5vdXRGaWVsZHMgPSBbJyonXVxuICAgICAgcXVlcnkub2JqZWN0SWRzID0gZmVhdHVyZXMubWFwKGZlYXR1cmUgPT4gZmVhdHVyZS5hdHRyaWJ1dGVzW2xheWVyLm9iamVjdElkRmllbGRdKVxuICAgICAgcmV0dXJuIGxheWVyLnF1ZXJ5RmVhdHVyZXMocXVlcnkpLnRoZW4oYXN5bmMgKHJlc3VsdCkgPT4ge1xuICAgICAgICBpZiAocmVzdWx0ICYmIHJlc3VsdC5mZWF0dXJlcyAmJiByZXN1bHQuZmVhdHVyZXMubGVuZ3RoID09PSBmZWF0dXJlcy5sZW5ndGgpIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKHJlc3VsdC5mZWF0dXJlcylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gYXdhaXQgUHJvbWlzZS5yZXNvbHZlKGZlYXR1cmVzKVxuICAgICAgICB9XG4gICAgICB9LCBhc3luYyAoKSA9PiB7XG4gICAgICAgIHJldHVybiBhd2FpdCBQcm9taXNlLnJlc29sdmUoZmVhdHVyZXMpXG4gICAgICB9KVxuICAgIH0pXG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGF3YWl0IFByb21pc2UucmVzb2x2ZShmZWF0dXJlcylcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gY2hlY2tJc0xpdmUgKGFwcE1vZGU6IEFwcE1vZGUpOiBib29sZWFuIHtcbiAgaWYgKHdpbmRvdy5qaW11Q29uZmlnLmlzSW5CdWlsZGVyKSB7XG4gICAgaWYgKGFwcE1vZGUgPT09IEFwcE1vZGUuRGVzaWduKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0TWFwQmFzZVJlc3RvcmVEYXRhIChtYXBJbnN0YW5jZTogTWFwQmFzZSk6IGFueSB7XG4gIHJldHVybiB7XG4gICAgbWFwQ29udGFpbmVyOiBtYXBJbnN0YW5jZS5tYXBDb250YWluZXIsXG4gICAgc3RhdGU6IG1hcEluc3RhbmNlLnN0YXRlLFxuICAgIE1hcFZpZXc6IG1hcEluc3RhbmNlLk1hcFZpZXcsXG4gICAgU2NlbmVWaWV3OiBtYXBJbnN0YW5jZS5TY2VuZVZpZXcsXG4gICAgRXh0ZW50OiBtYXBJbnN0YW5jZS5FeHRlbnQsXG4gICAgVmlld3BvaW50OiBtYXBJbnN0YW5jZS5WaWV3cG9pbnQsXG4gICAgbWFwVmlldzogbWFwSW5zdGFuY2UubWFwVmlldyxcbiAgICBzY2VuZVZpZXc6IG1hcEluc3RhbmNlLnNjZW5lVmlldyxcbiAgICBleHRlbnRXYXRjaDogbWFwSW5zdGFuY2UuZXh0ZW50V2F0Y2gsXG4gICAgZmF0YWxFcnJvcldhdGNoOiBtYXBJbnN0YW5jZS5mYXRhbEVycm9yV2F0Y2gsXG4gICAgZHNNYW5hZ2VyOiBtYXBJbnN0YW5jZS5kc01hbmFnZXIsXG4gICAgaGlnaExpZ2h0SGFuZGxlczogbWFwSW5zdGFuY2UuaGlnaExpZ2h0SGFuZGxlcyxcbiAgICBtYXBCYXNlVmlld0V2ZW50SGFuZGxlczogbWFwSW5zdGFuY2UubWFwQmFzZVZpZXdFdmVudEhhbmRsZXMsXG4gICAgQ29sb3I6IG1hcEluc3RhbmNlLkNvbG9yLFxuICAgIGlzUmVxdWVzdGluZ01hcDogbWFwSW5zdGFuY2UuaXNSZXF1ZXN0aW5nTWFwXG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc3RvcmVNYXBCYXNlIChtYXBJbnN0YW5jZTogTWFwQmFzZSwgcmVzdG9yZURhdGE6IGFueSk6IHZvaWQge1xuICBtYXBJbnN0YW5jZS5tYXBDb250YWluZXIgPSByZXN0b3JlRGF0YS5tYXBDb250YWluZXJcbiAgbWFwSW5zdGFuY2Uuc3RhdGUgPSByZXN0b3JlRGF0YS5zdGF0ZVxuICBtYXBJbnN0YW5jZS5NYXBWaWV3ID0gcmVzdG9yZURhdGEuTWFwVmlld1xuICBtYXBJbnN0YW5jZS5TY2VuZVZpZXcgPSByZXN0b3JlRGF0YS5TY2VuZVZpZXdcbiAgbWFwSW5zdGFuY2UuRXh0ZW50ID0gcmVzdG9yZURhdGEuRXh0ZW50XG4gIG1hcEluc3RhbmNlLlZpZXdwb2ludCA9IHJlc3RvcmVEYXRhLlZpZXdwb2ludFxuICBtYXBJbnN0YW5jZS5tYXBWaWV3ID0gcmVzdG9yZURhdGEubWFwVmlld1xuICBtYXBJbnN0YW5jZS5zY2VuZVZpZXcgPSByZXN0b3JlRGF0YS5zY2VuZVZpZXdcbiAgbWFwSW5zdGFuY2UuZXh0ZW50V2F0Y2ggPSByZXN0b3JlRGF0YS5leHRlbnRXYXRjaFxuICBtYXBJbnN0YW5jZS5mYXRhbEVycm9yV2F0Y2ggPSByZXN0b3JlRGF0YS5mYXRhbEVycm9yV2F0Y2hcbiAgbWFwSW5zdGFuY2UuZHNNYW5hZ2VyID0gcmVzdG9yZURhdGEuZHNNYW5hZ2VyXG4gIG1hcEluc3RhbmNlLmhpZ2hMaWdodEhhbmRsZXMgPSByZXN0b3JlRGF0YS5oaWdoTGlnaHRIYW5kbGVzXG4gIG1hcEluc3RhbmNlLm1hcEJhc2VWaWV3RXZlbnRIYW5kbGVzID0gcmVzdG9yZURhdGEubWFwQmFzZVZpZXdFdmVudEhhbmRsZXNcbiAgbWFwSW5zdGFuY2UuQ29sb3IgPSByZXN0b3JlRGF0YS5Db2xvclxuICBtYXBJbnN0YW5jZS5pc1JlcXVlc3RpbmdNYXAgPSByZXN0b3JlRGF0YS5pc1JlcXVlc3RpbmdNYXBcbn1cbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///./extensions/widgets/arcgis/arcgis-map/src/runtime/utils.ts\n");

/***/ }),

/***/ "jimu-arcgis":
/*!******************************!*\
  !*** external "jimu-arcgis" ***!
  \******************************/
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_arcgis__;

/***/ }),

/***/ "jimu-core":
/*!****************************!*\
  !*** external "jimu-core" ***!
  \****************************/
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_MODULE_jimu_core__;

/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		var cachedModule = __webpack_module_cache__[moduleId];
/******/ 		if (cachedModule !== undefined) {
/******/ 			return cachedModule.exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	// This entry module can't be inlined because the eval-source-map devtool is used.
/******/ 	var __webpack_exports__ = __webpack_require__("./extensions/widgets/arcgis/arcgis-map/src/message-actions/pan-to-action.ts");
/******/ 	
/******/ 	return __webpack_exports__;
/******/ })()

			);
		}
	};
});